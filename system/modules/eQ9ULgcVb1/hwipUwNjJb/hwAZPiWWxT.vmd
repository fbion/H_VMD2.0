{"vmdversion":"2.0.3.20190124","vmdlayout":"{\"components\":[{\"cid\":\"viewport\",\"id\":\"MyViewport\",\"layoutConfig\":{},\"userConfig\":{\"layout\":\"border\",\"afterrender\":\"MyViewport_afterrender\",\"beforerender\":\"MyViewport_beforerender\"},\"cn\":[{\"cid\":\"panel\",\"id\":\"MyPanel_head\",\"layoutConfig\":{},\"userConfig\":{\"x\":0,\"y\":0,\"height\":60,\"layout\":\"border\",\"bodyStyle\":\"background-color: #409EFF;\",\"region\":\"north\",\"id\":\"MyPanel_head\",\"header\":false},\"cn\":[{\"cid\":\"panel\",\"id\":\"MyPanel_logo\",\"layoutConfig\":{},\"userConfig\":{\"region\":\"west\",\"layout\":\"border\",\"width\":200,\"maskDisabled\":true,\"border\":false,\"bodyStyle\":\"background-color: #0676fe;\",\"id\":\"MyPanel_logo\",\"header\":false},\"cn\":[{\"cid\":\"container\",\"id\":\"MyC_Logoimg\",\"layoutConfig\":{},\"userConfig\":{\"width\":58,\"height\":42,\"style\":\"background: url('/system/img/main/vmdlogo.png') no-repeat center;    margin-left: 20px;    margin-top: 5px;\",\"x\":0,\"y\":0,\"region\":\"west\",\"id\":\"MyC_Logoimg\",\"border\":false}},{\"cid\":\"label\",\"id\":\"MyLb_name\",\"layoutConfig\":{},\"userConfig\":{\"x\":70,\"y\":10,\"text\":\"VMD2.0\",\"style\":\"font-family: \\\"Microsoft Yahei\\\";    font-size: 26px;    color: #ffffff;    margin-left: 20px;    margin-top: 4px;\",\"region\":\"center\",\"split\":false,\"cls\":\"lineHeight200\",\"id\":\"MyLb_name\",\"width\":180}}]},{\"cid\":\"panel\",\"id\":\"MyP_Htool\",\"layoutConfig\":{\"align\":\"middle\",\"pack\":\"end\",\"scrollOffset\":20},\"userConfig\":{\"region\":\"east\",\"width\":520,\"layout\":\"hbox\",\"border\":false,\"style\":\"background-color: skyblue;\",\"bodyStyle\":\"background-color: #0676FE;\",\"id\":\"MyP_Htool\",\"header\":false,\"margins\":\"\",\"padding\":\"\",\"cmargins\":\"\",\"split\":false,\"afterrender\":\"MyP_Htool_afterrender\"},\"cn\":[{\"cid\":\"container\",\"id\":\"div3\",\"layoutConfig\":{},\"userConfig\":{\"width\":40,\"border\":false,\"backgroundImage\":\"/system/modules/eQ9ULgcVb1/img/tips.png\",\"backgroundRepeat\":\"no-repeat\",\"backgroundPosition\":\"center center\",\"flex\":\"\",\"disableImage\":false,\"click\":\"div3_click\"}},{\"cid\":\"container\",\"id\":\"MyC_pro\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"MyC_pro\",\"border\":false,\"style\":\"background-image: url(/system/img/main/sysmange.png);    background-repeat: no-repeat;    background-position: 5px center;    background-size: 16px;    padding-left: 25px;\",\"height\":40,\"width\":80,\"overCls\":\"div-hove\"},\"cn\":[{\"cid\":\"vmdButton\",\"id\":\"btnPro\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"btnPro\",\"style\":\"font-size: 12px;    color: #ffffff;    margin-right: 10px;    line-height: 30px;\",\"type\":\"text\",\"text\":\"项目管理\",\"click\":\"btnPro_click\"}}]},{\"cid\":\"container\",\"id\":\"div\",\"layoutConfig\":{},\"userConfig\":{\"x\":83,\"y\":25,\"height\":40,\"width\":80,\"style\":\"background-image: url(/system/img/main/hjbl.png);    background-repeat: no-repeat;    margin-right: 10px;    background-position: 8px center;    padding-left: 30px;\",\"border\":false,\"region\":\"center\",\"margins\":\"\",\"cls\":\"hove\",\"overCls\":\"div-hove\"},\"cn\":[{\"cid\":\"vmdButton\",\"id\":\"btnWorkSpaceManagement\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"btnWorkSpaceManagement\",\"text\":\"工区管理\",\"type\":\"text\",\"style\":\"font-size: 12px;    color: #ffffff;    margin-right: 10px;    line-height: 30px;\",\"x\":110,\"y\":22,\"click\":\"btnWorkSpaceManagement_click\",\"width\":\"\",\"region\":\"west\",\"margins\":\"0 5 0 0\"}}]},{\"cid\":\"container\",\"id\":\"div2\",\"layoutConfig\":{},\"userConfig\":{\"width\":80,\"height\":40,\"backgroundImage\":\"/system/modules/eQ9ULgcVb1/img/复合组件1.png\",\"backgroundPosition\":\"top left\",\"style\":\"margin-right: 10px;    background-image: url('/system/modules/eQ9ULgcVb1/img/复合组件1.png');    background-repeat: no-repeat;    background-position: 5px center;    padding-left: 30px;    background-size: 22px;\",\"border\":false,\"overCls\":\"div-hove\"},\"cn\":[{\"cid\":\"vmdButton\",\"id\":\"btn_uxcom\",\"layoutConfig\":{},\"userConfig\":{\"type\":\"text\",\"id\":\"btn_uxcom\",\"click\":\"btn_uxcom_click\",\"style\":\"font-size: 12px;    color: #ffffff;    line-height: 30px;\",\"margins\":\"0 10 0 5\",\"text\":\"复合组件\"}}]},{\"cid\":\"container\",\"id\":\"MyC_zy\",\"layoutConfig\":{},\"userConfig\":{\"x\":270,\"y\":25,\"width\":80,\"id\":\"MyC_zy\",\"style\":\"background-image: url(/system/img/main/zy.png);    background-repeat: no-repeat;    background-position: 8px center;    padding-left: 28px;    background-size: 18px;\",\"height\":40,\"pageX\":\"\",\"pageY\":\"\",\"border\":false,\"overCls\":\"div-hove\"},\"cn\":[{\"cid\":\"vmdButton\",\"id\":\"btnZy\",\"layoutConfig\":{},\"userConfig\":{\"x\":200,\"y\":22,\"style\":\"font-size: 12px;    color: #ffffff;    line-height: 30px;\",\"text\":\"资源管理\",\"type\":\"text\",\"width\":\"\",\"id\":\"btnZy\",\"click\":\"btnZy_click\",\"margins\":\"0 5 0 0\"}}]},{\"cid\":\"container\",\"id\":\"MyC_hjbl\",\"layoutConfig\":{},\"userConfig\":{\"x\":270,\"y\":25,\"width\":1,\"style\":\"background-image: url(/system/img/main/xtpz.png);    background-repeat: no-repeat;    background-position: 8px center;    background-size: 18px;    padding-left: 28px;    display: none\",\"height\":40,\"id\":\"MyC_hjbl\",\"border\":false,\"overCls\":\"div-hove\"},\"cn\":[{\"cid\":\"vmdButton\",\"id\":\"btnXtpz\",\"layoutConfig\":{},\"userConfig\":{\"style\":\"font-size: 12px;    color: #ffffff;    line-height: 28px;\",\"text\":\"系统配置\",\"width\":\"\",\"type\":\"text\",\"y\":22,\"x\":290,\"id\":\"btnXtpz\",\"click\":\"btnXtpz_click\",\"margins\":\"0 5 0 0\"}}]},{\"cid\":\"container\",\"id\":\"MyC_grxx\",\"layoutConfig\":{},\"userConfig\":{\"x\":360,\"y\":25,\"width\":80,\"style\":\"background-image: url(/system/img/main/grxx.png);    background-repeat: no-repeat;    background-position: 5px center;    background-size: 18px;    padding-left: 25px;\",\"height\":40,\"id\":\"MyC_grxx\",\"border\":false,\"margins\":\"\",\"overCls\":\"\"},\"cn\":[{\"cid\":\"vmdButton\",\"id\":\"btnGrxx\",\"layoutConfig\":{},\"userConfig\":{\"style\":\"font-size: 12px;    color: #ffffff;    cursor: default;    line-height: 28px;\",\"text\":\"个人信息\",\"type\":\"text\",\"width\":\"\",\"id\":\"btnGrxx\",\"x\":380,\"y\":22,\"click\":\"btnGrxx_click\",\"margins\":\"0 10 0 0\"}}]},{\"cid\":\"container\",\"id\":\"MyC_tc\",\"layoutConfig\":{},\"userConfig\":{\"x\":430,\"y\":25,\"width\":60,\"style\":\"background-image: url(/system/img/main/tc.png);    background-repeat: no-repeat;    background-position: 5px center;    background-size: 16px;    padding-left: 25px;\",\"height\":40,\"id\":\"MyC_tc\",\"afterrender\":\"MyC_tc_afterrender\",\"border\":false,\"overCls\":\"div-hove\"},\"cn\":[{\"cid\":\"vmdButton\",\"id\":\"button\",\"layoutConfig\":{},\"userConfig\":{\"x\":440,\"y\":22,\"type\":\"text\",\"width\":\"\",\"style\":\"font-size: 12px;    color: #ffffff;    line-height: 28px;\",\"text\":\"退&nbsp;&nbsp;出\",\"id\":\"button\",\"click\":\"button_click\"}}]}]},{\"cid\":\"panel\",\"id\":\"panel3\",\"layoutConfig\":{},\"userConfig\":{\"region\":\"center\",\"border\":false,\"header\":false,\"layout\":\"auto\",\"bodyStyle\":\"background-color: #0676FE;\",\"width\":\"\"},\"cn\":[{\"cid\":\"panel\",\"id\":\"panel4\",\"layoutConfig\":{},\"userConfig\":{\"bodyStyle\":\"background-color: #0676FE;\",\"border\":false,\"header\":false,\"height\":45},\"cn\":[{\"cid\":\"panel\",\"id\":\"panel6\",\"layoutConfig\":{},\"userConfig\":{\"border\":false,\"header\":false,\"bodyStyle\":\"background-color: #0676FE;\",\"height\":50,\"width\":211,\"afterrender\":\"panel6_afterrender\"},\"cn\":[{\"cid\":\"vmdButton\",\"id\":\"btnWorkSpaceName\",\"layoutConfig\":{},\"userConfig\":{\"text\":\"我的工区\",\"id\":\"btnWorkSpaceName\",\"type\":\"text\",\"style\":\"font-family: \\\"Microsoft Yahei\\\";    font-size: 18px;    color: #fff;    line-height: 55px;    background-image: icon-double-angle-down;    background-position: center left;\",\"y\":18,\"region\":\"center\",\"click\":\"btnWorkSpaceName_click\",\"icon\":\"icon-angle-down\"}},{\"cid\":\"vmdButton\",\"id\":\"btnMenu1\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"btnMenu1\",\"text\":\"\",\"click\":\"btnMenu1_click\",\"type\":\"text\",\"style\":\"font-size: 18px;    color: #fff;    margin-left: 10px;\",\"x\":100,\"y\":12,\"region\":\"east\",\"icon\":\"icon-cog\"}}]}]},{\"cid\":\"container\",\"id\":\"div1\",\"layoutConfig\":{},\"userConfig\":{\"height\":20,\"border\":false,\"style\":\"background-image: url('/system/modules/eQ9ULgcVb1/img/down.png');    background-repeat: no-repeat;    background-size: 17px 11px;    margin-right: 10px;    background-position: 30px 0;\",\"backgroundImage\":\"/system/modules/eQ9ULgcVb1/img/down.png\",\"hidden\":true}}]}]},{\"cid\":\"panel\",\"id\":\"MyP_info\",\"layoutConfig\":{},\"userConfig\":{\"x\":0,\"y\":60,\"height\":640,\"layout\":\"border\",\"region\":\"center\",\"id\":\"MyP_info\",\"header\":false,\"border\":false},\"cn\":[{\"cid\":\"panel\",\"id\":\"MyP_ModelTree\",\"layoutConfig\":{},\"userConfig\":{\"width\":220,\"height\":639,\"layout\":\"border\",\"x\":0,\"y\":0,\"region\":\"west\",\"id\":\"MyP_ModelTree\",\"header\":false,\"style\":\"background-color: white;\",\"bodyStyle\":\"background-color: white;\",\"split\":true,\"floatable\":false,\"collapseMode\":\"mini\",\"collapsible\":true,\"border\":false},\"cn\":[{\"cid\":\"panel\",\"id\":\"MyPanel2\",\"layoutConfig\":{},\"userConfig\":{\"region\":\"north\",\"id\":\"MyPanel2\",\"layout\":\"border\",\"border\":true,\"header\":false,\"height\":40,\"afterrender\":\"MyPanel2_afterrender\"},\"cn\":[{\"cid\":\"panel\",\"id\":\"MyPanel\",\"layoutConfig\":{},\"userConfig\":{\"x\":0,\"y\":0,\"border\":false,\"header\":false,\"layout\":\"border\",\"width\":220,\"height\":40,\"region\":\"center\",\"autoHeight\":false,\"autoWidth\":false,\"id\":\"MyPanel\"},\"cn\":[{\"cid\":\"vmdButton\",\"id\":\"btnProjectName\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"btnProjectName\",\"text\":\"源头数据采集项目\",\"style\":\"font-family: Microsoft YaHei;    font-size: 16px;    text-align: left;    padding-left: 10px;    overflow: hidden;\",\"width\":167,\"height\":24,\"region\":\"center\",\"type\":\"text\",\"disabled\":false,\"hidden\":false,\"autoHide\":false,\"x\":3,\"y\":14,\"click\":\"btnProjectName_click\",\"icon\":\"icon-angle-down\"}},{\"cid\":\"vmdButton\",\"id\":\"ListBtn\",\"layoutConfig\":{},\"userConfig\":{\"x\":180,\"y\":5,\"width\":30,\"height\":20,\"id\":\"ListBtn\",\"text\":\"\",\"type\":\"text\",\"style\":\"font-size: 16px;    border: 0;\",\"region\":\"east\",\"cls\":\"\",\"icon\":\"icon-wrench\",\"click\":\"ListBtn_click\",\"disabled\":false}}]}]},{\"cid\":\"panel\",\"id\":\"MyPanel1\",\"layoutConfig\":{},\"userConfig\":{\"x\":70,\"y\":130,\"height\":300,\"border\":false,\"header\":false,\"region\":\"center\",\"layout\":\"fit\",\"width\":357},\"cn\":[{\"cid\":\"tabpanel\",\"id\":\"MyTabs\",\"layoutConfig\":{},\"userConfig\":{\"unstyled\":false,\"activeItem\":\"panel\",\"activeTab\":0,\"tabchange\":\"MyTabs_tabchange\"},\"cn\":[{\"cid\":\"panel\",\"id\":\"panel\",\"layoutConfig\":{},\"userConfig\":{\"title\":\"模块\",\"id\":\"panel\",\"border\":false,\"layout\":\"border\",\"afterrender\":\"panel_afterrender\"},\"cn\":[{\"cid\":\"panel\",\"id\":\"panel5\",\"layoutConfig\":{},\"userConfig\":{\"border\":false,\"header\":false,\"region\":\"north\",\"layout\":\"fit\",\"height\":28,\"afterrender\":\"panel5_afterrender\"},\"cn\":[{\"cid\":\"vmdComlist\",\"id\":\"mCombo\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"mCombo\",\"afterrender\":\"mCombo_afterrender\",\"selectChanged\":\"mCombo_selectChanged\",\"style\":\"border: 1px solid #dfdfdf;    border-right: 0;    border-top: 0;    font-size: 13px;\"}}]},{\"cid\":\"vmdTree\",\"id\":\"hwTree\",\"layoutConfig\":{},\"userConfig\":{\"x\":0,\"y\":0,\"afterrender\":\"hwTree_afterrender\",\"height\":\"\",\"width\":220,\"onOpenEnd\":\"hwTree_onOpenEnd\",\"nodeClick\":\"hwTree_nodeClick\",\"region\":\"center\",\"onOpenStart\":\"hwTree_onOpenStart\",\"onDblClick\":\"hwTree_onDblClick\",\"doubleClick\":\"\",\"nodeSelected\":\"\",\"beforerender\":\"hwTree_beforerender\",\"CheckBox\":false}}]},{\"cid\":\"panel\",\"id\":\"panel1\",\"layoutConfig\":{},\"userConfig\":{\"title\":\"工作流\",\"border\":false,\"layout\":\"fit\"},\"cn\":[{\"cid\":\"panel\",\"id\":\"panel7\",\"layoutConfig\":{},\"userConfig\":{\"border\":false,\"header\":false,\"layout\":\"fit\",\"afterrender\":\"panel7_afterrender\"},\"cn\":[{\"cid\":\"vmdTree\",\"id\":\"hwTreeWorkFlow\",\"layoutConfig\":{},\"userConfig\":{\"height\":580,\"width\":220,\"id\":\"hwTreeWorkFlow\",\"afterrender\":\"hwTreeWorkFlow_afterrender\",\"nodeClick\":\"hwTreeWorkFlow_nodeClick\",\"onOpenEnd\":\"hwTreeWorkFlow_onOpenEnd\",\"beforerender\":\"hwTreeWorkFlow_beforerender\"}}]}]},{\"cid\":\"panel\",\"id\":\"panel2\",\"layoutConfig\":{},\"userConfig\":{\"title\":\"数据服务\",\"border\":false,\"layout\":\"fit\"},\"cn\":[{\"cid\":\"panel\",\"id\":\"panel8\",\"layoutConfig\":{},\"userConfig\":{\"layout\":\"fit\",\"border\":false,\"header\":false,\"afterrender\":\"panel8_afterrender\"},\"cn\":[{\"cid\":\"vmdTree\",\"id\":\"hwTreeDataService\",\"layoutConfig\":{},\"userConfig\":{\"height\":580,\"width\":220,\"id\":\"hwTreeDataService\",\"afterrender\":\"hwTreeDataService_afterrender\",\"nodeClick\":\"hwTreeDataService_nodeClick\",\"beforerender\":\"hwTreeDataService_beforerender\"}}]}]}]}]}]},{\"cid\":\"panel\",\"id\":\"MyP_jcxx\",\"layoutConfig\":{},\"userConfig\":{\"width\":900,\"x\":220,\"y\":0,\"height\":640,\"layout\":\"anchor\",\"region\":\"center\",\"id\":\"MyP_jcxx\",\"header\":false,\"border\":false,\"afterrender\":\"MyP_jcxx_afterrender\"},\"cn\":[{\"cid\":\"container\",\"id\":\"divJcxx\",\"layoutConfig\":{},\"userConfig\":{\"layout\":\"anchor\",\"width\":869,\"height\":629,\"id\":\"divJcxx\",\"hidden\":true,\"anchor\":\"100% 100%\"}},{\"cid\":\"vmd.ux.WorkflowModuleInfo\",\"id\":\"WorkflowModuleInfo\",\"layoutConfig\":{},\"userConfig\":{\"hidden\":true}},{\"cid\":\"vmd.ux.DataServiceModuleInfo\",\"id\":\"DataServiceModuleInfo\",\"layoutConfig\":{},\"userConfig\":{\"hidden\":true}},{\"cid\":\"vmd.ux.ModuleInfo\",\"id\":\"ModuleInfo\",\"layoutConfig\":{},\"userConfig\":{\"anchor\":\"100% 100%\",\"hidden\":true}}]}]},{\"cid\":\"vmdMenu\",\"id\":\"hwMenuWorkSpaceList\",\"layoutConfig\":{},\"userConfig\":{\"region\":\"west\",\"id\":\"hwMenuWorkSpaceList\",\"click\":\"hwMenuWorkSpaceList_click\",\"width\":120}},{\"cid\":\"vmdMenu\",\"id\":\"hwMenuWorkSpace\",\"layoutConfig\":{},\"userConfig\":{\"region\":\"west\",\"id\":\"hwMenuWorkSpace\",\"click\":\"hwMenuWorkSpace_click\",\"width\":50},\"cn\":[{\"cid\":\"vmdMenuItem\",\"id\":\"hwMenuItemAddProject\",\"layoutConfig\":{},\"userConfig\":{\"text\":\"添加项目\",\"hidden\":false,\"id\":\"hwMenuItemAddProject\"}},{\"cid\":\"vmdMenuItem\",\"id\":\"hwMenuItemNewProject\",\"layoutConfig\":{},\"userConfig\":{\"text\":\"新建项目\",\"hidden\":true,\"id\":\"hwMenuItemNewProject\"}},{\"cid\":\"vmdMenuItem\",\"id\":\"hwMenuItemWorkSpaceConfig\",\"layoutConfig\":{},\"userConfig\":{\"text\":\"参数配置\",\"hidden\":false,\"id\":\"hwMenuItemWorkSpaceConfig\"}}]},{\"cid\":\"vmdMenu\",\"id\":\"hwMenuProject\",\"layoutConfig\":{},\"userConfig\":{\"region\":\"east\",\"id\":\"hwMenuProject\",\"click\":\"hwMenuProject_click\",\"width\":50},\"cn\":[{\"cid\":\"vmdMenuItem\",\"id\":\"hwMenuItemProjectConfig\",\"layoutConfig\":{},\"userConfig\":{\"text\":\"项目配置\",\"id\":\"hwMenuItemProjectConfig\"}},{\"cid\":\"vmdMenuItem\",\"id\":\"ProjectNewFord\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"ProjectNewFord\",\"text\":\"新建分类\",\"hidden\":true}},{\"cid\":\"vmdMenuItem\",\"id\":\"ProjectNewMode\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"ProjectNewMode\",\"text\":\"新建模块\",\"hidden\":true}},{\"cid\":\"vmdMenuItem\",\"id\":\"hwMenuItemProjectDel\",\"layoutConfig\":{},\"userConfig\":{\"text\":\"删除\",\"id\":\"hwMenuItemProjectDel\"}}]},{\"cid\":\"vmdMenu\",\"id\":\"hwMenuProjectList\",\"layoutConfig\":{},\"userConfig\":{\"region\":\"south\",\"id\":\"hwMenuProjectList\",\"width\":120,\"click\":\"hwMenuProjectList_click\"}},{\"cid\":\"vmdMenu\",\"id\":\"hwMenuProjectConfig\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"hwMenuProjectConfig\"},\"cn\":[{\"cid\":\"vmdMenuItem\",\"id\":\"projectInfo\",\"layoutConfig\":{},\"userConfig\":{\"text\":\"项目配置\",\"hidden\":false,\"id\":\"projectInfo\",\"click\":\"projectInfo_click\"}},{\"cid\":\"vmdMenuItem\",\"id\":\"RegInfo\",\"layoutConfig\":{},\"userConfig\":{\"text\":\"发布注册配置\",\"hidden\":false,\"id\":\"RegInfo\",\"click\":\"RegInfo_click\"}},{\"cid\":\"vmdMenuItem\",\"id\":\"varsInfo\",\"layoutConfig\":{},\"userConfig\":{\"text\":\"环境变量\",\"hidden\":false,\"id\":\"varsInfo\",\"click\":\"varsInfo_click\"}}]},{\"cid\":\"vmdMenu\",\"id\":\"hwMenuProMange\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"hwMenuProMange\"},\"cn\":[{\"cid\":\"vmdMenuItem\",\"id\":\"newProject\",\"layoutConfig\":{},\"userConfig\":{\"text\":\"新建项目\",\"hidden\":false,\"id\":\"newProject\",\"click\":\"newProject_click\"}},{\"cid\":\"vmdMenuItem\",\"id\":\"projectExp\",\"layoutConfig\":{},\"userConfig\":{\"text\":\"导出项目\",\"hidden\":false,\"id\":\"projectExp\",\"click\":\"projectExp_click\"}},{\"cid\":\"vmdMenuItem\",\"id\":\"projectImp\",\"layoutConfig\":{},\"userConfig\":{\"text\":\"项目导入\",\"hidden\":false,\"id\":\"projectImp\",\"click\":\"projectImp_click\"}}]},{\"cid\":\"vmdMenu\",\"id\":\"hwMenuHelp\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"hwMenuHelp\"},\"cn\":[{\"cid\":\"vmdMenuItem\",\"id\":\"guide\",\"layoutConfig\":{},\"userConfig\":{\"text\":\"向导\",\"hidden\":false,\"id\":\"guide\",\"click\":\"guide_click\"}},{\"cid\":\"vmdMenuItem\",\"id\":\"about\",\"layoutConfig\":{},\"userConfig\":{\"text\":\"关于\",\"hidden\":false,\"id\":\"about\",\"click\":\"about_click\"}}]},{\"cid\":\"vmd.ux.Uploader\",\"id\":\"Uploader\",\"layoutConfig\":{},\"userConfig\":{\"region\":\"east\",\"width\":\"\",\"height\":\"\",\"hidden\":true}}]},{\"cid\":\"vmddataset\",\"id\":\"数据集\",\"layoutConfig\":{},\"userConfig\":{}},{\"cid\":\"vmdvariable\",\"id\":\"变量\",\"layoutConfig\":{},\"userConfig\":{},\"cn\":[{\"cid\":\"vmdVariable\",\"id\":\"hwvarWorkSpaceId\",\"layoutConfig\":{},\"userConfig\":{\"cid\":\"vmdVariable\",\"id\":\"hwvarWorkSpaceId\"}},{\"cid\":\"vmdVariable\",\"id\":\"hwproject_id\",\"layoutConfig\":{},\"userConfig\":{\"cid\":\"vmdVariable\",\"id\":\"hwproject_id\"}}]},{\"cid\":\"vmdsubviewport\",\"id\":\"SubView_Window\",\"layoutConfig\":{},\"userConfig\":{}}]}","vmdevents":"//上次点击的节点\r\nvar bselNodeId = \"\";\r\n//获取传递的设计模式\r\nvar allowedDesigner = false;\r\nvar einfo = Ext.util.Cookies.get('hwEcyLogin');\r\nvar login = Ext.util.Cookies.get('hwLogin');\r\n// 项目ID\r\nvar hwproject_id = '';\r\nvar lastWorkId = ''; //上一个活动工区 \r\nvar myMask, selectData = [],\r\n    cateData = [];\r\nvar store = new Ext.data.JsonStore({\r\n    proxy: new Ext.data.MemoryProxy(),\r\n    fields: ['id', 'name', 'category_id', 'project_id']\r\n});\r\n// vmd.workspace = {\r\n//     workflowIp: '',\r\n//     dataServiceIp: '',\r\n//     workspaceid: ''\r\n// }\r\n\r\n//初始化数据\r\nfunction hwTree_afterrender(sender) {\r\n    // 清空树原有的默认数据\r\n    hwTree.deleteChildItems(0);\r\n    hwTree.el.dom.setAttribute(\"data-step\", \"4\");\r\n    hwTree.el.dom.setAttribute(\"data-intro\", \"项目模块树，用于展示该项目的分类及模块，通过切换项目实现项目树信息的变化；\");\r\n    hwTree.el.dom.setAttribute(\"data-position\", \"right\");\r\n}\r\n\r\nfunction hwTree_onOpenEnd(sender, id) {\r\n    OpenNOde(id)\r\n}\r\n// 展开节点操作\r\nfunction OpenNOde(id, callback) {\r\n    var proId = id;\r\n    var mytree = hwTree;\r\n    mytree.newnode = false;\r\n    var hasChild = mytree.hasChildren(proId);\r\n    var selnode = mytree.itemObj[proId];\r\n    var selnodepath = selnode.path;\r\n    var projectId = hwproject_id.getValue();\r\n    var childParentId = id;\r\n\r\n    // return;\r\n    if(!selnode.loadChild && !selnode.isModel) {\r\n\r\n        var myMask = new Ext.LoadMask(Ext.getCmp(\"hwTree\").el, {\r\n            msg: \"数据加载中,请稍后...\",\r\n            msgCls: 'z-index:10000;'\r\n        });\r\n        myMask.show();\r\n\r\n        var bCategoryFlag = false;\r\n        var bInfoFlag = false;\r\n\r\n        hwDas.ajax({\r\n            das: {\r\n                idedas: true\r\n            },\r\n            url: \"CDEServcie/module/category\",\r\n            type: 'get',\r\n            timeout: 5000,\r\n            params: {\r\n                project_id: projectId,\r\n                parent_id: childParentId\r\n            },\r\n            success: function(result) {\r\n                var datajson = result.data[0].datas;\r\n                var treeDataJson = [];\r\n                for(var i = 0; i < datajson.length; i++) {\r\n                    mytree.insertNewChild(proId, datajson[i].id, datajson[i].name);\r\n                    mytree.setItemImage2(datajson[i].id, \"tree/folderClosed.gif\", \"tree/folderOpen.gif\", \"tree/folderClosed.gif\")\r\n                    mytree.insertNewChild(datajson[i].id, datajson[i].id + \"-0\", \"\");\r\n                    mytree.closeItem(datajson[i].id);\r\n                    var treenode = mytree.item(datajson[i].id);\r\n                    treenode.path = selnodepath + \"/\" + datajson[i].id;\r\n                    treenode.projectId = projectId;\r\n                    if(treenode) {\r\n                        treenode.isFord = true;\r\n                        treenode.loadChild = false;\r\n                    }\r\n                    mytree.itemObj[datajson[i].id] = treenode;\r\n                }\r\n\r\n                bCategoryFlag = true;\r\n                if(bCategoryFlag && bInfoFlag) {\r\n                    myMask.hide();\r\n                }\r\n                if(callback) {\r\n                    callback();\r\n                }\r\n            },\r\n            error: function(msg) {\r\n                bCategoryFlag = true;\r\n                if(bCategoryFlag && bInfoFlag) {\r\n                    myMask.hide();\r\n                }\r\n                Ext.Msg.alert(\"提示\", \"获取模块信息失败\", function() {})\r\n            }\r\n        })\r\n        if(!selnode.loadChild) {\r\n            mytree.deleteItem(id + \"-0\", false);\r\n        }\r\n        selnode.loadChild = true;\r\n        hwDas.ajax({\r\n            das: {\r\n                idedas: true\r\n            },\r\n            url: \"CDEServcie/module/info\",\r\n            type: 'get',\r\n            timeout: 5000,\r\n            params: {\r\n                category_id: childParentId,\r\n                project_id: projectId\r\n            },\r\n            success: function(result) {\r\n                var datajson = result.data[0].datas;\r\n                var treeDataJson = [];\r\n                for(var i = 0; i < datajson.length; i++) {\r\n                    mytree.insertNewChild(proId, datajson[i].id, datajson[i].name);\r\n                    mytree.setItemImage2(datajson[i].id, \"tree/model.png\", \"tree/model.png\", \"tree/model.png\")\r\n                    var treenode = mytree.item(datajson[i].id);\r\n                    treenode.path = selnodepath + \"/\" + datajson[i].id;\r\n                    treenode.projectId = projectId;\r\n                    if(treenode) {\r\n                        treenode.isModel = true;\r\n                        treenode.createuser = datajson[i].row_created_by;\r\n                        treenode.createtime = datajson[i].row_created_date;\r\n                        treenode.changetime = datajson[i].row_changed_date;\r\n                        treenode.changeuser = datajson[i].row_changed_by;\r\n                        treenode.remark = datajson[i].remark;\r\n                        treenode.code = datajson[i].code;\r\n                    }\r\n                    mytree.itemObj[datajson[i].id] = treenode;\r\n                }\r\n                bInfoFlag = true;\r\n                if(bCategoryFlag && bInfoFlag) {\r\n                    myMask.hide();\r\n                }\r\n                if(callback) {\r\n                    callback();\r\n                }\r\n            },\r\n            error: function(msg) {\r\n                bInfoFlag = true;\r\n                if(bCategoryFlag && bInfoFlag) {\r\n                    myMask.hide();\r\n                }\r\n                Ext.Msg.alert(\"提示\", \"获取模块信息失败\")\r\n            }\r\n        })\r\n    }\r\n}\r\nvar lastnodeType = \"-1\"; // 0:空白，1：分类，2：模板\r\n//点击树节点操作\r\nfunction hwTree_nodeClick(sender, id) {\r\n    var proId = id;\r\n    var mytree = hwTree;\r\n    mytree.newnode = false;\r\n    var hasChild = mytree.hasChildren(proId);\r\n    var selnode = mytree.itemObj[proId];\r\n    var selnodepath = selnode.path;\r\n    var projectId = btnProjectName.projectId;\r\n    var childParentId = \"0\";\r\n    // if(bselNodeId != id) \r\n    {\r\n        if(selnode.isModel) {\r\n            divJcxx.hide();\r\n            ModuleInfo.show();\r\n            WorkflowModuleInfo.hide();\r\n            DataServiceModuleInfo.hide();\r\n\r\n            ModuleInfo.refresh(hwTree, projectId, btnWorkSpaceName.workspaceId);\r\n            lastnodeType = \"2\"\r\n            // document.getElementById(\"iframe_page\").src = vmd.virtualPath + vmdSettings.systemPath+'/eQ9ULgcVb5/hwa99a3307.html';\r\n        } else {\r\n            if(lastnodeType != \"1\") {\r\n                divJcxx.show();\r\n                ModuleInfo.hide()\r\n                WorkflowModuleInfo.hide();\r\n                DataServiceModuleInfo.hide();\r\n\r\n                document.getElementById(\"iframe_page\").src = vmd.virtualPath + vmdSettings.systemPath+'/eQ9ULgcVb5/hw03cb4931.html';\r\n                //MyP_jcxx.body.update(\"<\" + \"iframe \" + \" src=vmdSettings.systemPath+'/eQ9ULgcVb5/hw03cb4931.html' \" + \" width=100% height=100% frameborder=0  \" + \">\" + \"sdsds\" + \"<\" + \"/\" + \"iframe\" + \">\");\r\n                // projectId = selnode.projectId;\r\n                childParentId = proId;\r\n                lastnodeType = \"1\";\r\n            }\r\n\r\n            // document.getElementById(\"iframe_page\").src = vmd.virtualPath + vmdSettings.systemPath+'/eQ9ULgcVb5/hw03cb4931.html';\r\n        }\r\n    }\r\n    bselNodeId = id;\r\n}\r\n//创建分类按钮操作\r\nfunction creatFord() {\r\n    var addford = function(fordname, callback) {\r\n        var mytree = hwTree;\r\n        var selId = mytree.getSelectedItemId();\r\n        var selnode = mytree.itemObj[selId];\r\n        var selnodepath = selnode.path;\r\n        var parentId;\r\n        var projectId;\r\n        var nodename = fordname;\r\n        var newnodeid = newGuid(10);\r\n        var newcode = newGuid(10);\r\n        var xh = 10;\r\n        if(selnode.isProject) {\r\n            parentId = \"0\";\r\n            projectId = selId;\r\n        } else if(selnode.isModel) {\r\n            return;\r\n        } else if(selnode.isFord) {\r\n            parentId = selId;\r\n            projectId = selnode.projectId;\r\n        }\r\n        myMask = new Ext.LoadMask(Ext.getBody(), {\r\n            msg: \"加载中,请稍后...\"\r\n        });\r\n        myMask.show();\r\n        // 判断同一目录下是否存在相同名称分类\r\n        checkfordReName(projectId, parentId, newnodeid, nodename, function() {\r\n            if(callback) {\r\n                callback()\r\n            }\r\n            hwDas.ajax({\r\n                das: {\r\n                    idedas: true\r\n                },\r\n                url: \"CDEServcie/module/category\",\r\n                type: 'post',\r\n                contentType: 'application/json;charset=UTF-8',\r\n                timeout: 5000,\r\n                params: {\r\n                    parent_id: parentId,\r\n                    name: nodename,\r\n                    code: newcode,\r\n                    project_id: projectId,\r\n                    id: newnodeid,\r\n                    xh: xh\r\n                },\r\n                datas: [{\r\n                    parent_id: parentId,\r\n                    name: nodename,\r\n                    code: newcode,\r\n                    project_id: projectId,\r\n                    id: newnodeid,\r\n                    xh: xh\r\n                }],\r\n                success: function(result) {\r\n                    mytree.insertNewChild(selId, newnodeid, nodename);\r\n                    mytree.setItemImage2(newnodeid, \"tree/folderClosed.gif\", \"tree/folderOpen.gif\", \"tree/folderClosed.gif\")\r\n                    var treenode = mytree.item(newnodeid);\r\n                    treenode.path = selnodepath + \"/\" + newnodeid;\r\n                    treenode.projectId = projectId;\r\n                    selnode.loadChild = true;\r\n                    if(treenode) {\r\n                        treenode.isFord = true;\r\n                        treenode.loadChild = true;\r\n                    }\r\n                    mytree.itemObj[newnodeid] = treenode;\r\n                    myMask.hide();\r\n                },\r\n                error: function(msg) {\r\n                    myMask.hide();\r\n                    Ext.Msg.alert(\"提示\", \"新建目录失败\")\r\n                }\r\n            })\r\n        })\r\n    }\r\n    var fordname = new Ext.MyFordWin(addford, '');\r\n    fordname.show();\r\n}\r\n\r\n//删除目录 模块信息\r\nfunction button1_click(sender) {\r\n    var mytree = hwTree;\r\n    var selId = mytree.getSelectedItemId();\r\n    var selnode = mytree.itemObj[selId];\r\n    var haschild = mytree.hasChildren(selId);\r\n\r\n    if(selId == \"hwZ8jCmRKR\" || selId == \"eQ9ULgcVc5\" || selId == \"eQ9ULgcVb5\" || selId == \"hwa99a3307\" || selId == \"hwc6d63bc6\") {\r\n        Ext.Msg.alert(\"提示\", \"该模块禁止删除！\")\r\n        return\r\n    }\r\n\r\n    if(mytree.itemObj[selId].projectId == \"eQ9ULgcVb1\") {\r\n        Ext.Msg.confirm(\"提示\", \"删除的模块或项目为协同办公，请谨慎操作\", function(type) {\r\n            if(type == \"yes\") {\r\n                deleteNode();\r\n            } else\r\n                return;\r\n        })\r\n        return;\r\n    }\r\n    deleteNode();\r\n}\r\n\r\nfunction deleteNode() {\r\n    var mytree = hwTree;\r\n    var selId = mytree.getSelectedItemId();\r\n    var selnode = mytree.itemObj[selId];\r\n    var haschild = mytree.hasChildren(selId);\r\n\r\n    //删除文件夹\r\n    if(selnode.isProject) {\r\n        if(haschild > 0) {\r\n            Ext.Msg.alert(\"提示\", \"存在子目录或模块，请删除子目录或子模块后再删除该项目！\")\r\n            return\r\n        }\r\n        Ext.Msg.confirm(\"提示\", \"删除项目后，项目下的所有文件都将删除。确认要删除该项目！\", function(type) {\r\n            if(type == \"yes\") {\r\n                hwDas.ajax({\r\n                    das: {\r\n                        idedas: true\r\n                    },\r\n                    url: \"CDEServcie/project/info\",\r\n                    type: 'delete',\r\n                    timeout: 5000,\r\n                    params: {\r\n                        id: selId\r\n                    },\r\n                    success: function(result) {\r\n                        mytree.deleteItem(selId, true);\r\n                        getQueryData();\r\n                    },\r\n                    error: function(msg) {\r\n                        Ext.Msg.alert(\"提示\", \"删除项目失败\")\r\n                    }\r\n                })\r\n            }\r\n        })\r\n        return;\r\n    }\r\n    //删除文件夹\r\n    if(selnode.isFord) {\r\n        if(haschild > 0) {\r\n            Ext.Msg.alert(\"提示\", \"存在子目录或模块，请删除子目录或子模块后再删除该目录\")\r\n            return\r\n        }\r\n        Ext.Msg.confirm(\"提示\", \"确认要删除该目录！\", function(type) {\r\n            if(type == \"yes\") {\r\n                hwDas.ajax({\r\n                    das: {\r\n                        idedas: true\r\n                    },\r\n                    url: \"CDEServcie/module/category\",\r\n                    type: 'delete',\r\n                    timeout: 5000,\r\n                    params: {\r\n                        id: selId\r\n                    },\r\n                    success: function(result) {\r\n                        hwDas.remove(\"vmd\", 'modules' + selnode.path, function() {\r\n                            hwDas.remove(\"vmd\", 'modules' + selnode.path, function() {\r\n                                hwDas.remove(\"vmd\", 'modules' + selnode.path, function() {\r\n                                    Tips.tips(\"删除分类成功\", \"success\");\r\n                                    getQueryData();\r\n                                }, function(msg) {\r\n                                    Tips.tips(\"删除分类失败\", \"error\");\r\n                                })\r\n                            }, function(msg) {\r\n                                Tips.tips(\"删除分类失败\", \"error\");\r\n                            })\r\n                        }, function(msg) {\r\n                            Tips.tips(\"删除分类失败\", \"error\");\r\n                        })\r\n                        mytree.deleteItem(selId, true);\r\n                    },\r\n                    error: function(msg) {\r\n                        Ext.Msg.alert(\"提示\", \"删除分类失败\")\r\n                    }\r\n                })\r\n            }\r\n        })\r\n        return;\r\n    }\r\n    //删除模块\r\n    if(selnode.isModel) {\r\n        Ext.Msg.confirm(\"提示\", \"确认要删除该模块？\", function(type) {\r\n            if(type == \"yes\") {\r\n                //先删除模块信息\r\n                hwDas.ajax({\r\n                    das: {\r\n                        idedas: true\r\n                    },\r\n                    url: \"CDEServcie/module/info\",\r\n                    type: 'delete',\r\n                    timeout: 5000,\r\n                    params: {\r\n                        id: selId\r\n                    },\r\n                    success: function(result) {\r\n                        //删除模块文件对应关系\r\n                        // hwDas.ajax({\r\n                        //     das: {\r\n                        //         idedas: true\r\n                        //     },\r\n                        //     url: \"CDEServcie/module/file\",\r\n                        //     type: 'delete',\r\n                        //     timeout: 5000,\r\n                        //     params: {\r\n                        //         module_id: selId\r\n                        //     },\r\n                        //     success: function(result) {\r\n                        Tips.tips(\"删除模块成功\", \"success\");\r\n                        getQueryData();\r\n                        //     },\r\n                        //     error: function(msg) {\r\n                        //         Ext.Msg.alert(\"提示\", \"删除模块文件信息失败\")\r\n                        //     }\r\n                        // })\r\n                        mytree.deleteItem(selId); //, true);\r\n                    },\r\n                    error: function(msg) {\r\n                        Ext.Msg.alert(\"提示\", \"删除模块信息失败\")\r\n                        return\r\n                    }\r\n                })\r\n\r\n                //删除vmd文件\r\n                hwDas.remove(\"vmd\", 'modules' + selnode.path + '.vmd', function(result) {}, function(msg) {\r\n                    Ext.Msg.alert(\"提示\", \"删除vmd模块文件失败\")\r\n                })\r\n                //删除vmd文件\r\n                hwDas.remove(\"vmd\", 'modules' + selnode.path + '.html', function(result) {}, function(msg) {\r\n                    Ext.Msg.alert(\"提示\", \"删除vmd模块文件失败\")\r\n                })\r\n                hwDas.remove(\"vmd\", 'modules' + selnode.path + '_r.html', function(result) {}, function(msg) {\r\n                    Ext.Msg.alert(\"提示\", \"删除vmd模块文件失败\")\r\n                })\r\n                hwDas.remove(\"vmd\", 'modules' + selnode.path, function(result) {}, function(msg) {\r\n                    Ext.Msg.alert(\"提示\", \"删除vmd子模块文件失败\")\r\n                })\r\n            }\r\n        })\r\n        return;\r\n    }\r\n}\r\n\r\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\r\n//自定义自定义方法\r\nfunction newGuid(len) {\r\n    var length = 32;\r\n    if(len)\r\n        length = len - 2\r\n    var guid = \"\";\r\n    arr = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z', 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z'];\r\n    for(var i = 0; i < length; i++) {\r\n        pos = Math.round(Math.random() * (arr.length - 1));\r\n        guid += arr[pos];\r\n    }\r\n    return \"hw\" + guid;\r\n}\r\n\r\n//文件夹名称录入框\r\nExt.MyFordWin = Ext.extend(Ext.Window, {\r\n    xtype: \"window\",\r\n    title: \"文件夹对话框\",\r\n    width: 300,\r\n    height: 150,\r\n    layout: \"form\",\r\n    bodyStyle: 'padding:15px',\r\n    labelAlign: \"left\",\r\n    labelWidth: 40,\r\n    modal: true,\r\n    constructor: function(callback, name) {\r\n        this.valueName = name;\r\n        this.callback = callback;\r\n        this.callParent();\r\n    },\r\n    initComponent: function() {\r\n        var me = this;\r\n        this.fbar = [{\r\n            text: \"确定\",\r\n            handler: function() {\r\n                me.callback(Ext.getCmp('filename').getValue(), function() {\r\n                    me.close();\r\n                });\r\n            }\r\n        }, {\r\n            text: \"取消\",\r\n            handler: function() {\r\n                me.close();\r\n            }\r\n        }];\r\n        this.items = [{\r\n            id: 'filename',\r\n            xtype: \"textfield\",\r\n            fieldLabel: \"名称\",\r\n            anchor: \"100%\",\r\n            value: this.valueName\r\n        }]\r\n        Ext.MyFordWin.superclass.initComponent.call(this);\r\n    }\r\n})\r\n//右键菜单事件\r\nfunction onMenuClick(menuitemId) {\r\n    if(menuitemId == \"newFord\") { // 新建分类\r\n        creatFord();\r\n    } else if(menuitemId == \"newMode\") { // 新建模块\r\n        // 在空白处点击鼠标时，就取消原有节点的选中\r\n        // hwTree.clearSelection();\r\n        hwTree.newnode = true;\r\n        divJcxx.hide();\r\n        ModuleInfo.show();\r\n        WorkflowModuleInfo.hide();\r\n        DataServiceModuleInfo.hide();\r\n        ModuleInfo.refresh(hwTree, btnProjectName.projectId, btnWorkSpaceName.workspaceId);\r\n        // lastnodeType = \"1\";\r\n        // bselNodeId = hwTree.getSelectedItemId();\r\n        // hwTree.itemObj[bselNodeId].loadChild = true;\r\n        // hwTree.newnode = true;\r\n        // document.getElementById(\"iframe_page\").src = vmd.virtualPath + vmdSettings.systemPath+'/eQ9ULgcVb5/hwa99a3307.html';\r\n    } else if(menuitemId == \"delete\") {\r\n        button1_click();\r\n    } else if(menuitemId == \"newPro\") {\r\n        hwTree.newnode = true;\r\n        document.getElementById(\"iframe_page\").src = vmd.virtualPath + vmdSettings.systemPath+'/eQ9ULgcVb5/hwc6d63bc6.html';\r\n    } else if(menuitemId == \"copy\") {\r\n        nodeCopy();\r\n    } else if(menuitemId == \"cut\") {\r\n        // nodeCut();\r\n    } else if(menuitemId == \"paste\") {\r\n        nodePaste();\r\n    } else if(menuitemId == \"reName\") {\r\n        nodeReName()\r\n    } else if(menuitemId == \"expmodules\") {\r\n        ExpModules()\r\n    }else if(menuitemId == \"exppublishmodules\") {\r\n        expPublicshModules()\r\n    }\r\n}\r\n\r\n///复制节点\r\nfunction nodeCopy() {\r\n    var mytree = hwTree;\r\n    var selId = mytree.getSelectedItemId();\r\n    // copyNodeId = selId;\r\n    // cutNodeId = \"\";\r\n    mytree.copyNodeId = selId;\r\n\r\n}\r\n\r\n//剪切节点(暂时不考虑)\r\nfunction nodeCut() {\r\n    var mytree = hwTree;\r\n    var selId = mytree.getSelectedItemId();\r\n    cutNodeId = selId;\r\n    copyNodeId = \"\";\r\n}\r\n\r\nfunction nodePaste() {\r\n    //创建一个form，填写name，备注\r\n    var copyNode = hwTree.itemObj[hwTree.copyNodeId];\r\n    var form = new Ext.form.FormPanel({\r\n        labelAlign: \"top\",\r\n        bodyStyle: \"padding: 10px\",\r\n        border: false,\r\n        items: [{\r\n            xtype: \"textfield\",\r\n            allowBlank: false,\r\n            anchor: \"100%\",\r\n            name: 'name',\r\n            height: 30,\r\n            fieldLabel: '将<span style=\"color:red;font-weight:bold\">' + copyNode.text + '</span>复制为',\r\n            emptyText: \"请输入模块名称\"\r\n        }, {\r\n            xtype: \"textarea\",\r\n            allowBlank: true,\r\n            name: 'remark',\r\n            anchor: \"100%\",\r\n            fieldLabel: \"备注\"\r\n        }]\r\n\r\n\r\n    })\r\n    var win = new Ext.Window({\r\n\r\n        width: 440,\r\n        height: 260,\r\n        title: '模块粘贴',\r\n        hidden: false,\r\n        layout: \"fit\",\r\n        border: false,\r\n        modal: true,\r\n        items: form,\r\n        fbar: [{\r\n            text: '确定',\r\n            handler: function() {\r\n                if(form.getForm().isValid()) {\r\n                    var values = form.form.getValues()\r\n                    doNodePaste(values.name, values.remark, function() {\r\n                        win.close()\r\n                    })\r\n                }\r\n            }\r\n        }, {\r\n            text: '取消',\r\n            handler: function() {\r\n                win.close()\r\n            }\r\n\r\n        }]\r\n    });\r\n    win.show()\r\n    form.form.setValues({\r\n        name: copyNode.text + '1'\r\n    })\r\n}\r\n\r\n//粘帖节点\r\nfunction doNodePaste(name, remark, callback) {\r\n    var mytree = hwTree;\r\n    //先粘贴，等粘贴成功后，将copynodeid置空\r\n    var copyNodeId = mytree.copyNodeId;\r\n    if(!copyNodeId) {\r\n        Ext.Msg.alert('错误', \"粘贴出错，请重新复制！\");\r\n        return;\r\n    }\r\n    //首先创建模块，等成功后再拷贝文件。\r\n    var selId = mytree.getSelectedItemId();\r\n    var selnode = mytree.itemObj[selId];\r\n    var selnodepath = selnode.path;\r\n    var category_id;\r\n    var projectId;\r\n    var remark = remark || selnode.remark;\r\n    if(selnode.isProject) {\r\n        projectId = C;\r\n        category_id = \"0\";\r\n    } else if(selnode.isFord) {\r\n        projectId = selnode.projectId;\r\n        category_id = selId;\r\n    } else {\r\n        projectId = btnProjectName.projectId;\r\n        category_id = \"0\";\r\n        selId = '0';\r\n    }\r\n    myMask = new Ext.LoadMask(Ext.getBody(), {\r\n        msg: \"加载中,请稍后...\"\r\n    });\r\n    myMask.show();\r\n    // 判断同一节点下是否存在相同名称的模块\r\n    checkModuleReName(projectId, category_id, name, function() {\r\n        if(callback) {\r\n            callback()\r\n        }\r\n        if(copyNodeId) {\r\n            var copyNode = mytree.itemObj[copyNodeId];\r\n            var copyFilePath = copyNode.path;\r\n            var ModeName = name || copyNode.text;\r\n            var id = newGuid(10);\r\n            var newcode = newGuid(32);\r\n            var row_created_by = Ext.util.Cookies.get('userName');\r\n            var row_created_date = Ext.Date.dateFormat(new Date(), 'Y-m-d H:i:s');\r\n\r\n            var saveCopyModelinfo = function() {\r\n\r\n                //保存模块基础信息\r\n                hwDas.ajax({\r\n                    das: {\r\n                        idedas: true\r\n                    },\r\n                    url: \"CDEServcie/module/info\",\r\n                    type: 'post',\r\n                    contentType: 'application/json;charset=UTF-8',\r\n                    timeout: 5000,\r\n                    params: {},\r\n                    data: [{\r\n                        id: id,\r\n                        code: newcode,\r\n                        type: \"0\",\r\n                        name: ModeName,\r\n                        remark: remark,\r\n                        category_id: category_id,\r\n                        project_id: projectId,\r\n                        row_created_by: row_created_by,\r\n                        row_created_date: row_created_date,\r\n                        row_changed_by: row_created_by,\r\n                        row_changed_date: row_created_date\r\n                    }],\r\n                    success: function(result) {\r\n                        if(selId == '0') {\r\n                            mytree.insertNewChild(selId, id, ModeName);\r\n                            mytree.setItemImage2(id, \"tree/model.png\", \"tree/model.png\", \"tree/model.png\")\r\n                        } else {\r\n                            if(mytree.itemObj[selId].loadChild == true) {\r\n                                mytree.insertNewChild(selId, id, ModeName);\r\n                                mytree.setItemImage2(id, \"tree/model.png\", \"tree/model.png\", \"tree/model.png\")\r\n                            }\r\n                        }\r\n                        var treenode = mytree.item(id);\r\n                        treenode.path = selnodepath + \"/\" + id;\r\n                        treenode.projectId = projectId;\r\n                        if(treenode) {\r\n                            treenode.isModel = true;\r\n                            treenode.text = ModeName;\r\n                            treenode.createuser = row_created_by;\r\n                            treenode.createtime = row_created_date;\r\n                            treenode.remark = remark;\r\n                            treenode.code = newcode\r\n                            treenode.newnode = false;\r\n                        }\r\n                        mytree.itemObj[id] = treenode;\r\n                        mytree.selectItem(id, false, false);\r\n                        mytree.newnode = false;\r\n                        //拷贝vmd文件\r\n                        hwDas.copy(\"vmd\", \"modules\" + copyFilePath + \".vmd\", \"modules\" + treenode.path + \".vmd\", function() {\r\n                            //重新刷新\r\n                            mytree.selectItem(id, true);\r\n                            mytree.copyNodeId = null;\r\n                            myMask.hide();\r\n                        }, function(msg) {\r\n                            if(msg.indexOf('不存在') != -1) {\r\n                                myMask.hide();\r\n                                mytree.selectItem(id, true);\r\n                                mytree.copyNodeId = null;\r\n                                vmd.tip(\"该模块未设计\", 'info', 2000);\r\n                            } else {\r\n                                Tips.tips(msg, \"error\");\r\n                            }\r\n                        });\r\n                        //拷贝html 预览界面\r\n                        hwDas.copy(\"vmd\", \"modules\" + copyFilePath + \".html\", \"modules\" + treenode.path + \".html\",\r\n                            function() {\r\n                                myMask.hide();\r\n                            },\r\n                            function(msg) {\r\n                                myMask.hide();\r\n                                //   Ext.Msg.alert('错误',msg);\r\n                            });\r\n                        //复制后对file文件信息进行生成   成兵20180816增加\r\n                        hwDas.ajax({\r\n                            das: {\r\n                                idedas: true\r\n                            },\r\n                            url: \"CDEServcie/module/file\",\r\n                            type: 'post',\r\n                            contentType: 'application/json;charset=UTF-8',\r\n                            timeout: 5000,\r\n                            params: {},\r\n                            data: [{\r\n                                filepath: selnodepath + \"/\" + id,\r\n                                version: 1,\r\n                                module_id: id\r\n                            }],\r\n                            success: function(result) {\r\n                                // Ext.Msg.alert(\"提示\", \"保存成功！\")\r\n                            },\r\n                            error: function(msg) {\r\n                                Ext.Msg.alert(\"提示\", \"保存模块版本信息失败\")\r\n                                return;\r\n                            }\r\n                        })\r\n                    },\r\n                    error: function(msg) {\r\n                        myMask.hide();\r\n                        Ext.Msg.alert(\"提示\", \"复制失败\")\r\n                        return;\r\n                    }\r\n                })\r\n            }\r\n            var saveSubwinInfo = function() {\r\n                //首先获取模块及所有子模块信息\r\n                hwDas.get(\"CDEServcie/module/getmoduleandsubmodule\", {}, {\r\n                        module_id: copyNodeId\r\n                    }, function(result) {\r\n                        var datas = result.data[0].datas;\r\n                        var newmoduleid = vmd.getGuid(10)\r\n                        var newcode = vmd.getGuid(36)\r\n                        //此处循环处理目标id  路径  层级关系\r\n                        var getchildWinIds = function(srcid, trgid, mainid, trgpath) {\r\n                            for(var i = 0; i < datas.length; i++) {\r\n                                if(srcid == datas[i].upmoduleid) {\r\n                                    newguid = vmd.getGuid(10)\r\n                                    datas[i].trgid = newguid;\r\n                                    datas[i].code = vmd.getGuid(36);\r\n                                    datas[i].trgpath = trgpath + \"/\" + newguid;\r\n                                    datas[i].trgupid = trgid;\r\n                                    datas[i].trgmainid = mainid;\r\n                                    datas[i].trgcateid = category_id;\r\n                                    getchildWinIds(datas[i].id, newguid, mainid, trgpath + \"/\" + newguid)\r\n                                }\r\n                            }\r\n                        }\r\n                        for(var i = 0; i < datas.length; i++) {\r\n                            if(copyNodeId == datas[i].id) {\r\n                                datas[i].trgid = newmoduleid;\r\n                                datas[i].trgpath = selnodepath + \"/\" + newmoduleid;\r\n                                datas[i].trgupid = \"\";\r\n                                datas[i].trgmainid = \"\";\r\n                                datas[i].trgcateid = category_id;\r\n                                datas[i].code = newcode;\r\n                                datas[i].name = ModeName;\r\n                                getchildWinIds(copyNodeId, newmoduleid, newmoduleid, selnodepath + \"/\" + newmoduleid)\r\n                                break;\r\n                            }\r\n                        }\r\n                        //此处保存复制的文件信息\r\n                        var paths = [];\r\n                        var saveData = [];\r\n                        for(var i = 0; i < datas.length; i++) {\r\n                            //用于替换path的信息\r\n                            paths.push({\r\n                                oldpath: datas[i].filepath + \".vmd\",\r\n                                newpath: datas[i].trgpath + \".vmd\"\r\n                            })\r\n                            //用于替换moduleid的信息\r\n                            paths.push({\r\n                                oldpath: \"moduleId:\\\"\" + datas[i].id + \"\\\"\",\r\n                                newpath: \"moduleId:\\\"\" + datas[i].trgid + \"\\\"\"\r\n                            }, {\r\n                                oldpath: \"moduleId\\\\\\\":\\\\\\\"\" + datas[i].id,\r\n                                newpath: \"moduleId\\\\\\\":\\\\\\\"\" + datas[i].trgid\r\n                            })\r\n                            //组织用于入库的模块信息\r\n                            saveData.push({\r\n                                project_id: datas[i].project_id,\r\n                                code: datas[i].code,\r\n                                upmoduleid: datas[i].trgupid,\r\n                                mainmoduleid: datas[i].trgmainid,\r\n                                module_id: datas[i].trgid,\r\n                                name: datas[i].name,\r\n                                remark: datas[i].remark,\r\n                                category_id: datas[i].category_id,\r\n                                type: datas[i].type,\r\n                                filepath: datas[i].trgpath\r\n                            })\r\n                        }\r\n                        //保存模块信息服务\r\n                        hwDas.save(\"CDEServcie/module/getchildmodule\", {}, {}, saveData, function() {\r\n                            //添加节点到树\r\n                            if(selId == '0') {\r\n                                mytree.insertNewChild(selId, newmoduleid, ModeName);\r\n                                mytree.setItemImage2(id, \"tree/model.png\", \"tree/model.png\", \"tree/model.png\")\r\n                            } else {\r\n                                if(mytree.itemObj[selId].loadChild == true) {\r\n                                    mytree.insertNewChild(selId, newmoduleid, ModeName);\r\n                                    mytree.setItemImage2(newmoduleid, \"tree/model.png\", \"tree/model.png\", \"tree/model.png\")\r\n                                }\r\n                            }\r\n                            var treenode = mytree.item(newmoduleid);\r\n                            treenode.path = selnodepath + \"/\" + newmoduleid;\r\n                            treenode.projectId = projectId;\r\n                            if(treenode) {\r\n                                treenode.isModel = true;\r\n                                treenode.text = ModeName;\r\n                                treenode.createuser = row_created_by;\r\n                                treenode.createtime = row_created_date;\r\n                                treenode.remark = remark;\r\n                                treenode.code = newcode\r\n                                treenode.newnode = false;\r\n                            }\r\n                            mytree.itemObj[newmoduleid] = treenode;\r\n                            mytree.selectItem(newmoduleid, false, false);\r\n                            mytree.newnode = false;\r\n\r\n                            //此处读取文件、替换、保存\r\n                            var count = 0;\r\n                            acount = datas.length * 2;\r\n                            var checkcount = function() {\r\n                                count++;\r\n                                if(count == acount) {\r\n                                    myMask.hide();\r\n                                }\r\n                            }\r\n                            for(var i = 0; i < datas.length; i++) {\r\n                                vmd.core.createCopyFile(\"modules\" + datas[i].filepath + \".vmd\", \"modules\" + datas[i].trgpath + \".vmd\", paths, \"text\", function() {\r\n                                    checkcount()\r\n                                }, function() {\r\n                                    checkcount()\r\n                                })\r\n                                vmd.core.createCopyFile(\"modules\" + datas[i].filepath + \".html\", \"modules\" + datas[i].trgpath + \".html\", paths, \"html\", function() {\r\n                                    checkcount()\r\n                                }, function() {\r\n                                    checkcount()\r\n                                })\r\n                            }\r\n                        }, function(msg) {\r\n                            console.log(msg)\r\n                            myMask.hide();\r\n                        })\r\n                    },\r\n                    function(msg) {\r\n                        console.log(msg)\r\n                        myMask.hide();\r\n                    })\r\n            }\r\n            //20180920 成兵 增加对是否包含子页面模块的判断\r\n            hwDas.get(\"CDEServcie/module/getchildmodule\", {}, {\r\n                mainmoduleid: copyNodeId\r\n            }, function(result) {\r\n                if(result.data.length > 0 && result.data[0].datas.length > 0) {\r\n                    saveSubwinInfo()\r\n                } else {\r\n                    saveCopyModelinfo()\r\n                }\r\n            }, function(msg) {\r\n                console.log(msg)\r\n            })\r\n        } else if(cutNodeId != \"\") {\r\n            var cutNode = mytree.itemObj[copyNodeId];\r\n            var cutFilePath = copyNode.path;\r\n            var ModeName = copyNode.text;\r\n            var remark = cutNode.remark;\r\n            var code = cutNode.code;\r\n            var id = cutNodeId;\r\n            var row_created_by = Ext.util.Cookies.get('userName');\r\n            var row_created_date = Ext.Date.dateFormat(new Date(), 'Y-m-d H:i:s');\r\n            var row_changed_by = Ext.util.Cookies.get('userName');\r\n            var row_changed_date = Ext.Date.dateFormat(new Date(), 'Y-m-d H:i:s');\r\n            //保存模块基础信息\r\n            hwDas.ajax({\r\n                das: {\r\n                    idedas: true\r\n                },\r\n                url: \"CDEServcie/module/info\",\r\n                type: 'put',\r\n                contentType: 'application/json;charset=UTF-8',\r\n                timeout: 5000,\r\n                params: {},\r\n                data: [{\r\n                    id: id,\r\n                    category_id: category_id,\r\n                    project_id: projectId,\r\n                    row_created_by: row_created_by,\r\n                    row_created_date: row_created_date,\r\n                    row_changed_by: row_changed_by,\r\n                    row_changed_date: row_changed_date\r\n                }],\r\n                success: function(result) {\r\n                    //将节点移除，再添加\r\n                    mytree.deleteItem(id);\r\n                    mytree.insertNewChild(selId, id, ModeName);\r\n                    mytree.setItemImage2(id, \"tree/model.png\", \"tree/model.png\", \"tree/model.png\")\r\n\r\n                    cutNode.path = selnodepath + \"/\" + id;\r\n                    cutNode.projectId = Project_id;\r\n                    cutNode.createuser = row_created_by;\r\n                    cutNode.createtime = row_created_date;\r\n                    cutNode.changetime = row_changed_date;\r\n                    cutNode.changeuser = row_changed_by;\r\n                    treenode.newnode = false;\r\n\r\n                    mytree.selectItem(id, false, false);\r\n                    mytree.newnode = false;\r\n                    //保存模块路径版本信息\r\n                    hwDas.ajax({\r\n                        das: {\r\n                            idedas: true\r\n                        },\r\n                        url: \"CDEServcie/module/file\",\r\n                        type: 'put',\r\n                        contentType: 'application/json;charset=UTF-8',\r\n                        timeout: 5000,\r\n                        params: {},\r\n                        data: [{\r\n                            filepath: selnodepath + \"/\" + id,\r\n                            version: 1,\r\n                            module_id: id\r\n                        }],\r\n                        success: function(result) {\r\n                            // Ext.Msg.alert(\"提示\", \"保存成功！\")\r\n                        },\r\n                        error: function(msg) {\r\n                            Ext.Msg.alert(\"提示\", \"保存模块版本信息失败\")\r\n                            return;\r\n                        }\r\n                    })\r\n                },\r\n                error: function(msg) {\r\n                    Ext.Msg.alert(\"提示\", \"复制失败\")\r\n                    myMask.hide();\r\n                    return;\r\n                }\r\n            })\r\n        }\r\n        copyCutNodeId = \"\";\r\n    })\r\n}\r\n// 重命名\r\nfunction nodeReName() {\r\n    var mytree = hwTree;\r\n    var selId = mytree.getSelectedItemId();\r\n    var selnode = mytree.itemObj[selId];\r\n    var nodeName = mytree.itemObj[selId].text;\r\n    var parentId;\r\n    if(mytree.getParentId(selId)) {\r\n        parentId = mytree.getParentId(selId)\r\n    } else {\r\n        parentId = '0'\r\n    }\r\n    var addford = function(fordname, callback) {\r\n        myMask = new Ext.LoadMask(Ext.getBody(), {\r\n            msg: \"加载中,请稍后...\"\r\n        });\r\n        myMask.show();\r\n        // 判断同一目录下是否存在相同名称分类\r\n        checkfordReName(btnProjectName.projectId, parentId, selId, fordname, function() {\r\n            if(callback) {\r\n                callback()\r\n            }\r\n            hwDas.edit(\"CDEServcie/module/category\", {}, {\r\n                    name: fordname,\r\n                    id: selId,\r\n                }, [{\r\n                    name: fordname,\r\n                    id: selId,\r\n                }],\r\n                function(result) {\r\n                    selnode.text = fordname;\r\n                    mytree.setItemText(selId, fordname);\r\n                    myMask.hide();\r\n                },\r\n                function(msg) {\r\n                    myMask.hide();\r\n                    Ext.Msg.alert(\"提示\", \"新建目录失败\")\r\n                }\r\n            )\r\n        })\r\n    }\r\n    var fordname = new Ext.MyFordWin(addford, nodeName);\r\n    fordname.show();\r\n}\r\n//页面加载完后事件\r\nfunction MyViewport_afterrender(sender) {\r\n    var einfo = Ext.util.Cookies.get('hwEcyLogin');\r\n    var login = Ext.util.Cookies.get('hwLogin');\r\n    btnGrxx.setText(Cookie.get('userName') || '个人信息');\r\n    MyP_Htool.doLayout()\r\n    divJcxx.show()\r\n    divJcxx.update(\"<iframe  id='iframe_page' src='\" + vmd.virtualPath + vmdSettings.systemPath+\"/eQ9ULgcVb5/hw03cb4931.html' width=100% height=100% frameborder=0  ></iframe>\");\r\n\r\n    // MyP_jcxx.body.update(\"<iframe  id='iframe_page' src='\" + vmd.virtualPath + vmdSettings.systemPath+\"/eQ9ULgcVb5/hw03cb4931.html' width=100% height=100% frameborder=0  ></iframe>\");\r\n    if(!allowedDesigner) {\r\n        MyC_tc.hide();\r\n        button.hide();\r\n    }\r\n    // 初始化工区切换菜单\r\n    initMenuWorkSpaceList();\r\n\r\n    $LAB.script('/lib/introjs/intro.js')\r\n        .wait(function() {\r\n            vmd.loadCss('/lib/introjs/introjs.css')\r\n            var vmdinittips = LocalData.get('vmdinittips');\r\n            if(!vmdinittips) {\r\n                introJs().setOptions({\r\n                    nextLabel: '下一步 &rarr;',\r\n                    prevLabel: '&larr; 上一步',\r\n                    skipLabel: '退出',\r\n                    doneLabel: '结束'\r\n                }).start();\r\n                LocalData.set('vmdinittips', true)\r\n            }\r\n        })\r\n}\r\n//退出图标的点击事件\r\nfunction MyC_tc_afterrender(sender) {\r\n    sender.el.on('click', function() {\r\n        outvmd();\r\n    })\r\n}\r\n//退出按钮操作\r\nfunction button_click(sender) {\r\n    outvmd();\r\n}\r\n//登出vmd2.0\r\nfunction outvmd() {\r\n\r\n    Ext.Msg.confirm(\"提示\", \"确定要退出vmd2.0吗？\", function(type) {\r\n\r\n        if(type == \"yes\") {\r\n            // Ext.util.Cookies.clear(\"hwLogin\");\r\n            Cookie.clear();\r\n            self.location = vmd.virtualPath + vmdSettings.systemPath+\"/eQ9ULgcVb5/eQ9ULgcVc5.html\";\r\n        }\r\n\r\n    })\r\n}\r\n\r\n//页面初始化前方法 控制权限 记录编辑权限\r\nfunction MyViewport_beforerender(sender) {\r\n    if(Ext.isIE)\r\n        vmd.tip('为达到更好的用户体验，建议采用谷歌浏览器、360极速浏览器等webkit内核的浏览器进行操作。', 'info', 3000);\r\n    //模拟平台5的token传参登陆,默认设置cookie 为dbadmin 管理员\r\n    var urlToken = getUrlParam(\"token\");\r\n    if(urlToken != null && urlToken != \"\") {\r\n        Ext.util.Cookies.set('userName', \"管理员\");\r\n        Ext.util.Cookies.set('hwLogin', \"dbadmin\");\r\n        return\r\n    }\r\n    var userType = Ext.util.Cookies.get(\"userType\");\r\n    allowedDesigner = userType == \"vmdDesigner\" ? true : false;\r\n    // var login = Ext.util.Cookies.get(\"login\");\r\n    if(!login) {\r\n        self.location = vmd.virtualPath + vmdSettings.systemPath+\"/eQ9ULgcVb5/eQ9ULgcVc5.html\";\r\n    }\r\n}\r\n\r\nvar selModeWin;\r\nwindow[\"selModeWin\"] = selModeWin;\r\n//新建模块时 打开模版选择页面 关闭时调用该方法，由子页面调用或该页面调用\r\nfunction closeSelMode(create) {\r\n    if(create) {\r\n        var mytree = hwTree;\r\n        var selId = mytree.getSelectedItemId();\r\n        var selnode = mytree.itemObj[selId];\r\n        selnode.newnode = false;\r\n        mytree.newnode = false;\r\n    }\r\n\r\n    selModeWin.close();\r\n}\r\nwindow[\"closeSelMode\"] = closeSelMode;\r\n//新建模块时 打开模版选择页面，由子页面调用或该页面调用\r\nfunction openSelMode(id, name, pdth, workspaceId) {\r\n    selModeWin = new vmdDesigner({\r\n        title: '<span style=\"color:blue\">' + name + '</span> 模版选择',\r\n        params: {\r\n            id: id,\r\n            name: name,\r\n            path: pdth,\r\n            workspaceid: workspaceId\r\n        },\r\n        auto: false,\r\n        width: 920,\r\n        height: 580,\r\n        // width: document.body.clientWidth - 200,\r\n        // height: document.body.clientHeight - 100,\r\n        url: vmd.virtualPath + vmdSettings.systemPath+'/eQ9ULgcVb5/hw3b9ae460.html'\r\n    });\r\n    selModeWin.show(true);\r\n}\r\n//将选择模版方法放入window中\r\nwindow[\"openSelMode\"] = openSelMode;\r\nvar maskProgress = null;\r\n\r\n// 工作流是否加载过\r\nvar ifWorkflowLoaded = false;\r\n\r\nfunction hwTreeWorkFlow_afterrender(sender) {\r\n    ifWorkflowLoaded = true;\r\n    // 清空树原有的默认数据\r\n    hwTreeWorkFlow.deleteChildItems(0);\r\n    getWorkflowCategory();\r\n\r\n    // 设置没配置工作流的提示信息\r\n    panel1.add({\r\n        id: 'infoWorkflow_div',\r\n        tag: 'div',\r\n        html: '请配置工作流',\r\n        style: 'font-size:14px;font-family:Microsoft YaHei;color:#666666;margin:10px;'\r\n    });\r\n}\r\n\r\n// 重新加载工作流分类，用于项目配置完成后保存\r\nfunction reloadWorkflowCategory() {\r\n\r\n    if(ifWorkflowLoaded) {\r\n        hwTreeWorkFlow.deleteChildItems(0);\r\n        getWorkflowCategory();\r\n    }\r\n}\r\n\r\nfunction getWorkflowCategory() {\r\n    if(!ifWorkflowLoaded) {\r\n        return;\r\n    }\r\n    // 进度条\r\n    var myMask = new Ext.LoadMask(Ext.getCmp(\"hwTreeWorkFlow\").el, {\r\n        msg: \"数据加载中,请稍后...\",\r\n        msgCls: 'z-index:10000;'\r\n    });\r\n    myMask.show();\r\n    maskProgress = new Ext.LoadMask(Ext.getBody(), {\r\n        msg: \"数据加载中,请稍后...\",\r\n        msgCls: 'z-index:10000;'\r\n    });\r\n    maskProgress.hide();\r\n\r\n    // 获取项目中配置的工作流分类\r\n    hwDas.get(\r\n        \"DataServiceWorkSpace/projectInfo/ProjcetServiceCategory\", {}, {\r\n            \"projectid\": btnProjectName.projectId,\r\n            \"type\": 0\r\n        },\r\n        function(resultChecked) {\r\n            // 根据获取的数据赋值基本信息Tab页\r\n            if(null === resultChecked && undefined === resultChecked) {\r\n                showWorkflowHintInfo();\r\n                return;\r\n            }\r\n\r\n            if(null != resultChecked.data && undefined != resultChecked.data) {\r\n                        // 获取所有工作流分类\r\n                        var mytree = hwTreeWorkFlow;\r\n                        mytree.itemObj = {};\r\n                if(resultChecked.data.length > 0) {\r\n\r\n                    // if(null != resultChecked.data[0].datas && undefined != resultChecked.data[0].datas) {}\r\n\r\n                    if(resultChecked.data[0].datas.length > 0) {\r\n\r\n                        var firstNode = \"\";\r\n                        mytree.deleteChildItems(0);\r\n                        mytree.loadJSONObject({\r\n                            id: 0,\r\n                            text: \"工作流\",\r\n                            item: []\r\n                        });\r\n                        mytree.newnode = false;\r\n                        var urlService = \"http://\" + (vmd.workspace.workflowIp || vmdSettings.workflowIp) + \"/activiti-rest/service/repository/categorys/root?info=kermit\";\r\n                        // if(vmdSettings.workflowIp) {\r\n                        //     var info = \"kermit\";\r\n                        //     urlService = \"http://\" + vmdSettings.workflowIp + \"/activiti-rest/service/repository/categorys/root?info=\" + info;\r\n\r\n                        //     // if(einfo && einfo != undefined && einfo != \"undefined\") {\r\n                        //     //     urlService = \"http://\" + vmdSettings.workflowIp + \"/activiti-rest/service/repository/categorys/root?einfo=\" + einfo;\r\n                        //     // } else {\r\n                        //     //     var info = login;\r\n                        //     //     if(!info) {\r\n                        //     //         info = \"kermit\";\r\n                        //     //     }\r\n                        //     //     urlService = \"http://\" + vmdSettings.workflowIp + \"/activiti-rest/service/repository/categorys/root?info=\" + info;\r\n                        //     // }\r\n                        // }\r\n\r\n                        // 获取根节点下的文件夹节点信息\r\n                        hwDas.ajax({\r\n                            // das: {\r\n                            //     idedas: false\r\n                            // },\r\n                            url: urlService,\r\n                            type: 'get',\r\n                            timeout: 10000,\r\n                            params: {},\r\n                            success: function(result) {\r\n                                var bFlag = false;\r\n\r\n                                ////////////////////////////////////////////////////////////////////\r\n                                for(var j = 0; j < resultChecked.data[0].datas.length; j++) {\r\n\r\n                                    // 获取数据后解析形成树形节点；\r\n                                    for(var i = 0; i < result.data.length; i++) {\r\n                                        if(result.data[i].id ==\r\n                                            resultChecked.data[0].datas[j].service_category_id) {\r\n\r\n                                            bFlag = true;\r\n                                            mytree.insertNewChild(0, result.data[i].id, result.data[i].name);\r\n                                            mytree.setItemImage2(result.data[i].id, \"tree/projectclose.png\", \"tree/projectopen.png\", \"tree/projectclose.png\");\r\n                                            mytree.setItemColor(result.data[i].id, '#000000', '#000000');\r\n                                            mytree.insertNewChild(result.data[i].id, result.data[i].id + \"-0000\", \"\");\r\n                                            mytree.closeItem(result.data[i].id);\r\n                                            var treenode = mytree.item(result.data[i].id);\r\n                                            if(treenode) {\r\n                                                treenode.isTemplate = false; // 标识是否是模板文件\r\n                                                // treenode.childLoaded = false; // 标识是否加载了子节点\r\n                                                treenode.isDeployment = false; // 标识是否发布\r\n                                                treenode.url = result.data[i].url;\r\n                                                // 标识当前分类节点下的分类节点是否加载完成\r\n                                                treenode.childCategoryLoaded = false;\r\n                                                // 标识当前分类节点下的模板节点是否加载完成\r\n                                                treenode.childModelLoaded = false;\r\n                                            }\r\n                                            var objKey = \"hw\" + result.data[i].id;\r\n                                            mytree.itemObj[objKey] = treenode;\r\n                                        }\r\n                                    }\r\n                                }\r\n\r\n                                if(bFlag) {\r\n                                    hwTreeWorkFlow.show();\r\n                                } else {\r\n\r\n                                    hwTreeWorkFlow.hide();\r\n                                }\r\n                                // ifWorkflowLoaded = true;\r\n                                myMask.hide();\r\n                            },\r\n                            error: function(msg) {\r\n                                showWorkflowHintInfo();\r\n                                myMask.hide();\r\n                                // Ext.Msg.alert(\"提示\", \"获取模块信息失败\", function() {})\r\n                            }\r\n                        })\r\n\r\n                        //绑定右键菜单\r\n                        var menu = new dhtmlXMenuObject();\r\n                        menu.renderAsContextMenu();\r\n                        menu.attachEvent(\"onClick\", onMenuWorkFlowClick);\r\n                        menu.addNewChild(menu.topId, 0, \"newWorkFlowCategory\", \"新建分类\", false);\r\n                        menu.addNewChild(menu.topId, 1, \"newWorkFlowTemplate\", \"新建模板\", false);\r\n                        menu.addNewChild(menu.topId, 2, \"editWorkFlow\", \"编辑\", false);\r\n                        menu.addNewChild(menu.topId, 3, \"deleteWorkFlow\", \"删除\", false);\r\n                        menu.addNewChild(menu.topId, 4, \"viewWorkFlow\", \"查看\", false);\r\n                        menu.addNewChild(menu.topId, 5, \"publishWorkFlow\", \"发布\", false);\r\n                        mytree.enableDragAndDrop(\"temporary_disabled\");\r\n                        mytree.enableContextMenu(menu);\r\n\r\n                        mytree.attachEvent(\"onBeforeContextMenu\", function(itemId) {\r\n                            var mytree = hwTreeWorkFlow;\r\n                            var selId = mytree.getSelectedItemId();\r\n                            var objKey = \"hw\" + selId;\r\n                            var selnode = mytree.itemObj[objKey];\r\n                            if(!selnode) {\r\n                                return;\r\n                            }\r\n                            // 模板节点\r\n                            if(selnode.isTemplate) {\r\n                                menu.hideItem('newWorkFlowCategory');\r\n                                menu.hideItem('newWorkFlowTemplate');\r\n                                menu.showItem('editWorkFlow');\r\n                                menu.showItem('viewWorkFlow');\r\n                                if(selnode.isDeployment) {\r\n                                    menu.hideItem('deleteWorkFlow');\r\n                                    menu.hideItem('publishWorkFlow');\r\n                                } else {\r\n                                    menu.showItem('publishWorkFlow');\r\n                                    menu.showItem('deleteWorkFlow');\r\n                                }\r\n                            } else // 分类节点\r\n                            {\r\n                                menu.showItem('newWorkFlowCategory');\r\n                                menu.showItem('newWorkFlowTemplate');\r\n                                menu.showItem('editWorkFlow');\r\n                                menu.showItem('deleteWorkFlow');\r\n                                menu.hideItem('viewWorkFlow');\r\n                                menu.hideItem('publishWorkFlow');\r\n                            }\r\n\r\n                            return true;\r\n                        })\r\n\r\n                        //绑定右键事件 设置右键选中节点\r\n                        mytree.attachEvent('onRightClick', function(id) {\r\n                            mytree.selectItem(id);\r\n                        })\r\n                    } else {\r\n                        showWorkflowHintInfo();\r\n                        myMask.hide();\r\n                    }\r\n                } else {\r\n                    showWorkflowHintInfo();\r\n                    myMask.hide();\r\n                }\r\n            } else {\r\n                showWorkflowHintInfo();\r\n                myMask.hide();\r\n            }\r\n            // Tips.tips(\"查询成功！\", \"success\");\r\n        },\r\n        function(msg) {\r\n            showWorkflowHintInfo();\r\n            myMask.hide();\r\n        });\r\n}\r\n\r\nfunction showWorkflowHintInfo() {\r\n\r\n    hwTreeWorkFlow.hide();\r\n    // panel1.add({\r\n    //     id: 'infoWorkflow_div',\r\n    //     tag: 'div',\r\n    //     html: '请配置工作流',\r\n    //     style: 'font-size:14px;font-family:Microsoft YaHei;color:#666666;margin:10px;'\r\n    // });\r\n}\r\n// function hwTreeWorkFlow_afterrender(sender) {\r\n//     // 进度条\r\n//     var myMask = new Ext.LoadMask(Ext.getCmp(\"hwTreeWorkFlow\").el, {\r\n//         msg: \"数据加载中,请稍后...\",\r\n//         msgCls: 'z-index:10000;'\r\n//     });\r\n//     myMask.show();\r\n//     maskProgress = new Ext.LoadMask(Ext.getBody(), {\r\n//         msg: \"数据加载中,请稍后...\",\r\n//         msgCls: 'z-index:10000;'\r\n//     });\r\n//     maskProgress.hide();\r\n\r\n//     var mytree = hwTreeWorkFlow;\r\n//     var firstNode = \"\";\r\n//     mytree.deleteChildItems(0);\r\n//     mytree.loadJSONObject({\r\n//         id: 0,\r\n//         text: \"工作流\",\r\n//         item: []\r\n//     });\r\n//     mytree.itemObj = {};\r\n//     mytree.newnode = false;\r\n//     var urlService = \"http://\" + vmdSettings.workflowIp + \"/activiti-rest/service/repository/categorys/root?info=kermit\";\r\n//     if(vmdSettings.workflowIp) {\r\n//         var info = \"kermit\";\r\n//         urlService = \"http://\" + vmdSettings.workflowIp + \"/activiti-rest/service/repository/categorys/root?info=\" + info;\r\n\r\n//         // if(einfo && einfo != undefined && einfo != \"undefined\") {\r\n//         //     urlService = \"http://\" + vmdSettings.workflowIp + \"/activiti-rest/service/repository/categorys/root?einfo=\" + einfo;\r\n//         // } else {\r\n//         //     var info = login;\r\n//         //     if(!info) {\r\n//         //         info = \"kermit\";\r\n//         //     }\r\n//         //     urlService = \"http://\" + vmdSettings.workflowIp + \"/activiti-rest/service/repository/categorys/root?info=\" + info;\r\n//         // }\r\n//     }\r\n\r\n//     // 获取根节点下的文件夹节点信息\r\n//     hwDas.ajax({\r\n//         // das: {\r\n//         //     idedas: false\r\n//         // },\r\n//         url: urlService,\r\n//         type: 'get',\r\n//         timeout: 5000,\r\n//         params: {},\r\n//         success: function(result) {\r\n//             // 获取数据后解析形成树形节点；\r\n//             for(var i = 0; i < result.data.length; i++) {\r\n\r\n//                 mytree.insertNewChild(0, result.data[i].id, result.data[i].name);\r\n//                 mytree.setItemImage2(result.data[i].id, \"tree/projectclose.png\", \"tree/projectopen.png\", \"tree/projectclose.png\");\r\n//                 mytree.setItemColor(result.data[i].id, '#000000', '#000000');\r\n//                 mytree.insertNewChild(result.data[i].id, result.data[i].id + \"-0000\", \"\");\r\n//                 mytree.closeItem(result.data[i].id);\r\n//                 var treenode = mytree.item(result.data[i].id);\r\n//                 if(treenode) {\r\n//                     treenode.isTemplate = false; // 标识是否是模板文件\r\n//                     // treenode.childLoaded = false; // 标识是否加载了子节点\r\n//                     treenode.isDeployment = false; // 标识是否发布\r\n//                     treenode.url = result.data[i].url;\r\n//                     // 标识当前分类节点下的分类节点是否加载完成\r\n//                     treenode.childCategoryLoaded = false;\r\n//                     // 标识当前分类节点下的模板节点是否加载完成\r\n//                     treenode.childModelLoaded = false;\r\n//                 }\r\n//                 var objKey = \"hw\" + result.data[i].id;\r\n//                 mytree.itemObj[objKey] = treenode;\r\n//             }\r\n\r\n//             myMask.hide();\r\n//         },\r\n//         error: function(msg) {\r\n//             myMask.hide();\r\n//             Ext.Msg.alert(\"提示\", \"获取模块信息失败\", function() {})\r\n//         }\r\n//     })\r\n\r\n//     //绑定右键菜单\r\n//     var menu = new dhtmlXMenuObject();\r\n//     menu.renderAsContextMenu();\r\n//     menu.attachEvent(\"onClick\", onMenuWorkFlowClick);\r\n//     menu.addNewChild(menu.topId, 0, \"newWorkFlowCategory\", \"新建分类\", false);\r\n//     menu.addNewChild(menu.topId, 1, \"newWorkFlowTemplate\", \"新建模板\", false);\r\n//     menu.addNewChild(menu.topId, 2, \"editWorkFlow\", \"编辑\", false);\r\n//     menu.addNewChild(menu.topId, 3, \"deleteWorkFlow\", \"删除\", false);\r\n//     menu.addNewChild(menu.topId, 4, \"viewWorkFlow\", \"查看\", false);\r\n//     menu.addNewChild(menu.topId, 5, \"publishWorkFlow\", \"发布\", false);\r\n//     mytree.enableDragAndDrop(\"temporary_disabled\");\r\n//     mytree.enableContextMenu(menu);\r\n\r\n//     mytree.attachEvent(\"onBeforeContextMenu\", function(itemId) {\r\n//         var mytree = hwTreeWorkFlow;\r\n//         var selId = mytree.getSelectedItemId();\r\n//         var objKey = \"hw\" + selId;\r\n//         var selnode = mytree.itemObj[objKey];\r\n//         if(!selnode) {\r\n//             return;\r\n//         }\r\n//         // 模板节点\r\n//         if(selnode.isTemplate) {\r\n//             menu.hideItem('newWorkFlowCategory');\r\n//             menu.hideItem('newWorkFlowTemplate');\r\n//             menu.showItem('editWorkFlow');\r\n//             menu.showItem('viewWorkFlow');\r\n//             if(selnode.isDeployment) {\r\n//                 menu.hideItem('deleteWorkFlow');\r\n//                 menu.hideItem('publishWorkFlow');\r\n//             } else {\r\n//                 menu.showItem('publishWorkFlow');\r\n//                 menu.showItem('deleteWorkFlow');\r\n//             }\r\n//         } else // 分类节点\r\n//         {\r\n//             menu.showItem('newWorkFlowCategory');\r\n//             menu.showItem('newWorkFlowTemplate');\r\n//             menu.showItem('editWorkFlow');\r\n//             menu.showItem('deleteWorkFlow');\r\n//             menu.hideItem('viewWorkFlow');\r\n//             menu.hideItem('publishWorkFlow');\r\n//         }\r\n\r\n//         return true;\r\n//     })\r\n\r\n//     //绑定右键事件 设置右键选中节点\r\n//     mytree.attachEvent('onRightClick', function(id) {\r\n//         mytree.selectItem(id);\r\n//     })\r\n// }\r\n\r\n/*1.使用MessageBox.wait()方法实现进度条*/\r\nfunction Read1() {\r\n    Ext.Msg.wait(\"内容\", \"Extjs进度条应用\", {\r\n        text: \"正在加载。。。\"\r\n    });\r\n}\r\n//右键菜单事件\r\nfunction onMenuWorkFlowClick(menuitemId) {\r\n    if(menuitemId == \"newWorkFlowCategory\") { // 新建类别\r\n        newWorkFlowCategoryFun();\r\n    } else if(menuitemId == \"newWorkFlowTemplate\") { // 新建模板\r\n        newWorkFlowTemplateFun();\r\n    } else if(menuitemId == \"editWorkFlow\") { // 编辑\r\n        editWorkFlowFun();\r\n    } else if(menuitemId == \"deleteWorkFlow\") { //删除\r\n        deleteWorkFlowFun();\r\n    } else if(menuitemId == \"viewWorkFlow\") { //查看\r\n        viewWorkFlowFun();\r\n    } else if(menuitemId == \"publishWorkFlow\") { //发布\r\n        publishWorkFlowFun();\r\n    }\r\n}\r\n\r\n//工作流空白处右键菜单事件\r\nfunction onMenuWorkFlowPanelClick(menuitemId) {\r\n    // 在空白处点击鼠标时，就取消原有节点的选中\r\n    hwTreeWorkFlow.clearSelection();\r\n    newWorkFlowCategoryFun();\r\n}\r\n\r\n// 新建工作流分类\r\nfunction newWorkFlowCategoryFun() {\r\n    var addTreeNode = function(fordname, callback) {\r\n        var mytree = hwTreeWorkFlow;\r\n        var selId = mytree.getSelectedItemId();\r\n        var parentId = selId;\r\n        var iconPathOpen = \"tree/folderOpen.gif\";\r\n        var iconPathClose = \"tree/folderClosed.gif\";\r\n        if('' == selId) {\r\n            selId = \"00000000000000000000000000000000\";\r\n            parentId = \"0\";\r\n            iconPathOpen = \"tree/projectopen.png\";\r\n            iconPathClose = \"tree/projectclose.png\";\r\n        }\r\n        var nodename = fordname;\r\n        myMask = new Ext.LoadMask(Ext.getBody(), {\r\n            msg: \"正在执行新建操作...\",\r\n            msgCls: 'z-index:10000;'\r\n        });\r\n        myMask.show();\r\n        checkFlowfordReName(parentId, selId, nodename, function() {\r\n            if(callback) {\r\n                callback();\r\n            }\r\n            var urlService = \"http://\" + (vmd.workspace.workflowIp || vmdSettings.workflowIp) + \"/activiti-rest/service/repository/categorys?info=kermit\";\r\n            // if(vmdSettings.workflowIp) {\r\n            //     var info = \"kermit\";\r\n            //     urlService = \"http://\" + vmdSettings.workflowIp + \"/activiti-rest/service/repository/categorys?info=\" + info;\r\n\r\n            //     // if(einfo && einfo != undefined && einfo != \"undefined\") {\r\n            //     //     urlService = \"http://\" + vmdSettings.workflowIp + \"/activiti-rest/service/repository/categorys?einfo=\" + einfo;\r\n            //     // } else {\r\n            //     //     var info = login;\r\n            //     //     if(!info) {\r\n            //     //         info = \"kermit\";\r\n            //     //     }\r\n            //     //     urlService = \"http://\" + vmdSettings.workflowIp + \"/activiti-rest/service/repository/categorys?info=\" + info;\r\n            //     // }\r\n            // }\r\n            hwDas.ajax({\r\n                url: urlService,\r\n                type: 'post',\r\n                timeout: 5000,\r\n                contentType: 'application/json;charset=UTF-8',\r\n                data: { // body传参\r\n                    'superId': selId,\r\n                    'name': nodename,\r\n                    'xh': 1\r\n                },\r\n                success: function(result) {\r\n\r\n                    if(result == \"\") {\r\n                        return;\r\n                    }\r\n                    // 获取数据后解析形成树形节点；\r\n                    mytree.insertNewChild(parentId, result.id, result.name);\r\n                    mytree.setItemColor(result.id, '#000000', '#000000');\r\n                    mytree.setItemImage2(result.id, iconPathClose, iconPathOpen, iconPathClose);\r\n                    // mytree.insertNewChild(result.id, result.id + \"-0000\", \"\");\r\n                    mytree.closeItem(result.id);\r\n                    var treenode = mytree.item(result.id);\r\n                    if(treenode) {\r\n                        treenode.isTemplate = false; // 标识是否是目标文件\r\n                        // treenode.childLoaded = true; // 标识是否加载了子节点\r\n                        treenode.isDeployment = false; // 标识是否发布\r\n                        treenode.url = result.url;\r\n                        // 标识当前分类节点下的分类节点是否加载完成\r\n                        treenode.childCategoryLoaded = true;\r\n                        // 标识当前分类节点下的模板节点是否加载完成\r\n                        treenode.childModelLoaded = true;\r\n                    }\r\n                    var objKey = \"hw\" + result.id;\r\n                    mytree.itemObj[objKey] = treenode;\r\n\r\n                    hwTreeWorkFlow.show();\r\n\r\n                    connectWorkflowProject(result.id);\r\n\r\n                    myMask.hide();\r\n                },\r\n                error: function(msg) {\r\n                    myMask.hide();\r\n                    Ext.Msg.alert(\"提示\", \"新建分类失败！\")\r\n                }\r\n            })\r\n        })\r\n\r\n    }\r\n    var winForm = new Ext.winWorkFlowCategory(addTreeNode, \"\");\r\n    winForm.show();\r\n}\r\n\r\n// 新建工作流分类后，同步关联与项目的关系\r\nfunction connectWorkflowProject(id) {\r\n    var objWorkflow = {\r\n        'projectid': btnProjectName.projectId,\r\n        'servicecategoryid': id,\r\n        'type': 0\r\n    };\r\n    hwDas.add(\r\n        \"DataServiceWorkSpace/projectInfo/ProjcetServiceCategory\", {}, {}, objWorkflow,\r\n        function(result) {\r\n            // // 清空树原有的默认数据\r\n            // hwTreeWorkFlow.deleteChildItems(0);\r\n            // getWorkflowCategory();\r\n\r\n            // Tips.tips(\"保存成功！\", \"success\");\r\n        },\r\n        function(msg) {\r\n            // Tips.tips(\"保存失败！\", \"error\");\r\n        }\r\n    );\r\n}\r\n\r\n// 新建工作流模板\r\nfunction newWorkFlowTemplateFun() {\r\n\r\n    var addTreeNode = function(fordname, keyword, callback) {\r\n        var mytree = hwTreeWorkFlow;\r\n        var selId = mytree.getSelectedItemId();\r\n        var nodeNameSel = mytree.getSelectedItemText();\r\n        var nodename = fordname;\r\n        var nodeKeyWord = keyword;\r\n        var userName = Ext.util.Cookies.get('userName');\r\n        myMask = new Ext.LoadMask(Ext.getBody(), {\r\n            msg: \"正在新建模板...\",\r\n            msgCls: 'z-index:10000;'\r\n        });\r\n        myMask.show();\r\n        CheckFlowMoudlRename(selId, '', nodename, function() {\r\n            if(callback) {\r\n                callback();\r\n            }\r\n            var urlService = \"http://\" + (vmd.workspace.workflowIp || vmdSettings.workflowIp) + \"/activiti-rest/service/repository/hwmodels?info=kermit\";\r\n            // if(vmdSettings.workflowIp) {\r\n            //     var info = \"kermit\";\r\n            //     urlService = \"http://\" + vmdSettings.workflowIp + \"/activiti-rest/service/repository/hwmodels?info=\" + info;\r\n\r\n            //     // if(einfo && einfo != undefined && einfo != \"undefined\") {\r\n            //     //     urlService = \"http://\" + vmdSettings.workflowIp + \"/activiti-rest/service/repository/hwmodels?einfo=\" + einfo;\r\n            //     // } else {\r\n            //     //     var info = login;\r\n            //     //     if(!info) {\r\n            //     //         info = \"kermit\";\r\n            //     //     }\r\n            //     //     urlService = \"http://\" + vmdSettings.workflowIp + \"/activiti-rest/service/repository/hwmodels?info=\" + info;\r\n            //     // }\r\n            // }\r\n\r\n            hwDas.ajax({\r\n                url: urlService,\r\n                type: 'post',\r\n                timeout: 5000,\r\n                contentType: 'application/json;charset=UTF-8',\r\n                data: { // body传参\r\n                    'name': nodename,\r\n                    'key': nodeKeyWord,\r\n                    'category': nodeNameSel,\r\n                    'categoryId': selId,\r\n                    'creator': userName,\r\n                    'reviser': userName\r\n                },\r\n                success: function(result) {\r\n\r\n                    if(result == \"\") {\r\n                        return;\r\n                    }\r\n                    // 获取数据后解析形成树形节点；\r\n                    mytree.insertNewChild(selId, result, nodename);\r\n                    mytree.setItemColor(result, '#808080', '#808080');\r\n                    mytree.setItemImage2(result, \"tree/model.png\", \"tree/model.png\", \"tree/model.png\");\r\n                    mytree.closeItem(result);\r\n\r\n                    var treenode = mytree.item(result);\r\n                    if(treenode) {\r\n                        treenode.isTemplate = true; // 标识是否是模板文件\r\n                        // treenode.childLoaded = true; // 标识是否加载了子节点\r\n                        treenode.isDeployment = false; // 标识是否发布（新建的模板是未发布的）\r\n                        // treenode.url = result.data.url; // 返回值只有一个ID，没有URL\r\n                        // 标识当前分类节点下的分类节点是否加载完成\r\n                        treenode.childCategoryLoaded = true;\r\n                        // 标识当前分类节点下的模板节点是否加载完成\r\n                        treenode.childModelLoaded = true;\r\n\r\n                        // treenode.path = \"/\" + result.data[j].datas[i].ID;\r\n                        // treenode.isModel = true;\r\n                        // treenode.createuser = datajson[i].row_created_by;\r\n                        treenode.createtime = Ext.Date.dateFormat(new Date(), 'Y-m-d H:i:s');\r\n                        treenode.changetime = Ext.Date.dateFormat(new Date(), 'Y-m-d H:i:s');\r\n\r\n                        // treenode.changeuser = datajson[i].row_changed_by;\r\n                        // treenode.remark = datajson[i].remark;\r\n                        treenode.code = result;\r\n                    }\r\n                    var objKey = \"hw\" + result;\r\n                    mytree.itemObj[objKey] = treenode;\r\n\r\n                    mytree.selectItem(result, true, false);\r\n\r\n                    // 显示基本信息页面\r\n                    var eleIFrame = document.getElementById(\"iframe_page\");\r\n                    if(eleIFrame) {\r\n                        eleIFrame.src = vmd.virtualPath + vmdSettings.systemPath+'/hw4acf2f8b/hw28e7092c.html';\r\n                    }\r\n                    // // 调用设计器HTML页面\r\n                    // document.getElementById(\"iframe_page\").src = '/activiti/modeler.html?mode=design&modelId=' + result + '&info=kermit';\r\n\r\n                    myMask.hide();\r\n                },\r\n                error: function(msg) {\r\n                    myMask.hide();\r\n                    Ext.Msg.alert(\"提示\", \"新建模板失败！\")\r\n                }\r\n            })\r\n        })\r\n    }\r\n    var winForm = new Ext.winWorkFlowTemplate(addTreeNode);\r\n    winForm.show();\r\n}\r\n\r\n// 用于响应工作流加载完成后隐藏进度条\r\nfunction workflowPageLoaded() {\r\n    if(maskProgress) {\r\n        maskProgress.hide();\r\n    }\r\n}\r\n\r\n// 工作流分类编辑\r\nfunction editWorkFlowFun() {\r\n    var mytreeTmp = hwTreeWorkFlow;\r\n    var nodeIdTmp = mytreeTmp.getSelectedItemId();\r\n    var nodeNameSelTmp = mytreeTmp.getSelectedItemText();\r\n    var objKeyTmp = \"hw\" + nodeIdTmp;\r\n    var nodeItemObjTmp = mytreeTmp.itemObj[objKeyTmp];\r\n    var userName = Ext.util.Cookies.get('userName');\r\n    if(nodeItemObjTmp) {\r\n        // 模板节点\r\n        if(nodeItemObjTmp.isTemplate) {\r\n            // 调用设计器HTML页面\r\n            var infoLogin = '&info=kermit';\r\n            // var info = login;\r\n            // if(einfo && einfo != undefined && einfo != \"undefined\") {\r\n            //     infoLogin = '&einfo=' + einfo;\r\n            // } else if(info && info != undefined && info != \"undefined\") {\r\n            //     infoLogin = '&info=' + info;\r\n            // }\r\n            divJcxx.show();\r\n            ModuleInfo.hide();\r\n            WorkflowModuleInfo.hide();\r\n            DataServiceModuleInfo.hide();\r\n            var pageSrc = '/activiti/modeler.html?mode=design&modelId=' + nodeIdTmp + infoLogin;\r\n\r\n            // 显示工作流HTML页面\r\n            if(maskProgress) {\r\n                // maskProgress.show();\r\n            }\r\n            // if(progressBar) {\r\n            //     // progressBar.show();\r\n            // }\r\n            document.getElementById(\"iframe_page\").src = pageSrc;\r\n        } else { // 分类节点\r\n            var callbackFunc = function(fordname, callback) {\r\n                var mytree = hwTreeWorkFlow;\r\n                var nodeId = mytree.getSelectedItemId();\r\n                var nodeNameSel = fordname;\r\n                var objKey = \"hw\" + nodeId;\r\n                var nodeItemObj = mytree.itemObj[objKey];\r\n                var parentId;\r\n                if(mytree.getParentId(nodeId)) {\r\n                    parentId = mytree.getParentId(nodeId)\r\n                } else {\r\n                    parentId = '0'\r\n                }\r\n                myMask = new Ext.LoadMask(Ext.getBody(), {\r\n                    msg: \"加载中,请稍后...\"\r\n                });\r\n                myMask.show();\r\n                checkFlowfordReName(parentId, nodeId, fordname, function() {\r\n                    if(callback) {\r\n                        callback();\r\n                    }\r\n                    var urlService = \"http://\" + (vmd.workspace.workflowIp || vmdSettings.workflowIp) + \"/activiti-rest/service/repository/categorys/\" + nodeId + \"?info=kermit\";\r\n                    // if(vmdSettings.workflowIp) {\r\n                    //     var info = \"kermit\";\r\n                    //     urlService = \"http://\" + vmdSettings.workflowIp + \"/activiti-rest/service/repository/categorys/\" + nodeId + \"?info=\" + info;\r\n\r\n                    //     // if(einfo && einfo != undefined && einfo != \"undefined\") {\r\n                    //     //     urlService = \"http://\" + vmdSettings.workflowIp + \"/activiti-rest/service/repository/categorys/\" + nodeId + \"?einfo=\" + einfo;\r\n                    //     // } else {\r\n                    //     //     var info = login;\r\n                    //     //     if(!info) {\r\n                    //     //         info = \"kermit\";\r\n                    //     //     }\r\n                    //     //     urlService = \"http://\" + vmdSettings.workflowIp + \"/activiti-rest/service/repository/categorys/\" + nodeId + \"?info=\" + info;\r\n                    //     // }\r\n                    // }\r\n                    if(nodeItemObj) {\r\n                        // 模板节点\r\n                        hwDas.ajax({\r\n                            // das: {\r\n                            //     idedas: true\r\n                            // },\r\n                            url: urlService,\r\n                            type: 'put',\r\n                            timeout: 5000,\r\n                            contentType: 'application/json;charset=UTF-8',\r\n                            data: { // body传参\r\n                                'name': nodeNameSel\r\n                            },\r\n                            success: function(result) {\r\n                                // 获取数据后解析形成树形节点；\r\n                                mytree.setItemText(result.id, result.name, result.name);\r\n                                myMask.hide();\r\n                            },\r\n                            error: function(msg) {\r\n                                myMask.hide();\r\n                                Ext.Msg.alert(\"提示\", \"编辑分类失败！\")\r\n                            }\r\n                        })\r\n                    }\r\n                })\r\n            }\r\n            var winForm = new Ext.winWorkFlowCategory(callbackFunc, nodeNameSelTmp);\r\n            winForm.show();\r\n        }\r\n    }\r\n}\r\n\r\n// 删除\r\nfunction deleteWorkFlowFun() {\r\n    Ext.Msg.confirm(\"提示!\", \"确定要删除?\", function(btn) {\r\n        if(btn == \"yes\") {\r\n            var mytree = hwTreeWorkFlow;\r\n            var selId = mytree.getSelectedItemId();\r\n            var objKey = \"hw\" + selId;\r\n            var nodeItemObj = mytree.itemObj[objKey];\r\n\r\n            if(!nodeItemObj) {\r\n                return;\r\n            }\r\n\r\n            var urlService = \"http://\" + (vmd.workspace.workflowIp || vmdSettings.workflowIp) + \"/activiti-rest/service/repository/categorys/\" + selId + \"?info=kermit\";\r\n            // if(vmdSettings.workflowIp) {\r\n            //     var info = \"kermit\";\r\n            //     urlService = \"http://\" + vmdSettings.workflowIp + \"/activiti-rest/service/repository/categorys/\" + selId + \"?info=\" + info;\r\n\r\n            //     // if(einfo && einfo != undefined && einfo != \"undefined\") {\r\n            //     //     urlService = \"http://\" + vmdSettings.workflowIp + \"/activiti-rest/service/repository/categorys/\" + selId + \"?einfo=\" + einfo;\r\n            //     // } else {\r\n            //     //     var info = login;\r\n            //     //     if(!info) {\r\n            //     //         info = \"kermit\";\r\n            //     //     }\r\n            //     //     urlService = \"http://\" + vmdSettings.workflowIp + \"/activiti-rest/service/repository/categorys/\" + selId + \"?info=\" + info;\r\n            //     // }\r\n            // }\r\n            // 分类节点\r\n            if(!nodeItemObj.isTemplate) {\r\n\r\n                var myMask = new Ext.LoadMask(Ext.getBody(), {\r\n                    msg: \"正在执行删除操作...\",\r\n                    msgCls: 'z-index:10000;'\r\n                });\r\n                myMask.show();\r\n\r\n                hwDas.ajax({\r\n                    // das: {\r\n                    //     idedas: true\r\n                    // },\r\n                    url: urlService,\r\n                    type: 'delete',\r\n                    timeout: 5000,\r\n                    data: null,\r\n                    dataType: 'text', // 返回的数据的格式\r\n                    contentType: 'application/json',\r\n                    success: function(result) {\r\n                        delWorkflowProject(id);\r\n                        mytree.deleteChildItems(selId);\r\n                        mytree.deleteItem(selId);\r\n                        if(mytree.hasChildren(0)) {\r\n                            mytree.show();\r\n                        } else {\r\n                            mytree.hide();\r\n                        }\r\n\r\n                        myMask.hide();\r\n                    },\r\n                    error: function(msg) {\r\n                        myMask.hide();\r\n                        Ext.Msg.alert(\"提示\", \"删除分类失败！\");\r\n                    }\r\n                })\r\n            } else // 模板节点\r\n            {\r\n                var urlService = \"http://\" + (vmd.workspace.workflowIp || vmdSettings.workflowIp) + \"/activiti-rest/service/repository/models/\" + selId + \"?info=kermit\";\r\n                // if(vmdSettings.workflowIp) {\r\n                //     var info = \"kermit\";\r\n                //     urlService = \"http://\" + vmdSettings.workflowIp + \"/activiti-rest/service/repository/models/\" + selId + \"?info=\" + info;\r\n\r\n                //     // if(einfo && einfo != undefined && einfo != \"undefined\") {\r\n                //     //     urlService = \"http://\" + vmdSettings.workflowIp + \"/activiti-rest/service/repository/models/\" + selId + \"?einfo=\" + einfo;\r\n                //     // } else {\r\n                //     //     var info = logini;\r\n                //     //     if(!info) {\r\n                //     //         info = \"kermit\";\r\n                //     //     }\r\n                //     //     urlService = \"http://\" + vmdSettings.workflowIp + \"/activiti-rest/service/repository/models/\" + selId + \"?info=\" + info;\r\n                //     // }\r\n                // }\r\n\r\n                var myMask = new Ext.LoadMask(Ext.getBody(), {\r\n                    msg: \"正在执行删除操作...\",\r\n                    msgCls: 'z-index:10000;'\r\n                });\r\n                myMask.show();\r\n                hwDas.ajax({\r\n                    // das: {\r\n                    //     idedas: true\r\n                    // },\r\n                    url: urlService,\r\n                    type: 'delete',\r\n                    timeout: 5000,\r\n                    data: null,\r\n                    dataType: 'text', // 返回的数据的格式\r\n                    // contentType: \"\", // 传入数据的内容格式\r\n                    success: function(result) {\r\n                        mytree.deleteItem(selId);\r\n                        // Ext.Msg.alert(\"提示\", \"删除模板成功！\")\r\n                        myMask.hide();\r\n                    },\r\n                    error: function(msg) {\r\n                        myMask.hide();\r\n                        Ext.Msg.alert(\"提示\", \"删除模板失败！\")\r\n                    }\r\n                })\r\n            }\r\n        } else {\r\n\r\n        }\r\n    });\r\n}\r\n\r\n// 同步删除工作流与项目的关联关系\r\nfunction delWorkflowProject(id) {\r\n\r\n    hwDas.del(\r\n        \"DataServiceWorkSpace/projectInfo/ProjcetServiceCategory\", {}, {\r\n            'projectid': btnProjectName.projectId,\r\n            'servicecategoryid': id,\r\n            'type': 0\r\n        },\r\n        function(result) {\r\n            // Tips.tips(\"删除成功！\", \"success\");\r\n        },\r\n        function(msg) {\r\n            // Tips.tips(\"删除失败！\", \"error\");\r\n        }\r\n    );\r\n}\r\n\r\n// 查看\r\nfunction viewWorkFlowFun() {\r\n\r\n    var mytree = hwTreeWorkFlow;\r\n    var nodeId = mytree.getSelectedItemId();\r\n    var objKey = \"hw\" + nodeId;\r\n    var nodeItemObj = mytree.itemObj[objKey];\r\n    if(nodeItemObj) {\r\n        // 模板节点\r\n        if(nodeItemObj.isTemplate) {\r\n            divJcxx.show();\r\n            ModuleInfo.hide();\r\n            WorkflowModuleInfo.hide();\r\n            DataServiceModuleInfo.hide();\r\n            if(maskProgress) {\r\n                // maskProgress.show();\r\n            }\r\n            // if(progressBar) {\r\n            //     // progressBar.show();\r\n            // }\r\n            // 调用设计器HTML页面\r\n            document.getElementById(\"iframe_page\").src = vmd.virtualPath + vmdSettings.systemPath+'/hw4acf2f8b/hw8ad68408.html?modelId=' + nodeId;\r\n        } else // 分类节点\r\n        {\r\n            return;\r\n        }\r\n    }\r\n}\r\n\r\n// 发布\r\nfunction publishWorkFlowFun() {\r\n\r\n    var mytree = hwTreeWorkFlow;\r\n    var selId = mytree.getSelectedItemId();\r\n    var nodeNameSel = mytree.getSelectedItemText();\r\n\r\n    var info = \"kermit\";\r\n    var urlService = \"http://\" + (vmd.workspace.workflowIp || vmdSettings.workflowIp) + \"/activiti-rest/service/repository/deployments/deployModel?info=\" + info;\r\n    // var urlService = \"http://\" + vmdSettings.workflowIp + \"/activiti-rest/service/repository/deployments/deployModel?info=kermit\";\r\n    // if(vmdSettings.workflowIp) {\r\n    //     var info = \"kermit\";\r\n    //     urlService = \"http://\" + vmdSettings.workflowIp + \"/activiti-rest/service/repository/deployments/deployModel?info=\" + info;\r\n\r\n    //     // if(einfo && einfo != undefined && einfo != \"undefined\") {\r\n    //     //     urlService = \"http://\" + vmdSettings.workflowIp + \"/activiti-rest/service/repository/deployments/deployModel?einfo=\" + einfo;\r\n    //     // } else {\r\n    //     //     var info = login;\r\n    //     //     if(!info) {\r\n    //     //         info = \"kermit\";\r\n    //     //     }\r\n    //     //     urlService = \"http://\" + vmdSettings.workflowIp + \"/activiti-rest/service/repository/deployments/deployModel?info=\" + info;\r\n    //     // }\r\n    // }\r\n\r\n    var myMask = new Ext.LoadMask(Ext.getBody(), {\r\n        msg: \"数据加载中,请稍后...\",\r\n        msgCls: 'z-index:10000;'\r\n    });\r\n    myMask.show();\r\n\r\n    hwDas.ajax({\r\n        // das: {\r\n        //     idedas: true\r\n        // },\r\n        url: urlService,\r\n        type: 'post',\r\n        timeout: 5000,\r\n        contentType: 'application/json;charset=UTF-8',\r\n        data: { // body传参\r\n            'id': selId,\r\n            'name': nodeNameSel\r\n        },\r\n        success: function(result) {\r\n\r\n            mytree.setItemColor(selId, \"#000000\", \"#000000\");\r\n            myMask.hide();\r\n        },\r\n        error: function(msg) {\r\n            myMask.hide();\r\n            Ext.Msg.alert(\"提示\", \"模板发布失败！\");\r\n        }\r\n    })\r\n}\r\n\r\n//分类名称录入框\r\nExt.winWorkFlowCategory = Ext.extend(Ext.Window, {\r\n    xtype: \"window\",\r\n    title: \"分类\",\r\n    width: 300,\r\n    height: 150,\r\n    layout: \"form\",\r\n    bodyStyle: 'padding:15px',\r\n    labelAlign: \"left\",\r\n    labelWidth: 40,\r\n    modal: true,\r\n    constructor: function(callback, valueText) {\r\n        this.callback = callback;\r\n        this.valueText = valueText;\r\n        this.callParent();\r\n    },\r\n    initComponent: function() {\r\n        var me = this;\r\n        this.fbar = [{\r\n            text: \"确定\",\r\n            handler: function() {\r\n                me.callback(Ext.getCmp('filename').getValue(), function() {\r\n                    me.close();\r\n                });\r\n            }\r\n        }, {\r\n            text: \"取消\",\r\n            handler: function() {\r\n                me.close();\r\n            }\r\n        }];\r\n\r\n        this.items = [{\r\n            id: 'filename',\r\n            xtype: \"textfield\",\r\n            fieldLabel: \"名称\",\r\n            anchor: \"100%\",\r\n            value: this.valueText\r\n        }]\r\n\r\n        Ext.winWorkFlowCategory.superclass.initComponent.call(this);\r\n    }\r\n})\r\n\r\n//模板名称录入框\r\nExt.winWorkFlowTemplate = Ext.extend(Ext.Window, {\r\n    xtype: \"window\",\r\n    title: \"模板名称\",\r\n    width: 300,\r\n    height: 150,\r\n    layout: \"form\",\r\n    bodyStyle: 'padding:15px',\r\n    labelAlign: \"left\",\r\n    labelWidth: 40,\r\n    modal: true,\r\n    constructor: function(callback) {\r\n        this.callback = callback;\r\n        this.callParent();\r\n    },\r\n    initComponent: function() {\r\n        var me = this;\r\n        this.fbar = [{\r\n            text: \"确定\",\r\n            handler: function() {\r\n                var keyValue = randomWord(true, 3, 10);\r\n                me.callback(Ext.getCmp('filename').getValue(), keyValue, function() {\r\n                    me.close();\r\n                });\r\n            }\r\n        }, {\r\n            text: \"取消\",\r\n            handler: function() {\r\n                me.close();\r\n            }\r\n        }];\r\n\r\n        this.items = [{\r\n            id: 'filename',\r\n            xtype: \"textfield\",\r\n            fieldLabel: \"名称\",\r\n            anchor: \"100%\"\r\n        }]\r\n        Ext.winWorkFlowTemplate.superclass.initComponent.call(this);\r\n    }\r\n})\r\n/*\r\n ** randomWord 产生任意长度随机字母数字组合\r\n ** randomFlag-是否任意长度 min-任意长度最小位[固定位数] max-任意长度最大位\r\n ** xuanfeng 2014-08-28\r\n */\r\nfunction randomWord(randomFlag, min, max) {\r\n    var str = \"\",\r\n        range = min,\r\n        arr = ['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z', 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z'];\r\n    // arr = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z', 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z'];\r\n\r\n    // 随机产生\r\n    if(randomFlag) {\r\n        range = Math.round(Math.random() * (max - min)) + min;\r\n    }\r\n    for(var i = 0; i < range; i++) {\r\n        pos = Math.round(Math.random() * (arr.length - 1));\r\n        str += arr[pos];\r\n    }\r\n    return str;\r\n}\r\n// 点击工作流树形节点\r\nfunction hwTreeWorkFlow_nodeClick(sender, id) {\r\n    divJcxx.show();\r\n    ModuleInfo.hide();\r\n    WorkflowModuleInfo.hide();\r\n    DataServiceModuleInfo.hide();\r\n\r\n    var nodeId = id;\r\n    var mytree = hwTreeWorkFlow;\r\n    var objKey = \"hw\" + nodeId;\r\n    var selnode = mytree.itemObj[objKey];\r\n\r\n    var eleIFrame = document.getElementById(\"iframe_page\");\r\n    if(eleIFrame) {\r\n        if(selnode.isTemplate) {\r\n\r\n            divJcxx.hide();\r\n            WorkflowModuleInfo.show();\r\n            WorkflowModuleInfo.refresh(mytree, btnProjectName.projectId, btnWorkSpaceName.workspaceId);\r\n\r\n            // eleIFrame.src = vmd.virtualPath + vmdSettings.systemPath+'/hw4acf2f8b/hw28e7092c.html';\r\n        } else {\r\n            eleIFrame.src = vmd.virtualPath + vmdSettings.systemPath+'/eQ9ULgcVb5/hw03cb4931.html';\r\n        }\r\n    }\r\n}\r\n\r\n// 获取子节点中的分类节点\r\nfunction getChildCategoryNodes(nodeParentId, maskLoading) {\r\n\r\n    var nodeId = nodeParentId;\r\n    var mytree = hwTreeWorkFlow;\r\n    var objKeyTmp = \"hw\" + nodeId;\r\n    var selnode = mytree.itemObj[objKeyTmp];\r\n    if(!selnode) {\r\n        return;\r\n    }\r\n    var info = \"kermit\";\r\n    urlService = \"http://\" + (vmd.workspace.workflowIp || vmdSettings.workflowIp) + \"/activiti-rest/service/repository/categorys/\" + nodeParentId + \"/members?info=\" + info;\r\n\r\n    // var urlService = \"http://\" + (vmd.workspace.workflowIp || vmdSettings.workflowIp) + \"/activiti-rest/service/repository/categorys/\" + nodeParentId + \"/members?info=kermit\";\r\n    // if(vmdSettings.workflowIp) {\r\n    //     var info = \"kermit\";\r\n    //     urlService = \"http://\" + (vmd.workspace.workflowIp || vmdSettings.workflowIp) + \"/activiti-rest/service/repository/categorys/\" + nodeParentId + \"/members?info=\" + info;\r\n\r\n    //     // if(einfo && einfo != undefined && einfo != \"undefined\") {\r\n    //     //     urlService = \"http://\" + vmdSettings.workflowIp + \"/activiti-rest/service/repository/categorys/\" + nodeParentId + \"/members?einfo=\" + einfo;\r\n    //     // } else {\r\n    //     //     var info = login;\r\n    //     //     if(!info) {\r\n    //     //         info = \"kermit\";\r\n    //     //     }\r\n    //     //     urlService = \"http://\" + vmdSettings.workflowIp + \"/activiti-rest/service/repository/categorys/\" + nodeParentId + \"/members?info=\" + info;\r\n    //     // }\r\n    // }\r\n    // 获取根节点下的文件夹节点信息\r\n    hwDas.ajax({\r\n        url: urlService,\r\n        type: 'get',\r\n        timeout: 10000,\r\n        params: {},\r\n        success: function(result) {\r\n\r\n            // 获取分类节点数据后解析形成树形节点；\r\n            for(var i = 0; i < result.data.length; i++) {\r\n\r\n                mytree.insertNewChild(nodeId, result.data[i].id, result.data[i].name);\r\n                mytree.setItemColor(result.data[i].id, '#000000', '#000000');\r\n                mytree.setItemImage2(result.data[i].id, \"tree/folderClosed.gif\", \"tree/folderOpen.gif\", \"tree/folderClosed.gif\");\r\n                mytree.insertNewChild(result.data[i].id, result.data[i].id + \"-0000\", \"\");\r\n                mytree.closeItem(result.data[i].id);\r\n                var treenode = mytree.item(result.data[i].id);\r\n                if(treenode) {\r\n                    treenode.isTemplate = false; // 标识是否是目标文件\r\n                    // treenode.childLoaded = false; // 标识是否加载了子节点\r\n                    treenode.isDeployment = false; // 标识是否发布\r\n                    treenode.url = result.data[i].url;\r\n                    // 标识当前分类节点下的分类节点是否加载完成\r\n                    treenode.childCategoryLoaded = false;\r\n                    // 标识当前分类节点下的模板节点是否加载完成\r\n                    treenode.childModelLoaded = false;\r\n                }\r\n                var objKey = \"hw\" + result.data[i].id;\r\n                mytree.itemObj[objKey] = treenode;\r\n            }\r\n\r\n            selnode.childCategoryLoaded = true;\r\n            // selnode.childLoaded = true;\r\n            if(selnode.childCategoryLoaded && selnode.childModelLoaded) {\r\n                if(maskLoading) {\r\n                    maskLoading.hide();\r\n                }\r\n            }\r\n        },\r\n        error: function(msg) {\r\n            selnode.childCategoryLoaded = true;\r\n            if(selnode.childCategoryLoaded && selnode.childModelLoaded) {\r\n                if(maskLoading) {\r\n                    maskLoading.hide();\r\n                }\r\n            }\r\n            Ext.Msg.alert(\"提示\", \"获取分类节点信息失败\", function() {})\r\n        }\r\n    })\r\n}\r\n\r\n// 获取子节点中的模板节点\r\nfunction getChildTemplateNodes(nodeParentId, maskLoading) {\r\n\r\n    var nodeId = nodeParentId;\r\n    var mytree = hwTreeWorkFlow;\r\n    var objKeyTmp = \"hw\" + nodeId;\r\n    var selnode = mytree.itemObj[objKeyTmp];\r\n    if(!selnode) {\r\n        return;\r\n    }\r\n    var info = \"kermit\";\r\n    urlService = \"http://\" + (vmd.workspace.workflowIp || vmdSettings.workflowIp) + \"/activiti-rest/service/repository/hwmodels?categoryId=\" + nodeParentId + \"&info=\" + info;\r\n\r\n    // 获取根节点下的文件夹节点信息\r\n    hwDas.ajax({\r\n        // das: {\r\n        //     idedas: true\r\n        // },\r\n\r\n        url: urlService,\r\n        type: 'get',\r\n        timeout: 10000,\r\n        params: {},\r\n        success: function(result) {\r\n\r\n            // 获取分类节点数据后解析形成树形节点；\r\n            for(var j = 0; j < result.data.length; j++) {\r\n\r\n                for(var i = 0; i < result.data[j].datas.length; i++) {\r\n\r\n                    mytree.insertNewChild(nodeId, result.data[j].datas[i].ID, result.data[j].datas[i].NAME);\r\n                    if(result.data[j].datas[i].ISDEPLOYMENT) {\r\n                        mytree.setItemColor(result.data[j].datas[i].ID, '#000000', '#000000');\r\n                    } else {\r\n                        mytree.setItemColor(result.data[j].datas[i].ID, '#808080', '#808080');\r\n                    }\r\n                    mytree.setItemImage2(result.data[j].datas[i].ID, \"tree/model.png\", \"tree/model.png\", \"tree/model.png\");\r\n                    mytree.closeItem(result.data[j].datas[i].ID);\r\n                    var treenode = mytree.item(result.data[j].datas[i].ID);\r\n                    if(treenode) {\r\n                        treenode.isTemplate = true; // 标识是否是目标文件\r\n                        // treenode.childLoaded = true; // 标识是否加载了子节点\r\n                        treenode.isDeployment = result.data[j].datas[i].ISDEPLOYMENT; // 标识是否发布\r\n                        treenode.url = result.data[j].datas[i].URL;\r\n                        // 标识当前分类节点下的分类节点是否加载完成\r\n                        treenode.childCategoryLoaded = false;\r\n                        // 标识当前分类节点下的模板节点是否加载完成\r\n                        treenode.childModelLoaded = false;\r\n\r\n                        // treenode.path = \"/\" + result.data[j].datas[i].ID;\r\n                        // treenode.isModel = true;\r\n                        // treenode.createuser = datajson[i].row_created_by;\r\n                        var dateCreate = new Date(result.data[j].datas[i].CREATETIME);\r\n                        var dateUpdate = new Date(result.data[j].datas[i].LASTUPDATETIME);\r\n\r\n                        treenode.createtime = Ext.Date.dateFormat(dateCreate, 'Y-m-d H:i:s');\r\n                        treenode.changetime = Ext.Date.dateFormat(dateUpdate, 'Y-m-d H:i:s');\r\n                        // console.log(JSON.parse(result.data[j].datas[i].METAINFO).reviser)\r\n                        treenode.changeuser = JSON.parse(result.data[j].datas[i].METAINFO).reviser;\r\n                        // treenode.remark = datajson[i].remark;\r\n                        treenode.code = result.data[j].datas[i].ID;\r\n                    }\r\n                    var objKey = \"hw\" + result.data[j].datas[i].ID;\r\n                    mytree.itemObj[objKey] = treenode;\r\n                }\r\n            }\r\n            selnode.childModelLoaded = true;\r\n            // selnode.childLoaded = true;\r\n            if(selnode.childCategoryLoaded && selnode.childModelLoaded) {\r\n                if(maskLoading) {\r\n                    maskLoading.hide();\r\n                }\r\n            }\r\n        },\r\n        error: function(msg) {\r\n            selnode.childModelLoaded = true;\r\n            if(selnode.childCategoryLoaded && selnode.childModelLoaded) {\r\n                if(maskLoading) {\r\n                    maskLoading.hide();\r\n                }\r\n            }\r\n            Ext.Msg.alert(\"提示\", \"获取分类节点信息失败\", function() {})\r\n        }\r\n    })\r\n}\r\n\r\nfunction hwTreeWorkFlow_onOpenEnd(sender, id, state) {\r\n    var nodeId = id;\r\n    var mytree = hwTreeWorkFlow;\r\n    var objKey = \"hw\" + nodeId;\r\n    var selnode = mytree.itemObj[objKey];\r\n    if(!selnode) {\r\n        return;\r\n    }\r\n    if(selnode.childCategoryLoaded || selnode.childModelLoaded) {\r\n        return;\r\n    }\r\n    var maskLoading = new Ext.LoadMask(Ext.getCmp(\"hwTreeWorkFlow\").el, {\r\n        msg: \"数据加载中,请稍后...\",\r\n        msgCls: 'z-index:10000;'\r\n    });\r\n    maskLoading.show();\r\n    // 如果是文件夹节点\r\n    if(!selnode.isTemplate) {\r\n        var nodeNullId = nodeId + \"-0000\";\r\n        var nIndex = mytree.getIndexById(nodeNullId);\r\n        if(null != nIndex) {\r\n            if(nIndex > -1) {\r\n                mytree.deleteItem(nodeNullId);\r\n            }\r\n        }\r\n\r\n        // 获取文件夹下的分类节点和模板节点\r\n        // 分类节点\r\n        getChildCategoryNodes(nodeId, maskLoading);\r\n        // 模板节点\r\n        getChildTemplateNodes(nodeId, maskLoading);\r\n    }\r\n\r\n    // myMask.hide();\r\n}\r\n\r\n\r\n\r\n//20171122 chengbing  主页面窗口\r\nfunction openWin(obj, html, parname, par) {\r\n    window[parname] = par;\r\n    var openWinFrom = new Ext.Window(obj || {\r\n        title: \"节点绑定表单\",\r\n        modal: true,\r\n        maximized: false,\r\n        height: 600,\r\n        width: 800,\r\n        maximizable: true,\r\n        resizable: true,\r\n        bodyStyle: \"background-color:#fff\",\r\n        closeAction: 'close'\r\n\r\n    })\r\n    Ext.defer(function() {\r\n        openWinFrom.html = html; //\"<iframe src='\"+vmd.core.getVirtualPath()+vmdSettings.systemPath+\"/hw4acf2f8b/hw3b434d49.html?r=\" + new Date().getTime() + \"' frameborder=0 scrolling=no style='height:100%;width:100%'></iframe>\";\r\n        openWinFrom.show()\r\n    }, 50)\r\n\r\n    window[\"openWinFrom\"] = openWinFrom;\r\n    return openWinFrom;\r\n}\r\nwindow[\"openWin\"] = openWin;\r\n\r\n//20171125 sgw  工作流页面保存后调用的方法，用于更新工作流节点的是否发布的状态\r\nfunction designTemplate(id) {\r\n\r\n    var mytree = hwTreeWorkFlow;\r\n    var nodeId = id;\r\n    if(nodeId == \"\" || !nodeId) {\r\n        return;\r\n    }\r\n    // 显示默认页面\r\n    divJcxx.show();\r\n    ModuleInfo.hide();\r\n    WorkflowModuleInfo.hide();\r\n    DataServiceModuleInfo.hide();\r\n    // 调用设计器HTML页面\r\n    var eleIFrame = document.getElementById(\"iframe_page\");\r\n    if(eleIFrame) {\r\n        // eleIFrame.src = '/activiti/modeler.html?mode=design&modelId=' + nodeId + '&info=kermit';\r\n\r\n        var infoLogin = '&info=kermit';\r\n        //var info = Ext.util.Cookies.get('login');\r\n        // if(einfo && einfo != undefined && einfo != \"undefined\") {\r\n        //     infoLogin = '&einfo=' + einfo;\r\n        // } else if(info && info != undefined && info != \"undefined\") {\r\n        //     infoLogin = '&info=' + info;\r\n        // }\r\n        var pageSrc = '/activiti/modeler.html?mode=design&modelId=' + nodeId + infoLogin;\r\n        eleIFrame.src = pageSrc;\r\n    }\r\n\r\n}\r\n\r\n// 2017.11.25 sgw: 声明全局函数\r\nwindow[\"designTemplate\"] = designTemplate;\r\n\r\n//20171128 sgw  工作流页面基本信息的保存\r\nfunction saveModelInfo(name, description) {\r\n    var mytree = hwTreeWorkFlow;\r\n    var selId = mytree.getSelectedItemId();\r\n    if(selId == \"\" || !selId) {\r\n        return;\r\n    }\r\n    var objKey = \"hw\" + selId;\r\n    var selnode = mytree.itemObj[objKey];\r\n    if(!selnode) {\r\n        return;\r\n    }\r\n    if(!selnode.isTemplate) {\r\n        return;\r\n    }\r\n    selnode.text = name;\r\n    var userName = Ext.util.Cookies.get('userName');\r\n    var pid = mytree.getParentId(selId)\r\n    CheckFlowMoudlRename(pid, selId, name, function() {\r\n        // var urlService = \"http://\" + (vmd.workspace.workflowIp || vmdSettings.workflowIp) + \"/activiti-rest/service/repository/models/\" + selId + \"?info=kermit\";\r\n        // if(vmdSettings.workflowIp) {\r\n        //     var info = \"kermit\";\r\n        //     urlService = \"http://\" + vmdSettings.workflowIp + \"/activiti-rest/service/repository/models/\" + selId + \"?info=\" + info;\r\n\r\n        //     // if(einfo && einfo != undefined && einfo != \"undefined\") {\r\n        //     //     urlService = \"http://\" + vmdSettings.workflowIp + \"/activiti-rest/service/repository/models/\" + selId + \"?einfo=\" + einfo;\r\n        //     // } else {\r\n        //     //     var info = login;\r\n        //     //     if(!info || info == undefined || info == \"undefined\") {\r\n        //     //         info = \"kermit\";\r\n        //     //     }\r\n        //     //     urlService = \"http://\" + vmdSettings.workflowIp + \"/activiti-rest/service/repository/models/\" + selId + \"?info=\" + info;\r\n        //     // }\r\n        // }\r\n\r\n        // var urlService = \"activiti-rest/service/repository/models/\" + selId + \"?info=kermit\";\r\n\r\n        // var urlparam = {\r\n        //     host: (vmd.workspace.workflowIp || vmdSettings.workflowIp),\r\n        //     url: urlService\r\n        // }\r\n\r\n        // // 更改活动工区状态\r\n        // hwDas.edit(\r\n        //     urlparam, {}, {}, [{ // body传参\r\n        //         'name': name,\r\n        //         'metaInfo': \"{\\\"name\\\":\\\"\" + name + \"\\\",\\\"description\\\":\\\"\" + description + \"\\\",\\\"reviser\\\":\\\"\" + userName + \"\\\"}\"\r\n        //     }],\r\n        //     function(result) {\r\n        //         // 获取数据后解析形成树形节点；\r\n        //         mytree.setItemText(selId, name, name);\r\n        //         Ext.Msg.alert(\"提示\", \"保存成功！\");\r\n        //     },\r\n        //     function(msg) {\r\n        //         Ext.Msg.alert(\"提示\", \"保存模板基本信息失败！\")\r\n        //     }\r\n        // );\r\n\r\n        var urlService = \"http://\" + (vmd.workspace.workflowIp || vmdSettings.workflowIp) + \"/activiti-rest/service/repository/models/\" + selId + \"?info=kermit\";\r\n\r\n        // var tmp = \"{\\\"name\\\":\\\"\" + name + \"\\\",\\\"description\\\":\\\"\" + description + \"\\\",\\\"reviser\\\":\\\"\" + userName + \"\\\"}\";\r\n        hwDas.ajax({\r\n            // das: {\r\n            //     idedas: true\r\n            // },\r\n            url: urlService,\r\n            type: 'put',\r\n            timeout: 5000,\r\n            contentType: 'application/json;charset=UTF-8',\r\n            data: { // body传参\r\n                'name': name,\r\n                'metaInfo': \"{\\\"name\\\":\\\"\" + name + \"\\\",\\\"description\\\":\\\"\" + description + \"\\\",\\\"reviser\\\":\\\"\" + userName + \"\\\"}\"\r\n                // 'metaInfo': {'name':name,'description':description,'reviser':userName}\r\n            },\r\n            success: function(result) {\r\n                // 获取数据后解析形成树形节点；\r\n                mytree.setItemText(selId, name, name);\r\n                WorkflowModuleInfo.hwText4.setValue(Ext.util.Cookies.get('userName'));\r\n                WorkflowModuleInfo.hwText5.setValue(Ext.Date.dateFormat(new Date(), 'Y-m-d H:i:s'))\r\n                Ext.Msg.alert(\"提示\", \"保存成功！\")\r\n            },\r\n            error: function(msg) {\r\n                Ext.Msg.alert(\"提示\", \"保存模板基本信息失败！\")\r\n            }\r\n        })\r\n    })\r\n}\r\n\r\n// 2017.11.25 sgw: 声明全局函数\r\nwindow[\"saveModelInfo\"] = saveModelInfo;\r\n\r\n//20171125 sgw  工作流页面保存后调用的方法，用于更新工作流节点的是否发布的状态\r\nfunction modelDeployment(id) {\r\n\r\n    var mytree = hwTreeWorkFlow;\r\n    var selId = id;\r\n    if(selId == \"\" || !selId) {\r\n        return;\r\n    }\r\n\r\n    var nodeNameSel = mytree.getItemText(selId);\r\n\r\n    var urlService = \"http://\" + (vmd.workspace.workflowIp || vmdSettings.workflowIp) + \"/activiti-rest/service/repository/deployments/deployModel?info=kermit\";\r\n    // if(vmdSettings.workflowIp) {\r\n    //     var info = \"kermit\";\r\n    //     urlService = \"http://\" + vmdSettings.workflowIp + \"/activiti-rest/service/repository/deployments/deployModel?info=\" + info;\r\n\r\n    //     // if(einfo && einfo != undefined && einfo != \"undefined\") {\r\n    //     //     urlService = \"http://\" + vmdSettings.workflowIp + \"/activiti-rest/service/repository/deployments/deployModel?einfo=\" + einfo;\r\n    //     // } else {\r\n    //     //     var info = login;\r\n    //     //     if(!info || info == undefined || info == \"undefined\") {\r\n    //     //         info = \"kermit\";\r\n    //     //     }\r\n    //     //     urlService = \"http://\" + vmdSettings.workflowIp + \"/activiti-rest/service/repository/deployments/deployModel?info=\" + info;\r\n    //     // }\r\n    // }\r\n    hwDas.ajax({\r\n        // das: {\r\n        //     idedas: true\r\n        // },\r\n        url: urlService,\r\n        type: 'post',\r\n        timeout: 5000,\r\n        contentType: 'application/json;charset=UTF-8',\r\n        data: { // body传参\r\n            'id': selId,\r\n            'name': nodeNameSel\r\n        },\r\n        success: function(result) {\r\n            selnode.isDeployment = false;\r\n\r\n            var nodeId = mytree.getSelectedItemId();\r\n            var objKey = \"hw\" + nodeId;\r\n            var selnode = mytree.itemObj[objKey];\r\n            if(selnode) {\r\n                // 如果是文件夹节点\r\n                if(selnode.isTemplate) {\r\n                    selnode.isDeployment = true;\r\n                    mytree.setItemColor(selId, \"#000000\", \"#000000\");\r\n                }\r\n            }\r\n\r\n\r\n\r\n        },\r\n        error: function(msg) {\r\n            Ext.Msg.alert(\"提示\", \"模板发布失败！\");\r\n        }\r\n    })\r\n\r\n}\r\n\r\n// 2017.11.25 sgw: 声明全局函数\r\nwindow[\"modelDeployment\"] = modelDeployment;\r\n\r\n//20171125 sgw  工作流页面保存后调用的方法，用于更新工作流节点的是否发布的状态\r\nfunction updateDeploymentState() {\r\n\r\n    var mytree = hwTreeWorkFlow;\r\n    var nodeId = mytree.getSelectedItemId();\r\n    var objKey = \"hw\" + nodeId;\r\n    var selnode = mytree.itemObj[objKey];\r\n    if(!selnode) {\r\n        return;\r\n    }\r\n    // 如果是文件夹节点\r\n    if(selnode.isTemplate) {\r\n        selnode.isDeployment = false;\r\n        mytree.setItemColor(nodeId, '#808080', '#808080');\r\n    }\r\n}\r\n\r\n// 2017.11.25 sgw: 声明全局函数\r\nwindow[\"updateDeploymentState\"] = updateDeploymentState;\r\n\r\n// 数据服务是否加载过\r\nvar ifDataServiceLoaded = false;\r\n\r\nfunction hwTreeDataService_afterrender(sender) {\r\n\r\n    ifDataServiceLoaded = true;\r\n    // 清空树原有的默认数据\r\n    hwTreeDataService.deleteChildItems(0);\r\n    getDataServiceCategory();\r\n\r\n    // 没配置数据服务时的提示信息\r\n    panel2.add({\r\n        id: 'infoDataService_div',\r\n        tag: 'div',\r\n        html: '请配置数据服务',\r\n        style: 'font-size:14px;font-family:Microsoft YaHei;color:#666666;margin:10px;'\r\n    });\r\n}\r\n\r\n// 重新加载数据服务分类，用于项目配置完成后保存\r\nfunction reloadDataServiceCategory() {\r\n    if(ifDataServiceLoaded) {\r\n        // 清空树原有的默认数据\r\n        hwTreeDataService.deleteChildItems(0);\r\n        getDataServiceCategory();\r\n    }\r\n}\r\n\r\nfunction getDataServiceCategory() {\r\n    if(!ifDataServiceLoaded) {\r\n        return;\r\n    }\r\n    // 进度条\r\n    var myMask = new Ext.LoadMask(Ext.getCmp(\"hwTreeDataService\").el, {\r\n        msg: \"数据加载中,请稍后...\",\r\n        modal: true,\r\n        msgCls: 'z-index:10000;'\r\n    });\r\n    myMask.show();\r\n\r\n    var mytree = hwTreeDataService;\r\n    var firstNode = \"\";\r\n    mytree.deleteChildItems(0);\r\n    mytree.loadJSONObject({\r\n        id: 0,\r\n        text: \"数据服务\",\r\n        item: []\r\n    });\r\n    mytree.itemObj = {};\r\n    mytree.newnode = false;\r\n\r\n    // 获取项目中配置的数据服务\r\n    hwDas.get(\r\n        \"DataServiceWorkSpace/projectInfo/ProjcetServiceCategory\", {}, {\r\n            \"projectid\": btnProjectName.projectId,\r\n            \"type\": 1\r\n        },\r\n        function(resultChecked) {\r\n            // 根据获取的数据赋值基本信息Tab页\r\n            if(null === resultChecked && undefined === resultChecked) {\r\n                showDataServiceHintInfo();\r\n                return;\r\n            }\r\n\r\n            if(null != resultChecked.data && undefined != resultChecked.data) {\r\n                if(resultChecked.data.length > 0) {\r\n                    if(null != resultChecked.data[0].datas && undefined != resultChecked.data[0].datas) {\r\n                        if(resultChecked.data[0].datas.length > 0) {\r\n\r\n                            var urlparam = {\r\n                                host: vmd.workspace.dataServiceIp || vmdSettings.dataServiceIp,\r\n                                url: \"DataService/Service/Project\"\r\n                            }\r\n                            hwDas.get(urlparam, {}, {\r\n                                    develop: \"true\"\r\n                                }, function(result) {\r\n\r\n                                    var bFlag = false;\r\n                                    ////////////////////////////////////////////////\r\n                                    for(var k = 0; k < resultChecked.data[0].datas.length; k++) {\r\n\r\n                                        // 获取分类节点数据后解析形成树形节点；\r\n                                        for(var j = 0; j < result.data.length; j++) {\r\n\r\n                                            for(var i = 0; i < result.data[j].datas.length; i++) {\r\n                                                if(result.data[j].datas[i].id ==\r\n                                                    resultChecked.data[0].datas[k].service_category_id) {\r\n\r\n                                                    bFlag = true;\r\n                                                    mytree.insertNewChild(0, result.data[j].datas[i].id, result.data[j].datas[i].name);\r\n                                                    mytree.setItemImage2(result.data[j].datas[i].id, \"tree/model.png\", \"tree/model.png\", \"tree/model.png\");\r\n                                                    mytree.closeItem(result.data[j].datas[i].id);\r\n                                                    var treenode = mytree.item(result.data[j].datas[i].id);\r\n                                                    if(treenode) {\r\n                                                        treenode.builtin = result.data[j].datas[i].builtin;\r\n                                                        treenode.code = result.data[j].datas[i].code;\r\n                                                        treenode.remark = result.data[j].datas[i].remark;\r\n                                                    }\r\n                                                    var objKey = \"hw\" + result.data[j].datas[i].id;\r\n                                                    mytree.itemObj[objKey] = treenode;\r\n                                                }\r\n\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                    if(bFlag) {\r\n                                        hwTreeDataService.show();\r\n                                    } else {\r\n\r\n                                        hwTreeDataService.hide();\r\n                                    }\r\n                                    // 隐藏进度条\r\n                                    myMask.hide();\r\n                                },\r\n                                function(msg) {\r\n                                    showDataServiceHintInfo();\r\n                                    // 隐藏进度条\r\n                                    myMask.hide();\r\n                                })\r\n\r\n\r\n                            //绑定右键菜单\r\n                            var menu = new dhtmlXMenuObject();\r\n                            menu.renderAsContextMenu();\r\n                            menu.attachEvent(\"onClick\", onMenuDataServiceClick);\r\n                            // menu.attachEvent(\"onClick\", onMenuWorkFlowClick);\r\n                            // menu.addNewChild(menu.topId, 0, \"newDataService\", \"添加\", false);\r\n                            // menu.addNewChild(menu.topId, 1, \"editDataService\", \"编辑\", false);\r\n                            // menu.addNewChild(menu.topId, 2, \"deleteDataService\", \"删除\", false);\r\n                            menu.addNewChild(menu.topId, 3, \"viewDataService\", \"查看\", false);\r\n                            mytree.enableDragAndDrop(\"temporary_disabled\");\r\n                            mytree.enableContextMenu(menu);\r\n\r\n\r\n                            // 右键菜单的显示隐藏\r\n                            mytree.attachEvent(\"onBeforeContextMenu\", function(itemId) {\r\n\r\n                                // menu.showItem('newDataService');\r\n                                // menu.showItem('editDataService');\r\n                                // menu.showItem('deleteDataService');\r\n                                menu.showItem('viewDataService');\r\n                                return true;\r\n                            })\r\n\r\n                            //绑定右键事件 设置右键选中节点\r\n                            mytree.attachEvent('onRightClick', function(id) {\r\n                                mytree.selectItem(id);\r\n                            })\r\n                        } else {\r\n                            showDataServiceHintInfo();\r\n                            // 隐藏进度条\r\n                            myMask.hide();\r\n                        }\r\n\r\n                    } else {\r\n                        showDataServiceHintInfo();\r\n                        // 隐藏进度条\r\n                        myMask.hide();\r\n                    }\r\n                } else {\r\n                    showDataServiceHintInfo();\r\n                    // 隐藏进度条\r\n                    myMask.hide();\r\n                }\r\n            } else {\r\n                showDataServiceHintInfo();\r\n                // 隐藏进度条\r\n                myMask.hide();\r\n            }\r\n        },\r\n        function(msg) {\r\n            showDataServiceHintInfo();\r\n            // 隐藏进度条\r\n            myMask.hide();\r\n        });\r\n}\r\n\r\nfunction showDataServiceHintInfo() {\r\n    hwTreeDataService.hide();\r\n    // panel2.add({\r\n    //     id: 'infoDataService_div',\r\n    //     tag: 'div',\r\n    //     html: '请配置数据服务',\r\n    //     style: 'font-size:14px;font-family:Microsoft YaHei;color:#666666;margin:10px;'\r\n    // });\r\n}\r\n// function hwTreeDataService_afterrender(sender) {\r\n\r\n//     // 进度条\r\n//     var myMask = new Ext.LoadMask(Ext.getCmp(\"hwTreeDataService\").el, {\r\n//         msg: \"数据加载中,请稍后...\",\r\n//         modal: true,\r\n//         msgCls: 'z-index:10000;'\r\n//     });\r\n//     myMask.show();\r\n\r\n//     var mytree = hwTreeDataService;\r\n//     var firstNode = \"\";\r\n//     mytree.deleteChildItems(0);\r\n//     mytree.loadJSONObject({\r\n//         id: 0,\r\n//         text: \"数据服务\",\r\n//         item: []\r\n//     });\r\n//     mytree.itemObj = {};\r\n//     mytree.newnode = false;\r\n\r\n//     // 获取根节点下的文件夹节点信息\r\n\r\n//     hwDas.ajax({\r\n//         das: {\r\n//             idedas: true\r\n//         },\r\n//         url: \"DataService/Service/Project\",\r\n//         type: 'get',\r\n//         timeout: 5000,\r\n//         params: {\r\n//             develop: \"true\"\r\n//         },\r\n//         success: function(result) {\r\n\r\n//             // 获取分类节点数据后解析形成树形节点；\r\n//             for(var j = 0; j < result.data.length; j++) {\r\n\r\n//                 for(var i = 0; i < result.data[j].datas.length; i++) {\r\n\r\n//                     mytree.insertNewChild(0, result.data[j].datas[i].id, result.data[j].datas[i].name);\r\n//                     mytree.setItemImage2(result.data[j].datas[i].id, \"tree/model.png\", \"tree/model.png\", \"tree/model.png\");\r\n//                     mytree.closeItem(result.data[j].datas[i].id);\r\n//                     var treenode = mytree.item(result.data[j].datas[i].id);\r\n//                     if(treenode) {\r\n//                         treenode.builtin = result.data[j].datas[i].builtin;\r\n//                         treenode.code = result.data[j].datas[i].code;\r\n//                         treenode.remark = result.data[j].datas[i].remark;\r\n//                     }\r\n//                     var objKey = \"hw\" + result.data[j].datas[i].id;\r\n//                     mytree.itemObj[objKey] = treenode;\r\n//                 }\r\n//             }\r\n//             // 隐藏进度条\r\n//             myMask.hide();\r\n//         },\r\n//         error: function(msg) {\r\n//             Ext.Msg.alert(\"提示\", \"数据服务信息获取失败！\", function() {})\r\n//         }\r\n//     })\r\n\r\n\r\n//     //绑定右键菜单\r\n//     var menu = new dhtmlXMenuObject();\r\n//     menu.renderAsContextMenu();\r\n//     menu.attachEvent(\"onClick\", onMenuDataServiceClick);\r\n//     // menu.attachEvent(\"onClick\", onMenuWorkFlowClick);\r\n//     menu.addNewChild(menu.topId, 0, \"newDataService\", \"添加\", false);\r\n//     menu.addNewChild(menu.topId, 1, \"editDataService\", \"编辑\", false);\r\n//     menu.addNewChild(menu.topId, 2, \"deleteDataService\", \"删除\", false);\r\n//     menu.addNewChild(menu.topId, 3, \"viewDataService\", \"查看\", false);\r\n//     mytree.enableDragAndDrop(\"temporary_disabled\");\r\n//     mytree.enableContextMenu(menu);\r\n\r\n\r\n//     // 右键菜单的显示隐藏\r\n//     mytree.attachEvent(\"onBeforeContextMenu\", function(itemId) {\r\n\r\n//         menu.showItem('newDataService');\r\n//         menu.showItem('editDataService');\r\n//         menu.showItem('deleteDataService');\r\n//         menu.showItem('viewDataService');\r\n//         return true;\r\n//     })\r\n\r\n//     //绑定右键事件 设置右键选中节点\r\n//     mytree.attachEvent('onRightClick', function(id) {\r\n//         mytree.selectItem(id);\r\n//     })\r\n// }\r\n//右键菜单事件\r\nfunction onMenuDataServiceClick(menuitemId) {\r\n    if(menuitemId == \"newDataService\") { // 添加\r\n        newDataService();\r\n    } else if(menuitemId == \"editDataService\") { // 编辑\r\n        editDataService();\r\n    } else if(menuitemId == \"deleteDataService\") { // 删除\r\n        deleteDataService();\r\n    } else if(menuitemId == \"viewDataService\") { //查看\r\n        viewDataService();\r\n    }\r\n}\r\n//数据服务的空白处右键菜单事件\r\nfunction onMenuDataServicePanelClick(menuitemId) {\r\n    // 在空白处点击鼠标时，就取消原有节点的选中\r\n    hwTreeDataService.clearSelection();\r\n    newDataService();\r\n}\r\n\r\n// 添加数据服务\r\n// function newDataService() {\r\n\r\n//     var addTreeNode = function(code, name, remark) {\r\n//         var mytree = hwTreeDataService;\r\n//         var selId = mytree.getSelectedItemId();\r\n//         var nodeNameSel = mytree.getSelectedItemText();\r\n//         var serviceCode = code;\r\n//         var serviceName = name;\r\n//         var serviceRemark = remark;\r\n\r\n//         var urlparam = {\r\n//             host: vmd.workspace.dataServiceIp || vmdSettings.dataServiceIp,\r\n//             url: \"DataService/Service/Project\"\r\n//         }\r\n//         hwDas.add(\r\n//             urlparam, {}, {}, {\r\n//                 code: serviceCode,\r\n//                 name: serviceName,\r\n//                 remark: serviceRemark\r\n//             },\r\n//             function(result) { // 保存成功\r\n//                 // Tips.tips(\"保存成功！\", \"success\");\r\n\r\n//                 if(result == \"\") {\r\n//                     return;\r\n//                 }\r\n//                 if(!result.data) {\r\n//                     return;\r\n//                 }\r\n\r\n//                 if(result.data.length > 0) {\r\n//                     if(result.data[0].datas) {\r\n//                         var serviceName = result.data[0].datas.name;\r\n//                         var serviceId = result.data[0].datas.id;\r\n\r\n//                         // 获取数据后解析形成树形节点；\r\n//                         mytree.insertNewChild(0, serviceId, serviceName);\r\n//                         mytree.setItemImage2(serviceId, \"tree/model.png\", \"tree/model.png\", \"tree/model.png\");\r\n//                         mytree.closeItem(serviceId);\r\n//                         var treenode = mytree.item(serviceId);\r\n//                         if(treenode) {\r\n//                             treenode.code = result.data[0].datas.code;\r\n//                             treenode.remark = result.data[0].datas.remark;\r\n//                             treenode.builtin = result.data[0].datas.builtin;\r\n//                         }\r\n//                         var objKey = \"hw\" + serviceId;\r\n//                         mytree.itemObj[objKey] = treenode;\r\n//                         mytree.selectItem(serviceId, true, false);\r\n\r\n//                         hwTreeDataService.show();\r\n\r\n//                         connectDataServicProject(serviceId);\r\n\r\n//                         // 显示基本信息页面\r\n//                         var eleIFrame = document.getElementById(\"iframe_page\");\r\n//                         if(eleIFrame) {\r\n//                             eleIFrame.src = vmd.virtualPath + vmdSettings.systemPath+'/hw4acf2f8b/hwcb376d18.html';\r\n//                         }\r\n//                     }\r\n//                 }\r\n//             },\r\n//             function(msg) {\r\n//                 Ext.Msg.alert(\"提示\", \"添加服务失败！\");\r\n//             }\r\n//         );\r\n\r\n\r\n//         // hwDas.ajax({\r\n//         //     das: {\r\n//         //         idedas: true\r\n//         //     },\r\n//         //     url: \"DataService/Service/Project\",\r\n//         //     type: 'post',\r\n//         //     timeout: 5000,\r\n//         //     data: [{ // body传参\r\n//         //         code: serviceCode,\r\n//         //         name: serviceName,\r\n//         //         remark: serviceRemark\r\n//         //     }],\r\n//         //     success: function(result) {\r\n\r\n//         //         if(result == \"\") {\r\n//         //             return;\r\n//         //         }\r\n//         //         if(!result.data) {\r\n//         //             return;\r\n//         //         }\r\n\r\n//         //         if(result.data.length > 0) {\r\n//         //             if(result.data[0].datas) {\r\n//         //                 var serviceName = result.data[0].datas.name;\r\n//         //                 var serviceId = result.data[0].datas.id;\r\n\r\n//         //                 // 获取数据后解析形成树形节点；\r\n//         //                 mytree.insertNewChild(0, serviceId, serviceName);\r\n//         //                 mytree.setItemImage2(serviceId, \"tree/model.png\", \"tree/model.png\", \"tree/model.png\");\r\n//         //                 mytree.closeItem(serviceId);\r\n//         //                 var treenode = mytree.item(serviceId);\r\n//         //                 if(treenode) {\r\n//         //                     treenode.code = result.data[0].datas.code;\r\n//         //                     treenode.remark = result.data[0].datas.remark;\r\n//         //                     treenode.builtin = result.data[0].datas.builtin;\r\n//         //                 }\r\n//         //                 var objKey = \"hw\" + serviceId;\r\n//         //                 mytree.itemObj[objKey] = treenode;\r\n//         //                 mytree.selectItem(serviceId, true, false);\r\n\r\n//         //                 connectDataServicProject(serviceId);\r\n\r\n//         //                 // 显示基本信息页面\r\n//         //                 var eleIFrame = document.getElementById(\"iframe_page\");\r\n//         //                 if(eleIFrame) {\r\n//         //                     eleIFrame.src = vmd.virtualPath + vmdSettings.systemPath+'/hw4acf2f8b/hwcb376d18.html';\r\n//         //                 }\r\n//         //             }\r\n//         //         }\r\n//         //     },\r\n//         //     error: function(msg) {\r\n//         //         Ext.Msg.alert(\"提示\", \"添加服务失败！\")\r\n//         //     }\r\n//         // })\r\n//     }\r\n//     var winForm = new Ext.winDataService(addTreeNode, \"\", \"\", \"\");\r\n//     winForm.show();\r\n// }\r\n\r\n// 新建数据服务分类后，同步关联与项目的关系\r\n// function connectDataServicProject(id) {\r\n//     var objData = {\r\n//         'projectid': btnProjectName.projectId,\r\n//         'servicecategoryid': id,\r\n//         'type': 1\r\n//     };\r\n//     hwDas.add(\r\n//         \"DataServiceWorkSpace/projectInfo/ProjcetServiceCategory\", {}, {}, objData,\r\n//         function(result) {\r\n//             // Tips.tips(\"保存成功！\", \"success\");\r\n//         },\r\n//         function(msg) {\r\n//             // Tips.tips(\"保存失败！\", \"error\");\r\n//         }\r\n//     );\r\n// }\r\n\r\n// 同步删除数据服务与项目的关联关系\r\n// function delDataServiceProject(id) {\r\n\r\n//     hwDas.del(\r\n//         \"DataServiceWorkSpace/projectInfo/ProjcetServiceCategory\", {}, {\r\n//             'projectid': btnWorkSpaceName.workspaceId,\r\n//             'servicecategoryid': id,\r\n//             'type': 1\r\n//         },\r\n//         function(result) {\r\n//             // Tips.tips(\"删除成功！\", \"success\");\r\n//         },\r\n//         function(msg) {\r\n//             // Tips.tips(\"删除失败！\", \"error\");\r\n//         }\r\n//     );\r\n// }\r\n\r\n// 编辑数据服务\r\nfunction editDataService() {\r\n\r\n    var addTreeNode = function(code, name, remark) {\r\n\r\n        var mytree = hwTreeDataService;\r\n        var serviceIdTmp = mytree.getSelectedItemId();\r\n        var serviceCode = code;\r\n        var serviceName = name;\r\n        var serviceRemark = remark;\r\n\r\n        var urlparam = {\r\n            host: vmd.workspace.dataServiceIp || vmdSettings.dataServiceIp,\r\n            url: \"DataService/Service/Project\"\r\n        }\r\n\r\n        // 更改活动工区状态\r\n        hwDas.edit(\r\n            urlparam, {}, {}, [{\r\n                'code': serviceCode,\r\n                'id': serviceIdTmp,\r\n                'name': serviceName,\r\n                'remark': serviceRemark\r\n            }],\r\n            function(result) {\r\n                if(result == \"\") {\r\n                    return;\r\n                }\r\n                if(!result.data) {\r\n                    return;\r\n                }\r\n\r\n                if(result.data.length > 0) {\r\n                    if(result.data[0].datas) {\r\n                        var serviceName = result.data[0].datas.name;\r\n                        var serviceId = result.data[0].datas.id;\r\n\r\n                        mytree.setItemText(serviceId, serviceName, serviceName);\r\n                        var treenode = mytree.item(serviceId);\r\n                        if(treenode) {\r\n                            treenode.code = result.data[0].datas.code;\r\n                            treenode.remark = result.data[0].datas.remark;\r\n                            treenode.builtin = result.data[0].datas.builtin;\r\n                        }\r\n                        var objKey = \"hw\" + serviceId;\r\n                        mytree.itemObj[objKey] = treenode;\r\n                    }\r\n                }\r\n            },\r\n            function(msg) {\r\n                Ext.Msg.alert(\"提示\", \"编辑节点失败！\")\r\n            }\r\n        );\r\n\r\n        // // 模板节点\r\n        // hwDas.ajax({\r\n        //     das: {\r\n        //         idedas: true\r\n        //     },\r\n        //     url: \"DataService/Service/Project\",\r\n        //     // url: \"http://\"+vmdSettings.dataServiceIp+\"/DasService/DataService/DataService/Service/Project\",\r\n        //     type: 'put',\r\n        //     timeout: 5000,\r\n        //     data: [{ // body传参\r\n        //         'code': serviceCode,\r\n        //         'id': serviceIdTmp,\r\n        //         'name': serviceName,\r\n        //         'remark': serviceRemark\r\n        //     }],\r\n        //     success: function(result) {\r\n\r\n        //         if(result == \"\") {\r\n        //             return;\r\n        //         }\r\n        //         if(!result.data) {\r\n        //             return;\r\n        //         }\r\n\r\n        //         if(result.data.length > 0) {\r\n        //             if(result.data[0].datas) {\r\n        //                 var serviceName = result.data[0].datas.name;\r\n        //                 var serviceId = result.data[0].datas.id;\r\n\r\n        //                 mytree.setItemText(serviceId, serviceName, serviceName);\r\n        //                 var treenode = mytree.item(serviceId);\r\n        //                 if(treenode) {\r\n        //                     treenode.code = result.data[0].datas.code;\r\n        //                     treenode.remark = result.data[0].datas.remark;\r\n        //                     treenode.builtin = result.data[0].datas.builtin;\r\n        //                 }\r\n        //                 var objKey = \"hw\" + serviceId;\r\n        //                 mytree.itemObj[objKey] = treenode;\r\n        //             }\r\n        //         }\r\n        //     },\r\n        //     error: function(msg) {\r\n        //         Ext.Msg.alert(\"提示\", \"编辑节点失败！\")\r\n        //     }\r\n        // })\r\n    }\r\n\r\n    var mytreeTmp = hwTreeDataService;\r\n    var nodeId = mytreeTmp.getSelectedItemId();\r\n    var nodeNameTmp = mytreeTmp.getSelectedItemText();\r\n    var objKey = \"hw\" + nodeId;\r\n    var nodeItemObj = mytreeTmp.itemObj[objKey];\r\n\r\n    var winForm = new Ext.winDataService(addTreeNode, nodeItemObj.code, nodeNameTmp, nodeItemObj.remark);\r\n    winForm.show();\r\n}\r\n// 删除数据服务\r\n// function deleteDataService() {\r\n//     var disabledIds=['104FPWq2wr','eQX5RdNjsW','TuKge8jDwF','Tv3hLjddZS'];\r\n//     Ext.Msg.confirm(\"提示!\", \"确定要删除?\", function(btn) {\r\n//         if(btn == \"yes\") {\r\n\r\n//             var mytree = hwTreeDataService;\r\n//             var selId = mytree.getSelectedItemId();\r\n//             var objKey = \"hw\" + selId;\r\n//             var nodeItemObj = mytree.itemObj[objKey];\r\n\r\n//             if(!nodeItemObj) {\r\n//                 return;\r\n//             }\r\n//             //关键服务禁用删除\r\n//             if(disabledIds.indexOf(selId)!=-1) return;\r\n\r\n//             mytree.deleteItem(selId);\r\n//             if(mytree.hasChildren(0)) {\r\n//                 mytree.show();\r\n//             } else {\r\n//                 mytree.hide();\r\n//             }\r\n//             delDataServiceProject(selId);\r\n\r\n//             // 显示默认页面\r\n//             divJcxx.show();\r\n//             ModuleInfo.hide();\r\n//             WorkflowModuleInfo.hide();\r\n//             DataServiceModuleInfo.hide();\r\n//             var eleIFrame = document.getElementById(\"iframe_page\");\r\n//             if(eleIFrame) {\r\n//                 eleIFrame.src = vmd.virtualPath + vmdSettings.systemPath+'/eQ9ULgcVb5/hw03cb4931.html';\r\n//             }\r\n\r\n//             var urlparam = {\r\n//                 host: vmd.workspace.dataServiceIp || vmdSettings.dataServiceIp,\r\n//                 url: \"DataService/Service/Project\"\r\n//             }\r\n//             hwDas.del(\r\n//                 urlparam, {}, {\r\n//                     'id': selId\r\n//                 },\r\n//                 function(result) {\r\n//                     // Tips.tips(\"删除成功！\", \"success\");\r\n//                 },\r\n//                 function(msg) {\r\n//                     Tips.tips(\"删除服务失败！\", \"error\");\r\n//                 }\r\n//             );\r\n\r\n//             // hwDas.ajax({\r\n//             //     das: {\r\n//             //         idedas: true\r\n//             //     },\r\n//             //     url: \"DataService/Service/Project\",\r\n//             //     // url: \"http://\"+vmdSettings.dataServiceIp+\"/DasService/DataService/DataService/Service/Project\",\r\n//             //     type: 'delete',\r\n//             //     timeout: 5000,\r\n//             //     params: {\r\n//             //         'id': selId\r\n//             //     },\r\n//             //     success: function(result) {\r\n//             //         // Ext.Msg.alert(\"提示\", \"删除模板成功！\")\r\n//             //     },\r\n//             //     error: function(msg) {\r\n//             //         Ext.Msg.alert(\"提示\", \"删除服务失败！\")\r\n//             //     }\r\n//             // })\r\n//         } else {\r\n\r\n//         }\r\n//     });\r\n// }\r\n\r\n//查看数据服务\r\nfunction viewDataService() {\r\n\r\n    var mytree = hwTreeDataService;\r\n    var nodeId = mytree.getSelectedItemId();\r\n    var objKey = \"hw\" + nodeId;\r\n    var selnode = mytree.itemObj[objKey];\r\n    if(!selnode) {\r\n        return;\r\n    }\r\n\r\n    divJcxx.show();\r\n    ModuleInfo.hide();\r\n    WorkflowModuleInfo.hide();\r\n    DataServiceModuleInfo.hide();\r\n\r\n    var eleIFrame = document.getElementById(\"iframe_page\");\r\n    var urlService = \"http://\" + (vmd.workspace.dataServiceIp || vmdSettings.dataServiceIp) + \"/DasManage/main/project/manage.html?id=\" + nodeId + \"&builtin=\" + selnode.builtin;\r\n    // if(vmdSettings.dataServiceIp) {\r\n    //     urlService = \"http://\" + vmdSettings.dataServiceIp + \"/DasManage/main/project/manage.html?id=\" + nodeId + \"&builtin=\" + selnode.builtin;\r\n    // }\r\n    if(eleIFrame) {\r\n        var url = urlService;\r\n        eleIFrame.src = url;\r\n        // eleIFrame.src = \"http://\"+vmdSettings.dataServiceIp+\"/DasManage/main/project/manage.html?id=104FPWq2wr&builtin=1\";\r\n    }\r\n}\r\n\r\n// 2017.11.27: 声明全局函数\r\nwindow[\"viewDataService\"] = viewDataService;\r\n\r\n//数据服务录入框\r\nExt.winDataService = Ext.extend(Ext.Window, {\r\n    xtype: \"window\",\r\n    title: \"数据服务\",\r\n    width: 300,\r\n    height: 214,\r\n    layout: \"form\",\r\n    bodyStyle: 'padding:15px',\r\n    labelAlign: \"left\",\r\n    labelWidth: 40,\r\n    modal: true,\r\n    constructor: function(callback, code, name, remark) {\r\n        this.callback = callback;\r\n        this.valueCode = code;\r\n        this.valueName = name;\r\n        this.valueRemark = remark;\r\n        this.callParent();\r\n    },\r\n    initComponent: function() {\r\n        var me = this;\r\n        this.fbar = [{\r\n            text: \"确定\",\r\n            handler: function() {\r\n                me.callback(Ext.getCmp('code').getValue(), Ext.getCmp('name').getValue(), Ext.getCmp('remark').getValue());\r\n                me.close();\r\n            }\r\n        }, {\r\n            text: \"取消\",\r\n            handler: function() {\r\n                me.close();\r\n            }\r\n        }];\r\n\r\n        this.items = [{\r\n            id: 'code',\r\n            xtype: \"textfield\",\r\n            fieldLabel: \"编码\",\r\n            anchor: \"100%\",\r\n            value: this.valueCode\r\n        }, {\r\n            id: 'name',\r\n            xtype: \"textfield\",\r\n            fieldLabel: \"名称\",\r\n            anchor: \"100%\",\r\n            value: this.valueName\r\n        }, {\r\n            id: 'remark',\r\n            xtype: \"textfield\",\r\n            fieldLabel: \"说明\",\r\n            anchor: \"100%\",\r\n            value: this.valueRemark\r\n        }]\r\n        Ext.winDataService.superclass.initComponent.call(this);\r\n    }\r\n})\r\n\r\nfunction hwTreeDataService_nodeClick(sender, id) {\r\n    viewDataService();\r\n    return;\r\n    //win.close()\r\n    divJcxx.show();\r\n    ModuleInfo.hide();\r\n    WorkflowModuleInfo.hide();\r\n    DataServiceModuleInfo.hide();\r\n\r\n    divJcxx.hide();\r\n    DataServiceModuleInfo.show();\r\n    DataServiceModuleInfo.refresh(hwTreeDataService, btnProjectName.projectId, btnWorkSpaceName.workspaceId);\r\n\r\n    // var eleIFrame = document.getElementById(\"iframe_page\");\r\n    // if(eleIFrame) {\r\n    //     eleIFrame.src = vmd.virtualPath + vmdSettings.systemPath+'/hw4acf2f8b/hwcb376d18.html';\r\n    // }\r\n}\r\n\r\nfunction btnXtpz_click(sender) {\r\n\r\n    var updateConfig = function(workflowIp, dataServiceIp) {\r\n\r\n        // 存储信息到系统配置变量中\r\n        vmdSettings.workflowIp = workflowIp;\r\n        vmdSettings.dataServiceIp = dataServiceIp;\r\n        var bodyStr = 'window.vmdSettings={\\n';\r\n        bodyStr += \"workflowIp: \\\"\" + workflowIp + \"\\\",\\n\";\r\n        bodyStr += \"dataServiceIp: \\\"\" + dataServiceIp + \"\\\"\\n\";\r\n        bodyStr += '}';\r\n        saveVmdConfig(\"config.js\", bodyStr, \"vmdstate\");\r\n    }\r\n\r\n    var winForm = new Ext.winVmdConfig(updateConfig, vmdSettings.workflowIp, vmdSettings.dataServiceIp);\r\n    winForm.show();\r\n}\r\n\r\n// 保存配置信息\r\nvar saveVmdConfig = function(filename, bodyStr, taskName) {\r\n\r\n    Ext.Ajax.request({\r\n        url: vmd.vmdUploadPath + 'FileService?FileName=' + filename,\r\n        timeout: 5000,\r\n        success: function(result) {\r\n            var res;\r\n            try {\r\n                res = Ext.util.JSON.decode(result.responseText);\r\n\r\n                var info = Ext.decode(bodyStr);\r\n                var replacestr = res.data;\r\n                var workflowIpStr = 'vmdSettings.workflowIp=\"{ip}\"';\r\n                var dataServiceIpStr = 'vmdSettings.dataServiceIp=\"{ip}\"';\r\n                workflowIpStr = workflowIpStr.format({\r\n                    ip: info.workflowIp\r\n                })\r\n                dataServiceIpStr = dataServiceIpStr.format({\r\n                    ip: info.dataServiceIp\r\n                })\r\n                replacestr = replacestr.replace(/vmdSettings.workflowIp=\"[\\w.:\\d]+\"/g, workflowIpStr);\r\n                replacestr = replacestr.replace(/vmdSettings.dataServiceIp=\"[\\w.:\\d]+\"/g, dataServiceIpStr);\r\n\r\n\r\n                if(res.errMsg) {\r\n                    Ext.Msg.alert('错误', res.errMsg);\r\n                    return\r\n                } else {\r\n                    Ext.Ajax.request({\r\n                        url: vmd.vmdUploadPath + 'FileService',\r\n                        // defaultPostHeader: 'text/plain',\r\n                        timeout: 5000,\r\n                        success: function(result) {\r\n                            Ext.Msg.alert('提示', '保存成功！');\r\n                        },\r\n                        failure: function(result) {\r\n                            //vmdstate = true;\r\n                            tastList[taskName] = true;\r\n                            Ext.Msg.alert('错误', '网络超时，保存失败！')\r\n                            myMask.hide()\r\n                        },\r\n                        headers: {\r\n                            token: '',\r\n                            FileName: filename\r\n                        },\r\n                        params: {\r\n                            body: replacestr\r\n                        }\r\n                    });\r\n                }\r\n            } catch (ex) {\r\n                res = {};\r\n            }\r\n        }\r\n    })\r\n}\r\n\r\n//模板名称录入框\r\nExt.winVmdConfig = Ext.extend(Ext.Window, {\r\n    xtype: \"window\",\r\n    title: \"系统信息配置\",\r\n    width: 300,\r\n    height: 160,\r\n    layout: \"form\",\r\n    bodyStyle: 'padding:10px',\r\n    labelAlign: \"right\",\r\n    labelWidth: 80,\r\n    modal: true,\r\n    constructor: function(callback, workflowIp, dataServiceIp) {\r\n\r\n        this.callback = callback;\r\n        this.workflowIp = workflowIp;\r\n        this.dataServiceIp = dataServiceIp;\r\n        // this.reportIp = reportIp;\r\n        this.callParent();\r\n    },\r\n    initComponent: function() {\r\n        var me = this;\r\n        this.fbar = [{\r\n            text: \"确定\",\r\n            handler: function() {\r\n                me.callback(Ext.getCmp('workflowIp').getValue(), Ext.getCmp('dataServiceIp').getValue());\r\n                me.close();\r\n            }\r\n        }, {\r\n            text: \"取消\",\r\n            handler: function() {\r\n                me.close();\r\n            }\r\n        }];\r\n\r\n        this.items = [{\r\n            id: 'workflowIp',\r\n            xtype: \"textfield\",\r\n            fieldLabel: \"工作流地址\",\r\n            anchor: \"100%\",\r\n            value: this.workflowIp\r\n        }, {\r\n            id: 'dataServiceIp',\r\n            xtype: \"textfield\",\r\n            fieldLabel: \"数据服务地址\",\r\n            anchor: \"100%\",\r\n            value: this.dataServiceIp\r\n        }]\r\n        Ext.winVmdConfig.superclass.initComponent.call(this);\r\n    }\r\n})\r\n\r\n// 退出\r\n\r\nfunction btnZy_click(sender) {\r\n    window.open(vmd.virtualPath + '/modules/hw3ce0447e/hwef4bf837/hw8EUFAFsa.html', \"资源管理\")\r\n}\r\n\r\nfunction btnGrxx_click(sender) {\r\n    // Ext.MessageBox.alert(\"提示\", \"正在开发中...\");\r\n}\r\n\r\nfunction rightMenuClick(id, el, title, fn) {\r\n    var menu = new Ext.menu.Menu({\r\n        id: id,\r\n        items: [{\r\n            text: title,\r\n            handler: function() {\r\n                fn && fn()\r\n            }\r\n        }]\r\n    })\r\n    el.on('contextmenu', function(e) {\r\n        e.stopEvent();\r\n        menu.showAt(e.getXY());\r\n    })\r\n}\r\n// 左侧空白右键菜单\r\nfunction panel_afterrender(sender) {\r\n    var isAdd = false; // 判断是否添加粘贴item\r\n    var menu = new Ext.menu.Menu({\r\n        id: 'p_menu',\r\n        items: [{\r\n            id: 1,\r\n            text: '新建分类',\r\n            handler: function() {\r\n                creatProjectFord()\r\n            }\r\n        }, {\r\n            id: 2,\r\n            text: '新建模块',\r\n            handler: function() {\r\n                // 在空白处点击鼠标时，就取消原有节点的选中\r\n                hwTree.clearSelection();\r\n\r\n                hwTree.newnode = true;\r\n                divJcxx.hide();\r\n                ModuleInfo.show();\r\n                WorkflowModuleInfo.hide();\r\n                DataServiceModuleInfo.hide();\r\n                ModuleInfo.refresh(hwTree, btnProjectName.projectId, btnWorkSpaceName.workspaceId);\r\n                lastnodeType = \"0\";\r\n                // hwTree.newnode = true;\r\n                // document.getElementById(\"iframe_page\").src = vmd.virtualPath + vmdSettings.systemPath+'/hwipUwNjJb/hw4db49729.html';\r\n                bselNodeId = id;\r\n            }\r\n        }, {\r\n            id: 3,\r\n            text: '项目注册',\r\n            handler: function() {\r\n                // 根据项目id获取注册配置信息\r\n                hwDas.get(\"DataServiceWorkSpace/projectInfo/projectreginfo\", {}, {\r\n                    projectid: btnProjectName.projectId\r\n                }, function(result) {\r\n                    // console.log(result)\r\n                    if(result.data && result.data.length > 0 && result.data[0].datas && result.data[0].datas.length > 0) {\r\n                        var porjectRegister = new vmd.window({\r\n                            title: \"项目注册发布\",\r\n                            url: vmd.core.getVirtualPath() + \"modules/eQ9ULgcVb1/eQ9ULgcVb5/hwid1VqqtB.html\",\r\n                            auto: false,\r\n                            height: 600,\r\n                            width: 520,\r\n                            maximizable: false,\r\n                            enableLoading: true,\r\n                            resizable: true,\r\n                            params: {\r\n                                project_id: btnProjectName.projectId,\r\n                                r: new Date().getTime()\r\n                            }\r\n                        })\r\n                        porjectRegister.show();\r\n                        parent.porjectRegister = porjectRegister;\r\n                        parent.projectName = btnProjectName.getText();\r\n                        parent.subsysid = result.data[0].datas[0].subsysid;\r\n                        parent.pttype = result.data[0].datas[0].pttype;\r\n                        parent.ptdb = result.data[0].datas[0].ptdb;\r\n                        parent.virtualPath = result.data[0].datas[0].virtualdir;\r\n                        parent.resourceserver = result.data[0].datas[0].resourceserver;\r\n                    } else {\r\n                        vmd.alert('提示', '请先对该项目进行注册信息配置');\r\n                    }\r\n\r\n                })\r\n            }\r\n        }, {\r\n            id: 4,\r\n            text: '导出模块',\r\n            handler: function() {\r\n                ExpModules(true)\r\n            }\r\n        }, {\r\n            id: 5,\r\n            text: '导出发布模块',\r\n            handler: function() {\r\n               expPublicshModules(true)\r\n            }\r\n        }]\r\n    })\r\n    this.el.on('contextmenu', function(e) {\r\n        e.stopEvent();\r\n        if(hwproject_id.getValue() == '') {\r\n            return;\r\n        }\r\n        if(hwTree.copyNodeId) {\r\n            if(!isAdd) {\r\n                menu.addItem({\r\n                    id: 4,\r\n                    text: '粘贴',\r\n                    handler: function() {\r\n                        nodePaste();\r\n                    }\r\n                });\r\n                isAdd = true;\r\n            }\r\n        } else {\r\n            if(isAdd) {\r\n                menu.remove(4);\r\n                isAdd = false\r\n            }\r\n        }\r\n\r\n        menu.showAt(e.getXY());\r\n    })\r\n}\r\nvar expMask\r\n//导出模块功能 成兵\r\nfunction ExpModules(project_name, project_id,expAll) {\r\n   \r\n    var nodepath;\r\n    if(hwTree.getSelectedItemId() && hwTree.itemObj[hwTree.getSelectedItemId()])\r\n        nodepath = hwTree.itemObj[hwTree.getSelectedItemId()].path; \r\n    if(expAll)nodepath=\"\"\r\n    var expmodulesWin = new vmd.window({\r\n        title: \"模块导出\",\r\n        url: vmd.core.getVirtualPath() + \"modules/eQ9ULgcVb1/eQ9ULgcVb5/hwca60610a.html\",\r\n        auto: false,\r\n        height: 520,\r\n        width: 500,\r\n        maximizable: false,\r\n        enableLoading: true,\r\n        resizable: false,\r\n        params: {\r\n            project_name: project_name || btnProjectName.getText(),\r\n            project_id: project_id || btnProjectName.projectId,\r\n            nodepath: nodepath,\r\n            r: new Date().getTime()\r\n        }\r\n    })\r\n    expmodulesWin.show();\r\n    window.expmodulesWin = expmodulesWin;\r\n}\r\nwindow.ExpModules = ExpModules;\r\n\r\nfunction expPublicshModules(expAll)\r\n{\r\n     var nodepath;\r\n    if(hwTree.getSelectedItemId() && hwTree.itemObj[hwTree.getSelectedItemId()])\r\n        nodepath = hwTree.itemObj[hwTree.getSelectedItemId()].path;\r\n    if(expAll)nodepath=\"\"\r\n    var expPublishmodulesWin = new vmd.window({\r\n        title: \"导出发布模块\",\r\n        url: vmd.core.getVirtualPath() + \"modules/eQ9ULgcVb1/eQ9ULgcVb5/hwPHVNaLbQ.html\",\r\n        auto: false,\r\n        height: 520,\r\n        width: 600,\r\n        maximizable: false,\r\n        enableLoading: true,\r\n        resizable: false,\r\n        params: {\r\n            project_name: btnProjectName.getText(),\r\n            project_id: btnProjectName.projectId,\r\n            nodepath: nodepath,\r\n            r: new Date().getTime()\r\n        }\r\n    })\r\n    \r\n    expPublishmodulesWin.show();\r\n    window.expPublishmodulesWin = expPublishmodulesWin;\r\n}\r\nwindow.expPublicshModules=expPublicshModules;\r\n\r\n//导出模块功能  选择项目 成兵\r\nfunction selectExpProject() {\r\n    var expProSelWin = new vmd.window({\r\n        title: \"导出项目选择\",\r\n        url: vmd.core.getVirtualPath() + \"modules/eQ9ULgcVb1/eQ9ULgcVb5/hwMYLlr4P6.html\",\r\n        auto: false,\r\n        height: 520,\r\n        width: 870,\r\n        maximizable: false,\r\n        enableLoading: true,\r\n        resizable: false,\r\n        params: {\r\n            r: new Date().getTime()\r\n        }\r\n    })\r\n    expProSelWin.show();\r\n    window.expProSelWin = expProSelWin;\r\n}\r\n\r\n\r\nfunction getNodePath(node) {\r\n    var nodepath = \"/\" + node.id\r\n    if(node.parent) {\r\n        return getNodePath(node.parent) + nodepath\r\n    }\r\n\r\n    return nodepath\r\n}\r\n\r\n// 工作流的新建分类\r\nfunction panel7_afterrender(sender) {\r\n    rightMenuClick('p_workflowMenu', this.el, '新建分类', function() {\r\n        onMenuWorkFlowPanelClick('newWorkFlowCategory');\r\n    });\r\n}\r\n\r\nfunction panel8_afterrender(sender) {\r\n    this.el.on('contextmenu', function(e) {\r\n        e.stopEvent();\r\n    })\r\n}\r\n\r\n// 获取模块／分类信息\r\nfunction changeData() {\r\n    var mytree = hwTree;\r\n    var firstNode = \"\";\r\n    mytree.deleteChildItems(0);\r\n    mytree.loadJSONObject({\r\n        id: 0,\r\n        text: \"我的项目\",\r\n        item: []\r\n    });\r\n    mytree.itemObj = {};\r\n    mytree.newnode = false;\r\n    if(hwproject_id.getValue() != '') {\r\n        //进度条\r\n        var myMask = new Ext.LoadMask(Ext.getCmp(\"hwTree\").el, {\r\n            msg: \"数据加载中,请稍后...\",\r\n            msgCls: 'z-index:10000;'\r\n        });\r\n        myMask.show();\r\n        hwDas.ajax({\r\n            das: {\r\n                idedas: true\r\n            },\r\n            url: \"CDEServcie/module/category\",\r\n            type: 'get',\r\n            timeout: 10000,\r\n            params: {\r\n                project_id: hwproject_id.getValue(),\r\n                parent_id: 0\r\n            },\r\n            success: function(result) {\r\n                var datajson = result.data[0].datas;\r\n                var treeDataJson = [];\r\n                for(var i = 0; i < datajson.length; i++) {\r\n                    mytree.insertNewChild(0, datajson[i].id, datajson[i].name);\r\n                    mytree.setItemImage2(datajson[i].id, \"tree/folderClosed.gif\", \"tree/folderOpen.gif\", \"tree/folderClosed.gif\")\r\n                    mytree.insertNewChild(datajson[i].id, datajson[i].id + \"-0\", \"\");\r\n                    mytree.closeItem(datajson[i].id);\r\n                    var treenode = mytree.item(datajson[i].id);\r\n                    treenode.path = \"/\" + hwproject_id.getValue() + \"/\" + datajson[i].id;\r\n                    treenode.projectId = hwproject_id.getValue();\r\n                    if(treenode) {\r\n                        treenode.isFord = true;\r\n                        treenode.loadChild = false;\r\n                        treenode.isProject = false;\r\n                    }\r\n                    mytree.itemObj[datajson[i].id] = treenode;\r\n                }\r\n\r\n                bCategoryFlag = true;\r\n                bInfoFlag = true;\r\n                if(bCategoryFlag && bInfoFlag) {\r\n                    myMask.hide();\r\n                }\r\n                // 项目中的模块添加到搜索列表\r\n                getQueryData()\r\n            },\r\n            error: function(msg) {\r\n                bCategoryFlag = true;\r\n                bInfoFlag = true;\r\n                if(bCategoryFlag && bInfoFlag) {\r\n                    myMask.hide();\r\n                }\r\n                Ext.Msg.alert(\"提示\", \"获取模块信息失败\", function() {})\r\n            }\r\n        })\r\n        hwDas.ajax({\r\n            das: {\r\n                idedas: true\r\n            },\r\n            url: \"CDEServcie/module/info\",\r\n            type: 'get',\r\n            timeout: 10000,\r\n            params: {\r\n                project_id: hwproject_id.getValue(),\r\n                category_id: '0'\r\n            },\r\n            success: function(result) {\r\n                var datajson = result.data[0].datas;\r\n                var treeDataJson = [];\r\n                for(var i = 0; i < datajson.length; i++) {\r\n                    mytree.insertNewChild(0, datajson[i].id, datajson[i].name);\r\n                    mytree.setItemImage2(datajson[i].id, \"tree/model.png\", \"tree/model.png\", \"tree/model.png\")\r\n                    var treenode = mytree.item(datajson[i].id);\r\n                    treenode.path = \"/\" + hwproject_id.getValue() + \"/\" + datajson[i].id;\r\n                    treenode.projectId = hwproject_id.getValue();\r\n                    if(treenode) {\r\n                        treenode.isModel = true;\r\n                        treenode.createuser = datajson[i].row_created_by;\r\n                        treenode.createtime = datajson[i].row_created_date;\r\n                        treenode.changetime = datajson[i].row_changed_date;\r\n                        treenode.changeuser = datajson[i].row_changed_by;\r\n                        treenode.remark = datajson[i].remark;\r\n                        treenode.code = datajson[i].code;\r\n                    }\r\n                    mytree.itemObj[datajson[i].id] = treenode;\r\n                }\r\n                bInfoFlag = true;\r\n                bCategoryFlag = true;\r\n                if(bCategoryFlag && bInfoFlag) {\r\n                    myMask.hide();\r\n                }\r\n            },\r\n            error: function(msg) {\r\n                bInfoFlag = true;\r\n                bCategoryFlag = true;\r\n                if(bCategoryFlag && bInfoFlag) {\r\n                    myMask.hide();\r\n                }\r\n                Ext.Msg.alert(\"提示\", \"获取模块信息失败\")\r\n            }\r\n        })\r\n    }\r\n\r\n    //绑定右键菜单\r\n    var menu = new dhtmlXMenuObject();\r\n    menu.renderAsContextMenu();\r\n    menu.attachEvent(\"onClick\", onMenuClick);\r\n    // menu.addNewChild(menu.topId, 0, \"newPro\", \"新建项目\", false);\r\n    menu.addNewChild(menu.topId, 1, \"newFord\", \"新建分类\", false);\r\n    menu.addNewChild(menu.topId, 2, \"newMode\", \"新建模块\", false);\r\n    menu.addNewChild(menu.topId, 3, \"copy\", \"复制\", false);\r\n    //menu.addNewChild(menu.topId, 4, \"cut\", \"剪切\", false);\r\n    menu.addNewChild(menu.topId, 5, \"paste\", \"粘帖\", false);\r\n    menu.addNewChild(menu.topId, 7, \"reName\", \"重命名\", false);\r\n    menu.addNewChild(menu.topId, 6, \"delete\", \"删除\", false);\r\n    menu.addNewChild(menu.topId, 8, \"expmodules\", \"导出模块\", false);\r\n    menu.addNewChild(menu.topId, 9, \"exppublishmodules\", \"导出发布模块\", false);\r\n    mytree.enableDragAndDrop(\"temporary_disabled\");\r\n\r\n    mytree.enableContextMenu(menu);\r\n\r\n    mytree.attachEvent(\"onBeforeContextMenu\", function(itemId) {\r\n        var mytree = hwTree;\r\n        var selId = mytree.getSelectedItemId();\r\n        var selnode = mytree.itemObj[selId];\r\n\r\n        //需要在项目及分类下显示粘贴\r\n        var showPasteMenu = function(tree, menu) {\r\n            menu.hideItem('copy');\r\n            menu.hideItem('cut');\r\n            if(tree.copyNodeId) {\r\n                menu.showItem('paste');\r\n            } else {\r\n                menu.hideItem('paste');\r\n            }\r\n        }\r\n\r\n        if(selnode.isProject) {\r\n            //项目\r\n            menu.showItem('newPro');\r\n            menu.showItem('newFord');\r\n            menu.showItem('newMode');\r\n            menu.showItem('delete');\r\n            menu.showItem('expmodules');\r\n            menu.showItem('exppublishmodules');\r\n\r\n            showPasteMenu(mytree, menu);\r\n        } else if(selnode.isFord) {\r\n            //分类\r\n            menu.hideItem('newPro');\r\n            menu.showItem('newFord');\r\n            menu.showItem('newMode');\r\n            menu.showItem('reName');\r\n            menu.showItem('delete');\r\n            menu.showItem('expmodules');\r\n            menu.showItem('exppublishmodules');\r\n\r\n            showPasteMenu(mytree, menu);\r\n        } else if(selnode.isModel) {\r\n            //模块\r\n            menu.hideItem('newPro');\r\n            menu.hideItem('newFord');\r\n            menu.hideItem('newMode');\r\n            menu.hideItem('reName');\r\n            menu.showItem('copy');\r\n            menu.showItem('expmodules');\r\n            menu.showItem('exppublishmodules');\r\n\r\n            //menu.showItem('cut');\r\n            menu.hideItem('paste');\r\n            menu.showItem('delete');\r\n        }\r\n        return true\r\n    })\r\n\r\n    //绑定右键事件 设置右键选中节点\r\n    mytree.attachEvent('onRightClick', function(id) {\r\n        //panel下的右键取消\r\n        Ext.getCmp('p_menu') && Ext.getCmp('p_menu').hide();\r\n        mytree.selectItem(id);\r\n        hwTree_nodeClick(mytree, id)\r\n    })\r\n\r\n\r\n}\r\n\r\n// 初始化工区列表菜单\r\nfunction initMenuWorkSpaceList() {\r\n    hwMenuWorkSpaceList.removeAll();\r\n    hwDas.get(\r\n        \"DataServiceWorkSpace/WorkSpaceInfo/WorkSpaceUserQuery\", {}, {\r\n            'loginname': Ext.util.Cookies.get('hwLogin')\r\n        },\r\n        function(result) {\r\n            // 根据获取的数据赋值基本信息Tab页\r\n            if(null == result || undefined == result) {\r\n                return;\r\n            }\r\n            if(null != result.data && undefined != result.data) {\r\n                if(result.data.length > 0) {\r\n                    if(null != result.data[0].datas && undefined != result.data[0].datas) {\r\n                        if(result.data[0].datas.length > 0) {\r\n                            var isActive = false;\r\n                            for(var i = 0; i < result.data[0].datas.length; i++) {\r\n                                if(result.data[0].datas[i].active_ind == 1) {\r\n                                    isActive = true;\r\n                                    hwvarWorkSpaceId.setValue(result.data[0].datas[i].workspace_id);\r\n                                    btnWorkSpaceManagement.workspaceId = result.data[0].datas[i].workspace_id;\r\n                                    btnWorkSpaceName.setText(result.data[0].datas[i].name);\r\n                                    btnWorkSpaceName.workspaceId = result.data[0].datas[i].workspace_id;\r\n                                    getProject(hwvarWorkSpaceId.getValue());\r\n                                    lastWorkId = result.data[0].datas[i].workspace_id;\r\n                                    var itemMenu = new Ext.menu.CheckItem({\r\n                                        id: result.data[0].datas[i].workspace_id,\r\n                                        text: result.data[0].datas[i].name,\r\n                                        iconCls: \"server-list\",\r\n                                        group: 'name',\r\n                                        checked: true\r\n                                    })\r\n                                } else {\r\n                                    var itemMenu = new Ext.menu.CheckItem({\r\n                                        id: result.data[0].datas[i].workspace_id,\r\n                                        text: result.data[0].datas[i].name,\r\n                                        iconCls: \"server-list\",\r\n                                        group: 'name',\r\n                                        checked: false\r\n                                    })\r\n                                }\r\n                                hwMenuWorkSpaceList.addMenuItem(itemMenu);\r\n                            }\r\n                            // 如果没有活动工区，就设置第一个为活动工区\r\n                            if(!isActive) {\r\n                                hwvarWorkSpaceId.setValue(result.data[0].datas[0].workspace_id);\r\n                                btnWorkSpaceManagement.workspaceId = result.data[0].datas[0].workspace_id;\r\n                                btnWorkSpaceName.setText(result.data[0].datas[0].name);\r\n                                btnWorkSpaceName.workspaceId = result.data[0].datas[0].workspace_id;\r\n                                getProject(hwvarWorkSpaceId.getValue());\r\n                            }\r\n                            vmd.core.getWorkSpaceServer(btnWorkSpaceName.workspaceId);\r\n                        } else {\r\n                            newDefaultWorkSpace();\r\n                        }\r\n                    } else {\r\n                        newDefaultWorkSpace();\r\n                    }\r\n                } else {\r\n                    newDefaultWorkSpace();\r\n                }\r\n            } else {\r\n                newDefaultWorkSpace();\r\n            }\r\n        },\r\n        function(msg) {\r\n            Tips.tips(\"查询工区信息失败！\", \"error\");\r\n        });\r\n}\r\n\r\n// 初始化工区列表菜单\r\nfunction newDefaultWorkSpace() {\r\n\r\n    // 当前用户无工区则新建工区\r\n    var newID = vmd.util.guid();\r\n    var workspace_name = '我的工区';\r\n\r\n    vmd.workspace.workflowIp = \"\";\r\n    vmd.workspace.dataServiceIp = \"\";\r\n\r\n    var is_active = 0;\r\n    var dateTime = new Date();\r\n    // var dateTime = new Date().getTime();\r\n    var dateTimeTmp = Ext.Date.dateFormat(new Date(), 'Y-m-d H:i:s')\r\n    // var dateTimeTmp = dateTime.getFullYear() + '-' + (parseFloat(dateTime.getMonth()) + 1) + '-' + dateTime.getDate() +\r\n    //     ' ' + dateTime.getHours() + ':' + dateTime.getMinutes() + ':' + dateTime.getSeconds();\r\n    hwDas.add(\r\n        \"DataServiceWorkSpace/WorkSpaceInfo/WorkSpaceInfo\", {}, {}, [{\r\n            'workspaceid': newID,\r\n            'lastid': \"\",\r\n            'workspacename': workspace_name,\r\n            'isactive': 1,\r\n            'modifydate': dateTimeTmp,\r\n            'createddate': dateTimeTmp,\r\n            'aliasid': vmd.util.guid(),\r\n            'aliaslongname': workspace_name,\r\n            'aliasshortname': workspace_name,\r\n            'remark': workspace_name\r\n        }],\r\n        function(result) {\r\n            vmd.workspace.workspaceid = newID;\r\n            setDefaultWorkSpace(newID);\r\n        },\r\n        function(msg) {\r\n            Tips.tips(\"添加工区信息失败！\", \"error\");\r\n        }\r\n    );\r\n}\r\n\r\nfunction updateMenuWorkSpaceList() {\r\n    hwMenuWorkSpaceList.removeAll();\r\n    hwDas.get(\r\n        \"DataServiceWorkSpace/WorkSpaceInfo/WorkSpaceUserQuery\", {}, {\r\n            'loginname': Ext.util.Cookies.get('hwLogin')\r\n        },\r\n        function(result) {\r\n            // 根据获取的数据赋值基本信息Tab页\r\n            if(null == result || undefined == result) {\r\n                return;\r\n            }\r\n            if(null != result.data && undefined != result.data) {\r\n                if(result.data.length > 0) {\r\n                    if(null != result.data[0].datas && undefined != result.data[0].datas) {\r\n                        if(result.data[0].datas.length > 0) {\r\n                            console.log(result.data[0].datas)\r\n                            var isActive = false;\r\n                            for(var i = 0; i < result.data[0].datas.length; i++) {\r\n                                if(result.data[0].datas[i].active_ind == 1) {\r\n                                    isActive = true;\r\n                                    hwvarWorkSpaceId.setValue(result.data[0].datas[i].workspace_id);\r\n                                    btnWorkSpaceManagement.workspaceId = result.data[0].datas[i].workspace_id;\r\n                                    btnWorkSpaceName.setText(result.data[0].datas[i].name);\r\n                                    btnWorkSpaceName.workspaceId = result.data[0].datas[i].workspace_id;\r\n                                    // getProject(hwvarWorkSpaceId.getValue());\r\n                                    lastWorkId = result.data[0].datas[i].workspace_id;\r\n                                    var itemMenu = new Ext.menu.CheckItem({\r\n                                        id: result.data[0].datas[i].workspace_id,\r\n                                        text: result.data[0].datas[i].name,\r\n                                        iconCls: \"server-list\",\r\n                                        group: 'name',\r\n                                        checked: true\r\n                                    })\r\n                                } else {\r\n                                    var itemMenu = new Ext.menu.CheckItem({\r\n                                        id: result.data[0].datas[i].workspace_id,\r\n                                        text: result.data[0].datas[i].name,\r\n                                        iconCls: \"server-list\",\r\n                                        group: 'name',\r\n                                        checked: false\r\n                                    })\r\n                                }\r\n                                hwMenuWorkSpaceList.addMenuItem(itemMenu);\r\n                            }\r\n                            // 如果没有活动工区，就设置第一个为活动工区\r\n                            if(!isActive) {\r\n                                hwvarWorkSpaceId.setValue(result.data[0].datas[0].workspace_id);\r\n                                btnWorkSpaceManagement.workspaceId = result.data[0].datas[0].workspace_id;\r\n                                btnWorkSpaceName.setText(result.data[0].datas[0].name);\r\n                                btnWorkSpaceName.workspaceId = result.data[0].datas[0].workspace_id;\r\n                                // getProject(hwvarWorkSpaceId.getValue());\r\n                            }\r\n                        }\r\n                    }\r\n                } else {\r\n                    // 当前用户无工区则新建工区\r\n                    var newID = vmd.util.guid();\r\n                    var workspace_name = '我的工区';\r\n\r\n                    vmd.workspace.workflowIp = \"\";\r\n                    vmd.workspace.dataServiceIp = \"\";\r\n\r\n                    var is_active = 0;\r\n                    var dateTime = new Date();\r\n                    // var dateTime = new Date().getTime();\r\n                    var dateTimeTmp = Ext.Date.dateFormat(new Date(), 'Y-m-d H:i:s')\r\n                    // var dateTimeTmp = dateTime.getFullYear() + '-' + (parseFloat(dateTime.getMonth()) + 1) + '-' + dateTime.getDate() +\r\n                    //     ' ' + dateTime.getHours() + ':' + dateTime.getMinutes() + ':' + dateTime.getSeconds();\r\n                    hwDas.add(\r\n                        \"DataServiceWorkSpace/WorkSpaceInfo/WorkSpaceInfo\", {}, {}, [{\r\n                            'workspaceid': newID,\r\n                            'lastid': \"\",\r\n                            'workspacename': workspace_name,\r\n                            'isactive': 1,\r\n                            'modifydate': dateTimeTmp,\r\n                            'createddate': dateTimeTmp,\r\n                            'aliasid': vmd.util.guid(),\r\n                            'aliaslongname': workspace_name,\r\n                            'aliasshortname': workspace_name,\r\n                            'remark': workspace_name\r\n                        }],\r\n                        function(result) {\r\n                            vmd.workspace.workspaceid = newID;\r\n                            setDefaultWorkSpace(newID);\r\n                        },\r\n                        function(msg) {\r\n                            Tips.tips(\"添加工区信息失败！\", \"error\");\r\n                        }\r\n                    );\r\n                }\r\n            }\r\n        },\r\n        function(msg) {\r\n            Tips.tips(\"查询工区信息失败！\", \"error\");\r\n        });\r\n}\r\n\r\nfunction setDefaultWorkSpace(newID) {\r\n    btnWorkSpaceManagement.workspaceId = newID;\r\n    btnWorkSpaceName.setText('我的工区');\r\n    btnWorkSpaceName.workspaceId = newID;\r\n    hwvarWorkSpaceId.setValue(newID);\r\n\r\n\r\n    hwproject_id.setValue('');\r\n    btnProjectName.setText('请添加项目');\r\n    btnProjectName.projectId = '';\r\n    ListBtn.onDisable();\r\n    btnProjectName.onDisable();\r\n    changeData();\r\n    // Ext.Msg.alert(\"提示\", \"获取工区数据失败！\");\r\n}\r\n// 显示当前登陆人工区列表\r\nfunction btnWorkSpaceManagement_click(sender, e) {\r\n    var formWorkSpaceManage = new vmd.window({\r\n        title: \"工区管理\",\r\n        url: vmd.core.getVirtualPath() + \"modules/eQ9ULgcVb1/hwipUwNjJb/hw4361c4dd.html\",\r\n        auto: false,\r\n        height: 520,\r\n        width: 860,\r\n        maximizable: false,\r\n        enableLoading: true,\r\n        resizable: false,\r\n        params: {\r\n            workspaceid: btnWorkSpaceName.workspaceId,\r\n            workflowaddr: vmd.workspace.workflowIp,\r\n            dataserviceaddr: vmd.workspace.dataServiceIp,\r\n            r: new Date().getTime()\r\n        }\r\n    })\r\n\r\n    formWorkSpaceManage.show();\r\n    window.formWorkSpaceManage = formWorkSpaceManage;\r\n    window.initMenuWorkSpaceList = initMenuWorkSpaceList;\r\n    window.updateMenuWorkSpaceList = updateMenuWorkSpaceList;\r\n    window.reloadWorkflowCategory = reloadWorkflowCategory;\r\n    window.reloadDataServiceCategory = reloadDataServiceCategory;\r\n    if(parent) {\r\n        parent.formWorkSpaceManage = formWorkSpaceManage;\r\n        parent.initMenuWorkSpaceList = initMenuWorkSpaceList;\r\n        parent.updateMenuWorkSpaceList = updateMenuWorkSpaceList;\r\n        parent.reloadWorkflowCategory = reloadWorkflowCategory;\r\n        parent.reloadDataServiceCategory = reloadDataServiceCategory;\r\n    }\r\n\r\n}\r\n\r\n// 工区切换\r\nfunction hwMenuWorkSpaceList_click(sender, menuItem, e) {\r\n    var itemId = menuItem.id;\r\n    var itemText = menuItem.text;\r\n    // 更改活动工区状态\r\n    hwDas.edit(\r\n        \"DataServiceWorkSpace/WorkSpaceInfo/changeActive\", {}, {}, [{\r\n            'lastworkid': lastWorkId,\r\n            'workid': itemId\r\n        }],\r\n        function(result) {},\r\n        function(msg) {\r\n            Tips.tips(\"工区状态更改失败！\", \"error\");\r\n        }\r\n    );\r\n    vmd.core.getWorkSpaceServer(itemId);\r\n    hwvarWorkSpaceId.setValue(itemId);\r\n    btnWorkSpaceManagement.workspaceId = itemId;\r\n    btnWorkSpaceName.setText(itemText);\r\n    btnWorkSpaceName.workspaceId = itemId;\r\n    getProject(hwvarWorkSpaceId.getValue());\r\n    lastWorkId = itemId;\r\n}\r\n\r\n// // 获取工区中配置的工作流服务地址\r\n// function getWorkflowAddress(wsId) {\r\n\r\n//     vmd.workspace.workspaceid = wsId;\r\n//     vmd.workspace.workflowIp = \"\";\r\n//     hwDas.get(\r\n//         \"DataServiceWorkSpace/WorkSpaceInfo/ServiceAddress\", {}, {\r\n//             \"workspaceid\": workspaceId,\r\n//             \"servicetype\": 3\r\n//         },\r\n//         function(result) {\r\n//             // 根据获取的数据赋值基本信息Tab页\r\n//             if(null === result && undefined === result) {\r\n//                 return;\r\n//             }\r\n\r\n//             if(null != result.data && undefined != result.data) {\r\n//                 if(result.data.length > 0) {\r\n//                     if(null != result.data[0].datas && undefined != result.data[0].datas) {\r\n//                         if(result.data[0].datas.length > 0) {\r\n//                             vmd.workspace.workflowIp = result.data[0].datas[0].address;\r\n//                         }\r\n//                     }\r\n//                 }\r\n//             }\r\n//         },\r\n//         function(msg) {\r\n//             // Ext.Msg.alert(\"提示\", \"查询工区信息失败！\");\r\n//         });\r\n// }\r\n\r\n// // 获取工区中配置的数据服务地址\r\n// function getDataServiceAddress(wsId) {\r\n\r\n//     vmd.workspace.workspaceid = wsId;\r\n//     vmd.workspace.dataServiceIp = \"\";\r\n//     hwDas.get(\r\n//         \"DataServiceWorkSpace/WorkSpaceInfo/ServiceAddress\", {}, {\r\n//             \"workspaceid\": workspaceId,\r\n//             \"servicetype\": 4\r\n//         },\r\n//         function(result) {\r\n//             // 根据获取的数据赋值基本信息Tab页\r\n//             if(null === result && undefined === result) {\r\n//                 return;\r\n//             }\r\n\r\n//             if(null != result.data && undefined != result.data) {\r\n//                 if(result.data.length > 0) {\r\n//                     if(null != result.data[0].datas && undefined != result.data[0].datas) {\r\n//                         if(result.data[0].datas.length > 0) {\r\n//                             vmd.workspace.dataServiceIp = result.data[0].datas[0].address;\r\n//                         }\r\n//                     }\r\n//                 }\r\n//             }\r\n//             panelTabDataService.ifDataLoaded = true;\r\n//         },\r\n//         function(msg) {\r\n//             // Ext.Msg.alert(\"提示\", \"查询工区信息失败！\");\r\n//         });\r\n// }\r\n\r\n// 工区管理\r\nfunction hwMenuWorkSpace_click(sender, menuItem, e) {\r\n    var itemId = menuItem.id;\r\n    var itemAddProject = itemId.indexOf(\"hwMenuItemAddProject\"); // 基于0开始,找不到返回-1\r\n    var itemConfig = itemId.indexOf(\"hwMenuItemWorkSpaceConfig\"); // 基于0开始,找不到返回-1\r\n    var itemNewProject = itemId.indexOf(\"hwMenuItemNewProject\"); // 基于0开始,找不到返回-1\r\n\r\n    // 基本信息\r\n    if(itemAddProject > -1) {\r\n        onMenuItemAddProject();\r\n    } else if(itemConfig > -1) {\r\n        onMenuItemWorkSpaceConfig();\r\n    } else if(itemNewProject > -1) {\r\n        onMenuItemNewProject();\r\n    }\r\n}\r\n// 添加项目\r\nfunction onMenuItemAddProject() {\r\n    window.getProject = getProject;\r\n    var formAddProject = new parent.vmd.window({\r\n        title: btnWorkSpaceName.text + \" - 项目添加\",\r\n        //url: vmd.core.getVirtualPath() + vmdSettings.systemPath+\"/hwipUwNjJb/hwzIqDcsGS.html\",\r\n        url: vmd.core.getVirtualPath() + \"modules/eQ9ULgcVb1/hwipUwNjJb/hwRSvMOuk9.html?r=\" + Math.random(),\r\n        auto: false,\r\n        height: 505,\r\n        width: 890,\r\n        // height: 506,\r\n        // width: 880,\r\n        maximizable: false,\r\n        enableLoading: true,\r\n        resizable: true,\r\n        params: {\r\n            workspaceid: btnWorkSpaceName.workspaceId,\r\n            r: new Date().getTime()\r\n        }\r\n    })\r\n\r\n    formAddProject.show();\r\n    window.formAddProject = formAddProject;\r\n    window.getProject = getProject;\r\n    if(parent) {\r\n        parent.formAddProject = formAddProject;\r\n        parent.getProject = getProject;\r\n    }\r\n}\r\n\r\n// function addProjectTree() {\r\n//     treeProjects.store.toRefresh(); // 刷新项目树\r\n// }\r\n// 工区配置\r\nfunction onMenuItemWorkSpaceConfig() {\r\n    window.btnWorkSpaceName = btnWorkSpaceName;\r\n    var formWorkSpaceConfig = new vmd.window({\r\n        title: btnWorkSpaceName.getText() + \"参数配置\",\r\n        url: vmd.core.getVirtualPath() + \"modules/eQ9ULgcVb1/hwipUwNjJb/hw56e34140.html\",\r\n        auto: false,\r\n        height: 510,\r\n        width: 626,\r\n        maximizable: false,\r\n        enableLoading: true,\r\n        resizable: false,\r\n        params: {\r\n            workspaceid: btnWorkSpaceName.workspaceId,\r\n            r: new Date().getTime()\r\n        }\r\n    })\r\n    window.formWorkSpaceConfig = formWorkSpaceConfig;\r\n    window.initMenuWorkSpaceList = initMenuWorkSpaceList;\r\n    window.updateMenuWorkSpaceList = updateMenuWorkSpaceList;\r\n    window.reloadWorkflowCategory = reloadWorkflowCategory;\r\n    window.reloadDataServiceCategory = reloadDataServiceCategory;\r\n    if(parent) {\r\n        parent.formWorkSpaceConfig = formWorkSpaceConfig;\r\n        parent.btnWorkSpaceName = btnWorkSpaceName;\r\n        parent.initMenuWorkSpaceList = initMenuWorkSpaceList;\r\n        parent.updateMenuWorkSpaceList = updateMenuWorkSpaceList;\r\n        parent.reloadWorkflowCategory = reloadWorkflowCategory;\r\n        parent.reloadDataServiceCategory = reloadDataServiceCategory;\r\n    }\r\n\r\n    formWorkSpaceConfig.show();\r\n\r\n}\r\n\r\n// 新建项目\r\nfunction onMenuItemNewProject() {\r\n    var formNewProject = new vmd.window({\r\n        title: \"新建项目\",\r\n        url: vmd.core.getVirtualPath() + \"modules/eQ9ULgcVb1/hwipUwNjJb/hwf9cbd384.html\",\r\n        auto: false,\r\n        height: 590,\r\n        width: 878,\r\n        maximizable: false,\r\n        enableLoading: true,\r\n        resizable: false,\r\n        params: {\r\n            workspaceid: btnWorkSpaceName.workspaceId,\r\n            r: new Date().getTime()\r\n        }\r\n    })\r\n\r\n    formNewProject.show();\r\n    window.formNewProject = formNewProject;\r\n    window.getProject = getProject;\r\n    if(parent) {\r\n        parent.formNewProject = formNewProject;\r\n        parent.getProject = getProject;\r\n    }\r\n}\r\n// 项目配置\r\nfunction ListBtn_click(sender, e) {\r\n    hwMenuProjectConfig.showAt(e.xy);\r\n}\r\n\r\nfunction opencProjectConfig() {\r\n    if(btnProjectName.projectId == '') {\r\n        return;\r\n    }\r\n    // var nodeSel = btnProjectName.projectId;\r\n    window.getProject = getProject;\r\n    var formProConfig = new vmd.window({\r\n        title: btnProjectName.getText() + \"配置\",\r\n        url: vmd.core.getVirtualPath() + \"modules/eQ9ULgcVb1/hwipUwNjJb/hw9299ec24.html\",\r\n        auto: false,\r\n        height: 510,\r\n        width: 626,\r\n        maximizable: false,\r\n        enableLoading: true,\r\n        resizable: false,\r\n        params: {\r\n            workId: btnWorkSpaceName.workspaceId,\r\n            id: btnProjectName.projectId,\r\n            r: new Date().getTime()\r\n        }\r\n    })\r\n\r\n    formProConfig.show();\r\n    window.formProConfig = formProConfig;\r\n    window.reloadWorkflowCategory = reloadWorkflowCategory;\r\n    window.reloadDataServiceCategory = reloadDataServiceCategory;\r\n    if(parent) {\r\n        parent.formProConfig = formProConfig;\r\n        parent.btnProjectName = btnProjectName;\r\n        parent.getProject = getProject;\r\n        parent.reloadWorkflowCategory = reloadWorkflowCategory;\r\n        parent.reloadDataServiceCategory = reloadDataServiceCategory;\r\n        // parent.getWorkflowCategory = getWorkflowCategory;\r\n        // parent.getDataServiceCategory = getDataServiceCategory;\r\n    }\r\n    // if(btnProjectName.projectId == '') {\r\n    //     Ext.Msg.alert(\"提示\", \"暂无项目可编辑！\");\r\n    //     return\r\n    // }\r\n    // var btnLeft = sender.el.getRegion().left;\r\n    // var btnTop = sender.el.getRegion().top;\r\n    // var btnHeight = sender.getHeight() / 1.2;\r\n    // hwMenuProject.showAt([btnLeft, btnTop + btnHeight]);\r\n    // // hwMenuProject.showAt(e.xy);\r\n}\r\n// 操作项目\r\nfunction hwMenuProject_click(sender, menuItem, e) {\r\n    var itemId = menuItem.id;\r\n    var itemConfig = itemId.indexOf(\"hwMenuItemProjectConfig\"); // 基于0开始,找不到返回-1\r\n    // var itemCopy = itemId.indexOf(\"hwMenuItemProjectCopy\"); // 基于0开始,找不到返回-1\r\n    var itemDel = itemId.indexOf(\"hwMenuItemProjectDel\"); // 基于0开始,找不到返回-1\r\n    var itemFord = itemId.indexOf(\"ProjectNewFord\");\r\n    var itemMode = itemId.indexOf(\"ProjectNewMode\");\r\n\r\n    // 基本信息\r\n    if(itemConfig > -1) {\r\n        onMenuItemProjectConfig();\r\n    } else if(itemDel > -1) {\r\n        onMenuItemProjectDel();\r\n    } else if(itemFord > -1) {\r\n        creatProjectFord()\r\n    } else if(itemMode > -1) {\r\n        hwTree.newnode = true;\r\n        divJcxx.hide();\r\n        ModuleInfo.show();\r\n        WorkflowModuleInfo.hide();\r\n        DataServiceModuleInfo.hide();\r\n        ModuleInfo.refresh(hwTree, btnProjectName.projectId, btnWorkSpaceName.workspaceId);\r\n\r\n        // hwTree.newnode = true;\r\n        // // document.getElementById(\"iframe_page\").src = vmd.virtualPath + vmdSettings.systemPath+'/eQ9ULgcVb5/hwa99a3307.html';\r\n        // document.getElementById(\"iframe_page\").src = vmd.virtualPath + vmdSettings.systemPath+'/hwipUwNjJb/hwSthqiIpx.html';\r\n    }\r\n}\r\n\r\n// 删除项目\r\nfunction onMenuItemProjectDel() {\r\n\r\n    Ext.Msg.confirm(\"提示\", \"确认要从工区中删除该项目？\", function(type) {\r\n        if(type == \"yes\") {\r\n\r\n            var nodeSel = btnProjectName.projectId;\r\n            if(null == nodeSel || undefined == nodeSel) {\r\n                Ext.Msg.alert(\"提示\", \"请选择要删除的节点！\");\r\n                return;\r\n            }\r\n\r\n            hwDas.del(\r\n                \"DataServiceWorkSpace/WorkSpaceInfo/WorkSpaceProject\", {}, {\r\n                    'workspaceid': btnWorkSpaceName.workspaceId,\r\n                    'projectid': nodeSel\r\n                },\r\n                function(result) {\r\n                    Tips.tips(\"删除成功！\", \"success\");\r\n                    // Ext.Msg.alert(\"提示\", \"删除资源目录成功！\");\r\n                },\r\n                function(msg) {\r\n                    Tips.tips(\"删除失败！\", \"error\");\r\n                    // Ext.Msg.alert(\"提示\", \"删除项目失败！\");\r\n                }\r\n            );\r\n\r\n        }\r\n    });\r\n}\r\n\r\n\r\n// 新建项目分类\r\nfunction creatProjectFord() {\r\n    var addford = function(fordname, callback) {\r\n        var mytree = hwTree;\r\n        var selId = btnProjectName.projectId;\r\n        // var selnode = mytree.itemObj[selId];\r\n        var selnodepath = \"/\" + selId;\r\n        var parentId;\r\n        var projectId;\r\n        var nodename = fordname;\r\n        var newnodeid = newGuid(10);\r\n        var newcode = newGuid(10);\r\n        var xh = 10;\r\n        parentId = \"0\";\r\n        projectId = selId;\r\n        myMask = new Ext.LoadMask(Ext.getBody(), {\r\n            msg: \"加载中,请稍后...\"\r\n        });\r\n        myMask.show();\r\n\r\n        // 判断同一目录下是否存在相同名称分类\r\n        checkfordReName(projectId, parentId, newnodeid, nodename, function() {\r\n            if(callback) {\r\n                callback()\r\n            }\r\n            hwDas.ajax({\r\n                das: {\r\n                    idedas: true\r\n                },\r\n                url: \"CDEServcie/module/category\",\r\n                type: 'post',\r\n                contentType: 'application/json;charset=UTF-8',\r\n                timeout: 5000,\r\n                params: {\r\n                    parent_id: parentId,\r\n                    name: nodename,\r\n                    code: newcode,\r\n                    project_id: projectId,\r\n                    id: newnodeid,\r\n                    xh: xh\r\n                },\r\n                datas: [{\r\n                    parent_id: parentId,\r\n                    name: nodename,\r\n                    code: newcode,\r\n                    project_id: projectId,\r\n                    id: newnodeid,\r\n                    xh: xh\r\n                }],\r\n                success: function(result) {\r\n                    mytree.insertNewChild(0, newnodeid, nodename);\r\n                    mytree.setItemImage2(newnodeid, \"tree/folderClosed.gif\", \"tree/folderOpen.gif\", \"tree/folderClosed.gif\")\r\n                    var treenode = mytree.item(newnodeid);\r\n                    treenode.path = selnodepath + \"/\" + newnodeid;\r\n                    treenode.projectId = projectId;\r\n                    treenode.loadChild = true;\r\n                    if(treenode) {\r\n                        treenode.isFord = true;\r\n                    }\r\n                    mytree.itemObj[newnodeid] = treenode;\r\n                    myMask.hide();\r\n                    getQueryData();\r\n                },\r\n                error: function(msg) {\r\n                    myMask.hide();\r\n                    Ext.Msg.alert(\"提示\", \"新建目录失败\")\r\n                }\r\n            })\r\n        })\r\n    }\r\n\r\n    var fordname = new Ext.MyFordWin(addford, '');\r\n    fordname.show();\r\n}\r\n// 弹出工区列表\r\nfunction btnMenu1_click(sender, e) {\r\n    var btnLeft = sender.el.getRegion().left;\r\n    var btnTop = sender.el.getRegion().top;\r\n    var btnHeight = sender.getHeight() / 1.2;\r\n    hwMenuWorkSpace.showAt([btnLeft, btnTop + btnHeight]);\r\n}\r\n// 获取项目列表\r\nfunction btnWorkSpaceName_click(sender, e) {\r\n    var btnLeft = sender.el.getRegion().left;\r\n    var btnTop = sender.el.getRegion().top;\r\n    var btnHeight = sender.getHeight() / 1.5;\r\n    if(hwMenuWorkSpaceList.items.length > 0) {\r\n        hwMenuWorkSpaceList.showAt([btnLeft, btnTop + btnHeight]);\r\n    }\r\n}\r\n//项目切换\r\nfunction hwMenuProjectList_click(sender, menuItem, e) {\r\n    var itemId = menuItem.id;\r\n    var itemText = menuItem.text;\r\n    hwDas.edit(\r\n        'DataServiceWorkSpace/projectInfo/changeprojectind', {}, {\r\n            'workspece_id': btnWorkSpaceName.workspaceId,\r\n            'project_id': menuItem.id\r\n        }, [{\r\n            'workspece_id': btnWorkSpaceName.workspaceId,\r\n            'project_id': menuItem.id\r\n        }],\r\n        function(result) {},\r\n        function(msg) {}\r\n    );\r\n    hwproject_id.setValue(itemId);\r\n\r\n    btnProjectName.setText(itemText);\r\n    btnProjectName.projectId = itemId;\r\n    //成兵 20180911 设置并获取该项目的环境变量\r\n    vmd.core.getEnvVariables(btnProjectName.projectId)\r\n\r\n    changeData();\r\n\r\n    if(ifWorkflowLoaded) {\r\n        // 清空树原有的默认数据\r\n        hwTreeWorkFlow.deleteChildItems(0);\r\n        getWorkflowCategory();\r\n    }\r\n\r\n    if(ifDataServiceLoaded) {\r\n        // 清空树原有的默认数据\r\n        hwTreeDataService.deleteChildItems(0);\r\n        getDataServiceCategory();\r\n    }\r\n\r\n    divJcxx.show();\r\n    ModuleInfo.hide()\r\n    WorkflowModuleInfo.hide();\r\n    DataServiceModuleInfo.hide();\r\n    // 右侧显示初始页面\r\n    document.getElementById(\"iframe_page\").src = vmd.virtualPath + vmdSettings.systemPath+'/eQ9ULgcVb5/hw03cb4931.html';\r\n    //MyP_jcxx.body.update(\"<\" + \"iframe \" + \" src=vmdSettings.systemPath+'/eQ9ULgcVb5/hw03cb4931.html' \" + \" width=100% height=100% frameborder=0  \" + \">\" + \"sdsds\" + \"<\" + \"/\" + \"iframe\" + \">\");\r\n    // projectId = selnode.projectId;\r\n    lastnodeType = \"1\";\r\n}\r\n// 获取项目列表\r\nfunction getProject(id) {\r\n    hwMenuProjectList.removeAll();\r\n\r\n    hwproject_id.setValue('');\r\n    btnProjectName.setText('');\r\n    btnProjectName.projectId = '';\r\n\r\n    hwDas.get('DataServiceWorkSpace/WorkSpaceInfo/WorkSpaceProject', {}, {\r\n            workspaceid: id\r\n        },\r\n        function(result) {\r\n            if(result.data.length > 0) {\r\n                if(null != result.data[0].datas && undefined != result.data[0].datas) {\r\n                    if(result.data[0].datas.length > 0) {\r\n                        var isActive = false;\r\n                        for(var i = 0; i < result.data[0].datas.length; i++) {\r\n                            if(result.data[0].datas[i].active_ind == 1) {\r\n                                isActive = true;\r\n                                var itemMenu = new Ext.menu.CheckItem({\r\n                                    id: result.data[0].datas[i].project_id,\r\n                                    text: result.data[0].datas[i].project_name,\r\n                                    iconCls: \"server-list\",\r\n                                    group: 'name of group',\r\n                                    checked: true\r\n                                })\r\n                                hwproject_id.setValue(result.data[0].datas[i].project_id);\r\n                                btnProjectName.setText(result.data[0].datas[i].project_name);\r\n                                btnProjectName.projectId = result.data[0].datas[i].project_id;\r\n                                ListBtn.onEnable();\r\n                                btnProjectName.onEnable();\r\n                            } else {\r\n                                var itemMenu = new Ext.menu.CheckItem({\r\n                                    id: result.data[0].datas[i].project_id,\r\n                                    text: result.data[0].datas[i].project_name,\r\n                                    iconCls: \"server-list\",\r\n                                    group: 'name of group',\r\n                                    checked: false\r\n                                })\r\n                            }\r\n                            hwMenuProjectList.addMenuItem(itemMenu);\r\n                        }\r\n                        if(!isActive) {\r\n                            hwproject_id.setValue(result.data[0].datas[0].project_id);\r\n                            btnProjectName.setText(result.data[0].datas[0].project_name);\r\n                            btnProjectName.projectId = result.data[0].datas[0].project_id;\r\n                            ListBtn.onEnable();\r\n                            btnProjectName.onEnable();\r\n                        }\r\n                        changeData();\r\n                        //成兵 20180911 设置并获取该项目的环境变量\r\n                        vmd.core.getEnvVariables(btnProjectName.projectId)\r\n                        // 重新加载工作流和数据服务\r\n                        reloadWorkflowCategory();\r\n                        reloadDataServiceCategory();\r\n                    } else {\r\n                        hwproject_id.setValue('');\r\n                        btnProjectName.setText('请添加项目');\r\n                        btnProjectName.projectId = '';\r\n                        ListBtn.onDisable();\r\n                        btnProjectName.onDisable();\r\n                        changeData();\r\n\r\n                        // 重新加载工作流和数据服务\r\n                        reloadWorkflowCategory();\r\n                        reloadDataServiceCategory();\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        function(msg) {\r\n            Ext.Msg.alert(\"提示\", \"获取项目信息失败\");\r\n        }\r\n    );\r\n    divJcxx.show()\r\n    //divJcxx.update(\"<iframe  id='iframe_page' src='\" + vmd.virtualPath + vmdSettings.systemPath+\"/eQ9ULgcVb5/hw03cb4931.html' width=100% height=100% frameborder=0  ></iframe>\");\r\n\r\n}\r\n// 弹出项目列表\r\nfunction btnProjectName_click(sender, e) {\r\n    if(btnProjectName.projectId == '') {\r\n        return;\r\n    }\r\n    var btnLeft = sender.el.getRegion().left + 5;\r\n    var btnTop = sender.el.getRegion().top;\r\n    var btnHeight = sender.getHeight() / 1.2;\r\n    hwMenuProjectList.showAt([btnLeft, btnTop + btnHeight]);\r\n}\r\n\r\nfunction MyTabs_tabchange(sender, tab) {\r\n    // var tabId = tab.id;\r\n\r\n    // // 基本信息\r\n    // if(tabId == \"panel\") { // 模块\r\n    // } else if(tabId == \"panel1\") { // 工作流\r\n    //     if(!ifWorkflowLoaded) {\r\n    //         getWorkflowCategory();\r\n    //     }\r\n    // } else if(tabId == \"panel2\") { // 数据服务\r\n    //     if(!ifDataServiceLoaded) {\r\n    //         // getDataServiceCategory();\r\n    //         ifDataServiceLoaded = true;\r\n    //     }\r\n    // }\r\n}\r\n\r\n// 判断同一节点下是否存在相同名称的模块\r\nfunction checkModuleReName(projectId, pId, name, callback) {\r\n    var isRep = false;\r\n    hwDas.ajax({\r\n        das: {\r\n            idedas: true\r\n        },\r\n        url: \"CDEServcie/module/info\",\r\n        type: 'get',\r\n        timeout: 5000,\r\n        params: {\r\n            category_id: pId,\r\n            project_id: projectId\r\n        },\r\n        success: function(result) {\r\n            var datajson = result.data[0].datas;\r\n            for(var i = 0; i < datajson.length; i++) {\r\n                if(datajson[i].name == name) {\r\n                    isRep = true;\r\n                    break\r\n                }\r\n            }\r\n            if(isRep) {\r\n                myMask.hide();\r\n                Ext.Msg.alert('提示', '此模版名称已存在');\r\n            } else {\r\n                callback()\r\n            }\r\n        },\r\n        error: function(msg) {\r\n            myMask.hide();\r\n            Ext.Msg.alert(\"提示\", \"获取模块信息失败\")\r\n        }\r\n    })\r\n}\r\n// 判断同一节点下是否存在相同名称的分类\r\nfunction checkfordReName(projectId, pId, id, name, callback) {\r\n    var isRep = false;\r\n    hwDas.ajax({\r\n        das: {\r\n            idedas: true\r\n        },\r\n        url: \"CDEServcie/module/category\",\r\n        type: 'get',\r\n        timeout: 5000,\r\n        params: {\r\n            project_id: projectId,\r\n            parent_id: pId\r\n        },\r\n        success: function(result) {\r\n            var datajson = result.data[0].datas;\r\n            for(var i = 0; i < datajson.length; i++) {\r\n                if(name == datajson[i].name && datajson[i].id != id) {\r\n                    isRep = true;\r\n                    break;\r\n                }\r\n            }\r\n            if(isRep) {\r\n                myMask.hide();\r\n                Ext.Msg.alert('提示', '此分类名称已存在');\r\n            } else {\r\n                callback()\r\n            }\r\n        },\r\n        error: function(msg) {\r\n            myMask.hide();\r\n            Ext.Msg.alert(\"提示\", \"获取分类信息失败\")\r\n        }\r\n    })\r\n}\r\n// 判断同一节点下是否存在相同名称的工作流分类\r\nfunction checkFlowfordReName(nodeParentId, id, name, callback) {\r\n    var isRep = false;\r\n    var info = \"kermit\";\r\n    var urlService = ''\r\n    if(nodeParentId == '0') {\r\n        urlService = \"http://\" + (vmd.workspace.workflowIp || vmdSettings.workflowIp) + \"/activiti-rest/service/repository/categorys/root?info=kermit\"\r\n    } else {\r\n        urlService = \"http://\" + (vmd.workspace.workflowIp || vmdSettings.workflowIp) + \"/activiti-rest/service/repository/categorys/\" + nodeParentId + \"/members?info=\" + info;\r\n    }\r\n    // 获取根节点下的文件夹节点信息\r\n    hwDas.ajax({\r\n        url: urlService,\r\n        type: 'get',\r\n        timeout: 10000,\r\n        params: {},\r\n        success: function(result) {\r\n            for(var i = 0; i < result.data.length; i++) {\r\n                if(result.data[i].name == name && result.data[i].id != id) {\r\n                    isRep = true;\r\n                    break;\r\n                };\r\n            }\r\n            if(isRep) {\r\n                myMask.hide();\r\n                Ext.Msg.alert('提示', '此分类名称已存在');\r\n            } else {\r\n                callback()\r\n            }\r\n        },\r\n        error: function(msg) {\r\n            myMask.hide();\r\n            Ext.Msg.alert(\"提示\", \"获取分类节点信息失败\", function() {})\r\n        }\r\n    })\r\n}\r\n// 判断同一节点下是否存在相同名称的工作流模块\r\nfunction CheckFlowMoudlRename(ParentId, id, name, callback) {\r\n    var isRep = false;\r\n    var info = \"kermit\";\r\n    urlService = \"http://\" + (vmd.workspace.workflowIp || vmdSettings.workflowIp) + \"/activiti-rest/service/repository/hwmodels?categoryId=\" + ParentId + \"&info=\" + info;\r\n    // 获取根节点下的文件夹节点信息\r\n    hwDas.ajax({\r\n        url: urlService,\r\n        type: 'get',\r\n        timeout: 10000,\r\n        params: {},\r\n        success: function(result) {\r\n            for(var j = 0; j < result.data.length; j++) {\r\n                for(var i = 0; i < result.data[j].datas.length; i++) {\r\n                    if(result.data[j].datas[i].NAME == name && result.data[j].datas[i].ID != id) {\r\n                        isRep = true;\r\n                        break\r\n                    }\r\n                }\r\n            }\r\n            if(isRep) {\r\n                myMask.hide();\r\n                Ext.Msg.alert('提示', '此分类名称已存在');\r\n            } else {\r\n                callback()\r\n            }\r\n        },\r\n        error: function(msg) {\r\n            myMask.hide();\r\n            Ext.Msg.alert(\"提示\", \"获取分类节点信息失败\", function() {})\r\n        }\r\n    })\r\n}\r\n\r\n\r\nfunction hwTreeWorkFlow_beforerender(sender) {\r\n    // ifWorkflowLoaded = false;\r\n}\r\n\r\nfunction hwTreeDataService_beforerender(sender) {\r\n    // ifDataServiceLoaded = false;\r\n}\r\n\r\nfunction hwTree_beforerender(sender) {}\r\n\r\nfunction btn_uxcom_click(sender, e) {\r\n    window.open(vmd.virtualPath + vmdSettings.systemPath+'/hw61499a5d/hwvl41einK.html', \"复合组件管理\");\r\n    // window.open(vmd.virtualPath + vmdSettings.systemPath+'/hw61499a5d/hw86c61c8b.html', \"复合组件管理\");\r\n}\r\n\r\nfunction projectInfo_click(sender, e) {\r\n    opencProjectConfig()\r\n}\r\n\r\nfunction btnPro_click(sender, e) {\r\n    hwMenuProMange.showAt(e.xy)\r\n}\r\n\r\nfunction newProject_click(sender, e) {\r\n    onMenuItemNewProject();\r\n}\r\n\r\nfunction RegInfo_click(sender, e) {\r\n    var formRegInfo = new vmd.window({\r\n        title: \"注册信息配置\",\r\n        url: vmd.core.getVirtualPath() + \"modules/eQ9ULgcVb1/eQ9ULgcVb5/hwd3771cbe.html\",\r\n        auto: false,\r\n        height: 650,\r\n        width: 600,\r\n        maximizable: false,\r\n        enableLoading: true,\r\n        resizable: false,\r\n        params: {\r\n            id: btnProjectName.projectId,\r\n            r: new Date().getTime()\r\n        }\r\n    })\r\n    formRegInfo.show();\r\n    window.formRegInfo=formRegInfo;\r\n}\r\n\r\nfunction varsInfo_click(sender, e) {\r\n    var formVarInfo = new vmd.window({\r\n        title: \"环境变量\",\r\n        url: vmd.core.getVirtualPath() + \"modules/eQ9ULgcVb1/eQ9ULgcVb5/hw0141d302.html\",\r\n        auto: false,\r\n        height: 650,\r\n        width: 600,\r\n        maximizable: false,\r\n        enableLoading: true,\r\n        resizable: false,\r\n        params: {\r\n            id: btnProjectName.projectId,\r\n            r: new Date().getTime()\r\n        }\r\n    })\r\n\r\n    formVarInfo.show();\r\n    window.formVarInfo = formVarInfo;\r\n}\r\n\r\n//成兵 20180911 设置并获取该项目的环境变量\r\nfunction reLoadEnvar() {\r\n    vmd.core.getEnvVariables(btnProjectName.projectId)\r\n}\r\nwindow.reLoadEnvar = reLoadEnvar;\r\n\r\n// 模块检索\r\nfunction mCombo_afterrender(sender) {\r\n    store.loadData(selectData);\r\n    mCombo.displayField = 'name';\r\n    mCombo.valueField = 'id';\r\n}\r\n\r\n// 获取项目下所有分类及模块信息\r\nfunction getQueryData() {\r\n    hwDas.get(\"CDEServcie/module/xmmk\", {}, {\r\n            'project_id': hwproject_id.getValue()\r\n        },\r\n        function(result) {\r\n            selectData = result.data[0].datas;\r\n            cateData = result.data[1].datas\r\n            store.loadData(selectData);\r\n            mCombo.bindStore(store)\r\n            mCombo.setValue('');\r\n        },\r\n        function(msg) {}\r\n    );\r\n}\r\n\r\n// 查找被检索界面的所有父级分类，并按顺序放到数组中\r\nfunction queryParen(arr, cId) {\r\n    var pid;\r\n    for(var i = 0; i < cateData.length; i++) {\r\n        if(cateData[i].id == cId) {\r\n            pid = cateData[i].parent_id;\r\n        }\r\n    }\r\n    if(pid != '0') {\r\n        arr.unshift(pid);\r\n        queryParen(arr, pid)\r\n    }\r\n}\r\n// 递归函数从祖父级开始逐层展开节点\r\nfunction diGuiopen(arr, m, seleId) {\r\n    if(m >= arr.length) {\r\n        return\r\n    }\r\n    if(m == arr.length - 1) {\r\n        // var isLoad = hwTree.itemObj[arr[m]].loadChild;\r\n        if(hwTree.itemObj[arr[m]] && hwTree.itemObj[arr[m]].loadChild == true) {\r\n            hwTree.openItem(arr[m])\r\n            hwTree.selectItem(seleId, true, false);\r\n        } else {\r\n            OpenNOde(arr[m], function() {\r\n                hwTree.selectItem(seleId, true, false);\r\n            })\r\n        }\r\n    } else {\r\n        // var isLoad = hwTree.itemObj[arr[m]].loadChild;\r\n        if(hwTree.itemObj[arr[m]] && hwTree.itemObj[arr[m]].loadChild == true) {\r\n            hwTree.openItem(arr[m])\r\n            m++;\r\n            diGuiopen(arr, m, seleId)\r\n        } else {\r\n            OpenNOde(arr[m], function() {\r\n                m++;\r\n                diGuiopen(arr, m, seleId)\r\n            })\r\n        }\r\n    }\r\n}\r\n\r\nfunction mCombo_selectChanged(sender, combo, record, index) {\r\n    var id = record.data.id;\r\n    if(id == '' || id == null) {\r\n        return\r\n    }\r\n    hwTree.closeAllItems()\r\n    var cataId, pidArr = [],\r\n        k = 0;\r\n    for(var i = 0; i < selectData.length; i++) {\r\n        if(selectData[i].id == id) {\r\n            cataId = selectData[i].category_id;\r\n            break\r\n        }\r\n    }\r\n    if(cataId == '0') {\r\n        hwTree.selectItem(combo, true, false);\r\n        return\r\n    }\r\n    pidArr.push(cataId);\r\n    queryParen(pidArr, cataId)\r\n    diGuiopen(pidArr, k, id)\r\n}\r\n\r\nfunction MyP_Htool_afterrender(sender) {\r\n\r\n    MyP_Htool.el.dom.setAttribute(\"data-step\", \"1\");\r\n    MyP_Htool.el.dom.setAttribute(\"data-intro\", \"vmd2.0 功能，支持项目管理、资源管理、复合组件管理等；\");\r\n    MyP_Htool.el.dom.setAttribute(\"data-position\", \"left\");\r\n}\r\n\r\nfunction MyPanel2_afterrender(sender) {\r\n    MyPanel2.el.dom.setAttribute(\"data-step\", \"3\");\r\n    MyPanel2.el.dom.setAttribute(\"data-intro\", \"对应工区下的所有项目列表，并可以对项目进行发布信息、环境变量、数据服务等信息的配置\");\r\n    MyPanel2.el.dom.setAttribute(\"data-position\", \"right\");\r\n}\r\n\r\nfunction panel6_afterrender(sender) {\r\n    panel6.el.dom.setAttribute(\"data-step\", \"2\");\r\n    panel6.el.dom.setAttribute(\"data-intro\", \"支持按工区进行项目管理，可将数据服务、工作流等资源相同的项目进行统一管理；\");\r\n    panel6.el.dom.setAttribute(\"data-position\", \"right\");\r\n}\r\n\r\nfunction panel5_afterrender(sender) {\r\n    panel5.el.dom.setAttribute(\"data-step\", \"5\");\r\n    panel5.el.dom.setAttribute(\"data-intro\", \"模块检索，支持输入关键字对模块进行检索，并进行定位；\");\r\n    panel5.el.dom.setAttribute(\"data-position\", \"right\");\r\n}\r\n\r\nfunction MyP_jcxx_afterrender(sender) {\r\n    MyP_jcxx.el.dom.setAttribute(\"data-step\", \"6\");\r\n    MyP_jcxx.el.dom.setAttribute(\"data-intro\", \"资料及模块基本信息展示区，提供vmd学习使用资料和模块的基本信息；\");\r\n    MyP_jcxx.el.dom.setAttribute(\"data-position\", \"left\");\r\n}\r\n//选择导出项目 成兵\r\nfunction projectExp_click(sender, e) {\r\n    selectExpProject()\r\n}\r\n//导入模块\r\nfunction projectImp_click(sender, e) {\r\n    var uploader = Uploader.getUploader();\r\n    var uploaderwin = new vmd.window({\r\n        items: Uploader,\r\n        auto: false,\r\n        height: 500,\r\n        width: 655,\r\n        maximizable: false,\r\n        resizable: false,\r\n        closeAction: 'hide',\r\n        title: \"文件上传\"\r\n    })\r\n    Uploader.show()\r\n    uploaderwin.show();\r\n    uploaderwin.hide(); //上传接口\r\n    uploader.upload(vmdSettings.dataServiceIp, \"expandimp\\\\expandimp\\\\impmodules\", uploaderwin, function(fileList) {\r\n        //上传成功回调\r\n        var state = true;\r\n        var proName = \"\";\r\n        var proId = \"\";\r\n        var impPath = \"\";\r\n        var impUser = \"\";\r\n        var impDate = \"\";\r\n        //组织导入项目信息\r\n        if(fileList.length > 0) {\r\n            if(fileList[0].state == 'SUCCESS') {\r\n                state = true\r\n                if(fileList[0].title.split(\".\").length == 2 && fileList[0].title.split(\".\")[1] == 'zip') {\r\n                    var zipInfos = fileList[0].title.split(\"-\");\r\n                    impPath = \"expandimp\\\\impmodules\\\\\" + fileList[0].title;\r\n                    if(zipInfos.length == 3) {\r\n                        proName = zipInfos[0];\r\n                        proId = zipInfos[1];\r\n                    } else {\r\n                        Ext.Msg.alert(\"提示\", \"导入的文件名不规范，请严格按照 项目名-项目id-导出用户-日期.zip 的格式\")\r\n                        return;\r\n                    }\r\n                } else {\r\n                    Ext.Msg.alert(\"提示\", '导入标准的zip模块导出文件')\r\n                    return;\r\n                }\r\n            } else\r\n                return;\r\n        }\r\n        var impMask = new Ext.LoadMask(document.body, {\r\n            msg: \"正在检测比对,请稍后...\",\r\n            msgCls: 'z-index:10000;'\r\n        });\r\n        impMask.show();\r\n        //判断项目是否存在\r\n        hwDas.get(\"DataServiceWorkSpace/projectInfo/ProjectBaseInfo\", {}, {\r\n            projectid: proId\r\n        }, function(result) {\r\n            if(result)\r\n                var datas = result.data[0].datas;\r\n            var creatPro = false;\r\n            var importSer = function() {\r\n                //调用服务，解压文件，并在服务器端比对数据并返回。\r\n                vmd.ajax({\r\n                    url: \"/expandimp/api/ModuleCheck\",\r\n                    type: 'post',\r\n                    timeout: 5000,\r\n                    //dataType:\"text\",\r\n                    //contentType: 'application/json;charset=UTF-8',\r\n                    data: {\r\n                        proName: proName,\r\n                        proId: proId,\r\n                        impUser: impUser,\r\n                        impDate: impDate,\r\n                        impPath: impPath,\r\n                        creatPro: creatPro\r\n                    },\r\n                    success: function(result) {\r\n\r\n                        impMask.hide();\r\n                        if(result.type == \"success\") {\r\n                            //返回模块信息比对信息\r\n                            window.modulesCheckInfos = {\r\n                                checkInfo: result.checkInfo || [],\r\n                                project_id: proId,\r\n                                proName: proName,\r\n                                path: impPath,\r\n                                impUser: impUser,\r\n                                impDate: impUser,\r\n                                creatPro: creatPro\r\n                            }\r\n                            var modulesCheckWin = new vmd.window({\r\n                                title: \"导入模块对比\",\r\n                                url: vmd.core.getVirtualPath() + \"modules/eQ9ULgcVb1/eQ9ULgcVb5/hwHHPbTeiO.html\",\r\n                                auto: false,\r\n                                height: 600,\r\n                                width: 520,\r\n                                maximizable: false,\r\n                                enableLoading: true,\r\n                                resizable: true,\r\n                                params: {\r\n                                    r: new Date().getTime()\r\n                                }\r\n                            })\r\n                            uploaderwin.hide();\r\n                            modulesCheckWin.show()\r\n                            window.modulesCheckWin = modulesCheckWin\r\n                        } else\r\n                            Ext.Msg.alert(\"提示\", result.msg)\r\n                    },\r\n                    error: function(msg) {\r\n                        impMask.hide();\r\n                    }\r\n                })\r\n            }\r\n            if(datas.length <= 0) {\r\n                Ext.Msg.confirm(\"提示\", \"该环境下无\" + proName + \"项目，是否新建项目并导入。\", function(type) {\r\n                    if(type == \"yes\") {\r\n                        creatPro = true\r\n                        importSer();\r\n                    }\r\n                })\r\n            } else {\r\n                importSer()\r\n            }\r\n        }, function(msg) {})\r\n    }, \"vmd\");\r\n}\r\n\r\n//设置导航提示\r\nfunction div3_click(sender, e) {\r\n    hwMenuHelp.showAt(e.xy);\r\n}\r\n\r\nfunction about_click(sender, e) {\r\n    var aboutWin = new vmd.window({\r\n        title: \"关于\",\r\n        url: vmd.core.getVirtualPath() + \"modules/eQ9ULgcVb1/eQ9ULgcVb5/hwf799effb.html\",\r\n        auto: false,\r\n        height: 240,\r\n        width: 380,\r\n        maximizable: false,\r\n        enableLoading: true,\r\n        resizable: true\r\n    })\r\n    aboutWin.show();\r\n}\r\n\r\nfunction guide_click(sender,e){\r\n    introJs().setOptions({\r\n        nextLabel: '下一步 &rarr;',\r\n        prevLabel: '&larr; 上一步',\r\n        skipLabel: '退出',\r\n        doneLabel: '结束'\r\n    }).start();\r\n    LocalData.set('vmdinittips', true)\r\n}","vmdcss":"/*.list-list{*/\r\n/*    margin-left: 25px;*/\r\n/*    background-image: url(\"/modules/hw3ce0447e/img/list-list.png\");*/\r\n/*    background-repeat: no-repeat;*/\r\n/*    background-position: center center;*/\r\n/*    border-radius: 0px;*/\r\n/*}*/\r\n.div-hove:hover{\r\n    background-color: rgba(255,255,255,0.3);\r\n}\r\n.div-hove{\r\n    cursor: pointer\r\n}\r\n.x-combo-list-item{\r\n    margin: 5px 0\r\n}","vmdprops":"\"\"","type":"module","vmdresource":"{\"components\":[{\"cid\":\"vmdrescsss\",\"layoutConfig\":{},\"userConfig\":{}},{\"cid\":\"vmdresjss\",\"layoutConfig\":{},\"userConfig\":{}},{\"cid\":\"vmdresimgs\",\"layoutConfig\":{},\"userConfig\":{}}]}"}