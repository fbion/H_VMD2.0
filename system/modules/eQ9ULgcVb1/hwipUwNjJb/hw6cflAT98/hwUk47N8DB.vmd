{"vmdversion":"2.0.3.0701","vmdlayout":"{\"components\":[{\"cid\":\"viewport\",\"id\":\"MyViewport\",\"layoutConfig\":{},\"userConfig\":{\"layout\":\"absolute\",\"afterrender\":\"MyViewport_afterrender\",\"beforerender\":\"MyViewport_beforerender\"},\"cn\":[{\"cid\":\"vmd.ux.TabWorkSpaceInfo\",\"id\":\"TabWorkSpaceInfo\",\"layoutConfig\":{},\"userConfig\":{\"x\":220,\"y\":0,\"comboListStore\":\"store\",\"width\":620,\"height\":420,\"afterrender\":\"TabWorkSpaceInfo_afterrender\",\"beforerender\":\"TabWorkSpaceInfo_beforerender\"}},{\"cid\":\"vmdButton\",\"id\":\"btnSave\",\"layoutConfig\":{},\"userConfig\":{\"x\":680,\"y\":430,\"id\":\"btnSave\",\"text\":\"保存\",\"width\":70,\"style\":\"background-color: rgb(64, 158, 255);    color: rgb(255, 255, 255);    font-size: 14px;\",\"click\":\"btnSave_click\"}},{\"cid\":\"vmdButton\",\"id\":\"btnClose\",\"layoutConfig\":{},\"userConfig\":{\"x\":760,\"y\":430,\"text\":\"关闭\",\"id\":\"btnClose\",\"width\":70,\"style\":\"background-color: rgb(201, 201, 201);    color: rgb(0, 0, 0);    font-size: 14px;\",\"click\":\"btnClose_click\"}},{\"cid\":\"vmd.ux.WorkSpaceList\",\"id\":\"WorkSpaceList\",\"layoutConfig\":{},\"userConfig\":{\"x\":0,\"y\":0,\"width\":220,\"height\":420,\"store\":\"storeWorkSpaceList\",\"onItemClick\":\"WorkSpaceList_onItemClick\",\"onAddItem\":\"WorkSpaceList_onAddItem\",\"onDelItem\":\"WorkSpaceList_onDelItem\"}}]},{\"cid\":\"vmddataset\",\"id\":\"数据集\",\"layoutConfig\":{},\"userConfig\":{},\"cn\":[{\"cid\":\"vmdJsonStore\",\"id\":\"storeResourceImage\",\"layoutConfig\":{},\"userConfig\":{\"cid\":\"vmdJsonStore\",\"id\":\"storeResourceImage\",\"storeConfig\":\"{\\\"id\\\":\\\"TxgUO9ajRM\\\",\\\"callcode\\\":\\\"vmdCode\\\",\\\"url\\\":\\\"DataServiceWorkSpace/WorkSpaceInfo/ServiceAddress\\\",\\\"host\\\":\\\"\\\",\\\"isHwRest\\\":true,\\\"name\\\":\\\"服务地址\\\",\\\"getMethods\\\":[{\\\"id\\\":\\\"workspaceid\\\",\\\"value1\\\":\\\"\\\",\\\"value2\\\":\\\"\\\"},{\\\"id\\\":\\\"servicetype\\\",\\\"value1\\\":\\\"\\\",\\\"value2\\\":\\\"\\\"}],\\\"postMethods\\\":[],\\\"putMethods\\\":[],\\\"deleteMethods\\\":[],\\\"saveMethods\\\":[],\\\"fields\\\":[{\\\"name\\\":\\\"id\\\",\\\"type\\\":\\\"string\\\"},{\\\"name\\\":\\\"name\\\",\\\"type\\\":\\\"string\\\"},{\\\"name\\\":\\\"address\\\",\\\"type\\\":\\\"string\\\"},{\\\"name\\\":\\\"remark\\\",\\\"type\\\":\\\"string\\\"}]}\"},\"cn\":[{\"cid\":\"datafield\",\"layoutConfig\":{},\"userConfig\":{\"cid\":\"datafield\",\"name\":\"id\"},\"name\":\"id\"},{\"cid\":\"datafield\",\"layoutConfig\":{},\"userConfig\":{\"cid\":\"datafield\",\"name\":\"name\"},\"name\":\"name\"},{\"cid\":\"datafield\",\"layoutConfig\":{},\"userConfig\":{\"cid\":\"datafield\",\"name\":\"address\"},\"name\":\"address\"},{\"cid\":\"datafield\",\"layoutConfig\":{},\"userConfig\":{\"cid\":\"datafield\",\"name\":\"remark\"},\"name\":\"remark\"}]},{\"cid\":\"vmdJsonStore\",\"id\":\"storeWorkflowList\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"storeWorkflowList\",\"storeConfig\":\"{\\\"id\\\":\\\"TDblz0Ejpz\\\",\\\"callcode\\\":\\\"vmdCode\\\",\\\"url\\\":\\\"DataServiceWorkSpace/WorkSpaceInfo/ServiceAddressAll\\\",\\\"host\\\":\\\"\\\",\\\"isHwRest\\\":true,\\\"name\\\":\\\"所有服务地址\\\",\\\"getMethods\\\":[{\\\"id\\\":\\\"type\\\",\\\"value1\\\":\\\"return 3;\\\",\\\"value2\\\":\\\"\\\"}],\\\"postMethods\\\":[],\\\"putMethods\\\":[],\\\"deleteMethods\\\":[],\\\"saveMethods\\\":[],\\\"fields\\\":[{\\\"name\\\":\\\"id\\\",\\\"type\\\":\\\"string\\\"},{\\\"name\\\":\\\"name\\\",\\\"type\\\":\\\"string\\\"},{\\\"name\\\":\\\"address\\\",\\\"type\\\":\\\"string\\\"},{\\\"name\\\":\\\"remark\\\",\\\"type\\\":\\\"string\\\"}]}\"},\"cn\":[{\"cid\":\"datafield\",\"layoutConfig\":{},\"userConfig\":{\"cid\":\"datafield\",\"name\":\"id\"},\"name\":\"id\"},{\"cid\":\"datafield\",\"layoutConfig\":{},\"userConfig\":{\"cid\":\"datafield\",\"name\":\"name\"},\"name\":\"name\"},{\"cid\":\"datafield\",\"layoutConfig\":{},\"userConfig\":{\"cid\":\"datafield\",\"name\":\"address\"},\"name\":\"address\"},{\"cid\":\"datafield\",\"layoutConfig\":{},\"userConfig\":{\"cid\":\"datafield\",\"name\":\"remark\"},\"name\":\"remark\"}]},{\"cid\":\"vmdJsonStore\",\"id\":\"storeDataService\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"storeDataService\",\"storeConfig\":\"{\\\"id\\\":\\\"TDblz0Ejpz\\\",\\\"callcode\\\":\\\"vmdCode\\\",\\\"url\\\":\\\"DataServiceWorkSpace/WorkSpaceInfo/ServiceAddressAll\\\",\\\"host\\\":\\\"\\\",\\\"isHwRest\\\":true,\\\"name\\\":\\\"所有服务地址\\\",\\\"getMethods\\\":[{\\\"id\\\":\\\"type\\\",\\\"value1\\\":\\\"return 4;\\\",\\\"value2\\\":\\\"\\\"}],\\\"postMethods\\\":[],\\\"putMethods\\\":[],\\\"deleteMethods\\\":[],\\\"saveMethods\\\":[],\\\"fields\\\":[{\\\"name\\\":\\\"id\\\",\\\"type\\\":\\\"string\\\"},{\\\"name\\\":\\\"name\\\",\\\"type\\\":\\\"string\\\"},{\\\"name\\\":\\\"address\\\",\\\"type\\\":\\\"string\\\"},{\\\"name\\\":\\\"remark\\\",\\\"type\\\":\\\"string\\\"}]}\"},\"cn\":[{\"cid\":\"datafield\",\"layoutConfig\":{},\"userConfig\":{\"cid\":\"datafield\",\"name\":\"id\"},\"name\":\"id\"},{\"cid\":\"datafield\",\"layoutConfig\":{},\"userConfig\":{\"cid\":\"datafield\",\"name\":\"name\"},\"name\":\"name\"},{\"cid\":\"datafield\",\"layoutConfig\":{},\"userConfig\":{\"cid\":\"datafield\",\"name\":\"address\"},\"name\":\"address\"},{\"cid\":\"datafield\",\"layoutConfig\":{},\"userConfig\":{\"cid\":\"datafield\",\"name\":\"remark\"},\"name\":\"remark\"}]},{\"cid\":\"vmdJsonStore\",\"id\":\"storeWorkSpaceList\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"storeWorkSpaceList\",\"storeConfig\":\"{\\\"id\\\":\\\"TxfVyP1knW\\\",\\\"callcode\\\":\\\"vmdCode\\\",\\\"url\\\":\\\"DataServiceWorkSpace/WorkSpaceInfo/WorkSpaceUserQuery\\\",\\\"host\\\":\\\"\\\",\\\"isHwRest\\\":true,\\\"name\\\":\\\"用户关联工区查询\\\",\\\"getMethods\\\":[{\\\"id\\\":\\\"login\\\",\\\"value1\\\":\\\"\\\",\\\"value2\\\":\\\"\\\"}],\\\"postMethods\\\":[],\\\"putMethods\\\":[],\\\"deleteMethods\\\":[],\\\"saveMethods\\\":[],\\\"fields\\\":[{\\\"name\\\":\\\"workspace_id\\\",\\\"type\\\":\\\"string\\\"},{\\\"name\\\":\\\"name\\\",\\\"type\\\":\\\"string\\\"},{\\\"name\\\":\\\"active_ind\\\",\\\"type\\\":\\\"string\\\"}]}\",\"load\":\"storeWorkSpaceList_load\"},\"cn\":[{\"cid\":\"datafield\",\"layoutConfig\":{},\"userConfig\":{\"cid\":\"datafield\",\"name\":\"workspace_id\"},\"name\":\"workspace_id\"},{\"cid\":\"datafield\",\"layoutConfig\":{},\"userConfig\":{\"cid\":\"datafield\",\"name\":\"name\"},\"name\":\"name\"},{\"cid\":\"datafield\",\"layoutConfig\":{},\"userConfig\":{\"cid\":\"datafield\",\"name\":\"active_ind\"},\"name\":\"active_ind\"}]}]},{\"cid\":\"vmdvariable\",\"id\":\"变量\",\"layoutConfig\":{},\"userConfig\":{},\"cn\":[{\"cid\":\"vmdVariable\",\"id\":\"hwvarServiceType\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"hwvarServiceType\"}},{\"cid\":\"vmdVariable\",\"id\":\"hwvarWorkSpaceId\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"hwvarWorkSpaceId\"}}]}]}","vmdevents":"var workspaceId = \"\";\nvar lastWorkid = '';\nvar workspaceIdCur = \"\";\nvar curWorkflowAddr = \"\";\nvar curDataServiceAddr = \"\";\nvar ifUpdateHomePage = false;\nvar ifClosed = false;\n// var workspaceId = \"657e35d9-494a-456d-8f80-98b4924133d7\";\n// var hwvarWorkSpaceName = \"我的工区\";\nvar workspaceSelData;\nvar login = Ext.util.Cookies.get('userName');\n\nfunction btnSave_click(sender, e) {\n    debugger;\n    TabWorkSpaceInfo.iSaveData(lastWorkid, function(id) {\n        storeWorkSpaceList.toRefresh();\n        parent.initMenuWorkSpaceList();\n        lastWorkid = id;\n        // parent.formWorkSpaceManage.close();\n    });\n    // TabWorkSpaceInfo.isSaveFlow(\n    //     function() {\n    //         parent.reloadWorkflowCategory();\n    //     }\n    // );\n    // TabWorkSpaceInfo.isSaveService(\n    //     function() {\n    //         debugger\n    //         parent.reloadDataServiceCategory();\n    //     }\n    // );\n}\n\nfunction btnClose_click(sender, e) {\n    // 因为会走两遍，所有增加限制\n    if(!ifClosed) {\n        ifClosed = true;\n        if(ifUpdateHomePage) {\n            parent.initMenuWorkSpaceList();\n        } else {\n            parent.updateMenuWorkSpaceList();\n        }\n    }\n    parent.formWorkSpaceManage.close();\n    // parent.updateMenuWorkSpaceList();\n    // parent.formWorkSpaceManage.close();\n}\n\nfunction MyViewport_afterrender(sender) {\n    workspaceId = getUrlParam('workspaceid');\n    lastWorkid = getUrlParam('lastWorkid');\n    ifUpdateHomePage = false;\n    ifClosed = false;\n\n    // 处理窗体右上角的叉号关闭按钮\n    parent.formWorkSpaceManage.on('hide', function() {\n        btnClose_click();\n    })\n}\n\nfunction hwDataView_click(sender, index, node, e) {\n    // index;\n    // sender.\n}\n\n// function btnAdd_click(sender, e) {\n//     TabWorkSpaceInfo.iNewWorkSpace();\n// }\n\n// function btnDel_click(sender, e) {\n\n// }\n\nfunction TabWorkSpaceInfo_afterrender(sender) {\n\n    TabWorkSpaceInfo.comlistWorkflowAddress.regex = /[\\w\\-]+(\\.[\\w\\-]+)+([\\w\\-\\.,@?^=%&:\\/~\\+#]*[\\w\\-\\@?^=%&\\/~\\+#])?:([0-9]|[1-9]\\d{1,3}|[1-5]\\d{4}|6[0-5]{2}[0-3][0-5])$/;\n    TabWorkSpaceInfo.comlistWorkflowAddress.regexText = '输入标准的服务器地址!';\n    TabWorkSpaceInfo.comlistWorkflowAddress.valueField = 'id';\n    TabWorkSpaceInfo.comlistWorkflowAddress.displayField = 'address';\n    TabWorkSpaceInfo.comlistWorkflowAddress.dropDownFields = 'address';\n    TabWorkSpaceInfo.comlistWorkflowAddress.queryField = 'id';\n    TabWorkSpaceInfo.comlistWorkflowAddress.store = storeWorkflowList;\n\n    TabWorkSpaceInfo.comlistDataServiceAddress.regex = /[\\w\\-]+(\\.[\\w\\-]+)+([\\w\\-\\.,@?^=%&:\\/~\\+#]*[\\w\\-\\@?^=%&\\/~\\+#])?:([0-9]|[1-9]\\d{1,3}|[1-5]\\d{4}|6[0-5]{2}[0-3][0-5])$/;\n    TabWorkSpaceInfo.comlistDataServiceAddress.regexText = '输入标准的服务器地址!';\n    TabWorkSpaceInfo.comlistDataServiceAddress.valueField = 'id';\n    TabWorkSpaceInfo.comlistDataServiceAddress.displayField = 'address';\n    TabWorkSpaceInfo.comlistDataServiceAddress.dropDownFields = 'address';\n    TabWorkSpaceInfo.comlistDataServiceAddress.queryField = 'id';\n    TabWorkSpaceInfo.comlistDataServiceAddress.store = storeDataService;\n\n    TabWorkSpaceInfo.iSetWorkSpaceId(workspaceId);\n}\n\nfunction WorkSpaceList_onItemClick(sender, index, node, e) {\n    workspaceSelData = WorkSpaceList.getSelData();\n    if(workspaceId != workspaceSelData.workspace_id) {\n        workspaceId = workspaceSelData.workspace_id;\n        TabWorkSpaceInfo.iSetIfDataLoaded(false);\n        TabWorkSpaceInfo.iChangeWorkSpace(workspaceId);\n        // TabWorkSpaceInfo.iQueryWorkSpaceInfo(workspaceId);\n    }\n}\n\nfunction WorkSpaceList_onAddItem(sender) {\n\n    workspaceId = vmd.util.guid();\n    TabWorkSpaceInfo.iNewWorkSpace(workspaceId);\n}\n\nfunction WorkSpaceList_onDelItem(sender) {\n\n    // 删除工区信息，调用删除工区的服务\n    // 清空工区Tab页的信息或者设置上一个选中；\n    // var selData = WorkSpaceList.getSelData();\n\n    Ext.Msg.confirm(\"提示\", \"确认要删除工区？\", function(type) {\n        if(type == \"yes\") {\n            workspaceId = workspaceSelData.workspace_id;\n            // 获取当前选中的索引值\n            // 将获取的索引值减1，获取其ID\n            // 设置减1后的项为当前选中项\n            var nextSelId = WorkSpaceList.iGetSelIdAfterDel();\n            TabWorkSpaceInfo.iSetIfDataLoaded(true);\n            hwDas.del(\n                \"DataServiceWorkSpace/WorkSpaceInfo/WorkSpaceInfo\", {}, {\n                    'workspaceid': workspaceId\n                },\n                function(result) {\n                    // // 更改活动工区状态\n                    // hwDas.edit(\n                    //     \"DataServiceWorkSpace/WorkSpaceInfo/changeActive\", {}, {}, [{\n                    //         'lastworkid': lastWorkid,\n                    //         'workid': nextSelId\n                    //     }],\n                    //     function(result) {\n                    //         // parent.initMenuWorkSpaceList();\n                    //         lastWorkid = nextSelId\n                    //     },\n                    //     function(msg) {\n                    //         Tips.tips(\"工区状态更改失败！\", \"error\");\n                    //     }\n                    // );\n                    // 如果删除的是主页面中显示的工区，就需要更新主页面的工区及项目信息；\n                    if(workspaceIdCur == workspaceId) {\n                        ifUpdateHomePage = true;\n                    }\n                    workspaceId = nextSelId;\n                    // 绑定的数据集刷新\n                    storeWorkSpaceList.toRefresh();\n                    Tips.tips(\"删除成功！\", \"success\");\n                },\n                function(msg) {\n                    Tips.tips(\"删除失败！\", \"error\");\n                }\n            );\n        }\n    });\n}\n\nfunction TabWorkSpaceInfo_beforerender(sender) {\n\n    TabWorkSpaceInfo.iSetIfDataLoaded(false);\n}\n\nfunction storeWorkSpaceList_load(sender, records, options) {\n    // 绑定数据加载完成后，设置选中项\n    // workspaceId = getUrlParam('workspaceid');\n    // 设置工区列表中的选中项\n    WorkSpaceList.iSelectItemById(workspaceId);\n    workspaceSelData = WorkSpaceList.getSelData();\n    TabWorkSpaceInfo.iSetIfDataLoaded(false);\n    TabWorkSpaceInfo.iQueryWorkSpaceInfo(workspaceId);\n}\n\nfunction MyViewport_beforerender(sender) {\n\n    workspaceId = getUrlParam('workspaceid');\n    workspaceIdCur = workspaceId;\n\n    curWorkflowAddr = getUrlParam('workflowaddr');\n    curDataServiceAddr = getUrlParam('dataserviceaddr');\n    \n    hwvarWorkSpaceId.setValue(workspaceId);\n}","vmdcss":"","vmdprops":"\"\"","type":"module","vmdresource":"{\"components\":[{\"cid\":\"vmdrescsss\",\"layoutConfig\":{},\"userConfig\":{}},{\"cid\":\"vmdresjss\",\"layoutConfig\":{},\"userConfig\":{}},{\"cid\":\"vmdresimgs\",\"layoutConfig\":{},\"userConfig\":{}}]}"}