<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

    <title>工区管理主界面</title>
	<!--基本样式-->
    <link href="/css/common.css" rel="stylesheet" />
    <!--加载dhx组件-->
    <link href="/lib/ext-3.4/resources/css/ext-all.css" rel="stylesheet" />
   
    <link href="/design/css/icons.css" rel="stylesheet" />

	<link href="/lib/dhtmlx/dhtmlx.css" rel="stylesheet" />
	  <!--样式快捷索引表-->
    <link href="/css/shortcut.css" rel="stylesheet" />
    <script src="/lib/labjs/LAB.min.js"></script>
    <script src="/config.js"></script>
    <script src="/lib/ext-3.4/adapter/ext/ext-base-debug.js"></script>
    <script src="/lib/ext-3.4/adapter/ext/ext-base-lang.js"></script>
    <script src="/lib/ext-3.4/adapter/ext/ext-base-class.js"></script>
    <script src="/lib/ext-3.4/ext-all-debug.js"></script>
    <script src="/lib/ext-3.4/src/locale/ext-lang-zh_CN.js"></script>
    <script src="/js/util.js"></script>
    <script src="/lib/dhtmlx/dhtmlx.js"></script>
	<script src="/report/dhtmlx/dhtmlxCommon/codebase/dhtmlxcommon.js"></script>
	 <script src="/report/dhtmlx/dhtmlxCommon/codebase/dhtmlxcore.js"></script>
   <script src="/report/dhtmlx/dhtmlxCommon/codebase/dhtmlxcontainer.js"></script>
	 <script src="/report/FillReport2.0/js/dhtmlx/dhtmlXFileUploader.js"></script>
    <script src="/js/hwdas.js"></script>
    <script src="/js/vmdcore.js"></script>
    <script src="/js/vmdcomps.js"></script>
    <script src="/js/publicMethods.js"></script>
     <script src="/js/vmdreport.js"></script>
	 
    <script src="/lib/ace/ace.js"></script>
    <script src="/lib/ace/mode-base.js" type="text/javascript"></script>
    <script src="/lib/ace/theme-xcode.js" type="text/javascript" ></script>
    <script src="/lib/ace/ext-language_tools.js"></script>


    <style>

    </style>
    <style type="text/css" id="vmdcss">
        
    </style>
    <script>
		vmd.virtualPath=''
        Ext.define("vmd.module.MyViewport" ,{
	extend:"vmd.comp.viewport",
	requires:vmd.getCmpDeps(["vmd.ux.TabWorkSpaceInfo$1.0$TabWorkSpaceInfo"]),
	xtype:"vmd.module.MyViewport",
	layout:"absolute",
	afterrender:"MyViewport_afterrender",
	initComponent: function(){
		var hwvarWorkSpaceId = "657e35d9-494a-456d-8f80-98b4924133d7";
var hwvarWorkSpaceName = "我的工区";
function btnSave_click(sender, e) {
    TabWorkSpaceInfo.iSaveData();
}

function btnClose_click(sender, e) {
    parent.WorkSpaceProject.setWorkSpaceInfo(hwvarWorkSpaceId, hwvarWorkSpaceName);
    parent.formWorkSpaceManage.close();
}

function MyViewport_afterrender(sender) {
    ;
    // TabWorkSpaceInfo.iSetDataStore(storeResourceImage);
    // TabWorkSpaceInfo.iSetApplyType(0);
}

function hwDataView_click(sender, index, node, e) {
    // index;
    // sender.
}

function btnAdd_click(sender, e) {
    TabWorkSpaceInfo.iNewWorkSpace();
}

function btnDel_click(sender, e) {

    // 删除工区信息，调用删除工区的服务
    // 清空工区Tab页的信息或者设置上一个选中；

    var nodeSel = treeProjects.getSelNode();
    if(null == nodeSel || undefined == nodeSel) {
        return;
    }
    
    hwDas.del(
        "DataServiceWorkSpace/WorkSpaceInfo/WorkSpaceInfo", {}, {
            'workspaceid': workSpaceId
        },
        function(result) {
                    Tips.tips("删除成功！", "success");
            // Ext.Msg.alert("提示", "删除资源目录成功！");
        },
        function(msg) {
                    Tips.tips("删除失败！", "error");
            // Ext.Msg.alert("提示", "删除项目失败！");
        }
    );
    
    // 绑定的数据集刷新
    storeWorkSpaceList.toRefresh();
}

function TabWorkSpaceInfo_afterrender(sender){

    TabWorkSpaceInfo.iSetWorkSpaceId(hwvarWorkSpaceId);
}
			storeResourceImage=new vmd.store.jsonStore({"xtype":"vmd.jsonStore","id":"storeResourceImage","autoLoad":true,"cid":"vmdJsonStore","storeConfig":"{\"id\":\"TxgUO9ajRM\",\"callcode\":\"vmdCode\",\"url\":\"DataServiceWorkSpace/WorkSpaceInfo/ServiceAddress\",\"host\":\"\",\"isHwRest\":true,\"name\":\"服务地址\",\"getMethods\":[{\"id\":\"workspaceid\",\"value1\":\"\",\"value2\":\"\"},{\"id\":\"servicetype\",\"value1\":\"\",\"value2\":\"\"}],\"postMethods\":[],\"putMethods\":[],\"deleteMethods\":[],\"saveMethods\":[],\"fields\":[{\"name\":\"id\",\"type\":\"string\"},{\"name\":\"name\",\"type\":\"string\"},{\"name\":\"address\",\"type\":\"string\"},{\"name\":\"remark\",\"type\":\"string\"}]}"});
		storeWorkflowList=new vmd.store.jsonStore({"xtype":"vmd.jsonStore","id":"storeWorkflowList","autoLoad":true,"storeConfig":"{\"id\":\"TxfvAbuBSl\",\"callcode\":\"vmdCode\",\"url\":\"DataServiceWorkSpace/WorkSpaceInfo/WorkSpaceInfo\",\"host\":\"\",\"isHwRest\":true,\"name\":\"工区信息\",\"getMethods\":[{\"id\":\"workspaceid\",\"value1\":\"\",\"value2\":\"\"}],\"postMethods\":[],\"putMethods\":[],\"deleteMethods\":[],\"saveMethods\":[],\"fields\":[{\"name\":\"workspace_id\",\"type\":\"string\"},{\"name\":\"name\",\"type\":\"string\"},{\"name\":\"active_ind\",\"type\":\"string\"},{\"name\":\"row_changed_date\",\"type\":\"datetime\"},{\"name\":\"row_created_date\",\"type\":\"datetime\"},{\"name\":\"remark\",\"type\":\"string\"}]}"});
		storeDataService=new vmd.store.jsonStore({"xtype":"vmd.jsonStore","id":"storeDataService","autoLoad":true,"storeConfig":"{\"id\":\"TxgUO9ajRM\",\"callcode\":\"vmdCode\",\"url\":\"DataServiceWorkSpace/WorkSpaceInfo/ServiceAddress\",\"host\":\"\",\"isHwRest\":true,\"name\":\"服务地址\",\"getMethods\":[{\"id\":\"workspaceid\",\"value1\":\"\",\"value2\":\"\"},{\"id\":\"servicetype\",\"value1\":\"return hwvarServiceType;\",\"value2\":\"\"}],\"postMethods\":[],\"putMethods\":[],\"deleteMethods\":[],\"saveMethods\":[],\"fields\":[{\"name\":\"id\",\"type\":\"string\"},{\"name\":\"name\",\"type\":\"string\"},{\"name\":\"address\",\"type\":\"string\"},{\"name\":\"remark\",\"type\":\"string\"}]}"});
		storeWorkSpaceList=new vmd.store.jsonStore({"xtype":"vmd.jsonStore","id":"storeWorkSpaceList","autoLoad":true,"storeConfig":"{\"id\":\"TA0O6NvbQm\",\"callcode\":\"vmdCode\",\"url\":\"DataServiceWorkSpace/WorkSpaceInfo/WorkSpaceAll\",\"host\":\"\",\"isHwRest\":true,\"name\":\"所有工区\",\"getMethods\":[],\"postMethods\":[],\"putMethods\":[],\"deleteMethods\":[],\"saveMethods\":[],\"fields\":[{\"name\":\"workspace_id\",\"type\":\"string\"},{\"name\":\"name\",\"type\":\"string\"},{\"name\":\"active_ind\",\"type\":\"string\"},{\"name\":\"row_changed_date\",\"type\":\"datetime\"},{\"name\":\"row_created_date\",\"type\":\"datetime\"},{\"name\":\"remark\",\"type\":\"string\"}]}"});

		hwvarServiceType=new vmd.var.variable({});
		hwvarWorkSpaceId=new vmd.var.variable({});


		this.items=[
			{
				xtype:"vmd.ux.TabWorkSpaceInfo",
				id:"TabWorkSpaceInfo",
				x:220,
				y:0,
				comboListStore:"store",
				width:620,
				height:420,
				afterrender:"TabWorkSpaceInfo_afterrender"
			},
			{
				xtype:"vmd.button",
				id:"btnSave",
				text:"保存",
				type:"(none)",
				size:"small",
				x:680,
				y:430,
				width:70,
				style:"background-color: rgb(64, 158, 255);    color: rgb(255, 255, 255);    font-size: 14px;",
				click:"btnSave_click",
				listeners:{
					click:btnSave_click
				}
			},
			{
				xtype:"vmd.button",
				id:"btnClose",
				text:"关闭",
				type:"(none)",
				size:"small",
				x:760,
				y:430,
				width:70,
				style:"background-color: rgb(201, 201, 201);    color: rgb(0, 0, 0);    font-size: 14px;",
				click:"btnClose_click",
				listeners:{
					click:btnClose_click
				}
			},
			{
				xtype:"panel",
				id:"panel1",
				title:"Panel",
				header:false,
				border:true,
				height:420,
				width:220,
				style:"border: 1px solid RGB(223, 223, 223);",
				items:[
					{
						xtype:"panel",
						id:"panel",
						title:"Panel",
						header:false,
						border:true,
						height:31,
						x:-1,
						y:0,
						width:220,
						layout:"absolute",
						style:"border: 1px solid RGB(223, 223, 223);",
						items:[
							{
								xtype:"vmd.button",
								id:"btnAdd",
								text:"添加",
								type:"text",
								size:"small",
								x:0,
								y:0,
								width:50,
								style:"font-size: 13px;",
								click:"btnAdd_click",
								icon:"plus",
								listeners:{
									click:btnAdd_click
								}
							},
							{
								xtype:"vmd.button",
								id:"btnDel",
								text:"删除",
								type:"text",
								size:"small",
								x:50,
								y:0,
								width:50,
								style:"font-size: 13px;",
								click:"btnDel_click",
								icon:"delete",
								listeners:{
									click:btnDel_click
								}
							}
						]
					},
					{
						xtype:"panel",
						id:"panel2",
						title:"Panel",
						header:false,
						border:true,
						height:393,
						items:[
							{
								xtype:"vmd.dataview",
								id:"hwDataView",
								width:220,
								height:391,
								itemSelector:"li.info",
								overClass:"info-hover",
								selectedClass:"x-view-selected",
								singleSelect:true,
								multiSelect:true,
								autoScroll:true,
								tpl:"<ul>    <tpl for=\".\">        <li class='info serverlist-info'> {name} </li>    </tpl></ul>",
								data:"var data = [{    \"workspace_id\": \"0000000001\",    \"name\": \"我的工区\",    \"remark\": \"test\"}, {    \"workspace_id\": \"0000000002\",    \"name\": \"我的工区1\",    \"remark\": \"test\"}];return data;",
								x:0,
								y:30,
								click:"hwDataView_click",
								style:"font-size: 14px;",
								store:storeWorkSpaceList,
								listeners:{
									click:hwDataView_click
								}
							}
						]
					}
				]
			}
		]
		this.callParent();
		var me = this;vmd.core.moduleInit(this.items, this);
			me.on('afterrender',function(){ MyViewport_afterrender.call(me,me)})
		TabWorkSpaceInfo.on('vmdafterrender',function(){ TabWorkSpaceInfo_afterrender.call(TabWorkSpaceInfo,TabWorkSpaceInfo)})
}
})
        Ext.onReady(function () {
            Ext.create('vmd.module.MyViewport', {
                renderTo: document.body
            })


        })

      </script>
</head>
<body>
</body>
</html>
