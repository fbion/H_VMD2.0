{"vmdversion":"vmd2.0.5.200306","vmdlayout":"{\"components\":[{\"cid\":\"viewport\",\"id\":\"MyViewport\",\"layoutConfig\":{},\"userConfig\":{\"layout\":\"border\",\"afterrender\":\"MyViewport_afterrender\"},\"cn\":[{\"cid\":\"container\",\"id\":\"div\",\"layoutConfig\":{},\"userConfig\":{\"x\":240,\"y\":110,\"width\":\"\",\"height\":40,\"style\":\"padding: 5px\",\"layout\":\"auto\",\"region\":\"north\"},\"cn\":[{\"cid\":\"vmdButton\",\"id\":\"button\",\"layoutConfig\":{},\"userConfig\":{\"icon\":\"icon-save font\",\"text\":\"保存\",\"click\":\"button_click\",\"type\":\"primary\",\"disabled\":false}},{\"cid\":\"label\",\"id\":\"label\",\"layoutConfig\":{},\"userConfig\":{\"text\":\"（温馨提示：编辑后请点击保存）\",\"style\":\"padding-left: 10px;    font-family: Microsoft YaHei;    font-size: 14px;    color: #f7ba2a;    color: #ff4949;\"}}]},{\"cid\":\"container\",\"id\":\"div1\",\"layoutConfig\":{},\"userConfig\":{\"x\":260,\"y\":230,\"width\":\"\",\"anchor\":\"100% -40\",\"layout\":\"fit\",\"region\":\"center\"},\"cn\":[{\"cid\":\"vmdAceEditor\",\"id\":\"MyAce\",\"layoutConfig\":{},\"userConfig\":{}}]}]},{\"cid\":\"vmddataset\",\"id\":\"数据\",\"layoutConfig\":{},\"userConfig\":{}},{\"cid\":\"vmdvariable\",\"id\":\"变量\",\"layoutConfig\":{},\"userConfig\":{}},{\"cid\":\"vmdsubviewport\",\"id\":\"SubView_Window\",\"layoutConfig\":{},\"userConfig\":{}}]}","vmdevents":"var path = getUrlParam('path');\nvar readonly = getUrlParam('readonly');\nvar editServer\nif(parent.hwdasFileServer)\n    editServer = parent.hwdasFileServer;\n\nfunction MyViewport_afterrender(sender) {\n    if(readonly) {\n        div.hide();\n        this.doLayout();\n    }\n    if(!path) {\n        Tips.tips('路径不能为空！', 'warning')\n        return;\n    }\n    var filename = path.substring(path.lastIndexOf('/') + 1)\n    var filenameArr = filename.split('.');\n    var ext = filenameArr[filenameArr.length - 1];\n    var isloadjs = false;\n    switch (ext) {\n        case 'js':\n            ext = 'javascript';\n            break;\n        case 'html':\n        case 'htm':\n            ext = 'html';\n            break;\n        case 'json':\n            ext = 'json';\n            break;\n        case 'xml':\n            ext = 'xml';\n            break;\n        case 'md':\n            ext = 'markdown';\n            break;\n        case 'css':\n            ext = 'css';\n            break;\n        default:\n            ext = 'text';\n            break;\n    }\n    //读取文件\n    hwDas.read(editServer, path, function(result) {\n        MyAce.language=ext;\n        MyAce.getSession().setMode(\"ace/mode/\" + ext);\n        MyAce.setValue(result.data);\n    }, function(err) {\n        Tips.tips(err, 'error')\n    })\n}\n\nfunction button_click(sender, e) {\n    var context = MyAce.getValue();\n    if(!path) {\n        Tips.tips('路径不能为空！', 'warning')\n        return;\n    }\n    hwDas.write(editServer, path, context, function(result) {\n        Tips.tips(\"保存文件成功\")\n        if(parent && parent.saveAceFileEditinfo) {\n            parent.saveAceFileEditinfo();\n        }\n        \n         var s = new vmd.proxy.Log();\n                    s.save(\"编辑文件\", \"ziyuan\", Ext.util.Cookies.get('userName') + \"在\" + Ext.Date.dateFormat(new Date(), 'Y-m-d H:i:s') + \"修改了\" + path + \"的文件内容\", \"资源\", function() {\n                        // alert(\"保存成功了！\")\n                    }, function() {\n                        console.log(\"日志报存失败了！\");\n                    })\n    }, function(err) {\n        Tips.tips(err, 'error')\n    })\n}","vmdcss":"","vmdprops":"\"\"","type":"module","vmdcmpdeps":[],"vmdresource":"{\"components\":[{\"cid\":\"vmdrescsss\",\"layoutConfig\":{},\"userConfig\":{}},{\"cid\":\"vmdresjss\",\"layoutConfig\":{},\"userConfig\":{},\"cn\":[{\"cid\":\"resjs\",\"id\":\"project.config.js\",\"layoutConfig\":{},\"userConfig\":{}}]},{\"cid\":\"vmdresimgs\",\"layoutConfig\":{},\"userConfig\":{}}]}"}