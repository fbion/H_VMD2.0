{"vmdversion":"2.0.3.1108","vmdlayout":"{\"components\":[{\"cid\":\"viewport\",\"id\":\"MainViewport\",\"layoutConfig\":{},\"userConfig\":{\"layout\":\"absolute\",\"afterrender\":\"MyViewport_afterrender\",\"autoScroll\":true,\"id\":\"MainViewport\"}},{\"cid\":\"vmddataset\",\"id\":\"数据集\",\"layoutConfig\":{},\"userConfig\":{}},{\"cid\":\"vmdvariable\",\"id\":\"变量\",\"layoutConfig\":{},\"userConfig\":{}},{\"cid\":\"vmdsubviewport\",\"id\":\"SubView_Window\",\"layoutConfig\":{},\"userConfig\":{}}]}","vmdevents":"var Login = (function() {\n    var isRememberPwd = function() {\n\n        return Cookie.get('rememberpwd');\n    };\n    var modifyRememberState = function(state) {\n        //取消记住密码\n        if(!state) {\n\n            rememberpwd.el.setStyle('background-position-x', '0px');\n\n        } else {\n            //记住状态\n            rememberpwd.el.setStyle('background-position-x', '-27px');\n        }\n\n    }\n    var delPwd = function() {\n\n        Cookie.del('rememberpwd');\n\n    };\n    var remembePwd = function() {\n\n        Cookie.set('rememberpwd', true, 30);\n\n\n    };\n    var rememberState = function() {\n        //默认记住密码\n        username.focus();\n        if(isRememberPwd()) {\n            modifyRememberState(true)\n            //rememberpwd.el.setStyle('background-position-x', '-27px');\n            var login = Cookie.get('hwLogin');\n            var pwd = Cookie.get('_userpwd');\n            username.setValue(login);\n            userpwd.setValue(pwd);\n        }\n\n\n    }\n\n    var setCookie = function(info) {\n        info = info || {};\n\n        hwDas.token = info.token;\n        if(Login.state) {\n            remembePwd();\n            Cookie.set('hwLogin', info.user.login, 30);\n            Cookie.set('_userpwd', userpwd.getValue(), 30);\n        } else {\n            delPwd();\n            Cookie.set('hwLogin', info.user.login);\n            Cookie.del('_userpwd')\n        }\n        Cookie.set('userName', info.user.name);\n        Cookie.set('hwToken', info.token);\n        Cookie.set('hwEcyLogin', info.user.ecyLogin || \"\");\n        //记录 登录用户是否拥有编辑主页面的权限\n        Cookie.set('userType', \"vmdDesigner\");\n\n    }\n\n    return {\n        state: isRememberPwd(),\n        isRememberPwd: isRememberPwd,\n        setCookie: setCookie,\n        rememberState: rememberState,\n        modifyRememberState:modifyRememberState\n\n    }\n\n\n})();\n\nfunction button_click(sender, e) {\n\n    if(!username.getValue()) {\n        // Ext.Msg.alert('提示', '用户名不能为空！', function() {\n        //     username.focus();\n        // })\n        username.focus();\n        vmd.tip('用户名不能为空！', 'info')\n\n        return\n    }\n    if(!userpwd.getValue()) {\n        // Ext.Msg.alert('提示', '密码不能为空！', function() {\n        //     userpwd.focus();\n        // })\n        userpwd.focus();\n        vmd.tip('密码不能为空！', 'info')\n        return\n    }\n    //加载服务\n\n    var myMask = new Ext.LoadMask(Ext.getBody(), {\n        msg: \"正在登录,请稍后...\",\n        msgCls: 'z-index:10000;'\n    });\n    myMask.show();\n    // hwDas.login(username.getValue(), userpwd.getValue(), successback, errorback, \"unity\");\n    /////////////////////////////////////////////////////////////\n    hwDas.login(\n        username.getValue(), userpwd.getValue(),\n        function(result) {\n\n            Login.setCookie(result);\n            myMask.hide();\n            // 新的\n            window.location.href = vmd.virtualPath + \"/modules/eQ9ULgcVb1/hwipUwNjJb/hwZ8jCmRKR.html?r=\" + new Date().getTime();\n\n            //原来的\n            //window.location.href = vmd.virtualPath + \"/modules/eQ9ULgcVb1/eQ9ULgcVb5/hwBgORDLpV.html?r=\" + new Date().getTime();\n        },\n        function(msg) {\n            Tips.tips(\"验证失败！\", \"error\");\n            myMask.hide();\n            // Ext.Msg.alert(\"提示\", \"保存服务地址信息失败！\");\n        },\n        \"unity\"\n    );\n\n\n}\n\nfunction rememberpwd_afterrender(sender) {\n\n    Login.state = Login.isRememberPwd();\n\n    rememberpwd.el.on('click', function(e) {\n\n        if(!Login.state) {\n            //记住密码\n            Login.modifyRememberState(true);\n\n        } else {\n             Login.modifyRememberState(false);\n        }\n\n        Login.state = !Login.state;\n\n    })\n}\n\n\n\n\n//增加页面回车登录快捷操作\nfunction MyViewport_afterrender(sender) {\n\n    var map = new Ext.KeyMap(document, {\n        key: 13, // or Ext.EventObject.ENTER\n        fn: button_click,\n        scope: button\n    })\n    Login.rememberState();\n    if(Ext.isIE)\n\t\tvmd.tip( '为达到更好的用户体验，建议采用谷歌浏览器、360极速浏览器等webkit内核的浏览器进行操作。','info',3000);\n\n}\n\n\n\nfunction qq_afterrender(sender) {\n    qq.el.on('click', function() {\n\n        Ext.Msg.alert('提示', '功能研发中！')\n    })\n}","vmdcss":".browser a{\n    \n    text-decoration: none;\n    color: blue\n}","vmdprops":"\"\"","type":"module","vmdresource":"{\"components\":[{\"cid\":\"vmdrescsss\",\"layoutConfig\":{},\"userConfig\":{}},{\"cid\":\"vmdresjss\",\"layoutConfig\":{},\"userConfig\":{}},{\"cid\":\"vmdresimgs\",\"layoutConfig\":{},\"userConfig\":{}}]}"}