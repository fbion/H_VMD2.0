<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

    <title>环境配置-测试1</title>
	<!--基本样式-->
    <link href="{vmdvirtualPath}/css/common.css?ver=vmd2.0.7.200328" rel="stylesheet" />
    <!--加载dhx组件-->
    <link href="{vmdvirtualPath}/lib/ext-3.4/resources/css/ext-all.css?ver=vmd2.0.7.200328" rel="stylesheet" />
   

	<link href="{vmdvirtualPath}/lib/dhtmlx/skins/material/dhtmlx.css?ver=vmd2.0.7.200328" rel="stylesheet" />
	  <!--样式快捷索引表-->
    <link href="{vmdvirtualPath}/css/shortcut.css?ver=vmd2.0.7.200328" rel="stylesheet" />
    
	{vmdprojectcssfiles}
    
    <script src="{vmdvirtualPath}/lib/labjs/LAB.min.js?ver=vmd2.0.7.200328"></script>
    <script src="{vmdvirtualPath}/config.js?ver=vmd2.0.7.200328"></script>
    <script src="{vmdvirtualPath}/lib/ext-3.4/adapter/ext/ext-base-debug.js?ver=vmd2.0.7.200328"></script>
    <script src="{vmdvirtualPath}/lib/ext-3.4/adapter/ext/ext-base-lang.js?ver=vmd2.0.7.200328"></script>
    <script src="{vmdvirtualPath}/lib/ext-3.4/adapter/ext/ext-base-class.js?ver=vmd2.0.7.200328"></script>
    <script src="{vmdvirtualPath}/lib/ext-3.4/ext-all-debug.js?ver=vmd2.0.7.200328"></script>
    <script src="{vmdvirtualPath}/lib/ext-3.4/src/locale/ext-lang-zh_CN.js?ver=vmd2.0.7.200328"></script>
    <script src="{vmdvirtualPath}/js/util.js?ver=vmd2.0.7.200328"></script>
    <script src="{vmdvirtualPath}/lib/dhtmlx/codebase/dhtmlx.js?ver=vmd2.0.7.200328"></script>
	
    <script src="{vmdvirtualPath}/js/hwdas.js?ver=vmd2.0.7.200328"></script>
    <script src="{vmdvirtualPath}/js/vmdcore.js?ver=vmd2.0.7.200328"></script>
    <script src="{vmdvirtualPath}/js/vmdcomps.js?ver=vmd2.0.7.200328"></script>
    <script src="{vmdvirtualPath}/js/publicMethods.js?ver=vmd2.0.7.200328"></script>
   
    
    {vmdworkspacePath}
	{vmdprojectconfigjs}
	
	{vmdprojectjsfiles}
    
    <style>

    </style>
    <style type="text/css" id="vmdcss">
        .aaaaa{
    font-size: 14px!important;
}
.aaaaa .x-tab-strip-inner span{
    font-size: 14px!important;
}
.aaaaa .x-tab-strip-top .x-tab-strip-active .x-tab-right {
    background-color: #20A0FF
}

.aaaaa .x-tab-strip-active span.x-tab-strip-text {
    color: white;
    font-weight: bold;
}

.aaaaa .x-panel-header-text {
    font-size: 14px;
}

.aaaaa .x-panel {
    border-radius: 8px;
}

.bbbbb .x-tab-strip-top .x-tab-strip-active .x-tab-right {
    background-color: #fafafa
}

.bbbbb .x-tab-strip-active span.x-tab-strip-text {
    color: #409eff;
    font-weight: bold;
}

.ccccc .icon-refresh {
    background-image: url("") !important;
}

.serverlist-info {
    padding: 8px 17px;
    margin: 2px;
    line-height: 0.25em;
    height: 5px;
    width: 150px;
    border-top: 5px solid transparent;
    cursor: pointer;
    font-size: 14px;
}

.x-grid3-hd-row td {
    font: normal 14px arial, tahoma, helvetica, sans-serif;
}

.x-grid3-row td,
.x-grid3-summary-row td {
    font: normal 14px arial, tahoma, helvetica, sans-serif;
}

.micrser-label {
    font-size: 14px!important;
    font-weight: 600;
    margin-left: 10px;
}

.micrser-btn {
    position: absolute;
    top: 10px;
    right: 20px;
    font-size: 14px;
    color: #20A0FF;
    border: 0;
    background-color: rgba(0, 0, 0, 0);
    cursor: pointer;
}

.pt-btn {
    position: absolute;
    right: 20px;
    margin-top: -5px;
    font-weight: 500;
    /*right: 20px;*/
    color: #20A0FF;
    border: 0;
    background-color: rgba(0, 0, 0, 0);
    cursor: pointer;
}

.min-btn {
    font-weight: 500;
    font-size: 12px;
    color: #20A0FF;
    border: 0;
    background-color: rgba(0, 0, 0, 0);
    cursor: pointer;
}

.min-btn::before {
    margin-left: 10px;
    content: "\271A";
}

.micrser-div .x-panel {
    display: inline-block !important;
}

.micrser-config {
    margin-left: 5px;
}


.resource-group {
    padding: 0 5px;
}

.resource-group:hover .resource-btn {
    visibility: visible;

}

.resource-btn {
    visibility: hidden;
}

.mircser-layout {
    border-radius: 5px;
    background-color: #fff;
    margin: 5px;
    padding: 5px;
    box-shadow: 1px 3px 4px 2px #ccc;
}

    </style>
    <script>
	    
        vmd.virtualPath = '{vmdvirtualPath}';
        
        Ext.define("vmd.module.MainViewport" ,{
	extend:"vmd.comp.viewport",
	requires:vmd.getCmpDeps(["vmd.ux.ResourceList$1.0$ResourceList","vmd.ux.PublishResource$1.0$PublishResource","vmd.ux.MicroservicesList$1.0$MicroservicesList"]),
	xtype:"vmd.module.MainViewport",
	layout:"border",
	autoScroll:true,
	afterrender:"MainViewport_afterrender",
	initComponent: function(){
		//定义校验规则表达式
var strRegex = '^(([0-9a-z_!~*().&=+$%-]+: )?[0-9a-z_!~*().&=+$%-]+@)?' //ftp的user@
    +
    '(([0-9]{1,3}.){3}[0-9]{1,3}' // IP形式的URL- 199.194.52.184
    +
    '|' // 允许IP和DOMAIN（域名）
    +
    '([0-9a-z_!~*()-]+.)*' // 域名- www.
    +
    '([0-9a-z][0-9a-z-]{0,61})?[0-9a-z].' // 二级域名
    +
    '[a-z]{2,6})' // first level domain- .com or .museum
    +
    '(:[0-9]{1,6})?' // 端口- :80
    +
    '((/?)|' // a slash isn't required if there is no file name
    +
    "(/[0-9a-z_!~*().;?:@&=+$,%#-]+)+/?)$";
// 设置微服务视图提交数据
var myMask;
var paneltype = 1;
var mircserverData = [];
var mircserverData1 = [];
var micrserList = [];
var micrserListname = [];
var micrserChild = [];
// 获取微服务分组信息
function getMicrserList(success) {
    hwDas.get({
            host: vmd.workspace.dataServiceIp,
            url: 'CDEServcie/micservice/micservicelist'
        }, {}, {},
        function(re_data) {
            success(re_data.data[0].datas)
        },
        function(msg) {}
    );
}

// 获取服务地址
function getMicrserChild(success) {

    hwDas.get({
            host: vmd.workspace.dataServiceIp,
            url: 'CDEServcie/micservice/micserviceaddress'
        }, {}, {},
        function(re_data) {
            success(re_data.data[0].datas)
        },
        function(msg) {}
    );
}

// 开发页面微服务数据查询
function store_load(sender, records, options) {
    myMask = new Ext.LoadMask(document.body, {
        msg: "数据加载中，请稍后...",
        msgCls: 'z-index:10000;'
    });
    myMask.show();
    if (records.length > 0) {
        initMicrserstore(records[0].data, MicrservList1)
    } else {
        var data = {
            authserver: "",
            dasserver: "",
            docserver: "",
            logserver: "",
            micserviceinfo: "",
            msgserver: "",
            reportserver: "",
            todoserver: "",
            wfserver: ""
        }

        initMicrserstore(data, MicrservList1)
    }


}
// 初始化微服务数据集数据
function initMicrserstore(records, sender) {
    getMicrserList(function(data) {
        for (var i = 0; i < data.length; i++) {
            micrserList[i] = data[i];
        }
        getMicrserChild(function(data) {
            for (var i = 0; i < data.length; i++) {
                micrserChild[i] = data[i];
            }
            // -------------在这里开始处理-----------------------
            if (records) {
                if (records.micserviceinfo != "") {
                    initMicrserfromStore(sender, records.micserviceinfo);
                } else {
                    initMicrserfromoldStore(sender, records);
                }
            }
        })

    })

}

// 根据数据库初始化微服务的值
function initMicrserfromStore(sender, data) {
    MicrservList.removeAll();
    mircserverData = [];
    if (data != "") {
        var micrserdata = JSON.parse(data);
    } else {
        var micrserdata = [];
    }

    for (var i = 0; i < micrserdata.length; i++) {
        micrserdata[i].identify = micrserdata[i].code;
        var str = JSON.stringify(micrserdata[i]);
        var list = [];
        // for (var j = 0; j < micrserdata.length; j++) {
        //      var objlist = {
        //             'key': micrserdata[j].address.id,
        //             'value': micrserdata[j].address.name,
        //             'url': micrserdata[j].address.url
        //         }
        //         list.push(objlist)
        // }
        for (var j = 0; j < micrserChild.length; j++) {
            if (micrserChild[j].mircserveradd_micserviceid == micrserdata[i].id) {
                var objlist = {
                    'key': micrserChild[j].mircserveradd_id,
                    'value': micrserChild[j].mircserveradd_name,
                    'url': micrserChild[j].mircserveradd_url
                }
                var exist = false;
                for (var k in list) {
                    if (list[k].key == objlist.key) {

                        exist = true;
                    }
                }
                if (!exist) {
                    list.push(objlist);
                }
            }
        }
        var flag = false;
        if (paneltype == 1) {
            if (i > 2)
                flag = true;
        }
        addMicrserList(sender, str, flag, list, i)
    }
    myMask.hide();

}
// 从旧的数据库拿到数据
function initMicrserfromoldStore(sender, data) {

    var list = getoldDataFromStore(data);
    var micrserlist = JSON.stringify(list);
    initMicrserfromStore(sender, micrserlist)
}

function getoldDataFromStore(data) {
    // micrserList
    var list = []
    // 认证中心
    if (data.authserver != '') {

        // hwc0f00e216222306dd5229ac3e12013

        var listobj = getoldData(data.authserver, 'hwc0f00e216222306dd5229ac3e12013')
        list.push(listobj)
    }
    // 数据服务
    // hwc0f00e216222306dd5229ac3e12001
    var listobj = getoldData(data.dasserver, 'hwc0f00e216222306dd5229ac3e12001', 'dasserver')
    list.push(listobj)
    // 文档中心
    if (data.docserver != '') {
        // hwc0f00e216222306dd5229ac3e12008
        var listobj = getoldData(data.docserver, 'hwc0f00e216222306dd5229ac3e12008')
        list.push(listobj)
    }
    // 日志中心
    // hwc0f00e216222306dd5229ac3e12006
    var listobj = getoldData(data.logserver, 'hwc0f00e216222306dd5229ac3e12006')
    list.push(listobj)
    // 消息中心
    if (data.msgserver != '') {
        // hwc0f00e216222306dd5229ac3e12005
        var listobj = getoldData(data.msgserver, 'hwc0f00e216222306dd5229ac3e12005')
        list.push(listobj)
    }
    // 报表中心
    // hwc0f00e216222306dd5229ac3e12003
    var listobj = getoldData(data.reportserver, 'hwc0f00e216222306dd5229ac3e12003')
    list.push(listobj)
    // 待办中心
    if (data.todoserver != '') {
        // hwc0f00e216222306dd5229ac3e12007
        var listobj = getoldData(data.todoserver, 'hwc0f00e216222306dd5229ac3e12007')
        list.push(listobj)
    }
    // 流程中心
    if (data.wfserver != '') {
        // hwc0f00e216222306dd5229ac3e12004
        var listobj = getoldData(data.wfserver, 'hwc0f00e216222306dd5229ac3e12004')
        list.push(listobj)
    }
    return list
}

function getoldData(url, id) {
    for (var i = 0; i < micrserList.length; i++) {
        if (micrserList[i].mircserver_id == id) {
            var listobj = {
                'id': micrserList[i].mircserver_id,
                'code': micrserList[i].mircserver_code,
                'name': micrserList[i].mircserver_name,
                'type': micrserList[i].mircserver_type,
                'address': {
                    'id': url,
                    'code': micrserList[i].mircserver_code,
                    'name': url,
                    'url': url
                }
            }
            return listobj;
        }
    }
}


//添加资源中心服务地址
winAddResourceServer = Ext.extend(Ext.Window, {
    xtype: "window",
    title: "添加资源中心服务地址",
    width: 300,
    height: 200,
    layout: "form",
    bodyStyle: 'padding:15px',
    labelAlign: "left",
    labelWidth: 40,
    modal: true,
    constructor: function(callback, name, addr, remark) {
        this.callback = callback;
        this.valueAddr = addr;
        this.valueName = name;
        this.valueRemark = remark;
        this.callParent();
    },
    initComponent: function() {
        var me = this;
        this.fbar = [{
            text: "确定",
            handler: function() {
                //var reg = /[\w\-]+(\.[\w\-]+)+([\w\-\.,@?^=%&:\/~\+#]*[\w\-\@?^=%&\/~\+#])?:([0-9]|[1-9]\d{1,5}|[1-5]\d{4}|6[0-5]{2}[0-3][0-5])$/;
                if (!new RegExp(strRegex).test(Ext.getCmp('addr').getValue())) {
                    Ext.Msg.alert("提示", "请输入正确的服务地址(带端口)！")
                    return;
                }
                myMask = new Ext.LoadMask(document.body, {
                    msg: "正在验证资源中心配置,请稍后...",
                    msgCls: 'z-index:10000;'
                });
                myMask.show();
                //验证资源中心是否配置正确
                hwDas.get({
                    host: Ext.getCmp('addr').getValue(),
                    url: "zyzx/zyzxtree/getServerInfo"
                }, {}, {}, function() {
                    myMask.hide();
                    //如果包含资源中心，则保存并关闭
                    me.callback(Ext.getCmp('name').getValue().trim(), Ext.getCmp('addr').getValue(), Ext.getCmp('remark').getValue().trim());
                    me.close();
                }, function() {
                    myMask.hide();
                    //不包含资源中心接口，则提示
                    Ext.Msg.alert("提示", "地址:" + Ext.getCmp('addr').getValue() + "不是有效的资源中心地址,请确认该地址是否包含资源中心服务接口!")
                    return;
                })
            }
        }, {
            text: "取消",
            handler: function() {
                me.close();
            }
        }];
        this.items = [{
            id: 'name',
            xtype: "textfield",
            fieldLabel: "名称",
            anchor: "100%",
            value: this.valueName
        }, {
            id: 'addr',
            xtype: "textfield",
            fieldLabel: "地址",
            anchor: "100%",
            value: this.valueAddr,
            regex: new RegExp(strRegex), //   /[\w\-]+(\.[\w\-]+)+([\w\-\.,@?^=%&:\/~\+#]*[\w\-\@?^=%&\/~\+#])?:([0-9]|[1-9]\d{1,3}|[1-5]\d{4}|6[0-5]{2}[0-3][0-5])$/,
            regexText: "输入标准的服务器地址（带端口）！"
        }, {
            id: 'remark',
            xtype: "textfield",
            fieldLabel: "说明",
            anchor: "100%",
            value: this.valueRemark
        }]
        winAddResourceServer.superclass.initComponent.call(this);
    }
})

function button5_click(sender, e) {
    var addResourceServer = function(name, addr, remark) {
        var id = vmd.util.guid();
        var records = vmd.data.Record.create({
            id: id,
            address: addr,
            name: name,
            remark: remark
        });
        hwDas.save("CDEServcie/project/projectconfig/devresourceservers", {}, {}, {
                projectid: vmd.getUrlParam("projectid") || 'hWlI8gBXWj',
                id: id,
                address: addr,
                name: name,
                remark: remark,
            },
            function(result) {
                vmd.tip('保存成功', "success")
                getresourceserver.add(records)
                var s = new vmd.proxy.Log();
                div9.removeAll();
                getresourceserver.toRefresh();
                addResList(getresourceserver.modified);
                // s.save("项目环境配置", vmd.getUrlParam("projectid") || 'hWlI8gBXWj', Ext.util.Cookies.get('userName') + "在" + Ext.Date.dateFormat(new Date(), 'Y-m-d H:i:s') + "添加了" + parent.btnProjectName.getText() + "项目的开发环境中的资源配置信息", "项目", function() {
                //     // alert("保存成功了！")
                // }, function() {
                //     alert("日志报存失败了！");
                // })
            },
            function(msg) {
                console.log(msg)
            })
    }
    var winForm = new winAddResourceServer(addResourceServer, "", "", "");
    winForm.show();
}
//编辑模块
function moduleEdit(index, record) {
    var rec = record || getresourceserver.getAt(index)
    if (rec) {
        var editServer = function(name, addr, remark) {
            var id = rec.data.id;
            hwDas.save("CDEServcie/project/projectconfig/devresourceservers", {}, {}, {
                    projectid: vmd.getUrlParam("projectid") || 'hWlI8gBXWj',
                    id: id,
                    address: addr,
                    name: name,
                    remark: remark,
                },
                function(result) {
                    vmd.tip('修改成功', "success")
                    rec.set("address", addr)
                    rec.set("name", name)
                    rec.set("remark", remark)
                    var s = new vmd.proxy.Log();
                    div9.removeAll();
                    getresourceserver.toRefresh();
                    addResList(getresourceserver.modified);
                    // s.save("项目环境配置", vmd.getUrlParam("projectid") || 'hWlI8gBXWj', Ext.util.Cookies.get('userName') + "在" + Ext.Date.dateFormat(new Date(), 'Y-m-d H:i:s') + "修改了" + parent.btnProjectName.getText() + "项目的开发环境中的资源配置信息", "项目", function() {
                    //     // alert("保存成功了！")
                    // }, function() {
                    //     alert("日志报存失败了！");
                    // })
                },
                function(msg) {
                    console.log(msg)
                })
        }
        var winForm = new winAddResourceServer(editServer, rec.data.name, rec.data.address, rec.data.remark);
        winForm.show();
    }
}
window.moduleEdit = moduleEdit
//删除资源
function moduleDel(index, record) {
    var rec = record || getresourceserver.getAt(index)
    if (rec)
        hwDas.del("CDEServcie/project/projectconfig/devresourceservers", {}, {
            serviceaddressid: rec.data.id
        }, function(result) {
            vmd.tip('删除成功', "success")
            getresourceserver.remove(rec)
            var s = new vmd.proxy.Log();
            div9.removeAll();
            getresourceserver.toRefresh();

            addResList(getresourceserver.modified);
            // s.save("项目环境配置", vmd.getUrlParam("projectid") || 'hWlI8gBXWj', Ext.util.Cookies.get('userName') + "在" + Ext.Date.dateFormat(new Date(), 'Y-m-d H:i:s') + "删除了" + parent.btnProjectName.getText() + "项目的开发环境中的资源配置信息", "项目", function() {

            // }, function() {
            //     alert("日志报存失败了！");
            // })
        }, function(msg) {
            console.log(msg)
        })
}
window.moduleDel = moduleDel

function MyGrid_beforerender(sender) {

}
//添加资源中心服务地址
winAddPubServer = Ext.extend(Ext.Window, {
    xtype: "window",
    title: "发布环境配置名称",
    width: 300,
    height: 150,
    layout: "form",
    bodyStyle: 'padding:15px',
    labelAlign: "left",
    labelWidth: 40,
    modal: true,
    constructor: function(callback, name) {
        this.callback = callback;
        this.valueName = name;
        this.callParent();
    },
    initComponent: function() {
        var me = this;
        this.fbar = [{
            text: "确定",
            handler: function() {
                me.callback(Ext.getCmp('name').getValue());
                me.close();
            }
        }, {
            text: "取消",
            handler: function() {
                me.close();
            }
        }];
        this.items = [{
            id: 'name',
            xtype: "textfield",
            fieldLabel: "名称",
            anchor: "100%",
            value: this.valueName
        }]
        winAddResourceServer.superclass.initComponent.call(this);
    }
})

function button2_click(sender, e) {
    var addPubServer = function(name) {
        var id = vmd.util.guid();
        var records = vmd.data.Record.create({
            config_id: id,
            project_id: vmd.getUrlParam("projectid") || 'hWlI8gBXWj',
            name: name
        });
        hwDas.save("CDEServcie/project/projectconfig/runserverconfig", {}, {}, {
                project_id: vmd.getUrlParam("projectid") || 'hWlI8gBXWj',
                config_id: id,
                name: name
            },
            function(result) {
                vmd.tip('添加成功', "success")
                pubservers.add(records);
                pubservers.toRefresh()
                var s = new vmd.proxy.Log();
                // s.save("项目环境配置", vmd.getUrlParam("projectid") || 'hWlI8gBXWj', Ext.util.Cookies.get('userName') + "在" + Ext.Date.dateFormat(new Date(), 'Y-m-d H:i:s') + "添加了" + parent.btnProjectName.getText() + "项目的发布环境信息，名称为：" + name, "项目", function() {

                // }, function() {
                //     alert("日志报存失败了！");
                // })
            },
            function(msg) {
                console.log(msg)
            })
    }
    var winForm = new winAddPubServer(addPubServer, "");
    winForm.show();
}

function button4_click(sender, e) {
    if (hwDataView.getSelectionCount() > 0) {
        var rec = hwDataView.getSelectedRecords()[0]
        hwDas.del("CDEServcie/project/projectconfig/runserverconfig", {}, {
            config_id: rec.data.config_id
        }, function(result) {
            vmd.tip('删除成功', "success")
            pubservers.remove(rec);
            pubservers.toRefresh()
            var s = new vmd.proxy.Log();
            // s.save("项目环境配置", vmd.getUrlParam("projectid") || 'hWlI8gBXWj', Ext.util.Cookies.get('userName') + "在" + Ext.Date.dateFormat(new Date(), 'Y-m-d H:i:s') + "删除了" + parent.btnProjectName.getText() + "项目的发布环境信息，名称为：" + rec.data.name, "项目", function() {
            //     // alert("保存成功了！")
            // }, function() {
            //     alert("日志报存失败了！");
            // })
        }, function(msg) {
            console.log(msg)
        })
    }
}

function bindtree(nodeid) {
    substore.loadData([])
    if (txt_ptserver.getValue()) {
        hwDas.get(txt_ptserver.getValue() + "/getsubsystem", {}, {}, function(result) {
            substore.loadData(result.data[0].datas);
            if (nodeid) {
                var node = tree.getNodeById(nodeid)
                if (node) node.select()
            }
        }, function(msg) {
            console.log(msg)
        })
    }
}

function hwDataView_click(sender, index, node, e) {

    // 获取数据
    hwDas.get({
            host: vmd.workspace.dataServiceIp,
            url: 'CDEServcie/project/projectconfig/runserverconfig'
        }, {}, {
            'project_id': vmd.getUrlParam("projectid") || 'hWlI8gBXWj'
        },
        function(result) {
            // 清空发布环境页面选项数据
            MicrservList.removeAll();
            if (paneltype == 1) {
                mircserverData1 = [];
            } else if (paneltype == 2) {
                mircserverData = [];
            }
            var rec = result.data[0].datas[index];
            if (rec) {
                //判断是否为旧数据库读取的数据
                if (rec.micserviceinfo == "") {
                    var objarr = getoldDataFromStore(rec)
                    // var objarr = [];
                } else {
                    var objarr = JSON.parse(rec.micserviceinfo)
                }
                // 与开发环境数据做比对
                var list = [];

                for (var i = 0; i < micrserListname.length; i++) {
                    for (var j = 0; j < objarr.length; j++) {
                        if (objarr[j].id == micrserListname[i].id) {
                            list.push(objarr[j])
                        }
                    }
                    if (list.length == i) {
                        var objlist = micrserListname[i];
                        objlist.address = '';
                        list.push(objlist);
                    }

                }
                // 把整理好的数据传入初始化方法
                rec.micserviceinfo = JSON.stringify(list)
                initMicrserstore(rec, MicrservList)
            }
            var rec = pubservers.getAt(index)
            if (rec) {
                recdata = rec.data;
                txt_ptserver.setValue(recdata.ptservice)
                bindtree(recdata.subsysid)
                txt_vir.setValue(recdata.virtualdir)
                // if (hwDiv.rendered)
                //     bindresource()
            }
            button7.setDisabled(false)
        },
        function(msg) {}
    );
    panel2.doLayout();

}
var comData = [{
    subsysname: "",
    subsysid: "",
    parentid: "0"
}]
var substore = new vmd.data.Store({
    data: comData,
    fields: ['subsysname', 'subsysid', 'parentid']
})

function tree_beforerender(sender) {
    tree.store = substore
}

function getNewResource() {
    if (!hwDiv.rendered) {
        if (hwDataView.getSelectionCount() > 0) {
            var _rec = hwDataView.getSelectedRecords()[0]
            return _rec.data.resourceserver;
        }
        return "[]";
    }
    var newres = []
    for (var i = 0; i < listPublishResourceComps.length; i++) {
        var _resourecInfo = listPublishResourceComps[i].com.getText();
        newres.push({
            name: listPublishResourceComps[i].sname,
            oldip: _resourecInfo.oldIP,
            newip: _resourecInfo.newIP
        })
    }
    return Ext.encode(newres);
}
window.getNewResource = getNewResource

function button7_click(sender, e) {
    // mircserverData=[]
    if (hwDataView.getSelectionCount() > 0) {
        var rec = hwDataView.getSelectedRecords()[0]
        var count = 0;
        var flag = true;
        MicrservList.items.each(function(item) {
            if (item.getComlistValue() == '') {
                flag = false;

            }
            var addressid = item.getComlistValue();
            for (var i = 0; i < micrserChild.length; i++) {
                if (addressid == micrserChild[i].mircserveradd_id) {
                    var objlist = {
                        'id': micrserChild[i].mircserveradd_id,
                        'name': micrserChild[i].mircserveradd_name,
                        'url': micrserChild[i].mircserveradd_url
                    }
                    if (paneltype == 1) {
                        mircserverData1[count].address = objlist;
                    } else if (paneltype == 2) {
                        mircserverData[count].address = objlist;
                    }

                }
            }
            if (paneltype == 1) {
                if (mircserverData1[count].address == "") {

                    var objlist = {
                        'id': item.getComlistValue(),
                        'name': item.getComlistValue(),
                        'url': item.getComlistValue()
                    }
                    mircserverData1[count].address = objlist;
                }
            } else if (paneltype == 2) {
                if (mircserverData[count].address == "") {
                    var objlist = {
                        'id': item.getComlistValue(),
                        'name': item.getComlistValue(),
                        'url': item.getComlistValue()
                    }
                    mircserverData[count].address = objlist;
                }
            }

            count++;

        })
        // if (!flag) {
        //     vmd.tip('提交前请先选择或设置数据', 'warning');
        //     return;
        // }

        if (paneltype == 1) {
            var mircserverDataStr = JSON.stringify(mircserverData1);
        } else if (paneltype == 2) {
            var mircserverDataStr = JSON.stringify(mircserverData);
        }

        hwDas.save("CDEServcie/project/projectconfig/runserverconfig", {}, {}, {
                config_id: rec.data.config_id,
                project_id: vmd.getUrlParam("projectid") || 'hWlI8gBXWj',
                ptservice: txt_ptserver.getValue().trim(),
                subsysid: tree.getSelNodeId() || "",
                virtualdir: txt_vir.getValue().trim(),
                micserviceinfo: mircserverDataStr,

                resourceserver: getNewResource()
            },
            function(result) {
                vmd.tip('保存成功', "success")
                rec.set("config_id", rec.data.config_id)
                rec.set("project_id", vmd.getUrlParam("projectid") || 'hWlI8gBXWj')
                rec.set("ptservice", txt_ptserver.getValue())
                rec.set("subsysid", tree.getSelNodeId() || "")
                rec.set("virtualdir", txt_vir.getValue())

                rec.set("resourceserver", getNewResource())
            },
            function(msg) {
                console.log(msg)
            })
    } else {
        vmd.tip('提交前请先选择左侧节点', 'warning');
        return;
    }
}

function button3_click(sender, e) {
    bindtree()
}
var resourceServices = []
var listPublishResourceComps = []

function bindresource() {
    hwDiv.removeAll()
    var resourceserver = [];
    listPublishResourceComps = []
    var j = 0
    if (hwDataView.getSelectionCount() > 0) {
        var _rec = hwDataView.getSelectedRecords()[0]
        resourceserver = Ext.decode(_rec.data.resourceserver);
    }
    for (var i = 0; i < getresourceserver.getCount(); i++) {
        var rec = getresourceserver.getAt(i);
        (function(rec, index) {
            hwDas.get({
                host: getresourceserver.getAt(index).data.address,
                url: "zyzx/zyzxtree/getServerInfo"
            }, {}, {}, function(c_result) {
                if (c_result.data && c_result.data.length > 0 && c_result.data[0].size > 0) {
                    for (var k = 0; k < c_result.data[0].datas.length; k++) {
                        var rname = rec.data.name + "/" + c_result.data[0].datas[k].name
                        var r_name = rec.data.name + "&&" + c_result.data[0].datas[k].name
                        var newip = ""
                        for (var m = 0; m < resourceserver.length; m++) {
                            if (resourceserver[m].name == r_name) newip = resourceserver[m].newip
                        }
                        var ipresource = new vmd.ux.PublishResource({
                            id: "PublishResource" + index + "_" + k,
                            anchor: "100% ",
                            style: "font-size:14px;margin: 10px"
                        });
                        //动态添加地址替换组件，根据有多少不同的地址进行添加
                        hwDiv.add(ipresource)
                        ipresource.setText(c_result.data[0].datas[k].ip, newip, rname);
                        listPublishResourceComps.push({
                            sname: r_name,
                            com: ipresource
                        })
                    }
                    hwDiv.doLayout()
                }
                j++
            }, function() {
                j++
            })
        })(rec, i)
    }
    var n = 0
}

function MyTabs_tabchange(sender, tab) {
    if (tab.id == 'panel') {
        paneltype = 1;
    } else if (tab.id == 'panel1') {
        paneltype = 2;
        // mircserverData = []
        hwDataView_click(sender, hwDataView.getSelectedIndexes()[0]);
        if (hwDiv.rendered) {
            bindresource();

        }
        if (hwDiv.rendered && tab.id == 'panel3') {
            if (hwDataView.getSelectionCount() <= 0)
                hwDiv.removeAll()
            else
                bindresource()
        }
    }

}


// 资源编辑
function button6_click(sender, e) {

    var rec;
    if (hwDataView.getSelectionCount() > 0) {
        rec = hwDataView.getSelectedRecords()[0]
    }
    if (rec) {
        var editPubServer = function(name) {
            hwDas.edit("CDEServcie/project/projectconfig/runserverconfig", {}, {}, {
                    config_id: rec.data.config_id,
                    name: name
                },
                function(result) {
                    vmd.tip('修改成功', "success")
                    rec.set("name", name)
                    var s = new vmd.proxy.Log();
                    // s.save("项目环境配置", vmd.getUrlParam("projectid") || 'hWlI8gBXWj', Ext.util.Cookies.get('userName') + "在" + Ext.Date.dateFormat(new Date(), 'Y-m-d H:i:s') + "修改了" + parent.btnProjectName.getText() + "项目的发布环境信息，名称为：" + name, "项目", function() {
                    //     // alert("保存成功了！")
                    // }, function() {
                    //     alert("日志报存失败了！");
                    // })
                },
                function(msg) {
                    console.log(msg)
                })
        }
        var winForm = new winAddPubServer(editPubServer, rec.data.name);
        winForm.show();
    }
}

function hwDataView_afterrender(sender) {
    if (pubservers.getCount() > 0) {
        hwDataView.selectRange(0, 0)
        hwDataView_click(sender, 0)
    }
    hwDataView.on("containerclick", function() {
        substore.loadData([])
        txt_ptserver.setValue("")
        txt_vir.setValue("")
        hwDiv.removeAll()
        button7.setDisabled(true)
    })
}

function panel_beforerender(sender) {}

function setRegEx(cmp) {
    cmp.regex = new RegExp(strRegex)
    cmp.regexText = "输入格式如:www.hanweikeji.com:8888或192.168.1.1:8888";
}

function txt_dev_dasserver_afterrender(sender) {
    setRegEx(this)
}

function txt_dev_wfserver_afterrender(sender) {
    setRegEx(this)
}

function txt_dev_msgserver_afterrender(sender) {
    setRegEx(this)
}

function txt_dev_todoserver_afterrender(sender) {
    setRegEx(this)
}

function txt_dev_authserver_afterrender(sender) {
    setRegEx(this)
}

function txt_dev_docserver_afterrender(sender) {
    setRegEx(this)
}

function txt_dev_reportserver_afterrender(sender) {
    setRegEx(this)
}

function txt_dev_logserver_afterrender(sender) {
    setRegEx(this)
}

function txt_pub_dasserver_afterrender(sender) {
    setRegEx(this)
}

function txt_pub_wfserver_afterrender(sender) {
    setRegEx(this)
}

function txt_pub_msgserver_afterrender(sender) {
    setRegEx(this)
}

function txt_pub_todoserver_afterrender(sender) {
    setRegEx(this)
}

function txt_pub_authserver_afterrender(sender) {
    setRegEx(this)
}

function txt_pub_docserver_afterrender(sender) {
    setRegEx(this)
}

function txt_pub_reportserver_afterrender(sender) {
    setRegEx(this)
}

function txt_pub_logserver_afterrender(sender) {
    setRegEx(this)
}

function MainViewport_afterrender(sender) {}

function panel3_afterrender(sender) {}

function button8_click(sender, e) {

    var selects = MyGrid.getSelectionModel();
    if (selects.selections.items.length > 0) {
        var selrow = selects.selections.items[0]
        moduleEdit("", selrow)
    }

    //记录日志信息 
    //vmd.webBase.syslog(loginfo,logtype,operationtype,function(res){}) 
}

function button9_click(sender, e) {
    var selects = MyGrid.getSelectionModel();
    if (selects.selections.items.length > 0) {
        var selrow = selects.selections.items[0]
        moduleDel("", selrow)
    }
    //记录日志信息 
    //vmd.webBase.syslog(loginfo,logtype,operationtype,function(res){}) 
}


/*
 *固定的微服务信息
 *hwc0f00e216222306dd5229ac3e12001：数据服务、
 *hwc0f00e216222306dd5229ac3e12003：报表中心、
 *hwc0f00e216222306dd5229ac3e12006：日志中心
 */
var fixinfoId = ['hwc0f00e216222306dd5229ac3e12001', 'hwc0f00e216222306dd5229ac3e12003', 'hwc0f00e216222306dd5229ac3e12006'];
// 添加微服务管理按钮
function MyTabs_afterrender(sender) {
    var mytab = sender.el.dom;
    var button = document.createElement("button");
    button.setAttribute("class", "micrser-btn");
    button.innerHTML = "微服务管理";
    button.onclick = function() {
        popMicsermanger("微服务管理", 1, 626, 510)
    }
    mytab.appendChild(button);
}
// 弹出微服务管理框
function popMicsermanger(title, index, width, height) {
    var selectData = [];
    getMicrserSelect();
    for (var i = 0; i < mircserverData1.length; i++) {
        if (mircserverData1[i].address != "") {
            selectData.push(mircserverData1[i].address.id);
        }
        selectData.push(mircserverData1[i].id);
    }

    var formProConfig = new vmd.window({
        title: title,
        url: vmd.core.getVirtualPath() + "modules/eQ9ULgcVb1/eQ9ULgcVb5/hwBYq7WEdk/hw981912e0.html",
        auto: false,
        height: height, //510
        width: width, //626
        maximizable: false,
        enableLoading: true,
        resizable: false,
        params: {
            type: index,
            select: JSON.stringify(selectData)
        }
    })
    formProConfig.show();
    window.affirm_windows = function(select) {
        if (paneltype == 1) {

            addmicrserchild(MicrservList1, select);
            // initMicrserstore(records[0].data, MicrservList1)

        } else if (paneltype == 2) {
            addmicrserchild(MicrservList, select);
        }

        formProConfig.close();
    }
    window.colse_windows = function(select) {

        formProConfig.close();
    }
}

function getMicrserSelect() {
    var count = 0;
    var flag = true;

    MicrservList1.items.each(function(item) {

        var addressid = item.getComlistValue();
        for (var i = 0; i < micrserChild.length; i++) {
            if (addressid == micrserChild[i].mircserveradd_id) {
                var objlist = {
                    'id': micrserChild[i].mircserveradd_id,
                    'name': micrserChild[i].mircserveradd_name,
                    'url': micrserChild[i].mircserveradd_url
                }
                if (paneltype == 1) {

                    mircserverData1[count].address = objlist;
                } else if (paneltype == 2) {
                    mircserverData[count].address = objlist;
                }

            }
        }
        if (paneltype == 1) {
            if (mircserverData1[count].address == "") {
                var objlist = {
                    'id': item.getComlistValue(),
                    'name': item.getComlistValue(),
                    'url': item.getComlistValue()
                }
                mircserverData1[count].address = objlist;
            }
        } else if (paneltype == 2) {
            if (mircserverData[count].address == "") {
                var objlist = {
                    'id': item.getComlistValue(),
                    'name': item.getComlistValue(),
                    'url': item.getComlistValue()
                }
                mircserverData[count].address = objlist;
            }
        }
        count++;

    })
    return flag;
}

// 移除视图子项
var delflag = false;

function removeMicrserList(index, sender) {

    delflag = true;
    getMicrserSelect()
    // 移除节点
    sender.removeAll();
    // 在数组中删除该序列
    if (paneltype == 1) {
        mircserverData1.splice(index, 1);
        micrserListname.splice(index, 1);
    } else if (paneltype == 2) {
        mircserverData.splice(index, 1);
    }
    initMicrserfromStore(sender, JSON.stringify(mircserverData1))
}

// 添加微服务下拉复合组件
function addMicrserList(sender, node, display, data, index) {
    var nodeInfo = JSON.parse(node);
    // 添加复合组件
    var MicroservicesList = new vmd.ux.MicroservicesList({
        'list': data,
        'id': vmd.getGuid(32)
    });
    var listobj = {
        'id': nodeInfo.id,
        'code': nodeInfo.identify,
        'name': nodeInfo.name,
        'type': nodeInfo.type,
        'address': ''
    }
    if (!delflag) {
        if (paneltype == 1) {
            mircserverData1.push(listobj);
            micrserListname.push(listobj);
        } else if (paneltype == 2) {
            mircserverData.push(listobj)
        }
    } else {
        mircserverData.push(listobj)
    }
    sender.add(MicroservicesList);
    sender.doLayout();
    var addressflag = false;
    for (i in data) {
        if (data[i].key == nodeInfo.address.id) {
            addressflag = true;
        }
    }
    if (!addressflag) {
        MicroservicesList.setAttr((index + 1) + "." + nodeInfo.name + "：", display, nodeInfo.address.url, nodeInfo.address.url);
    } else {
        MicroservicesList.setAttr((index + 1) + "." + nodeInfo.name + "：", display, nodeInfo.address.id, nodeInfo.address.url);
    }

    MicroservicesList.on('removeRelation', function() {
        removeMicrserList(index, sender)
    })
}
// 添加除固定三个以外的微服务
function addmicrserchild(sender, data) {
    getMicrserList(function(data1) {
        for (var i = 0; i < data1.length; i++) {
            micrserList[i] = data1[i];
        }
        getMicrserChild(function(data2) {
            for (var i = 0; i < data2.length; i++) {
                micrserChild[i] = data2[i];
            }

            // -------------在这里开始处理-----------------------
            var num = 0
            var count = mircserverData1.length;
            for (var i = 0; i < data.length; i++) {
                var list = [];
                // 判断是否为固定的微服务分组
                var isAdd = true;
                for (var k = 0; k < fixinfoId.length; k++) {
                    if (data[i].id == fixinfoId[k] || data[i].nodeDataJson.p_id != "root") {
                        isAdd = false;
                    }

                }
                for (var index in mircserverData1) {
                    if (data[i].id == mircserverData1[index].id) {
                        isAdd = false;
                    }
                }

                // 若不存在则添加
                if (isAdd) {

                    if (data[i].childNodes.length != 0) {
                        for (var j = 0; j < data[i].childNodes.length; j++) {
                            var listobj = {
                                'key': data[i].childNodes[j].id,
                                'value': data[i].childNodes[j].text
                            }
                            var exist = false;

                            for (var k in list) {
                                if (list[k].key == listobj.key) {

                                    exist = true;
                                }
                            }
                            if (!exist) {
                                list.push(listobj);
                            }

                        }
                    }
                    data[i].nodeDataJson.id = data[i].id;
                    data[i].nodeDataJson.address = '';
                    var str = JSON.stringify(data[i].nodeDataJson);
                    delflag = false;
                    addMicrserList(sender, str, true, list, count++)
                }



            }

            delflag = true;
            getMicrserSelect()
            // 移除节点
            sender.removeAll();
            initMicrserfromStore(sender, JSON.stringify(mircserverData1))

        })

    })


}

function button1_click(sender, e) {

}

function button10_click(sender, e) {
    //记录日志信息 
    //vmd.webBase.syslog(loginfo,logtype,operationtype,function(res){}) 
    popMicsermanger("添加微服务", 2, 350, 450)
}


function panel2_beforerender(sender) {

}

function panel2_afterrender(sender) {
    // var mytab = panel2.el.dom;
    // var button = document.createElement("button");
    // button.setAttribute("class", "pt-btn");
    // button.innerHTML = "从平台提取";
    // button.onclick = function() {}
    // mytab.children[0].appendChild(button);
}
// 点击微服务提交按钮
function button11_click(sender, e) {
    var flag = getMicrserSelect()
    if (paneltype == 1) {
        var mircserverDataStr = JSON.stringify(mircserverData1);
    } else if (paneltype == 2) {
        var mircserverDataStr = JSON.stringify(mircserverData);
    }
    if (flag) {
        hwDas.save("CDEServcie/project/projectconfig/devservers", {}, {}, {
            micserviceinfo: mircserverDataStr,
            project_id: vmd.getUrlParam("projectid") || 'hWlI8gBXWj'
        }, function(result) {
            vmd.tip('保存成功', "success")
            var s = new vmd.proxy.Log();
            // s.save("项目环境配置", vmd.getUrlParam("projectid") || 'hWlI8gBXWj', Ext.util.Cookies.get('userName') + "在" + Ext.Date.dateFormat(new Date(), 'Y-m-d H:i:s') + "修改了" + parent.btnProjectName.getText() + "项目的开发环境中的微服务配置信息", "项目", function() {
            //     // alert("保存成功了！")
            // }, function() {
            //     alert("日志报存失败了！");
            // })
            if (parent && parent.reLoadWFandDas) {
                parent.reLoadWFandDas()
            }
        }, function(msg) {

        })
    }
}

function getresourceserver_load(sender, records, options) {
    div9.removeAll();
    addResList(records);
}

// 添加资源列表
function addResList(records) {
    for (var i = 0; i < records.length; i++) {
        var MicroservicesList = new vmd.ux.ResourceList({
            'index': i
        });
        div9.add(MicroservicesList);
        div9.doLayout();
        var data1 = {
            'label': (i + 1) + ".资源名称：",
            'value': records[i].data.name
        }
        var data2 = {
            'label': "资源地址：",
            'value': records[i].data.address
        }
        MicroservicesList.setAtrr(data1, data2);
        MicroservicesList.on('edit', function() {
            var selects = records[this.index];
            moduleEdit("", selects);


        });
        MicroservicesList.on('delete', function() {
            var selects = records[this.index];
            moduleDel("", selects);

        })
    }
}


function panel5_afterrender(sender) {
    // var mytab = sender.el.dom;
    // var button = document.createElement("button");
    // button.setAttribute("class", "min-btn");
    // button.innerHTML = "添加";
    // button.title = "添加微服务"
    // button.onclick = function() {
    //     button10_click();
    // }
    // mytab.children[0].appendChild(button);
}

function panel6_afterrender(sender) {
    // var mytab = sender.el.dom;
    // var button = document.createElement("button");
    // button.setAttribute("class", "min-btn");
    // button.innerHTML = "添加";
    // button.title = "添加资源地址"
    // button.onclick = function() {
    //     button5_click();

    // }
    // mytab.children[0].appendChild(button);
}

function button13_click(sender, e) {
    //记录日志信息 
    //vmd.webBase.syslog(loginfo,logtype,operationtype,function(res){}) 
    button10_click();
}

function button13_afterrender(sender) {
    //记录日志信息 
    //vmd.webBase.syslog(loginfo,logtype,operationtype,function(res){}) 
    sender.el.dom.title = "添加微服务"
}

function button14_click(sender, e) {
    //记录日志信息 
    //vmd.webBase.syslog(loginfo,logtype,operationtype,function(res){}) 
    button5_click();
}

function button14_afterrender(sender) {
    //记录日志信息 
    //vmd.webBase.syslog(loginfo,logtype,operationtype,function(res){}) 
    sender.el.dom.title = "添加资源地址"
}
			this.MainViewport_afterrender=MainViewport_afterrender;

		store=new vmd.store.jsonStore({listeners:{load:function(){store_load.apply(this,arguments);}},"xtype":"vmd.jsonStore","id":"store","xcls":"vmd.store.jsonStore","autoLoad":true,"cid":"vmdJsonStore","storeConfig":"{\"id\":\"mpB2MEOdnZ\",\"callcode\":\"vmdCode\",\"url\":\"CDEServcie/project/projectconfig/devservers\",\"host\":\"\",\"name\":\"项目开发环境的服务配置\",\"isHwRest\":true,\"getMethods\":[{\"id\":\"project_id\",\"name\":\"项目id\",\"type\":\"String\",\"value1\":\"//返回值 \\r\\n return vmd.getUrlParam(\\\"projectid\\\")||'hWlI8gBXWj'\",\"value2\":\"\",\"testValue\":\"\",\"defaultvalue\":\"\"}],\"postMethods\":[],\"putMethods\":[],\"deleteMethods\":[],\"saveMethods\":[],\"fields\":[{\"name\":\"dasserver\",\"cname\":\"\",\"type\":\"string\",\"primary\":\"\",\"nullable\":\"Y\",\"length\":\"\",\"precision\":\"\",\"unit\":\"\",\"rule\":{}},{\"name\":\"wfserver\",\"cname\":\"\",\"type\":\"string\",\"primary\":\"\",\"nullable\":\"Y\",\"length\":\"\",\"precision\":\"\",\"unit\":\"\",\"rule\":{}},{\"name\":\"msgserver\",\"cname\":\"\",\"type\":\"string\",\"primary\":\"\",\"nullable\":\"Y\",\"length\":\"\",\"precision\":\"\",\"unit\":\"\",\"rule\":{}},{\"name\":\"todoserver\",\"cname\":\"\",\"type\":\"string\",\"primary\":\"\",\"nullable\":\"Y\",\"length\":\"\",\"precision\":\"\",\"unit\":\"\",\"rule\":{}},{\"name\":\"authserver\",\"cname\":\"\",\"type\":\"string\",\"primary\":\"\",\"nullable\":\"Y\",\"length\":\"\",\"precision\":\"\",\"unit\":\"\",\"rule\":{}},{\"name\":\"docserver\",\"cname\":\"\",\"type\":\"string\",\"primary\":\"\",\"nullable\":\"Y\",\"length\":\"\",\"precision\":\"\",\"unit\":\"\",\"rule\":{}},{\"name\":\"reportserver\",\"cname\":\"\",\"type\":\"string\",\"primary\":\"\",\"nullable\":\"Y\",\"length\":\"\",\"precision\":\"\",\"unit\":\"\",\"rule\":{}},{\"name\":\"logserver\",\"cname\":\"\",\"type\":\"string\",\"primary\":\"\",\"nullable\":\"Y\",\"length\":\"\",\"precision\":\"\",\"unit\":\"\",\"rule\":{}},{\"name\":\"micserviceinfo\",\"cname\":\"\",\"type\":\"string\",\"primary\":\"\",\"nullable\":\"Y\",\"length\":\"\",\"precision\":\"\",\"unit\":\"\",\"rule\":{}}]}","load":"store_load"});
		getresourceserver=new vmd.store.jsonStore({listeners:{load:function(){getresourceserver_load.apply(this,arguments);}},"xtype":"vmd.jsonStore","id":"getresourceserver","xcls":"vmd.store.jsonStore","autoLoad":true,"cid":"vmdJsonStore","storeConfig":"{\"id\":\"bn6KEvEwwL\",\"callcode\":\"vmdCode\",\"url\":\"CDEServcie/project/projectconfig/devresourceservers\",\"host\":\"\",\"isHwRest\":true,\"name\":\"项目开发环境资源服务信息\",\"getMethods\":[{\"id\":\"id\",\"value1\":\"//返回值 \\r\\n return vmd.getUrlParam(\\\"projectid\\\")||'hWlI8gBXWj'\",\"value2\":\"\",\"defaultvalue\":\"\"}],\"postMethods\":[],\"putMethods\":[],\"deleteMethods\":[],\"saveMethods\":[],\"fields\":[{\"name\":\"id\",\"type\":\"string\"},{\"name\":\"name\",\"type\":\"string\"},{\"name\":\"address\",\"type\":\"string\"},{\"name\":\"remark\",\"type\":\"string\"}]}","load":"getresourceserver_load"});
		pubservers=new vmd.store.jsonStore({"xtype":"vmd.jsonStore","id":"pubservers","xcls":"vmd.store.jsonStore","autoLoad":true,"cid":"vmdJsonStore","storeConfig":"{\"id\":\"mpChgtJuL5\",\"callcode\":\"vmdCode\",\"url\":\"CDEServcie/project/projectconfig/runserverconfig\",\"host\":\"\",\"name\":\"项目运行环境配置\",\"isHwRest\":true,\"getMethods\":[{\"id\":\"project_id\",\"name\":\"项目id\",\"type\":\"String\",\"value1\":\"//返回值 \\r\\n return vmd.getUrlParam(\\\"projectid\\\")||'hWlI8gBXWj'\",\"value2\":\"\",\"testValue\":\"\",\"defaultvalue\":\"\"}],\"postMethods\":[],\"putMethods\":[],\"deleteMethods\":[],\"saveMethods\":[],\"fields\":[{\"name\":\"config_id\",\"cname\":\"\",\"type\":\"string\",\"primary\":\"\",\"nullable\":\"Y\",\"length\":\"\",\"precision\":\"\",\"unit\":\"\",\"rule\":{}},{\"name\":\"project_id\",\"cname\":\"\",\"type\":\"string\",\"primary\":\"\",\"nullable\":\"Y\",\"length\":\"\",\"precision\":\"\",\"unit\":\"\",\"rule\":{}},{\"name\":\"type\",\"cname\":\"\",\"type\":\"int32\",\"primary\":\"\",\"nullable\":\"Y\",\"length\":\"\",\"precision\":\"\",\"unit\":\"\",\"rule\":{}},{\"name\":\"name\",\"cname\":\"\",\"type\":\"string\",\"primary\":\"\",\"nullable\":\"Y\",\"length\":\"\",\"precision\":\"\",\"unit\":\"\",\"rule\":{}},{\"name\":\"ptservice\",\"cname\":\"\",\"type\":\"string\",\"primary\":\"\",\"nullable\":\"Y\",\"length\":\"\",\"precision\":\"\",\"unit\":\"\",\"rule\":{}},{\"name\":\"subsysid\",\"cname\":\"\",\"type\":\"string\",\"primary\":\"\",\"nullable\":\"Y\",\"length\":\"\",\"precision\":\"\",\"unit\":\"\",\"rule\":{}},{\"name\":\"virtualdir\",\"cname\":\"\",\"type\":\"string\",\"primary\":\"\",\"nullable\":\"Y\",\"length\":\"\",\"precision\":\"\",\"unit\":\"\",\"rule\":{}},{\"name\":\"dasserver\",\"cname\":\"\",\"type\":\"string\",\"primary\":\"\",\"nullable\":\"Y\",\"length\":\"\",\"precision\":\"\",\"unit\":\"\",\"rule\":{}},{\"name\":\"wfserver\",\"cname\":\"\",\"type\":\"string\",\"primary\":\"\",\"nullable\":\"Y\",\"length\":\"\",\"precision\":\"\",\"unit\":\"\",\"rule\":{}},{\"name\":\"msgserver\",\"cname\":\"\",\"type\":\"string\",\"primary\":\"\",\"nullable\":\"Y\",\"length\":\"\",\"precision\":\"\",\"unit\":\"\",\"rule\":{}},{\"name\":\"todoserver\",\"cname\":\"\",\"type\":\"string\",\"primary\":\"\",\"nullable\":\"Y\",\"length\":\"\",\"precision\":\"\",\"unit\":\"\",\"rule\":{}},{\"name\":\"authserver\",\"cname\":\"\",\"type\":\"string\",\"primary\":\"\",\"nullable\":\"Y\",\"length\":\"\",\"precision\":\"\",\"unit\":\"\",\"rule\":{}},{\"name\":\"docserver\",\"cname\":\"\",\"type\":\"string\",\"primary\":\"\",\"nullable\":\"Y\",\"length\":\"\",\"precision\":\"\",\"unit\":\"\",\"rule\":{}},{\"name\":\"reportserver\",\"cname\":\"\",\"type\":\"string\",\"primary\":\"\",\"nullable\":\"Y\",\"length\":\"\",\"precision\":\"\",\"unit\":\"\",\"rule\":{}},{\"name\":\"logserver\",\"cname\":\"\",\"type\":\"string\",\"primary\":\"\",\"nullable\":\"Y\",\"length\":\"\",\"precision\":\"\",\"unit\":\"\",\"rule\":{}},{\"name\":\"resourceserver\",\"cname\":\"\",\"type\":\"string\",\"primary\":\"\",\"nullable\":\"Y\",\"length\":\"\",\"precision\":\"\",\"unit\":\"\",\"rule\":{}},{\"name\":\"micserviceinfo\",\"cname\":\"\",\"type\":\"string\",\"primary\":\"\",\"nullable\":\"Y\",\"length\":\"\",\"precision\":\"\",\"unit\":\"\",\"rule\":{}},{\"name\":\"ppdm_guid\",\"cname\":\"\",\"type\":\"string\",\"primary\":\"\",\"nullable\":\"Y\",\"length\":\"\",\"precision\":\"\",\"unit\":\"\",\"rule\":{}},{\"name\":\"remark\",\"cname\":\"\",\"type\":\"string\",\"primary\":\"\",\"nullable\":\"Y\",\"length\":\"\",\"precision\":\"\",\"unit\":\"\",\"rule\":{}},{\"name\":\"source\",\"cname\":\"\",\"type\":\"string\",\"primary\":\"\",\"nullable\":\"Y\",\"length\":\"\",\"precision\":\"\",\"unit\":\"\",\"rule\":{}},{\"name\":\"row_changed_by\",\"cname\":\"\",\"type\":\"string\",\"primary\":\"\",\"nullable\":\"Y\",\"length\":\"\",\"precision\":\"\",\"unit\":\"\",\"rule\":{}},{\"name\":\"row_changed_date\",\"cname\":\"\",\"type\":\"datetime\",\"primary\":\"\",\"nullable\":\"Y\",\"length\":\"\",\"precision\":\"\",\"unit\":\"\",\"rule\":{}},{\"name\":\"row_created_by\",\"cname\":\"\",\"type\":\"string\",\"primary\":\"\",\"nullable\":\"Y\",\"length\":\"\",\"precision\":\"\",\"unit\":\"\",\"rule\":{}},{\"name\":\"row_created_date\",\"cname\":\"\",\"type\":\"datetime\",\"primary\":\"\",\"nullable\":\"Y\",\"length\":\"\",\"precision\":\"\",\"unit\":\"\",\"rule\":{}},{\"name\":\"row_effective_date\",\"cname\":\"\",\"type\":\"datetime\",\"primary\":\"\",\"nullable\":\"Y\",\"length\":\"\",\"precision\":\"\",\"unit\":\"\",\"rule\":{}},{\"name\":\"row_expiry_date\",\"cname\":\"\",\"type\":\"datetime\",\"primary\":\"\",\"nullable\":\"Y\",\"length\":\"\",\"precision\":\"\",\"unit\":\"\",\"rule\":{}},{\"name\":\"row_quality\",\"cname\":\"\",\"type\":\"string\",\"primary\":\"\",\"nullable\":\"Y\",\"length\":\"\",\"precision\":\"\",\"unit\":\"\",\"rule\":{}}]}"});


		this.items=[
			{
				xtype:"tabpanel",
				id:"MyTabs",
				activeTab:0,
				height:150,
				width:500,
				x:170,
				y:120,
				region:"center",
				margins:"10 20 10 20",
				border:false,
				unstyled:false,
				collapsible:false,
				collapseMode:"standard",
				cls:"aaaaa",
				tabchange:"MyTabs_tabchange",
				bodyStyle:"font-size: 14px",
				style:"font-size: 14px",
				afterrender:"MyTabs_afterrender",
				listeners:{
					tabchange:MyTabs_tabchange,
					vmdafterrender:MyTabs_afterrender
				},
				items:[
					{
						xtype:"panel",
						id:"panel",
						title:"开发环境",
						header:true,
						border:false,
						height:100,
						layout:"fit",
						beforerender:"panel_beforerender",
						listeners:{
							beforerender:panel_beforerender
						},
						items:[
							{
								xtype:"vmd.div",
								id:"hwDiv1",
								autoEl:"div",
								border:true,
								backgroundRepeat:"no-repeat",
								backgroundPosition:"top left",
								width:400,
								height:50,
								layout:"auto",
								style:"background-color: #F5F5F5;    overflow: auto",
								items:[
									{
										xtype:"vmd.div",
										id:"hwDiv4",
										layoutConfig:{
											align:"middle"
										},
										autoEl:"div",
										border:false,
										backgroundRepeat:"no-repeat",
										backgroundPosition:"top left",
										width:400,
										height:30,
										layout:"hbox",
										hidden:false,
										autoWidth:true,
										items:[
											{
												xtype:"label",
												id:"hwLabel2",
												text:"微服务配置",
												cls:"micrser-label",
												margins:"0 15 0 0"
											},
											{
												xtype:"vmd.button",
												id:"button13",
												text:"添加",
												type:"text",
												size:"small",
												icon:"icon-plus",
												click:"button13_click",
												afterrender:"button13_afterrender",
												style:"font-size: 14px;",
												listeners:{
													click:button13_click,
													vmdafterrender:button13_afterrender
												}
											}
										]
									},
									{
										xtype:"panel",
										id:"panel5",
										title:"微服务配置",
										header:false,
										border:false,
										height:234,
										layout:"auto",
										autoHeight:true,
										autoWidth:false,
										afterrender:"panel5_afterrender",
										hidden:true,
										style:"border-radius: 8px;",
										listeners:{
											vmdafterrender:panel5_afterrender
										}
									},
									{
										xtype:"vmd.div",
										id:"hwDiv6",
										autoEl:"div",
										border:false,
										backgroundRepeat:"no-repeat",
										backgroundPosition:"top left",
										width:400,
										height:50,
										style:"min-height: 40px;",
										autoScroll:false,
										cls:"mircser-layout",
										autoWidth:true,
										autoHeight:true,
										items:[
											{
												xtype:"vmd.div",
												id:"div10",
												autoEl:"div",
												border:false,
												backgroundRepeat:"no-repeat",
												backgroundPosition:"top left",
												width:400,
												height:641,
												region:"center",
												style:"border-top: 0px;    font-size: 14px;",
												layout:"auto",
												autoHeight:true,
												autoWidth:true,
												items:[
													{
														xtype:"vmd.div",
														id:"MicrservList1",
														autoEl:"div",
														border:false,
														backgroundRepeat:"no-repeat",
														backgroundPosition:"top left",
														width:800,
														layout:"auto",
														autoHeight:false,
														autoWidth:false,
														cls:"micrser-div"
													},
													{
														xtype:"vmd.button",
														id:"button10",
														text:"添加",
														type:"(none)",
														size:"small",
														x:"",
														y:"",
														style:"font-size: 14px;    margin: 10px 70px;",
														click:"button10_click",
														icon:"icon-plus",
														width:63,
														hidden:true,
														listeners:{
															click:button10_click
														}
													}
												]
											}
										]
									},
									{
										xtype:"vmd.div",
										id:"hwDiv5",
										layoutConfig:{
											align:"middle"
										},
										autoEl:"div",
										border:false,
										backgroundRepeat:"no-repeat",
										backgroundPosition:"top left",
										width:400,
										height:30,
										layout:"hbox",
										hidden:false,
										autoWidth:true,
										items:[
											{
												xtype:"label",
												id:"hwLabel3",
												text:"资源配置",
												cls:"micrser-label",
												margins:"0 28 0 0"
											},
											{
												xtype:"vmd.button",
												id:"button14",
												text:"添加",
												type:"text",
												size:"small",
												icon:"icon-plus",
												click:"button14_click",
												afterrender:"button14_afterrender",
												style:"font-size: 14px;",
												listeners:{
													click:button14_click,
													vmdafterrender:button14_afterrender
												}
											}
										]
									},
									{
										xtype:"vmd.div",
										id:"hwDiv7",
										autoEl:"div",
										border:false,
										backgroundRepeat:"no-repeat",
										backgroundPosition:"top left",
										width:400,
										height:50,
										cls:"mircser-layout",
										style:"margin-bottom: 40px;    min-height: 40px;",
										autoWidth:true,
										autoHeight:true,
										items:[
											{
												xtype:"vmd.div",
												id:"div9",
												autoEl:"div",
												border:false,
												backgroundRepeat:"no-repeat",
												backgroundPosition:"top left",
												width:400,
												height:50,
												region:"center",
												layout:"auto",
												autoWidth:true,
												autoHeight:true,
												x:0,
												items:[
													{
														xtype:"vmd.div",
														id:"hwDiv3",
														layoutConfig:{
															align:"middle",
															pack:"start"
														},
														autoEl:"div",
														border:false,
														backgroundRepeat:"no-repeat",
														backgroundPosition:"top left",
														width:555,
														height:42,
														layout:"hbox",
														cls:"resource-group",
														hidden:true,
														items:[
															{
																xtype:"label",
																id:"hwLabel",
																text:"资源名称："
															},
															{
																xtype:"textfield",
																id:"hwText",
																allowBlank:true,
																enableKeyEvents:true,
																readOnly:true
															},
															{
																xtype:"label",
																id:"hwLabel1",
																text:"资源地址："
															},
															{
																xtype:"textfield",
																id:"hwText1",
																allowBlank:true,
																enableKeyEvents:true,
																readOnly:true
															},
															{
																xtype:"vmd.button",
																id:"button",
																text:"编辑",
																type:"text",
																size:"small",
																icon:"edit",
																cls:"resource-btn",
																margins:"0 5"
															},
															{
																xtype:"vmd.button",
																id:"button12",
																text:"删除",
																type:"text",
																size:"small",
																icon:"delete",
																cls:"resource-btn",
																margins:"0 5"
															}
														]
													}
												]
											}
										]
									},
									{
										xtype:"panel",
										id:"panel6",
										title:"资源配置",
										header:false,
										border:false,
										height:100,
										layout:"fit",
										x:0,
										y:0,
										autoWidth:false,
										autoHeight:false,
										afterrender:"panel6_afterrender",
										hidden:true,
										listeners:{
											vmdafterrender:panel6_afterrender
										},
										items:[
											{
												xtype:"vmd.div",
												id:"div7",
												autoEl:"div",
												border:false,
												backgroundRepeat:"no-repeat",
												backgroundPosition:"top left",
												width:0,
												height:50,
												region:"south",
												layout:"auto",
												style:"border-top: 1px solid #dddddd;    border-right: 1px solid #dddddd;    font-size: 14px",
												hidden:true,
												autoWidth:false,
												autoHeight:false,
												items:[
													{
														xtype:"vmd.div",
														id:"div8",
														autoEl:"div",
														border:false,
														backgroundRepeat:"no-repeat",
														backgroundPosition:"top left",
														width:950,
														height:43,
														region:"north",
														style:"border-bottom: 1px solid #dddddd;    margin-bottom: 60px;    padding-left: 60px;",
														layout:"hbox",
														hidden:true,
														autoWidth:false,
														items:[
															{
																xtype:"vmd.button",
																id:"button5",
																text:"添加",
																type:"(none)",
																size:"small",
																icon:"icon-plus",
																margins:"5",
																style:"font-size: 14px",
																click:"button5_click",
																region:"center",
																listeners:{
																	click:button5_click
																}
															},
															{
																xtype:"vmd.button",
																id:"button8",
																text:"编辑",
																type:"(none)",
																size:"small",
																icon:"icon-edit",
																margins:"5",
																style:"font-size: 14px",
																click:"button8_click",
																region:"west",
																listeners:{
																	click:button8_click
																}
															},
															{
																xtype:"vmd.button",
																id:"button9",
																text:"删除",
																type:"(none)",
																size:"small",
																icon:"icon-minus",
																margins:"5",
																style:"font-size: 14px;",
																click:"button9_click",
																region:"east",
																listeners:{
																	click:button9_click
																}
															}
														]
													}
												]
											},
											{
												xtype:"vmd.ux.ResourceList",
												id:"hwResourceList",
												layoutConfig:{
													align:"middle"
												},
												layout:"absolute",
												hidden:true
											},
											{
												xtype:"grid",
												id:"MyGrid",
												title:"Grid Panel",
												loadMask:true,
												border:false,
												header:false,
												style:"font-size: 14px;    background-color: #ccc",
												store:getresourceserver,
												beforerender:"MyGrid_beforerender",
												hideHeaders:false,
												disableHeaderClick:true,
												enableHdMenu:false,
												height:73,
												region:"center",
												x:0,
												y:0,
												hidden:true,
												width:755,
												listeners:{
													beforerender:MyGrid_beforerender
												},
												columns:[
													{
														xtype:"templatecolumn",
														header:"操作",
														sortable:true,
														resizable:true,
														tpl:"<button class=\"vmd-button vmd-button--success vmd-button--small\" style=\"height:10px\">模块编辑</button>",
														align:"center",
														hidden:true
													},
													{
														xtype:"gridcolumn",
														header:"id",
														sortable:true,
														resizable:true,
														dataIndex:"id",
														width:100
													},
													{
														xtype:"gridcolumn",
														header:"name",
														sortable:true,
														resizable:true,
														dataIndex:"name",
														width:100
													},
													{
														xtype:"gridcolumn",
														header:"address",
														sortable:true,
														resizable:true,
														dataIndex:"address",
														width:100
													},
													{
														xtype:"gridcolumn",
														header:"remark",
														sortable:true,
														resizable:true,
														dataIndex:"remark",
														width:100
													}
												]
											}
										]
									},
									{
										xtype:"vmd.div",
										id:"hwDiv2",
										layoutConfig:{
											align:"middle",
											pack:"end"
										},
										autoEl:"div",
										border:false,
										backgroundRepeat:"no-repeat",
										backgroundPosition:"top left",
										width:400,
										height:50,
										region:"south",
										layout:"hbox",
										margins:"0 10 5 10",
										autoWidth:true,
										autoHeight:false,
										style:"position: fixed;    bottom: 10px;    right: 20px;    left: 20px;    padding: 0 10px;    background-color: #ffffff;    border-top: 1px solid #dddddd;",
										hidden:false,
										items:[
											{
												xtype:"vmd.button",
												id:"button11",
												text:"保存",
												type:"primary",
												size:"small",
												x:420,
												y:0,
												style:"font-size:14px;",
												margins:"0 30 0 0",
												click:"button11_click",
												width:70,
												listeners:{
													click:button11_click
												}
											}
										]
									}
								]
							}
						]
					},
					{
						xtype:"panel",
						id:"panel1",
						title:"发布环境",
						header:true,
						border:true,
						height:666,
						layout:"border",
						autoScroll:true,
						bodyStyle:"background-color: #F5F5F5;",
						items:[
							{
								xtype:"vmd.div",
								id:"div2",
								autoEl:"div",
								border:false,
								backgroundRepeat:"no-repeat",
								backgroundPosition:"top left",
								width:400,
								height:50,
								region:"center",
								layout:"auto",
								autoScroll:true,
								margins:"5 10 0 0",
								style:"overflow-y: auto;    background-color: #F5F5F5;",
								items:[
									{
										xtype:"vmd.div",
										id:"div13",
										layoutConfig:{
											align:"middle",
											pack:"start"
										},
										autoEl:"div",
										border:true,
										backgroundRepeat:"no-repeat",
										backgroundPosition:"top left",
										width:400,
										height:34,
										region:"north",
										layout:"hbox",
										style:"background-color: #d9e8fb",
										autoHeight:false,
										autoWidth:true,
										hidden:true,
										items:[
											{
												xtype:"label",
												id:"label11",
												text:"测试发布配置   发布环境配置",
												height:20,
												style:"font-size: 14px;",
												x:10,
												y:5
											}
										]
									},
									{
										xtype:"vmd.div",
										id:"hwDiv8",
										layoutConfig:{
											align:"middle"
										},
										autoEl:"div",
										border:false,
										backgroundRepeat:"no-repeat",
										backgroundPosition:"top left",
										width:400,
										height:50,
										layout:"hbox",
										hidden:false,
										autoWidth:true,
										autoHeight:true,
										items:[
											{
												xtype:"label",
												id:"hwLabel4",
												text:"平台配置",
												cls:"micrser-label",
												margins:"0 15 0 0"
											}
										]
									},
									{
										xtype:"vmd.div",
										id:"hwDiv11",
										autoEl:"div",
										border:false,
										backgroundRepeat:"no-repeat",
										backgroundPosition:"top left",
										width:400,
										height:50,
										cls:"mircser-layout",
										autoWidth:true,
										autoHeight:true,
										items:[
											{
												xtype:"panel",
												id:"panel4",
												title:"平台配置",
												header:false,
												border:false,
												height:400,
												layout:"absolute",
												style:"font-size: 14px;",
												region:"west",
												autoHeight:false,
												items:[
													{
														xtype:"label",
														id:"label",
														text:"平台服务地址：",
														x:20,
														y:20
													},
													{
														xtype:"textfield",
														id:"txt_ptserver",
														allowBlank:true,
														enableKeyEvents:true,
														x:110,
														y:20,
														width:370
													},
													{
														xtype:"label",
														id:"label1",
														text:"注册子系统选择：",
														x:20,
														y:60,
														height:20
													},
													{
														xtype:"vmd.div",
														id:"div5",
														autoEl:"div",
														border:true,
														backgroundRepeat:"no-repeat",
														backgroundPosition:"top left",
														width:450,
														height:200,
														x:30,
														y:90,
														layout:"fit",
														items:[
															{
																xtype:"vmd.treeex",
																id:"tree",
																width:478,
																height:270,
																hideRoot:true,
																loadType:"全部加载",
																textField:"subsysname",
																valueField:"subsysid",
																parentField:"parentid",
																rootValue:"0",
																rootText:"子系统",
																beforerender:"tree_beforerender",
																folderImg:"/system/modules/eQ9ULgcVb1/img/folderClosed.gif",
																leafImg:"/system/modules/eQ9ULgcVb1/img/folderClosed.gif",
																listeners:{
																	beforerender:tree_beforerender
																}
															}
														]
													},
													{
														xtype:"label",
														id:"label2",
														text:"虚拟目录：",
														x:20,
														y:310,
														hidden:false
													},
													{
														xtype:"textfield",
														id:"txt_vir",
														allowBlank:true,
														enableKeyEvents:true,
														x:100,
														y:310,
														width:380
													},
													{
														xtype:"vmd.button",
														id:"button3",
														text:"重新加载",
														type:"text",
														size:"small",
														x:130,
														y:55,
														icon:"icon-refresh",
														style:"font-size: 14px; background-image: url() !important;",
														width:90,
														height:30,
														cls:"ccccc",
														click:"button3_click",
														listeners:{
															click:button3_click
														}
													}
												]
											}
										]
									},
									{
										xtype:"vmd.div",
										id:"hwDiv9",
										layoutConfig:{
											align:"middle"
										},
										autoEl:"div",
										border:false,
										backgroundRepeat:"no-repeat",
										backgroundPosition:"top left",
										width:400,
										height:50,
										layout:"hbox",
										hidden:false,
										autoWidth:true,
										autoHeight:true,
										items:[
											{
												xtype:"label",
												id:"hwLabel5",
												text:"微服务配置",
												cls:"micrser-label",
												margins:"0 15 0 0"
											},
											{
												xtype:"vmd.button",
												id:"button15",
												text:"从平台提取",
												type:"text",
												size:"small",
												style:"font-size: 14px;    font-weight: 500;    float: right",
												icon:"icon-plus"
											}
										]
									},
									{
										xtype:"vmd.div",
										id:"hwDiv12",
										autoEl:"div",
										border:false,
										backgroundRepeat:"no-repeat",
										backgroundPosition:"top left",
										width:400,
										height:50,
										cls:"mircser-layout",
										autoHeight:true,
										autoWidth:true,
										style:"min-height: 40px;",
										items:[
											{
												xtype:"panel",
												id:"panel2",
												title:"微服务配置",
												header:false,
												border:false,
												height:149,
												layout:"auto",
												bodyStyle:"font-size:14px",
												autoHeight:true,
												autoWidth:true,
												afterrender:"panel2_afterrender",
												listeners:{
													vmdafterrender:panel2_afterrender
												},
												items:[
													{
														xtype:"vmd.button",
														id:"button1",
														text:"从平台提取",
														type:"primary",
														size:"small",
														x:360,
														y:10,
														style:"display: inline-block;    float: right;    margin: 10px 6vw 10px 0;",
														click:"button1_click",
														hidden:true,
														listeners:{
															click:button1_click
														}
													},
													{
														xtype:"vmd.div",
														id:"MicrservList",
														autoEl:"div",
														border:false,
														backgroundRepeat:"no-repeat",
														backgroundPosition:"top left",
														width:600,
														height:117,
														layout:"auto",
														autoHeight:true,
														autoWidth:true,
														cls:"micrser-config"
													}
												]
											}
										]
									},
									{
										xtype:"vmd.div",
										id:"hwDiv10",
										layoutConfig:{
											align:"middle"
										},
										autoEl:"div",
										border:false,
										backgroundRepeat:"no-repeat",
										backgroundPosition:"top left",
										width:400,
										height:50,
										layout:"hbox",
										hidden:false,
										autoHeight:true,
										autoWidth:true,
										items:[
											{
												xtype:"label",
												id:"hwLabel6",
												text:"资源配置",
												cls:"micrser-label",
												margins:"0 15 0 0"
											}
										]
									},
									{
										xtype:"vmd.div",
										id:"hwDiv13",
										autoEl:"div",
										border:false,
										backgroundRepeat:"no-repeat",
										backgroundPosition:"top left",
										width:400,
										height:50,
										cls:"mircser-layout",
										style:"margin-bottom: 20px;    min-height: 40px;",
										autoHeight:true,
										autoWidth:true,
										items:[
											{
												xtype:"panel",
												id:"panel3",
												title:"资源配置",
												header:false,
												border:false,
												height:100,
												layout:"auto",
												autoScroll:true,
												style:"overflow-x: hidden",
												bodyStyle:"overflow-x: hidden",
												autoHeight:true,
												autoWidth:true,
												items:[
													{
														xtype:"vmd.div",
														id:"hwDiv",
														autoEl:"div",
														border:false,
														backgroundRepeat:"no-repeat",
														backgroundPosition:"top left",
														width:400,
														height:50,
														layout:"auto",
														style:"overflow-x: hidden",
														autoHeight:true,
														autoWidth:true,
														items:[
															{
																xtype:"vmd.ux.PublishResource",
																id:"PublishResource1",
																layout:"absolute",
																margins:"10"
															},
															{
																xtype:"vmd.ux.PublishResource",
																id:"PublishResource2",
																layout:"absolute",
																margins:"10"
															},
															{
																xtype:"vmd.ux.PublishResource",
																id:"PublishResource",
																layout:"absolute",
																margins:"10",
																style:"font-size:14px;margin: 10px"
															}
														]
													}
												]
											}
										]
									}
								]
							},
							{
								xtype:"vmd.div",
								id:"div3",
								autoEl:"div",
								border:false,
								backgroundRepeat:"no-repeat",
								backgroundPosition:"top left",
								width:200,
								height:50,
								region:"west",
								layout:"border",
								margins:"0 5 0 0",
								cls:"mircser-layout",
								autoHeight:false,
								autoWidth:false,
								items:[
									{
										xtype:"vmd.div",
										id:"div",
										autoEl:"div",
										border:false,
										backgroundRepeat:"no-repeat",
										backgroundPosition:"top left",
										width:400,
										height:34,
										region:"north",
										layout:"hbox",
										style:"border-bottom: 1px solid #dddddd;",
										items:[
											{
												xtype:"vmd.button",
												id:"button2",
												text:"添加",
												type:"text",
												size:"small",
												margins:"5 0 0 10",
												icon:"icon-plus",
												style:"font-size: 14px;",
												click:"button2_click",
												listeners:{
													click:button2_click
												}
											},
											{
												xtype:"vmd.button",
												id:"button6",
												text:"编辑",
												type:"text",
												size:"small",
												style:"font-size: 14px;",
												margins:"5 0 0 10",
												icon:"icon-edit",
												click:"button6_click",
												listeners:{
													click:button6_click
												}
											},
											{
												xtype:"vmd.button",
												id:"button4",
												text:"删除",
												type:"text",
												size:"small",
												icon:"icon-minus",
												margins:"5 0 0 10",
												style:"font-size: 14px;",
												click:"button4_click",
												listeners:{
													click:button4_click
												}
											}
										]
									},
									{
										xtype:"vmd.div",
										id:"div4",
										autoEl:"div",
										border:false,
										backgroundRepeat:"no-repeat",
										backgroundPosition:"top left",
										width:400,
										height:50,
										region:"center",
										layout:"fit",
										style:"font-size: 14px;",
										items:[
											{
												xtype:"vmd.dataview",
												id:"hwDataView",
												width:350,
												height:260,
												itemSelector:"li.info",
												overClass:"info-hover",
												selectedClass:"x-view-selected",
												singleSelect:true,
												multiSelect:true,
												autoScroll:true,
												tpl:"<ul>    <tpl for=\".\">        <li class='info serverlist-info'>{name}</li>    </tpl></ul>",
												data:"var data = [{    \"name\": \"Border Layout\"}, {    \"name\": \"layout-accordion.gif\"}];return data;",
												store:pubservers,
												click:"hwDataView_click",
												afterrender:"hwDataView_afterrender",
												autoHeight:true,
												listeners:{
													click:hwDataView_click,
													vmdafterrender:hwDataView_afterrender
												}
											}
										]
									}
								]
							},
							{
								xtype:"vmd.div",
								id:"div1",
								layoutConfig:{
									align:"middle",
									pack:"end"
								},
								autoEl:"div",
								border:false,
								backgroundRepeat:"no-repeat",
								backgroundPosition:"top left",
								width:400,
								height:30,
								region:"south",
								layout:"hbox",
								margins:"10",
								style:"border-top: 1px solid #ccc;    overflow: visible",
								items:[
									{
										xtype:"vmd.button",
										id:"button7",
										text:"保存",
										type:"primary",
										size:"small",
										x:420,
										y:0,
										style:"font-size: 14px;",
										margins:"5 30 0 0",
										click:"button7_click",
										width:70,
										listeners:{
											click:button7_click
										}
									}
								]
							}
						]
					}
				]
			},
			{
				xtype:"vmd.ux.MicroservicesList",
				id:"hwMicroservicesList1",
				layout:"auto",
				hidden:true,
				region:"west"
			}
		]
		this.callParent();
		var me = this;vmd.core.moduleInit(this.items, this);
			me.on('afterrender',function(){ MainViewport_afterrender.call(me,me)})
}
})
        Ext.onReady(function () {
            Ext.create('vmd.module.MainViewport', {
                renderTo: document.body
            })


        })

      </script>
</head>
<body>
</body>
</html>
