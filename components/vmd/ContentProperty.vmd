{"vmdversion":"vmd2.0.7.200328","vmdlayout":"{\"components\":[{\"cid\":\"uxpanel\",\"id\":\"ContentProperty\",\"layoutConfig\":{},\"userConfig\":{\"layout\":\"fit\",\"header\":false,\"width\":291,\"height\":656,\"autoScroll\":false,\"unstyled\":false,\"autoHeight\":false,\"cls\":\"contentprp\",\"title\":\"\",\"beforerender\":\"ContentProperty_beforerender\"},\"cn\":[{\"cid\":\"panel\",\"id\":\"showRptId\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"showRptId\",\"title\":\"reportID显示\",\"header\":false,\"autoHeight\":true},\"cn\":[{\"cid\":\"tabpanel\",\"id\":\"MyTabs1\",\"layoutConfig\":{},\"userConfig\":{\"x\":0,\"y\":0,\"width\":290,\"height\":800,\"activeTab\":0,\"tabchange\":\"MyTabs1_tabchange\"},\"cn\":[{\"cid\":\"panel\",\"id\":\"panel2\",\"layoutConfig\":{},\"userConfig\":{\"title\":\"单元格\",\"height\":800,\"border\":false,\"layout\":\"fit\"},\"cn\":[{\"cid\":\"tabpanel\",\"id\":\"MyTabs\",\"layoutConfig\":{},\"userConfig\":{\"x\":340,\"y\":50,\"width\":290,\"height\":580,\"activeTab\":0,\"border\":false,\"unstyled\":false,\"collapsible\":false,\"disabled\":false,\"tabchange\":\"MyTabs_tabchange\",\"beforerender\":\"MyTabs_beforerender\",\"afterrender\":\"MyTabs_afterrender\",\"cls\":\"fonttitle\"},\"cn\":[{\"cid\":\"panel\",\"id\":\"panel\",\"layoutConfig\":{},\"userConfig\":{\"title\":\"扩展\",\"layout\":\"absolute\",\"width\":292,\"height\":800,\"border\":false,\"header\":false,\"autoScroll\":true,\"afterrender\":\"panel_afterrender\"},\"cn\":[{\"cid\":\"label\",\"id\":\"label\",\"layoutConfig\":{},\"userConfig\":{\"x\":25,\"y\":140,\"text\":\"实际值：\"}},{\"cid\":\"textfield\",\"id\":\"txtValue\",\"layoutConfig\":{},\"userConfig\":{\"x\":80,\"y\":135,\"width\":165,\"id\":\"txtValue\",\"cls\":\"b\",\"beforerender\":\"txtValue_beforerender\",\"keyup\":\"txtValue_keyup\"}},{\"cid\":\"label\",\"id\":\"label1\",\"layoutConfig\":{},\"userConfig\":{\"x\":25,\"y\":175,\"text\":\"显示值：\"}},{\"cid\":\"textfield\",\"id\":\"txtShowValue\",\"layoutConfig\":{},\"userConfig\":{\"x\":80,\"y\":170,\"width\":165,\"id\":\"txtShowValue\",\"cls\":\"b\"}},{\"cid\":\"label\",\"id\":\"label3\",\"layoutConfig\":{},\"userConfig\":{\"x\":10,\"y\":205,\"text\":\"条件属性\"}},{\"cid\":\"checkbox\",\"id\":\"nr_bgColorCheck\",\"layoutConfig\":{},\"userConfig\":{\"x\":10,\"y\":230,\"boxLabel\":\"背景色：\",\"id\":\"nr_bgColorCheck\",\"check\":\"nr_bgColorCheck_check\"}},{\"cid\":\"checkbox\",\"id\":\"nr_frontColorCheck\",\"layoutConfig\":{},\"userConfig\":{\"x\":10,\"y\":265,\"boxLabel\":\"前景色：\",\"id\":\"nr_frontColorCheck\",\"check\":\"nr_frontColorCheck_check\"}},{\"cid\":\"checkbox\",\"id\":\"nr_leftMarginCheck\",\"layoutConfig\":{},\"userConfig\":{\"x\":10,\"y\":300,\"boxLabel\":\"左缩进：\",\"id\":\"nr_leftMarginCheck\",\"check\":\"nr_leftMarginCheck_check\"}},{\"cid\":\"checkbox\",\"id\":\"nr_heightCheck\",\"layoutConfig\":{},\"userConfig\":{\"x\":10,\"y\":440,\"boxLabel\":\"高度：\",\"id\":\"nr_heightCheck\",\"check\":\"nr_heightCheck_check\"}},{\"cid\":\"checkbox\",\"id\":\"nr_sameValueRight\",\"layoutConfig\":{},\"userConfig\":{\"x\":10,\"y\":530,\"boxLabel\":\"同值向右合并\",\"id\":\"nr_sameValueRight\",\"check\":\"nr_sameValueRight_check\",\"hidden\":false}},{\"cid\":\"checkbox\",\"id\":\"nr_sameValueDown\",\"layoutConfig\":{},\"userConfig\":{\"x\":10,\"y\":500,\"boxLabel\":\"同值向下合并\",\"id\":\"nr_sameValueDown\",\"check\":\"nr_sameValueDown_check\",\"hidden\":false}},{\"cid\":\"checkbox\",\"id\":\"nr_availableCheck\",\"layoutConfig\":{},\"userConfig\":{\"x\":10,\"y\":405,\"boxLabel\":\"可用：\",\"id\":\"nr_availableCheck\",\"check\":\"nr_availableCheck_check\"}},{\"cid\":\"checkbox\",\"id\":\"nr_widthCheck\",\"layoutConfig\":{},\"userConfig\":{\"x\":10,\"y\":370,\"boxLabel\":\"宽度：\",\"id\":\"nr_widthCheck\",\"check\":\"nr_widthCheck_check\"}},{\"cid\":\"checkbox\",\"id\":\"nr_rowTextCheck\",\"layoutConfig\":{},\"userConfig\":{\"x\":10,\"y\":335,\"boxLabel\":\"行字体：\",\"id\":\"nr_rowTextCheck\",\"check\":\"nr_rowTextCheck_check\"}},{\"cid\":\"textfield\",\"id\":\"nr_bgColor\",\"layoutConfig\":{},\"userConfig\":{\"x\":85,\"y\":230,\"width\":160,\"cls\":\"b\",\"id\":\"nr_bgColor\",\"afterrender\":\"nr_bgColor_afterrender\"}},{\"cid\":\"textfield\",\"id\":\"nr_frontColor\",\"layoutConfig\":{},\"userConfig\":{\"x\":85,\"y\":265,\"width\":160,\"cls\":\"b\",\"id\":\"nr_frontColor\"}},{\"cid\":\"textfield\",\"id\":\"nr_leftMargin\",\"layoutConfig\":{},\"userConfig\":{\"x\":85,\"y\":300,\"width\":160,\"cls\":\"b\",\"id\":\"nr_leftMargin\"}},{\"cid\":\"textfield\",\"id\":\"nr_rowText\",\"layoutConfig\":{},\"userConfig\":{\"x\":85,\"y\":335,\"width\":160,\"cls\":\"b\",\"id\":\"nr_rowText\"}},{\"cid\":\"textfield\",\"id\":\"nr_width\",\"layoutConfig\":{},\"userConfig\":{\"x\":85,\"y\":370,\"width\":160,\"cls\":\"b\",\"id\":\"nr_width\"}},{\"cid\":\"textfield\",\"id\":\"nr_available\",\"layoutConfig\":{},\"userConfig\":{\"x\":85,\"y\":405,\"width\":160,\"cls\":\"b\",\"id\":\"nr_available\"}},{\"cid\":\"textfield\",\"id\":\"nr_height\",\"layoutConfig\":{},\"userConfig\":{\"x\":85,\"y\":440,\"width\":160,\"cls\":\"b\",\"id\":\"nr_height\"}},{\"cid\":\"textfield\",\"id\":\"nr_downDependencies\",\"layoutConfig\":{},\"userConfig\":{\"x\":180,\"y\":496,\"width\":90,\"cls\":\"b\",\"id\":\"nr_downDependencies\",\"hidden\":true}},{\"cid\":\"textfield\",\"id\":\"nr_rightDependencies\",\"layoutConfig\":{},\"userConfig\":{\"x\":180,\"y\":530,\"width\":90,\"cls\":\"b\",\"id\":\"nr_rightDependencies\",\"hidden\":true}},{\"cid\":\"label\",\"id\":\"label4\",\"layoutConfig\":{},\"userConfig\":{\"x\":10,\"y\":475,\"text\":\"合并：\",\"hidden\":false}},{\"cid\":\"label\",\"id\":\"aaa\",\"layoutConfig\":{},\"userConfig\":{\"x\":120,\"y\":504,\"text\":\"依赖条件：\",\"id\":\"aaa\",\"hidden\":true}},{\"cid\":\"label\",\"id\":\"bbb\",\"layoutConfig\":{},\"userConfig\":{\"x\":120,\"y\":534,\"text\":\"依赖条件：\",\"id\":\"bbb\",\"hidden\":true}},{\"cid\":\"vmdButton\",\"id\":\"sjz\",\"layoutConfig\":{},\"userConfig\":{\"x\":250,\"y\":135,\"width\":30,\"height\":25,\"text\":\"...\",\"id\":\"sjz\",\"click\":\"sjz_click\"}},{\"cid\":\"vmdButton\",\"id\":\"xsz\",\"layoutConfig\":{},\"userConfig\":{\"x\":250,\"y\":170,\"width\":30,\"height\":25,\"text\":\"...\",\"id\":\"xsz\",\"click\":\"xsz_click\"}},{\"cid\":\"vmdButton\",\"id\":\"bjs\",\"layoutConfig\":{},\"userConfig\":{\"x\":250,\"y\":230,\"width\":30,\"height\":25,\"text\":\"...\",\"id\":\"bjs\",\"click\":\"bjs_click\"}},{\"cid\":\"vmdButton\",\"id\":\"qjs\",\"layoutConfig\":{},\"userConfig\":{\"x\":250,\"y\":270,\"width\":30,\"height\":25,\"text\":\"...\",\"id\":\"qjs\",\"click\":\"qjs_click\"}},{\"cid\":\"vmdButton\",\"id\":\"zsj\",\"layoutConfig\":{},\"userConfig\":{\"x\":250,\"y\":305,\"width\":30,\"height\":25,\"text\":\"...\",\"id\":\"zsj\",\"click\":\"zsj_click\"}},{\"cid\":\"vmdButton\",\"id\":\"hzt\",\"layoutConfig\":{},\"userConfig\":{\"x\":250,\"y\":340,\"width\":30,\"height\":25,\"text\":\"...\",\"id\":\"hzt\",\"click\":\"hzt_click\"}},{\"cid\":\"vmdButton\",\"id\":\"kd\",\"layoutConfig\":{},\"userConfig\":{\"x\":250,\"y\":375,\"width\":30,\"height\":25,\"text\":\"...\",\"id\":\"kd\",\"click\":\"kd_click\"}},{\"cid\":\"vmdButton\",\"id\":\"ky\",\"layoutConfig\":{},\"userConfig\":{\"x\":250,\"y\":410,\"width\":30,\"height\":25,\"text\":\"...\",\"id\":\"ky\",\"click\":\"ky_click\"}},{\"cid\":\"vmdButton\",\"id\":\"gd\",\"layoutConfig\":{},\"userConfig\":{\"x\":250,\"y\":445,\"width\":30,\"height\":25,\"text\":\"...\",\"id\":\"gd\",\"click\":\"gd_click\"}},{\"cid\":\"label\",\"id\":\"label2\",\"layoutConfig\":{},\"userConfig\":{\"x\":70,\"y\":205,\"text\":\"————————————————\",\"style\":\"color: #dddddd;\"}},{\"cid\":\"vmd.ux.ExtraPropertyChange\",\"id\":\"ExtraPropertyChange\",\"layoutConfig\":{},\"userConfig\":{\"x\":5,\"y\":0,\"directionClick\":\"ExtraPropertyChange_directionClick\"}}]},{\"cid\":\"panel\",\"id\":\"panel1\",\"layoutConfig\":{},\"userConfig\":{\"title\":\"属性\",\"layout\":\"fit\",\"autoScroll\":true},\"cn\":[{\"cid\":\"vmd.ux.CellTypeProperty\",\"id\":\"CellTypeProperty\",\"layoutConfig\":{},\"userConfig\":{\"DropDownTree\":\"CellTypeProperty_DropDownTree\"}}]},{\"cid\":\"panel\",\"id\":\"panel3\",\"layoutConfig\":{},\"userConfig\":{\"title\":\"样式\",\"layout\":\"fit\",\"afterrender\":\"panel3_afterrender\",\"autoScroll\":true},\"cn\":[{\"cid\":\"vmd.ux.NewNumber\",\"id\":\"hwNewNumber\",\"layoutConfig\":{},\"userConfig\":{\"decimalChanged\":\"hwNewNumber_decimalChanged\"}}]},{\"cid\":\"panel\",\"id\":\"panel4\",\"layoutConfig\":{},\"userConfig\":{\"title\":\"打印\",\"height\":573,\"header\":true,\"hidden\":false,\"autoScroll\":true},\"cn\":[{\"cid\":\"vmd.ux.PrintConfig\",\"id\":\"PrintConfig\",\"layoutConfig\":{},\"userConfig\":{\"hidden\":false,\"width\":285}}]},{\"cid\":\"panel\",\"id\":\"panel8\",\"layoutConfig\":{},\"userConfig\":{\"title\":\"菜单\",\"layout\":\"fit\",\"html\":\"\",\"autoScroll\":true},\"cn\":[{\"cid\":\"vmd.ux.LinkAndMenu\",\"id\":\"hwLinkAndMenu\",\"layoutConfig\":{},\"userConfig\":{}}]}]}]},{\"cid\":\"panel\",\"id\":\"panel5\",\"layoutConfig\":{},\"userConfig\":{\"title\":\"分栏\",\"layout\":\"fit\",\"border\":false,\"header\":false,\"autoScroll\":true},\"cn\":[{\"cid\":\"vmd.ux.Segmentation\",\"id\":\"Segmentation\",\"layoutConfig\":{},\"userConfig\":{}}]},{\"cid\":\"panel\",\"id\":\"panel9\",\"layoutConfig\":{},\"userConfig\":{\"title\":\"分片\",\"autoScroll\":true},\"cn\":[{\"cid\":\"vmd.ux.FP\",\"id\":\"hwFP\",\"layoutConfig\":{},\"userConfig\":{}}]},{\"cid\":\"panel\",\"id\":\"panel10\",\"layoutConfig\":{},\"userConfig\":{\"title\":\"填报\",\"autoScroll\":true},\"cn\":[{\"cid\":\"vmd.ux.Reporting\",\"id\":\"hwReporting\",\"layoutConfig\":{},\"userConfig\":{}}]},{\"cid\":\"panel\",\"id\":\"panel6\",\"layoutConfig\":{},\"userConfig\":{\"title\":\"打印\",\"autoScroll\":true},\"cn\":[{\"cid\":\"vmd.ux.PrintSetting\",\"id\":\"hwPrintSetting\",\"layoutConfig\":{},\"userConfig\":{}}]}]}]}]}]}","vmdevents":"this.on('afterrender', function() {\r\n    this.cascade(function(item) {\r\n        item.on('change', function(a, b, c) {\r\n            // debugger\r\n            // if (window.event && window.event.srcElement) {\r\n\r\n            // }\r\n            setCellInfo(a, b);\r\n        })\r\n        item.on(\"check\", function(a, b, c) {\r\n            // debugger\r\n            // if (window.event && window.event.srcElement) {\r\n\r\n            // }\r\n            setCellInfo(a, b);\r\n        })\r\n        item.on(\"select\", function(a, b, c) {\r\n            // debugger\r\n            // if (window.event && window.event.srcElement) {\r\n\r\n            // }\r\n            if (typeof b == 'object') {\r\n                setCellInfo(a, a.value);\r\n            } else {\r\n                setCellInfo(a, b);\r\n            }\r\n        })\r\n    })\r\n})\r\nvar page = this;\r\nvar hot = page.o;\r\npage.alreadySetSubmit = true;\r\n\r\nfunction setCellInfo(sender, value) {\r\n    var hot = page.o;\r\n    var canWrite = false;\r\n    var cell = hot.dealInvert()[0];\r\n    if (page.cells) {\r\n        for (var i = 0; i < page.cells.length; i++) {\r\n            var r = page.cells[i].r;\r\n            var c = page.cells[i].c;\r\n            if (hot.getCellMeta(r, c).mergeId != 2) {\r\n                var temp = page.o.getCellMeta(r, c).cellAttributeInfo\r\n                if (sender.initialConfig.id == 'txtValue') {\r\n                    temp.textValue.value = value;\r\n                    page.o.setCellMeta(r, c, 'cellAttributeInfo', temp)\r\n                    page.o.setDataAtCell(r, c, value)\r\n                    page.o.setCellMeta(r, c, 'theCellChanged', true)\r\n                } else if (sender.initialConfig.id == 'txtShowValue') {\r\n                    temp.showValue.value = value;\r\n                    page.o.setCellMeta(r, c, 'cellAttributeInfo', temp)\r\n                    page.o.setCellMeta(r, c, 'theCellChanged', true)\r\n                } else {\r\n                    if (temp && temp.setCellInfos) {\r\n                        if (value && value.inputValue) {\r\n                            temp.setCellInfos(sender.initialConfig.id, value.inputValue)\r\n                        } else {\r\n                            temp.setCellInfos(sender.initialConfig.id, value)\r\n                        }\r\n                        page.o.setCellMeta(r, c, 'cellAttributeInfo', temp)\r\n                        page.o.setCellMeta(r, c, 'theCellChanged', true)\r\n                    }\r\n                }\r\n                if (sender.initialConfig.id == 'data_dataSet') {\r\n                    switch (page.o.getCellMeta(r, c).cellAttributeInfo.contentInfo.cmbType.value) {\r\n                        case 'xlwg':\r\n                            page.o.changeAttributeInfo(r, c, 'ddg_dataSet', value)\r\n                            break;\r\n                        case 'dxan':\r\n                            page.o.changeAttributeInfo(r, c, 'dxan_dataSet', value)\r\n                            break;\r\n                    }\r\n                }\r\n                if (sender.initialConfig.id == 'data_typeSetting') {\r\n                    switch (page.o.getCellMeta(r, c).cellAttributeInfo.contentInfo.cmbType.value) {\r\n                        case 'xlwg':\r\n                            page.o.changeAttributeInfo(r, c, 'ddg_typeSetting', value)\r\n                            break;\r\n                        case 'dxan':\r\n                            page.o.changeAttributeInfo(r, c, 'dxan_typeSetting', value)\r\n                            break;\r\n                    }\r\n                }\r\n                if (sender.initialConfig.id == 'data_saveFiled') {\r\n                    switch (page.o.getCellMeta(r, c).cellAttributeInfo.contentInfo.cmbType.value) {\r\n                        case 'xlwg':\r\n                            page.o.changeAttributeInfo(r, c, 'ddg_saveFiled', value)\r\n                            break;\r\n                        case 'dxan':\r\n                            page.o.changeAttributeInfo(r, c, 'dxan_saveFiled', value)\r\n                            break;\r\n                    }\r\n                }\r\n                if (sender.initialConfig.id == 'data_myDisplayFiled') {\r\n                    switch (page.o.getCellMeta(r, c).cellAttributeInfo.contentInfo.cmbType.value) {\r\n                        case 'xlwg':\r\n                            page.o.changeAttributeInfo(r, c, 'ddg_myDisplayFiled', value)\r\n                            break;\r\n                        case 'dxan':\r\n                            page.o.changeAttributeInfo(r, c, 'dxan_myDisplayFiled', value)\r\n                            break;\r\n                    }\r\n                }\r\n                if (sender.initialConfig.id == 'data_dropDownDisplayColumn') {\r\n                    switch (page.o.getCellMeta(r, c).cellAttributeInfo.contentInfo.cmbType.value) {\r\n                        case 'xlwg':\r\n                            page.o.changeAttributeInfo(r, c, 'ddg_dropDownDisplayColumn', value)\r\n                            break;\r\n                        case 'dxan':\r\n                            page.o.changeAttributeInfo(r, c, 'dxan_dropDownDisplayColumn', value)\r\n                            break;\r\n                    }\r\n                }\r\n                if (sender.initialConfig.id == 'data_filterConditon') {\r\n                    switch (page.o.getCellMeta(r, c).cellAttributeInfo.contentInfo.cmbType.value) {\r\n                        case 'xlwg':\r\n                            page.o.changeAttributeInfo(r, c, 'ddg_filterConditon', value)\r\n                            break;\r\n                        case 'dxan':\r\n                            page.o.changeAttributeInfo(r, c, 'dxan_filterConditon', value)\r\n                            break;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if (sender.initialConfig.id == 'qtb_template') {\r\n            if (page.o.nestedNo != null && page.o.nestedTableArray[page.o.nestedNo]) {\r\n                page.o.nestedTableArray[page.o.nestedNo].qtb_template = value;\r\n            }\r\n        }\r\n        if (sender.initialConfig.id == 'qtb_tableName') {\r\n            if (page.o.nestedNo != null && page.o.nestedTableArray[page.o.nestedNo]) {\r\n                page.o.nestedTableArray[page.o.nestedNo].qtb_tableName = value;\r\n            }\r\n        }\r\n        if (sender.initialConfig.id == 'seg_fp' && value == false) {\r\n            page.o.setCellMeta(r, c, 'theCellChanged', false)\r\n        }\r\n        if (sender.initialConfig.id == 'seg_emptyRow') {\r\n            var arr = page.o.fpArray;\r\n            var cell = page.o.dealInvert()[0]\r\n            if (!page.o.oldArea) {\r\n                for (var i = 0; i < arr.length; i++) {\r\n                    if (cell.sr == arr[i].sr && cell.sc == arr[i].sc && cell.er == arr[i].er && cell.ec == arr[i].ec) {\r\n                        arr[i].emptyRow = value;\r\n                        var obj = {\r\n                            sr: arr[i].sr,\r\n                            er: arr[i].er,\r\n                            sc: arr[i].sc,\r\n                            ec: arr[i].ec,\r\n                            sliceName: arr[i].sliceName,\r\n                            emptyRow: value,\r\n                            emptyCol: arr[i].emptyCol\r\n                        }\r\n                        arr.splice(i, 1, obj)\r\n                    }\r\n                }\r\n                page.o.oldArea = cell;\r\n            } else {\r\n                var old = page.o.oldArea;\r\n                if (old.sr == cell.sr && old.sc == cell.sc && old.er == cell.er && old.ec == cell.ec) {\r\n                    for (var i = 0; i < arr.length; i++) {\r\n                        if (cell.sr == arr[i].sr && cell.sc == arr[i].sc && cell.er == arr[i].er && cell.ec == arr[i].ec) {\r\n                            arr[i].emptyRow = value;\r\n                            var obj = {\r\n                                sr: arr[i].sr,\r\n                                er: arr[i].er,\r\n                                sc: arr[i].sc,\r\n                                ec: arr[i].ec,\r\n                                sliceName: arr[i].sliceName,\r\n                                emptyRow: value,\r\n                                emptyCol: arr[i].emptyCol\r\n                            }\r\n                            arr.splice(i, 1, obj)\r\n                        }\r\n                    }\r\n                    page.o.oldArea = cell;\r\n                }\r\n            }\r\n        }\r\n        if (sender.initialConfig.id == 'seg_emptyCol') {\r\n            var arr = page.o.fpArray;\r\n            var cell = page.o.dealInvert()[0]\r\n            if (!page.o.oldArea) {\r\n                for (var i = 0; i < arr.length; i++) {\r\n                    if (cell.sr == arr[i].sr && cell.sc == arr[i].sc && cell.er == arr[i].er && cell.ec == arr[i].ec) {\r\n                        arr[i].emptyCol = value;\r\n                        var obj = {\r\n                            sr: arr[i].sr,\r\n                            er: arr[i].er,\r\n                            sc: arr[i].sc,\r\n                            ec: arr[i].ec,\r\n                            sliceName: arr[i].sliceName,\r\n                            emptyRow: arr[i].emptyRow,\r\n                            emptyCol: value\r\n                        }\r\n                        arr.splice(i, 1, obj)\r\n                    }\r\n                }\r\n                page.o.oldArea = cell;\r\n            } else {\r\n                var old = page.o.oldArea;\r\n                if (old.sr == cell.sr && old.sc == cell.sc && old.er == cell.er && old.ec == cell.ec) {\r\n                    for (var i = 0; i < arr.length; i++) {\r\n                        if (cell.sr == arr[i].sr && cell.sc == arr[i].sc && cell.er == arr[i].er && cell.ec == arr[i].ec) {\r\n                            arr[i].emptyCol = value;\r\n                            var obj = {\r\n                                sr: arr[i].sr,\r\n                                er: arr[i].er,\r\n                                sc: arr[i].sc,\r\n                                ec: arr[i].ec,\r\n                                sliceName: arr[i].sliceName,\r\n                                emptyRow: arr[i].emptyRow,\r\n                                emptyCol: value\r\n                            }\r\n                            arr.splice(i, 1, obj)\r\n                        }\r\n                    }\r\n                    page.o.oldArea = cell;\r\n                }\r\n            }\r\n        }\r\n        var oriName = hwFP.seg_sliceName.getValue();\r\n        if (sender.initialConfig.id == 'seg_sliceName') {\r\n            if (value == '') {\r\n                vmd.tip('分片名称不可为空', 'error')\r\n                hwFP.seg_sliceName.setValue(oriName);\r\n                return;\r\n            } else {\r\n                var arr = page.o.fpArray;\r\n                for (var i = 0; i < arr.length; i++) {\r\n                    if (value == arr[i].sliceName) {\r\n                        vmd.tip('分片名称不可重复', 'error');\r\n                        hwFP.seg_sliceName.setValue(oriName);\r\n                        return;\r\n                    }\r\n                }\r\n                if (arr && arr.length > 0) {\r\n                    var cell = page.o.dealInvert()[0]\r\n                    for (var n = 0; n < arr.length; n++) {\r\n                        if (cell.sr == arr[n].sr && cell.sc == arr[n].sc && cell.er == arr[n].er && cell.ec == arr[n].ec) {\r\n                            var obj = {\r\n                                sr: arr[n].sr,\r\n                                er: arr[n].er,\r\n                                sc: arr[n].sc,\r\n                                ec: arr[n].ec,\r\n                                sliceName: value,\r\n                                emptyRow: arr[n].emptyRow,\r\n                                emptyCol: arr[n].emptyCol\r\n                            }\r\n                            arr.splice(n, 1, obj)\r\n                            hwFP.seg_sliceName.setValue(value)\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nfunction setProperty(paramJson, sheet, cell) {\r\n    page.property = paramJson;\r\n    page.o = sheet;\r\n    page.cells = [];\r\n    for (var i = cell.sr; i < cell.er + 1; i++) {\r\n        for (var n = cell.sc; n < cell.ec + 1; n++) {\r\n            var obj = {\r\n                r: i,\r\n                c: n\r\n            }\r\n            page.cells.push(obj);\r\n        }\r\n    }\r\n    if (page.property && page.property.cellAttributeInfo && page.property.cellAttributeInfo.cellInfoToJson) {\r\n        d = page.property.cellAttributeInfo.cellInfoToJson();\r\n    }\r\n    var curTab;\r\n    if (MyTabs1.activeTab.initialConfig && MyTabs1.activeTab.initialConfig.title == '单元格') {\r\n        curTab = MyTabs.activeTab.initialConfig.title;\r\n        if (typeof d != 'undefined') {\r\n            txtValue.setValue(d.textinfo[0].value)\r\n            txtShowValue.setValue(d.textinfo[1].value)\r\n            if (curTab == '扩展') {\r\n                var ex = d.extraInfo[0];\r\n                ExtraPropertyChange.setInfo(ex, page.o);\r\n                for (var i = 0; i < d.contentDetailInfo.length; i++) {\r\n                    if (d.contentDetailInfo[i].type == \"CheckBox\") {\r\n                        page[d.contentDetailInfo[i].id].setValue(d.contentDetailInfo[i].checked)\r\n                    } else {\r\n                        page[d.contentDetailInfo[i].id].setValue(d.contentDetailInfo[i].value)\r\n                    }\r\n                }\r\n            }\r\n            if (curTab == '属性') {\r\n                if (page[\"CellTypeProperty\"]) {\r\n                    page[\"CellTypeProperty\"].setInfo(page.property, page.o, page.cells);\r\n                }\r\n            }\r\n            if (curTab == '样式') {\r\n                page[\"hwNewNumber\"].setInfo(page.property, page.o, page.cells);\r\n            }\r\n            if (curTab == '打印') {\r\n                page[\"PrintConfig\"].setInfo(d.printInfo[0])\r\n            }\r\n            if (curTab == '菜单') {\r\n                page['hwLinkAndMenu'].setInfo(page.property);\r\n            }\r\n        }\r\n    } else if (MyTabs1.activeTab.initialConfig && MyTabs1.activeTab.initialConfig.title == '分栏') {\r\n\r\n    } else if (MyTabs1.activeTab.initialConfig && MyTabs1.activeTab.initialConfig.title == '分片') {\r\n        hwFP.clearPanel();\r\n        hwFP.setInfo(sheetHot);\r\n    } else if (MyTabs1.activeTab.initialConfig && MyTabs1.activeTab.initialConfig.title == '填报') {\r\n        hwReporting.setInfo();\r\n        sheetHot.setSaveSubmit();\r\n        sheetHot.setSaveCheck();\r\n    } else if (MyTabs1.activeTab.initialConfig && MyTabs1.activeTab.initialConfig.title == '打印') {\r\n        hwPrintSetting.setInfo(page.o)\r\n    }\r\n\r\n    hwFP.setInfo(page.o)\r\n}\r\n\r\nfunction MyTabs_tabchange(sender, tab) {\r\n    if (page.property) {\r\n        var d = page.property.cellAttributeInfo.cellInfoToJson();\r\n        var curTab = tab.initialConfig.title;\r\n        debugger\r\n        if (curTab == '扩展') {\r\n            var ex = d.extraInfo[0];\r\n            ExtraPropertyChange.setInfo(ex, page.o);\r\n            for (var i = 0; i < d.contentDetailInfo.length; i++) {\r\n                if (d.contentDetailInfo[i].type == \"CheckBox\") {\r\n                    page[d.contentDetailInfo[i].id].setValue(d.contentDetailInfo[i].checked)\r\n                } else {\r\n                    page[d.contentDetailInfo[i].id].setValue(d.contentDetailInfo[i].value)\r\n                }\r\n            }\r\n        }\r\n        if (curTab == '属性') {\r\n            if (page[\"CellTypeProperty\"]) {\r\n                page[\"CellTypeProperty\"].setInfo(page.property, page.o, page.cells);\r\n            }\r\n        }\r\n        if (curTab == '样式') {\r\n            page[\"hwNewNumber\"].setInfo(page.property, page.o, page.cells);\r\n        }\r\n        if (curTab == '打印') {\r\n            page[\"PrintConfig\"].setInfo(d.printInfo[0])\r\n        }\r\n        if (curTab == '菜单') {\r\n            page['hwLinkAndMenu'].setInfo(page.property);\r\n        }\r\n    }\r\n}\r\n//数字转化成科学计数法\r\nfunction ChangeSciNum(num) {\r\n    var p = Math.floor(Math.log(num) / Math.LN10);\r\n    var n = num * Math.pow(10, -p);\r\n    return n + 'e' + p;\r\n}\r\n//千分位分隔符\r\nfunction numFormat(num) {\r\n    num = num.toString().split(\".\"); // 分隔小数点\r\n    var arr = num[0].split(\"\").reverse(); // 转换成字符数组并且倒序排列\r\n    var res = [];\r\n    for (var i = 0, len = arr.length; i < len; i++) {\r\n        if (i % 3 === 0 && i !== 0) {\r\n            res.push(\",\"); // 添加分隔符\r\n        }\r\n        res.push(arr[i]);\r\n    }\r\n    res.reverse(); // 再次倒序成为正确的顺序\r\n    if (num[1]) { // 如果有小数的话添加小数部分\r\n        res = res.join(\"\").concat(\".\" + num[1]);\r\n    } else {\r\n        res = res.join(\"\");\r\n    }\r\n    return res;\r\n}\r\n//数据设置选项\r\nvar store = new Ext.data.JsonStore({\r\n    proxy: new Ext.data.MemoryProxy(),\r\n    fields: ['id', 'name']\r\n});\r\nvar data = [{\r\n    id: 'single',\r\n    name: '单值'\r\n}, {\r\n    id: 'group',\r\n    name: '分组'\r\n}, {\r\n    id: 'select',\r\n    name: '列表'\r\n}]\r\nstore.loadData(data);\r\n\r\nfunction ExtraProperty_directionClick(sender, selectedIndex) {\r\n    setCellInfo(sender, selectedIndex);\r\n}\r\n\r\nfunction nr_bgColorCheck_check(sender, checked) {\r\n    if (checked) {\r\n        nr_bgColor.enable();\r\n        bjs.enable()\r\n    } else {\r\n        nr_bgColor.disable()\r\n        nr_bgColor.setValue('');\r\n        nr_bgColor.fireEvent(\"change\", nr_bgColor, \"\");\r\n        bjs.disable()\r\n    }\r\n}\r\n\r\nfunction nr_frontColorCheck_check(sender, checked) {\r\n    if (checked) {\r\n        nr_frontColor.enable();\r\n        qjs.enable()\r\n    } else {\r\n        nr_frontColor.disable()\r\n        nr_frontColor.setValue('')\r\n        nr_frontColor.fireEvent(\"change\", nr_frontColor, \"\");\r\n        qjs.disable()\r\n    }\r\n}\r\n\r\nfunction nr_leftMarginCheck_check(sender, checked) {\r\n    if (checked) {\r\n        nr_leftMargin.enable();\r\n        zsj.enable()\r\n    } else {\r\n        nr_leftMargin.disable()\r\n        nr_leftMargin.setValue('')\r\n        nr_leftMargin.fireEvent(\"change\", nr_leftMargin, \"\");\r\n        zsj.disable()\r\n    }\r\n}\r\n\r\nfunction nr_heightCheck_check(sender, checked) {\r\n    if (checked) {\r\n        nr_height.enable();\r\n        gd.enable()\r\n    } else {\r\n        nr_height.disable()\r\n        nr_height.setValue('')\r\n        nr_height.fireEvent(\"change\", nr_height, \"\");\r\n        gd.disable()\r\n    }\r\n}\r\n\r\nfunction nr_sameValueRight_check(sender, checked) {\r\n    if (checked) {\r\n        nr_rightDependencies.show();\r\n        bbb.show()\r\n    } else {\r\n        nr_rightDependencies.hide()\r\n        nr_rightDependencies.setValue('')\r\n        nr_rightDependencies.fireEvent(\"change\", nr_rightDependencies, \"\");\r\n        bbb.hide()\r\n    }\r\n}\r\n\r\nfunction nr_sameValueDown_check(sender, checked) {\r\n    if (checked) {\r\n        nr_downDependencies.show();\r\n        aaa.show()\r\n    } else {\r\n        nr_downDependencies.hide()\r\n        aaa.hide()\r\n        nr_downDependencies.setValue('')\r\n        nr_downDependencies.fireEvent(\"change\", nr_downDependencies, \"\");\r\n    }\r\n}\r\n\r\nfunction nr_availableCheck_check(sender, checked) {\r\n    if (checked) {\r\n        nr_available.enable();\r\n        ky.enable()\r\n    } else {\r\n        nr_available.disable()\r\n        nr_available.setValue('')\r\n        nr_available.fireEvent(\"change\", nr_available, \"\");\r\n        ky.disable()\r\n    }\r\n}\r\n\r\nfunction nr_widthCheck_check(sender, checked) {\r\n    if (checked) {\r\n        nr_width.enable();\r\n        kd.enable()\r\n    } else {\r\n        nr_width.disable()\r\n        nr_width.setValue('')\r\n        nr_width.fireEvent(\"change\", nr_width, \"\");\r\n        kd.disable()\r\n    }\r\n}\r\n\r\nfunction nr_rowTextCheck_check(sender, checked) {\r\n    if (checked) {\r\n        nr_rowText.enable();\r\n        hzt.enable()\r\n    } else {\r\n        nr_rowText.disable()\r\n        nr_rowText.setValue('')\r\n        nr_rowText.fireEvent(\"change\", nr_rowText, \"\");\r\n        hzt.disable()\r\n    }\r\n}\r\n\r\nfunction nr_bgColor_afterrender(sender) {\r\n    nr_bgColor.disable()\r\n    nr_frontColor.disable()\r\n    nr_leftMargin.disable()\r\n    nr_rowText.disable()\r\n    nr_width.disable()\r\n    nr_available.disable()\r\n    nr_height.disable()\r\n    bjs.disable()\r\n    qjs.disable()\r\n    zsj.disable()\r\n    hzt.disable()\r\n    kd.disable()\r\n    ky.disable()\r\n    gd.disable()\r\n}\r\n\r\nfunction sjz_click(sender, e) {\r\n    parent.openVisualEditor(0, txtValue.getValue());\r\n}\r\n\r\nfunction xsz_click(sender, e) {\r\n    parent.openVisualEditor(1, txtShowValue.getValue());\r\n}\r\n\r\nfunction bjs_click(sender, e) {\r\n    if (nr_bgColor.getValue() == \"\") {\r\n        parent.openVisualEditor(2, \"=if(@value>值){CellBgClr=颜色}\");\r\n    } else {\r\n        parent.openVisualEditor(2, nr_bgColor.getValue());\r\n    }\r\n}\r\n\r\nfunction qjs_click(sender, e) {\r\n    if (nr_frontColor.getValue() == \"\") {\r\n        parent.openVisualEditor(3, \"=if(@value>值){FontClr=颜色}\");\r\n    } else {\r\n        parent.openVisualEditor(3, nr_frontColor.getValue());\r\n    }\r\n}\r\n\r\nfunction zsj_click(sender, e) {\r\n    if (nr_leftMargin.getValue() == \"\") {\r\n        parent.openVisualEditor(4, \"=if(@value>值){LeftMargin=值}\");\r\n    } else {\r\n        parent.openVisualEditor(4, nr_leftMargin.getValue());\r\n    }\r\n}\r\n\r\nfunction hzt_click(sender, e) {\r\n    if (nr_rowText.getValue() == \"\") {\r\n        parent.openVisualEditor(5, \"=if(@value>值){RowFontBold=(是否加粗)}\");\r\n    } else {\r\n        parent.openVisualEditor(5, nr_rowText.getValue());\r\n    }\r\n}\r\n\r\nfunction ExtraPropertyChange_directionClick(sender, selectedIndex) {\r\n    setCellInfo(sender, selectedIndex)\r\n}\r\n\r\nfunction kd_click(sender, e) {\r\n    if (nr_width.getValue() == \"\") {\r\n        parent.openVisualEditor(6, \"=if(@value>值){RowFontBold=(是否加粗)}\");\r\n    } else {\r\n        parent.openVisualEditor(6, nr_width.getValue());\r\n    }\r\n}\r\n\r\nfunction ky_click(sender, e) {\r\n    if (nr_available.getValue() == \"\") {\r\n        parent.openVisualEditor(7, \"=if(@value>值){disable=1}\");\r\n    } else {\r\n        parent.openVisualEditor(7, nr_available.getValue());\r\n    }\r\n}\r\n\r\nfunction gd_click(sender, e) {\r\n    if (nr_height.getValue() == \"\") {\r\n        parent.openVisualEditor(8, \"=if(@value>值){rowheight=0}\");\r\n    } else {\r\n        parent.openVisualEditor(8, nr_height.getValue());\r\n    }\r\n}\r\n\r\nfunction CellTypeProperty_DropDownTree(sender, value) {\r\n    page.fireEvent(\"change\", sender, value)\r\n}\r\n//判断ele是否含有cls类名\r\nfunction hasClass(ele, cls) {\r\n    return ele.dom.className.match(new RegExp('(\\\\s|^)' + cls + '(\\\\s|$)'));\r\n}\r\n//元素移除class\r\nfunction removeClass(ele, cls) {\r\n    if (hasClass(ele, cls)) {\r\n        var reg = new RegExp('(\\\\s|^)' + cls + '(\\\\s|$)');\r\n        ele.dom.className = ele.dom.className.replace(reg, ' ');\r\n    }\r\n}\r\n// 字号转换像素\r\nfunction sizeToPX(size) {\r\n    var str = size;\r\n    switch (size) {\r\n        case \"6\":\r\n            str = \"9\";\r\n            break;\r\n        case \"8\":\r\n            str = \"11\";\r\n            break;\r\n        case \"9\":\r\n            str = \"12\";\r\n            break;\r\n        case \"10\":\r\n            str = \"13\";\r\n            break;\r\n        case \"10.5\":\r\n            str = \"14\";\r\n            break;\r\n        case \"11\":\r\n            str = \"15\";\r\n            break;\r\n        case \"12\":\r\n            str = \"16\";\r\n            break;\r\n        case \"14\":\r\n            str = \"19\";\r\n            break;\r\n        case \"15\":\r\n            str = \"20\";\r\n            break;\r\n        case \"16\":\r\n            str = \"21\";\r\n            break;\r\n        case \"18\":\r\n            str = \"24\";\r\n            break;\r\n        case \"20\":\r\n            str = \"27\";\r\n            break;\r\n        case \"22\":\r\n            str = \"29\";\r\n            break;\r\n        case \"24\":\r\n            str = \"32\";\r\n            break;\r\n        case \"26\":\r\n            str = \"35\";\r\n            break;\r\n        case \"28\":\r\n            str = \"37\";\r\n            break;\r\n        case \"36\":\r\n            str = \"48\";\r\n            break;\r\n        case \"48\":\r\n            str = \"64\";\r\n            break;\r\n        case \"54\":\r\n            str = \"72\";\r\n            break;\r\n        case \"72\":\r\n            str = \"96\";\r\n            break;\r\n    }\r\n    return str + \"px\";\r\n}\r\n\r\nfunction MyTabs_beforerender(sender) {\r\n    panel.title = '';\r\n    panel1.title = '';\r\n    panel3.title = '';\r\n    panel4.title = '';\r\n    panel8.title = '';\r\n}\r\n\r\nfunction MyTabs_afterrender(sender) {\r\n    var titleGroup = vmd(this.header.dom).find('.x-tab-strip-text')\r\n    titleGroup[0].innerHTML = \"<i class='report-iconfont icon-kuozhan font-20' data-tooltip='扩展'></i>\"\r\n    titleGroup[1].innerHTML = \"<i class='report-iconfont icon-shuxing font-20B' data-tooltip='属性'></i>\"\r\n    titleGroup[2].innerHTML = \"<i class='report-iconfont icon-zitiyangshi- font-20B' data-tooltip='样式'></i>\"\r\n    titleGroup[3].innerHTML = \"<i class='report-iconfont icon-dayin font-20B' data-tooltip='打印'></i>\"\r\n    titleGroup[4].innerHTML = \"<i class='report-iconfont icon-chaolianjie font-20B' data-tooltip='超链接与右键菜单'></i>\"\r\n    if (typeof padutis != undefined)\r\n        padutils = {\r\n            validUrlRe: new RegExp(\"^(?:https?|sftp|ftps?|ssh|ircs?|file|gopher|telnet|nntp|worldwind|chrome|chrome-extension|svn|git|mms|smb|afp|nfs|(x-)?man|gopher|txmt)://|^mailto:|^xmpp:|^sips?:|^tel:|^sms:|^news:|^bitcoin:|^magnet:|^urn:|^geo:|^/\", \"i\"),\r\n            escapeHtml: function(e) {\r\n                var t = /[&<>'\"]/g;\r\n                return t.MAP || (t.MAP = {\r\n                    \"&\": \"&amp;\",\r\n                    \"<\": \"&lt;\",\r\n                    \">\": \"&gt;\",\r\n                    '\"': \"&#34;\",\r\n                    \"'\": \"&#39;\"\r\n                }), e.replace(t, function(e) {\r\n                    return t.MAP[e]\r\n                })\r\n            },\r\n            uniqueId: function() {\r\n                function e(e, t) {\r\n                    return (Array(t + 1).join(\"0\") + Number(e).toString(35)).slice(-t)\r\n                }\r\n                return [pad.getClientIp(), e(+new Date, 7), e(Math.floor(1e9 * Math.random()), 4)].join(\".\")\r\n            },\r\n            getLength: function(e) {\r\n                for (var t = 0, n = 0; n < e.length; n++) {\r\n                    t += e.charCodeAt(n) <= 255 ? 1 : 2\r\n                }\r\n                return t\r\n            },\r\n            splitString: function(e, t) {\r\n                var n = \"\",\r\n                    o = 0;\r\n                if (padutils.getLength(e) <= t) n = e;\r\n                else\r\n                    for (var i = 0; i < e.length; i++) {\r\n                        var r = e.charAt(i);\r\n                        if ((o += e.charCodeAt(i) <= 255 ? 1 : 2) > t) {\r\n                            n += \"...\";\r\n                            break\r\n                        }\r\n                        n += r\r\n                    }\r\n                return n\r\n            },\r\n            getIsMobile: function() {\r\n                return -1 != navigator.userAgent.toLowerCase().indexOf(\"iphone\") || -1 != navigator.userAgent.toLowerCase().indexOf(\"ipad\") || -1 != navigator.userAgent.toLowerCase().indexOf(\"android\") || -1 != navigator.userAgent.toLowerCase().indexOf(\"ipod\")\r\n            },\r\n            timediff: function(e) {\r\n                function t(e, t) {\r\n                    return (e = Math.round(e)) + \" \" + t + (1 != e ? \"s\" : \"\") + \" ago\"\r\n                }\r\n                return (e = Math.max(0, (+new Date - +e - pad.clientTimeOffset) / 1e3)) < 60 ? t(e, \"second\") : (e /= 60) < 60 ? t(e, \"minute\") : (e /= 60) < 24 ? t(e, \"hour\") : t(e /= 24, \"day\")\r\n            },\r\n            getCheckbox: function(e) {\r\n                return $(e).is(\":checked\")\r\n            },\r\n            setCheckbox: function(e, t) {\r\n                t ? $(e).attr(\"checked\", \"checked\") : $(e).removeAttr(\"checked\")\r\n            },\r\n            bindCheckboxChange: function(e, t) {\r\n                $(e).bind(\"click change\", t)\r\n            },\r\n            encodeUserId: function(e) {\r\n                return e.replace(/[^a-y0-9]/g, function(e) {\r\n                    return \".\" == e ? \"-\" : \"z\" + e.charCodeAt(0) + \"z\"\r\n                })\r\n            },\r\n            decodeUserId: function(e) {\r\n                return e.replace(/[a-y0-9]+|-|z.+?z/g, function(e) {\r\n                    return \"-\" == e ? \".\" : \"z\" == e.charAt(0) ? String.fromCharCode(Number(e.slice(1, -1))) : e\r\n                })\r\n            },\r\n            setToolToastCss: function(e) {\r\n                var t = $(\"#toolToast\");\r\n                t.length > 0 && e && $.each(e, function(e, n) {\r\n                    t.css(e, n)\r\n                })\r\n            },\r\n            hideToolToast: function(e, t) {\r\n                t || (t = $(\"#toolToastWrap:last\")), setTimeout(function() {\r\n                    t.remove(), 0 == $(\"#toolToast:last\").filter(\":visible\").length && $(\"#toolToast:last\").show(), e && e()\r\n                }, 200)\r\n            },\r\n            toolToast: function(e, t, n, o, i) {\r\n                var r = !1;\r\n                if (n && n.supportMobile && (r = !0, t || (t = {}), t)) {\r\n                    if (!t.top) try {\r\n                        t.top = $(\"header\").height() + $(\"header\").offset().top + $(window).scrollTop() + 10\r\n                    } catch (e) {\r\n                        \"doc\" === clientVars.padType ? t.top = \"137px\" : \"sheet\" === clientVars.padType && (t.top = \"112px\"), console.log(\"showTooltoast mobile fail\")\r\n                    }\r\n                    t[\"background-color\"] || (t[\"background-color\"] = \"rgba(0,0,0,0.7)\"), t.color || (t.color = \"#ffffff\"), t[\"padding-left\"] || (t[\"padding-left\"] = \"10px\"), t[\"padding-right\"] || (t[\"padding-right\"] = \"10px\")\r\n                }\r\n                if (!padutils.getIsMobile() || r) {\r\n                    var s, a;\r\n                    if (padutils.hideToolToast(n && n.toolToastRemoveCallBack ? n.toolToastRemoveCallBack : void 0), a = o && i ? o : $(\"body\"), \"object\" != typeof t && (t = {}), !i && !r) {\r\n                        delete t.top, delete t.left, delete t.right, delete t.bottom, delete t.width, delete t.height, delete t[\"max-width\"], delete t[\"max-height\"], delete t.position, delete t.transform;\r\n                        try {\r\n                            \"doc\" === clientVars.padType ? (s = $(\".editor-wrapper\").offset().top + $(\"#padeditor\").scrollTop(), t.top = s, t.transform = \"translateY(-50%)\") : \"sheet\" === clientVars.padType && (t.top = $(\"header\").height() + $(\"header\").offset().top)\r\n                        } catch (e) {\r\n                            \"doc\" === clientVars.padType ? (t.top = \"137px\", t.transform = \"translateY(-50%)\") : \"sheet\" === clientVars.padType && (t.top = \"112px\"), console.log(\"showTooltoast fail\")\r\n                        }\r\n                    }\r\n                    var c = $('<div id=\"toolToastWrap\">').prependTo(a);\r\n                    c.css({\r\n                        left: \"20px\",\r\n                        right: \"30px\",\r\n                        borderSizing: \"border-box\",\r\n                        display: \"none\",\r\n                        position: \"absolute\",\r\n                        zIndex: 501\r\n                    }), r || c.css(t);\r\n                    var l = $(\"<div id='toolToast'>\").prependTo(c),\r\n                        u = $(\"<span></span>\").html(e).prependTo(l);\r\n                    if (r && (t && l.css(t), c.css(\"right\", \"20px\")), n && n.isNeedBtn) {\r\n                        var d = $('<span id=\"toolToastBtn\"></span>').html(n.btnText);\r\n                        u.append(d);\r\n                        var p = n.btnTextAfter;\r\n                        if (p) {\r\n                            var h = $('<span id=\"toolToastBtnAfter\"></span').html(p);\r\n                            u.append(h)\r\n                        }\r\n                        d.click(function() {\r\n                            n.btnCallBack && n.btnCallBack()\r\n                        })\r\n                    }\r\n                    if (n && n.isNeedClose) {\r\n                        var f = $(\"<div class='toast-colse'>\");\r\n                        l.append(f), f.hover(function() {\r\n                            $(this).addClass(\"toast-colse-hover\")\r\n                        }, function() {\r\n                            $(this).removeClass(\"toast-colse-hover\")\r\n                        }), l.css(\"padding-right\", 36), f.click(function() {\r\n                            padutils.hideToolToast(n && n.toolToastRemoveCallBack ? n.toolToastRemoveCallBack : void 0)\r\n                        })\r\n                    } else if (n && n.isWarnning) {\r\n                        var g = $(\"<div class='toast-mark-white'>\");\r\n                        l.prepend(g), l.css(\"background-color\", \"#ff7d6f\"), l.css(\"color\", \"white\"), l.css(\"padding-left\", 34);\r\n                        var m = $(\"<div class='toast-colse-white'>\");\r\n                        l.append(m), l.css(\"padding-right\", 36), m.click(function() {\r\n                            padutils.hideToolToast(n && n.toolToastRemoveCallBack ? n.toolToastRemoveCallBack : void 0)\r\n                        })\r\n                    }\r\n                    c.show(), l.show(), n && n.toolToastCloseTime && parseFloat(n.toolToastCloseTime) && setTimeout(function() {\r\n                        padutils.hideToolToast(n && n.toolToastRemoveCallBack ? n.toolToastRemoveCallBack : void 0, c)\r\n                    }, parseFloat(n.toolToastCloseTime))\r\n                }\r\n            },\r\n            toolTipMouseenter: function(e) {\r\n                var extendParam = e.data ? e.data.extendParam : null,\r\n                    drawViewCallback = e.data ? e.data.drawViewCallback : null;\r\n                padutils.setTimeoutId && (clearTimeout(padutils.setTimeoutId), padutils.setTimeoutId = 0), $(\"#tooltip\").remove();\r\n                var vtimeOut = 0;\r\n                if (extendParam && extendParam.timeOut && (vtimeOut = extendParam.timeOut), !(extendParam && extendParam.showTtpInNeedScroll && $(this)[0].scrollWidth <= $(this).outerWidth())) {\r\n                    var handleElement = $(this),\r\n                        setTimeoutId = setTimeout(function() {\r\n                            $(\"#tooltip\").remove();\r\n                            var tooltipData = handleElement.data(\"tooltip\") ? handleElement.data(\"tooltip\") : handleElement.attr(\"data-tooltip\");\r\n                            if (\"function\" == typeof tooltipData && (tooltipData = tooltipData()), void 0 !== tooltipData && \"string\" != typeof tooltipData && (tooltipData = handleElement[0].getAttribute(\"data-tooltip\")), tooltipData && !handleElement.hasClass(\"hp-ui-button-active\")) {\r\n                                if (extendParam && extendParam.mouseenterCallBack && extendParam.mouseenterCallBack(), tooltipData && tooltipData.indexOf(\"()\") && 0 == tooltipData.indexOf(\"'\")) {\r\n                                    var tempTooltipData = tooltipData;\r\n                                    try {\r\n                                        tooltipData = eval(tooltipData)\r\n                                    } catch (e) {\r\n                                        tooltipData = tempTooltipData\r\n                                    }\r\n                                }\r\n                                var tooltip = $(\"<div id='tooltip'>\").text(tooltipData).prependTo($(\"body\"));\r\n                                tooltip.data(\"target-dom\", e.target);\r\n                                var tooltip_taper_angle_Class = \"tooltip-before\";\r\n                                extendParam && (extendParam.tooltipArrowClass && (tooltip_taper_angle_Class = extendParam.tooltipArrowClass), extendParam.tooltipClass && !tooltip.hasClass(extendParam.tooltipClass) && tooltip.addClass(extendParam.tooltipClass));\r\n                                var tooltipAngle = $(\"<div id='\" + tooltip_taper_angle_Class + \"'>\"),\r\n                                    tooltip_taper_angle = null;\r\n                                tooltip_taper_angle = \"tooltip-after\" == tooltip_taper_angle_Class ? tooltipAngle.appendTo(tooltip) : tooltipAngle.prependTo(tooltip), drawViewCallback(tooltip, tooltip_taper_angle, handleElement)\r\n                            }\r\n                        }, vtimeOut);\r\n                    vtimeOut > 0 && (padutils.setTimeoutId = setTimeoutId)\r\n                }\r\n            },\r\n            toolTipMouseleave: function(e) {\r\n                var t = e.data ? e.data.extendParam : null;\r\n                $(\"#tooltip\").remove(), padutils.setTimeoutId && (clearTimeout(padutils.setTimeoutId), padutils.setTimeoutId = 0), t && t.mouseleaveCallBack && t.mouseleaveCallBack()\r\n            },\r\n            baseTooltip: function(e, t, n) {\r\n                if (!padutils.getIsMobile()) {\r\n                    this.removeTooltip(e);\r\n                    var o = $(e);\r\n                    o.on(\"mouseenter\", null, {\r\n                        drawViewCallback: t,\r\n                        extendParam: n\r\n                    }, this.toolTipMouseenter), o.on(\"mouseleave\", null, {\r\n                        drawViewCallback: t,\r\n                        extendParam: n\r\n                    }, this.toolTipMouseleave)\r\n                }\r\n            },\r\n            tooltip: function(e, t) {\r\n                return t = t || {}, padutils.baseTooltip(e, function(e, n, o) {\r\n                    if (o.siblings(\".dropdown-wrapper.open\").length > 0 || o.siblings(\".toolbar-border-palette.open\").length > 0 || \"toolbar-colorPicker-picker-wrapper\" == o.attr(\"id\") && $.fn.colorPicker.isColorPaletteShow(1) || \"toolbar-colorPicker-picker-paint-wrapper\" == o.attr(\"id\") && $.fn.colorPicker.isColorPaletteShow(2) || (\"sheet-calculate-button\" == o.attr(\"id\") || \"sheet-calculate-more\" == o.attr(\"id\")) && $(\"#sheet-calculate\").siblings(\".dropdown-wrapper.open\").length > 0) $(\"#tooltip\").remove();\r\n                    else {\r\n                        var i = o.offset().top + o.outerHeight() + 10,\r\n                            r = o.offset().left + o.outerWidth() / 2 - e.outerWidth() / 2;\r\n                        r = (r = Math.min(document.body.clientWidth - e.outerWidth() - 10, r)) <= 10 ? 10 : r;\r\n                        var s = o.offset().left + o.outerWidth() / 2 - r;\r\n                        n.css({\r\n                            left: t.beforeLeft || s\r\n                        }), i > document.body.clientHeight && n && \"tooltip-after\" == n.attr(\"id\") && (i = o.offset().top - o.outerHeight()), e.css({\r\n                            top: i,\r\n                            left: r > 0 ? r : 0,\r\n                            zIndex: 1e5,\r\n                            maxWidth: t.maxWidth || \"300px\",\r\n                            paddingLeft: t.paddingLeft || \"9px\",\r\n                            textAlign: t.textAlign || \"center\"\r\n                        }).hide().fadeIn()\r\n                    }\r\n                }, t)\r\n            },\r\n            hideTooltip: function() {\r\n                $(\"#tooltip\").remove()\r\n            },\r\n            removeTooltip: function(e) {\r\n                var t = this;\r\n                $(e).each(function() {\r\n                    $(this).off(\"mouseenter\", null, t.toolTipMouseenter), $(this).off(\"mouseleave\", null, t.toolTipMouseleave)\r\n                })\r\n            },\r\n            horizontalTooltip: function(e, t, n) {\r\n                return t || (t = {}), t.tooltipArrowClass || (t.tooltipArrowClass = \"tooltip-right\"), padutils.baseTooltip(e, function(e, o, i) {\r\n                    n && n.height ? e.css(\"height\", n.height) : e.css(\"height\", i.outerHeight() - 6), e.css(\"line-height\", e.css(\"height\")), t && t[\"min-width\"] && e.css(\"min-width\", t[\"min-width\"] - 16);\r\n                    var r, s = i.offset().top;\r\n                    r = \"tooltip-right\" == $(o).get(0).id ? i.offset().left + i.outerWidth() : i.offset().left - e.outerWidth() - 9, t && t.left && (r += t.left), s < 0 && o.css({\r\n                        top: e.outerHeight() / 2 + s\r\n                    }), e.css({\r\n                        top: s > 0 ? s : 0,\r\n                        left: r > 0 ? r : 0,\r\n                        zIndex: 1e5\r\n                    }).hide().fadeIn()\r\n                }, t)\r\n            },\r\n            btnState: function(e, t, n, o) {\r\n                e.mousedown(function(e) {\r\n                    $(this).addClass(o), $(this).removeClass(n + \" \" + t)\r\n                }), e.mouseup(function(e) {\r\n                    $(this).removeClass(o + \" \" + t), $(this).addClass(n)\r\n                }), e.mouseenter(function(e) {\r\n                    $(this).addClass(n), $(this).removeClass(t)\r\n                }), e.mouseleave(function(e) {\r\n                    $(this).addClass(t), $(this).removeClass(n + \" \" + o)\r\n                })\r\n            },\r\n            toolTextCount: function(e, t, n, o, i) {\r\n                var r = i || $(\"body\");\r\n                o && o.isNeedReflush && $(window).resize(function() {\r\n                    n && \"left\" in n || (s = r.outerWidth() / 2 - e.outerWidth() / 2, e.css({\r\n                        left: s > 0 ? s : 0\r\n                    }))\r\n                });\r\n                var s = r.outerWidth() / 2 - e.outerWidth() / 2;\r\n                e.css({\r\n                    left: s > 0 ? s : 0\r\n                }), n && $.each(n, function(t, n) {\r\n                    e.css(t, n)\r\n                }), e.text(t), e.show()\r\n            },\r\n            hideTextCount: function(e) {\r\n                e.hide()\r\n            }\r\n        };\r\n    padutils.tooltip(\".contentprp [data-tooltip]\");\r\n}\r\n\r\nfunction txtValue_beforerender(sender) {\r\n    this.enableKeyEvents = true\r\n}\r\n\r\nfunction txtValue_keyup(sender, e) {\r\n    var v = sender.getValue();\r\n    var arr = [];\r\n    if (page.cells) {\r\n        for (var i = 0; i < page.cells.length; i++) {\r\n            var r = page.cells[i].r;\r\n            var c = page.cells[i].c;\r\n            var temp = [r, c, v]\r\n            arr.push(temp)\r\n        }\r\n        page.o.setDataAtCell(arr)\r\n    }\r\n}\r\n\r\nfunction MyTabs1_tabchange(sender, tab) {\r\n    if (tab.title == '打印') {\r\n        hwPrintSetting.setInfo(page.o)\r\n    } else if (tab.title == '填报') {\r\n        hwReporting.setInfo();\r\n        sheetHot.setSaveSubmit();\r\n        sheetHot.setSaveCheck();\r\n        // sheetHot.setSubmitList(page.o.submitParams.id, page.o.submitParams.name, page.o.submitParams.text, page.o.submitParams.obj, page.o.submitParams.save)\r\n    } else if (tab.title == '分片') {\r\n        hwFP.clearPanel();\r\n        hwFP.setInfo(sheetHot);\r\n    }\r\n}\r\n\r\nfunction ContentProperty_beforerender(sender) {}\r\n\r\nfunction panel3_afterrender(sender) {}\r\n\r\nfunction hwNewNumber_decimalChanged(sender, value, describe) {\r\n    setCellInfo(sender, value)\r\n}\r\n\r\nfunction panel_afterrender(sender) {}","vmdcss":".b {\n    border: 1px solid #dddddd\n}\n\n.contentprp .x-tab-strip-active span.x-tab-strip-text {\n    color: #409EFF;\n    font-weight: bold;\n}\n\n.contentprp .x-tab-strip-active,\n.x-tab-strip-active a.x-tab-right {\n    background-color: #fff;\n}\n\n.contentprp .x-tab-strip-top .x-tab-right {\n    padding: 0 12px;\n    height: 30px;\n    background-color: #fff;\n}\n\n.contentprp .x-tab-panel-header, .x-tab-panel-body, .x-tab-panel-footer {\n    border-color: #dfdfdf;\n    border-top: 0px;\n    border-left: 0px;\n}\n\n.contentprp ul.x-tab-strip-top {\n    border: 0;\n    background-image: none;\n    background-color: #fff;\n    border-color: #dfdfdf;\n}\n\n.fonttitle .x-tab-strip-top .x-tab-right {\n    padding: 0 16px;\n    height: 30px;\n    background-color: #fff;\n}\n","vmdprops":"\"\"","type":"ux","vmdcmpdeps":[],"vmdevents_controller":"Ext.define('vmd.ux.contentProperty.Controller', {\n    xtype: 'vmd.ux.contentProperty.Controller',\n    constructor: function(options) {\n        \n    }\n})","vmdinterface":"{\"components\":[{\"cid\":\"vmduxprops\",\"layoutConfig\":{},\"userConfig\":{},\"cn\":[{\"cid\":\"uxprop\",\"id\":\"text\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"text\",\"desc\":\"实际值\",\"zhname\":\"\",\"isPublic\":\"on\",\"bindCmp\":\"txtValue\",\"bindValue\":\"emptyText\",\"uxcid\":\"textfield\"}},{\"cid\":\"uxprop\",\"id\":\"showValue\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"showValue\",\"desc\":\"显示值\",\"zhname\":\"\",\"isPublic\":\"on\",\"bindCmp\":\"txtShowValue\",\"bindValue\":\"emptyText\",\"uxcid\":\"textfield\"}}]},{\"cid\":\"vmduxmethods\",\"id\":\"方法\",\"layoutConfig\":{},\"userConfig\":{},\"cn\":[{\"cid\":\"uxmethod\",\"id\":\"setPropertyInfo\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"setPropertyInfo\",\"zhname\":\"\",\"bindCmp\":\"\",\"bindValue\":\"\",\"isPublic\":\"on\",\"desc\":\"\",\"uxcid\":\"\",\"params\":\"paramJson,selectCell,obj\",\"code\":\"//直接填写方法内容\\nsetProperty(paramJson,selectCell,obj);\",\"returnType\":\"无\"}},{\"cid\":\"uxmethod\",\"id\":\"setReport\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"setReport\",\"params\":\"type\",\"desc\":\"\",\"isPublic\":\"on\",\"code\":\"setReport(type)\",\"returnType\":\"\"}}]},{\"cid\":\"vmduxevents\",\"id\":\"事件\",\"layoutConfig\":{},\"userConfig\":{}}]}","vmdresource":"{\"components\":[{\"cid\":\"vmdrescsss\",\"layoutConfig\":{},\"userConfig\":{}},{\"cid\":\"vmdresjss\",\"layoutConfig\":{},\"userConfig\":{},\"cn\":[{\"cid\":\"resjs\",\"id\":\"controller.js\",\"layoutConfig\":{},\"userConfig\":{}}]},{\"cid\":\"vmdresimgs\",\"layoutConfig\":{},\"userConfig\":{}}]}"}