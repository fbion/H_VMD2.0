{"vmdversion":"2.0.3.0920","vmdlayout":"{\"components\":[{\"cid\":\"uxpanel\",\"id\":\"DetailsofUnitsSn\",\"layoutConfig\":{},\"userConfig\":{\"layout\":\"fit\",\"header\":false,\"width\":1160,\"height\":350,\"afterrender\":\"DetailsofUnitsSn_afterrender\"},\"cn\":[{\"cid\":\"panel\",\"id\":\"panel\",\"layoutConfig\":{},\"userConfig\":{\"x\":\"\",\"y\":\"\",\"border\":true,\"header\":true,\"height\":350,\"width\":1150,\"padding\":\"\",\"title\":\"各单位详细情况\",\"layout\":\"fit\",\"autoHeight\":false},\"cn\":[{\"cid\":\"grid\",\"id\":\"MyGrid\",\"layoutConfig\":{},\"userConfig\":{\"hideHeaders\":false,\"header\":false,\"border\":true,\"height\":330,\"width\":1150,\"beforerender\":\"MyGrid_beforerender\",\"cls\":\"vmd-grid\"},\"cn\":[{\"cid\":\"gridcolumn\",\"layoutConfig\":{},\"userConfig\":{\"header\":\"id\",\"dataIndex\":\"id\",\"align\":\"center\",\"hidden\":true},\"name\":\"id\"},{\"cid\":\"gridcolumn\",\"layoutConfig\":{},\"userConfig\":{\"header\":\"序号\",\"dataIndex\":\"xh\",\"align\":\"center\"},\"name\":\"xh\"},{\"cid\":\"gridcolumn\",\"layoutConfig\":{},\"userConfig\":{\"header\":\"单位代码\",\"dataIndex\":\"dwdm\",\"align\":\"center\",\"width\":230,\"hidden\":true,\"menuDisabled\":true},\"name\":\"dwdm\"},{\"cid\":\"gridcolumn\",\"layoutConfig\":{},\"userConfig\":{\"header\":\"单位\",\"dataIndex\":\"dwmc\",\"align\":\"center\",\"width\":220,\"menuDisabled\":true,\"css\":\"text-align: left !important;\",\"hidden\":false},\"name\":\"dwmc\"},{\"cid\":\"gridcolumn\",\"layoutConfig\":{},\"userConfig\":{\"header\":\"任务类型\",\"dataIndex\":\"rwlx\",\"align\":\"center\",\"menuDisabled\":true,\"css\":\"text-align: left !important;\",\"width\":120},\"name\":\"rwlx\"},{\"cid\":\"gridcolumn\",\"layoutConfig\":{},\"userConfig\":{\"header\":\"任务计划总数\",\"dataIndex\":\"zs\",\"align\":\"center\",\"menuDisabled\":true,\"css\":\"text-align: right !important;\"},\"name\":\"zs\"},{\"cid\":\"gridcolumn\",\"layoutConfig\":{},\"userConfig\":{\"header\":\"未开始\",\"dataIndex\":\"wks\",\"align\":\"center\",\"menuDisabled\":true,\"css\":\"text-align: right !important;\"},\"name\":\"wks\"},{\"cid\":\"gridcolumn\",\"layoutConfig\":{},\"userConfig\":{\"header\":\"进行中\",\"dataIndex\":\"jxz\",\"align\":\"center\",\"menuDisabled\":true,\"css\":\"text-align: right !important;\"},\"name\":\"jxz\"},{\"cid\":\"gridcolumn\",\"layoutConfig\":{},\"userConfig\":{\"header\":\"正常完成\",\"dataIndex\":\"zcwc\",\"align\":\"center\",\"menuDisabled\":true,\"css\":\"text-align: right !important;\"},\"name\":\"zcwc\"},{\"cid\":\"gridcolumn\",\"layoutConfig\":{},\"userConfig\":{\"header\":\"超时完成\",\"dataIndex\":\"cswc\",\"align\":\"center\",\"menuDisabled\":true,\"css\":\"text-align: right !important;\"},\"name\":\"cswc\"},{\"cid\":\"gridcolumn\",\"layoutConfig\":{},\"userConfig\":{\"header\":\"超时\",\"dataIndex\":\"cs\",\"align\":\"center\",\"menuDisabled\":true,\"css\":\"text-align: right !important;\"},\"name\":\"cs\"},{\"cid\":\"gridcolumn\",\"layoutConfig\":{},\"userConfig\":{\"header\":\"异常\",\"dataIndex\":\"yc\",\"align\":\"center\",\"menuDisabled\":true,\"css\":\"text-align: right !important;\",\"width\":95},\"name\":\"yc\"}]}]}]}]}","vmdevents":"var page = this;\nvar dbrwDateList = [];\nvar store3 = new Ext.data.JsonStore({\n    proxy: new Ext.data.MemoryProxy(),\n    fields: [\"id\", \"xh\", \"dwdm\", \"dwmc\", \"rwdm\", \"rwlx\", \"zs\", \"wks\", \"jxz\", \"zcwc\", \"cswc\", \"cs\", \"yc\"]\n});\nvar ptServer = {\n    ip: '',\n    callcode: '',\n    userInfo: '', //用户信息服务\n    orgschecount: ''\n};\nvar dwdm = '';\n\nfunction MyGrid_beforerender(sender) {\n    this.store = store3;\n}\n\n//获取用户信息\nfunction loginInfo() {\n    var hwDao = new HwDao(ptServer.ip, ptServer.callcode); //地址:端口和授权码(服务管理员分配)\n    var url = ptServer.userInfo;\n    hwDao.get(url, {}, {}, function(res) {\n        if(res.data[0].size > 0) {\n            dwdm = res.data[0].datas[0].dwdm;\n            loadData(dwdm);\n        } else {\n            loadData(dwdm);\n        }\n    }, function() {}); /*成功回调函数*/\n}\n\n//加载用户数据\nfunction loadData(dwcode) {\n    var hwDao = new HwDao(ptServer.ip, ptServer.callcode); //地址:端口和授权码(服务管理员分配)\n    var url = ptServer.orgschecount;\n    hwDao.get(url, {}, {\n        dwdm: ''\n    }, function(res) {\n        if(res.isSucceed) {\n            if(res.data && res.data[0].datas.length > 0) {\n                var data = res.data[0].datas;\n                for(var i = 0; i < data.length; i++) {\n                    var itemObj = {\n                        xh: i + 1,\n                        id: i + 1,\n                        dwdm: data[i].dwdm,\n                        dwmc: data[i].dwmc,\n                        rwdm: data[i].sched_type_code,\n                        rwlx: data[i].sched_type_name,\n                        zs: \"<a href='#' class='hand'>\" + data[i].zs + \"</a>\",\n                        wks: data[i].wks,\n                        jxz: data[i].jxz,\n                        zcwc: data[i].zcwc,\n                        cswc: data[i].cswc,\n                        cs: data[i].cs,\n                        yc: data[i].yc\n                    }\n                    dbrwDateList.push(itemObj);\n                }\n            }\n\n            store3.loadData(dbrwDateList);\n            gridSpan(MyGrid, \"row\", '[dwmc]', '[dwmc]');\n        } else {\n            alert(res.errMsg);\n        }\n    }, function(res) {\n        alert(res);\n    });\n}\n\nfunction gridSpan(grid, rowOrCol, cols, sepCol) {\n    var array1 = new Array();\n    var arraySep = new Array();\n    var count1 = 0;\n    var count2 = 0;\n    var index1 = 0;\n    var index2 = 0;\n    var aRow = undefined;\n    var preValue = undefined;\n    var firstSameCell = 0;\n    var allRecs = grid.getStore().getRange();\n    debugger\n    if(rowOrCol == \"row\") {\n        count1 = grid.getColumnModel().getColumnCount();\n        count2 = grid.getStore().getCount();\n    } else {\n        count1 = grid.getStore().getCount();\n        count2 = grid.getColumnModel().getColumnCount();\n    }\n    for(i = 0; i < count1; i++) {\n        if(rowOrCol == \"row\") {\n            var curColName = grid.getColumnModel().getDataIndex(i);\n            var curCol = \"[\" + curColName + \"]\";\n            if(cols.indexOf(curCol) < 0)\n                continue;\n        }\n        preValue = undefined;\n        firstSameCell = 0;\n        array1[i] = new Array();\n        for(j = 0; j < count2; j++) {\n            if(rowOrCol == \"row\") {\n                index1 = j;\n                index2 = i;\n            } else {\n                index1 = i;\n                index2 = j;\n            }\n            var colName = grid.getColumnModel().getDataIndex(index2);\n            if(sepCol && colName == sepCol)\n                arraySep[index1] = allRecs[index1].get(sepCol);\n            var seqOldValue = seqCurValue = \"1\";\n            if(sepCol && index1 > 0) {\n                seqOldValue = arraySep[index1 - 1];\n                seqCurValue = arraySep[index1];\n            }\n\n            if(allRecs[index1].get(colName) == preValue && (colName == sepCol || seqOldValue == seqCurValue)) {\n                allRecs[index1].set(colName, \"\");\n                array1[i].push(j-1);\n                if(j == count2 - 1) {\n                    var index = firstSameCell + Math.round((j + 1 - firstSameCell) / 2 - 1);\n                    if(rowOrCol == \"row\") {\n                        allRecs[index].set(colName, preValue);\n                    } else {\n                        allRecs[index1].set(grid.getColumnModel().getColumnId(index), preValue);\n                    }\n                }\n            } else {\n                if(j != 0) {\n                    var index = firstSameCell + Math.round((j + 1 - firstSameCell) / 2 - 1);\n                    if(rowOrCol == \"row\") {\n                        allRecs[index].set(colName, preValue);\n                    } else {\n                        allRecs[index1].set(grid.getColumnModel().getColumnId(index), preValue);\n                    }\n                }\n                firstSameCell = j;\n                preValue = allRecs[index1].get(colName);\n                allRecs[index1].set(colName, \"\");\n                if(j == count2 - 1) {\n                    allRecs[index1].set(colName, preValue);\n                }\n            }\n        }\n    }\n    grid.getStore().commitChanges();\n    //去除合并的单元格的分隔线\n    for(i = 0; i < array1.length; i++) {\n        if(!Ext.isEmpty(array1[i])) {\n            for(j = 0; j < array1[i].length; j++) {\n                if(rowOrCol == \"row\") {\n                    aRow = grid.getView().getCell(array1[i][j], i);\n                    aRow.style.borderBottom = \"none\";\n                } else {\n                    aRow = grid.getView().getCell(i, array1[i][j]);\n                    aRow.style.borderTop = \"none\";\n                }\n            }\n        }\n    }\n}\n\nfunction DetailsofUnitsSn_afterrender(sender){\nptServer = {\n    ip: vmd.workspace.dataServiceIp,\n    callcode: MyGrid.callcode,\n    userInfo: MyGrid.userInfo,//'platform/v1/UserManage', //用户信息服务\n    orgschecount: MyGrid.orgschecount//'XXHTS/schedule/taskmanager/workbench/orgschecount'\n};\nloginInfo();\n}","vmdcss":".hand a{\r\n   text-decoration:none; \r\n}\r\n.hand a:link {\r\n    color: blue; text-decoration:none;\r\n    \r\n}\r\n.hand a:active:{\r\n    color: red;\r\n    } \r\na:visited {\r\n    color:purple;text-decoration:none;\r\n    \r\n} \r\n.hand a:hover {\r\n    color: red; text-decoration:underline;\r\n    \r\n} \r\n.x-grid3-hd-row td {\r\n    line-height: 15px;\r\n    vertical-align: middle;\r\n    border-left: 0px solid;\r\n     border-right: 0px solid;\r\n     border: 1px solid #e4e4e4;\r\n}\r\n.x-grid3-scroller {\r\n    overflow-x: hidden;\r\n}\r\n/* =========================================== Grid Panel =========================================== */\r\n/* 表格左右间距 */\r\n.vmd-grid {\r\n    padding-left: 5px;\r\n    padding-right: 5px;\r\n}\r\n\r\n/* 表格线样式兼容 */\r\n.vmd-grid table {\r\n    border-collapse: collapse;\r\n}\r\n\r\n/* 表头背景色 */\r\n.vmd-grid .x-grid3-header {\r\n    background-color: #f7f7f7;\r\n}\r\n\r\n/* 表头鼠标悬停背景色 */\r\n.vmd-grid .x-grid3-hd-over .x-grid3-hd-inner {\r\n    background-color: #f7f7f7;\r\n}\r\n\r\n/* 表头错位兼容 */\r\n.vmd-grid .x-grid3-header-offset {\r\n    padding: 0;\r\n}\r\n\r\n/* 表头单元格 */\r\n.vmd-grid .x-grid3-header td {\r\n    border: 1px solid #e3e2e8;\r\n    font-size: 14px;\r\n}\r\n\r\n/* 表体单元格 */\r\n.vmd-grid .x-grid3-body td {\r\n    border: 1px solid #e3e2e8;\r\n    border-top-width: 0;\r\n    padding: 0;\r\n    font-size: 14px;\r\n}\r\n\r\n/* 表体行 */\r\n.vmd-grid .x-grid3-row {\r\n    border: none;\r\n}\r\n\r\n/* 表体行鼠标悬停背景色 */\r\n.vmd-grid .x-grid3-row-over {\r\n    background-color: white;\r\n}\r\n\r\n/* 表体行选中背景色 */\r\n.vmd-grid .x-grid3-row-selected {\r\n    background-color: #F5F7FC !important;\r\n}\r\n\r\n/* =========================================== Grid Panel =========================================== */","vmdprops":"\"\"","type":"ux","vmdinterface":"{\"components\":[{\"cid\":\"vmduxprops\",\"layoutConfig\":{},\"userConfig\":{},\"cn\":[{\"cid\":\"uxprop\",\"id\":\"callcode\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"callcode\",\"zhname\":\"授权码\",\"bindCmp\":\"MyGrid\",\"bindValue\":\"callcode\",\"isPublic\":\"on\",\"desc\":\"授权码\",\"uxcid\":\"grid\",\"group\":\"\",\"cmptype\":\"string\",\"cmpsettings\":\"{\\\"isMulti\\\":false,\\\"data\\\":\\\"\\\"}\",\"radio_oIS5\":\"string\"}},{\"cid\":\"uxprop\",\"id\":\"userInfo\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"userInfo\",\"desc\":\"用户信息服务\",\"zhname\":\"用户信息服务\",\"isPublic\":\"on\",\"radio_oIS5\":\"string\",\"bindCmp\":\"MyGrid\",\"bindValue\":\"userInfo\",\"uxcid\":\"grid\",\"cmptype\":\"string\",\"cmpsettings\":\"{\\\"isMulti\\\":false,\\\"data\\\":\\\"\\\"}\"}},{\"cid\":\"uxprop\",\"id\":\"orgschecount\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"orgschecount\",\"desc\":\"\",\"zhname\":\"数据服务地址\",\"isPublic\":\"on\",\"radio_oIS5\":\"string\",\"bindCmp\":\"MyGrid\",\"bindValue\":\"orgschecount\",\"uxcid\":\"grid\",\"cmptype\":\"string\",\"cmpsettings\":\"{\\\"isMulti\\\":false,\\\"data\\\":\\\"\\\"}\"}}]},{\"cid\":\"vmduxmethods\",\"id\":\"方法\",\"layoutConfig\":{},\"userConfig\":{}},{\"cid\":\"vmduxevents\",\"id\":\"事件\",\"layoutConfig\":{},\"userConfig\":{}}]}"}