{"vmdversion":"2.0.3.092701","vmdlayout":"{\"components\":[{\"cid\":\"uxpanel\",\"id\":\"Zytest\",\"layoutConfig\":{},\"userConfig\":{\"layout\":\"absolute\",\"header\":false,\"width\":618,\"height\":36,\"cls\":\"\"},\"cn\":[{\"cid\":\"vmdButton\",\"id\":\"homeButton\",\"layoutConfig\":{},\"userConfig\":{\"x\":0,\"y\":0,\"style\":\"background-image: url(\\\"/img/public/u165.png\\\");    background-repeat: no-repeat;    background-position: center center;    border-radius: 0px;    background-size: 22px 20px;    border-top: 0;    border-left: 0;\",\"text\":\"\",\"width\":42,\"id\":\"homeButton\",\"click\":\"homeButton_click\",\"height\":34}},{\"cid\":\"container\",\"id\":\"yarnball_ct\",\"layoutConfig\":{},\"userConfig\":{\"x\":42,\"y\":0,\"height\":32,\"id\":\"yarnball_ct\",\"afterrender\":\"yarnball_ct_afterrender\",\"html\":\"<div id=\\\"yarnball\\\" style=\\\"display: block\\\">\\n    <div>\\n        <span class=\\\"Ntext\\\">组织机构</span>\\n        <i class=\\\"icon-caret-right\\\">\\n        </i>\\n        <span class=\\\"Ntext\\\">单位管理</span>\\n    </div>\\n</div>\\n<div id=\\\"yarnball-input\\\" style=\\\"display: none;\\\">\\n    <input type=\\\"text\\\" name=\\\"path\\\" value=\\\"\\\" class=\\\"path\\\" id=\\\"path\\\">\\n</div>\",\"cls\":\"header-middle\",\"width\":\"\",\"border\":false}}]},{\"cid\":\"vmddataset\",\"id\":\"数据集\",\"layoutConfig\":{},\"userConfig\":{}}]}","vmdevents":"var that = this;\nvar NodeData = [],\n    nowNode;\nvar preIsShow = false,\n    nextIsShow = false;\n// 返回主页按键点击事件\nfunction homeButton_click(sender, e) {\n    that.fireEvent(\"homeClick\", sender, e)\n}\n\nfunction yarnball_ct_afterrender(sender) {\n    sender.setPath = function(address, path, isStorage) {\n        addressSet(address, path, isStorage);\n    }\n    var addressSet = function(address, path, isStorage) {\n        var _addressSet = function(address, path, sStorage) {\n            // 处理传递过来的路径\n            var e = address;\n            e = e.replace(/\\/+/g, \"/\");\n            var textData = e.split(\"/\");\n            \"\" == textData[textData.length - 1] && textData.pop();\n            var i = path;\n            i = i.replace(/\\/+/g, \"/\");\n            var idData = i.split(\"/\");\n            \"\" == idData[idData.length - 1] && idData.pop();\n\n            var addressObj = [];\n            for(var i = 0; i < textData.length; i++) {\n                addressObj.push({\n                    id: idData[i],\n                    text: textData[i],\n                })\n                if(addressObj[i - 1] && addressObj[i - 1].textPath) {\n                    addressObj[i].textPath = addressObj[i - 1].textPath + textData[i] + '/';\n                    addressObj[i].idPath = addressObj[i - 1].idPath + idData[i] + '/'\n                } else {\n                    addressObj[i].textPath = textData[i] + '/';\n                    addressObj[i].idPath = idData[i] + '/';\n                }\n            }\n            // 生成导航DOM结构\n            var str = '<div> ';\n            for(var i = 0; i < addressObj.length; i++) {\n                if(i == addressObj.length - 1) {\n                    str += '<p data-id=\"' + addressObj[i].id + '\" ><span class = \"Ntext\" data-textPath=\"' + addressObj[i].textPath + '\"  data-idPath=\"' + addressObj[i].idPath + '\">' + addressObj[i].text + '</span><p>'\n                } else {\n                    str += '<p data-id=\"' + addressObj[i].id + '\" ><span class = \"Ntext\" data-textPath=\"' + addressObj[i].textPath + '\"  data-idPath=\"' + addressObj[i].idPath + '\">' + addressObj[i].text + '</span>' +\n                        '<i class = \"icon-caret-right\"  data-id=\"' + addressObj[i].id + '\"  ></i></p>'\n                }\n            }\n            str += '<div> ';\n            // 记录节点操作痕迹\n            if(isStorage == false||isStorage=='undefined') {\n                \n            } else {  // 新操作的节点才记录，回退或前进操作不进行记录\n                var id = vmd.getGuid();\n                nowNode = {\n                    id: id,\n                    nodeId: addressObj[addressObj.length - 1].id,\n                    t: address,\n                    p: path\n                }\n                NodeData.push({\n                    id: id,\n                    nodeId: addressObj[addressObj.length - 1].id,\n                    t: address,\n                    p: path\n                })\n            }\n            return str\n        };\n        $(\"#yarnball\").html(_addressSet(address, path));\n    }\n    //初始化\n    $(\"#yarnball span\").die(\"click\").live(\"click\",\n        function(e) {\n            var t = $(this).attr(\"data-textPath\");\n            var d = $(this).attr(\"data-idPath\");\n            addressSet(t, d);\n            that.fireEvent('pathClick', sender, t, d);\n            stopPP(e)\n        });\n    $(\"#yarnball i\").die(\"click\").live(\"click\",\n        function(e) {\n            if($(this).hasClass('icon-caret-right')) {\n                $(this).removeClass('icon-caret-right');\n                $(this).addClass('icon-caret-down');\n            } else if($(this).hasClass('icon-caret-down')) {\n                $(this).removeClass('icon-caret-down');\n                $(this).addClass('icon-caret-right');\n            }\n            var id = $(this).attr(\"data-id\");\n            that.fireEvent('patnIcoClick', sender, $(this), id);\n            stopPP(e);\n        });\n}\n\nfunction previous(callback) {\n    if(!nowNode) {\n        return\n    }\n    for(var i = 0; i < NodeData.length; i++) {\n        if(NodeData[i].id == nowNode.id && NodeData[i - 1]) {\n            yarnball_ct.setPath(NodeData[i - 1].t, NodeData[i - 1].p, false);\n            nowNode = NodeData[i - 1];\n            nextIsShow = true;\n            break\n        }\n    }\n    if(NodeData[0].id == nowNode.id) {\n        preIsShow = false;\n    } else {\n        preIsShow = true;\n    }\n    callback(nowNode.nodeId)\n}\n\nfunction next(callback) {\n    if(!nowNode) {\n        return\n    }\n    for(var i = 0; i < NodeData.length; i++) {\n        if(NodeData[i].id == nowNode.id && NodeData[i + 1]) {\n            yarnball_ct.setPath(NodeData[i + 1].t, NodeData[i + 1].p, false);\n            nowNode = NodeData[i + 1];\n            preIsShow = true;\n            break\n        }\n    }\n    if(NodeData[NodeData.length - 1].id == nowNode.id) {\n        nextIsShow = false;\n    } else {\n        nextIsShow = true;\n    }\n    callback(nowNode.nodeId)\n}","vmdcss":".header-middle #yarnball {\r\n    width: 100%;\r\n    height: 32px;\r\n    overflow: hidden;\r\n    float: left;\r\n    border: 1px solid #ddd;\r\n    margin-left: -1px;\r\n    padding-left: 5px;\r\n}\r\n\r\n.header-middle #yarnball .yarnball {\r\n    list-style: none;\r\n    margin: 0;\r\n    margin-top: -1px;\r\n    padding: 0;\r\n    position: relative;\r\n}\r\n\r\n.header-middle #yarnball .yarnball .yarnlet {\r\n    display: inline-block;\r\n    float: left;\r\n}\r\n\r\n.header-middle #yarnball .yarnball .yarnlet a,.header-middle #yarnball .yarnball .yarnlet a:link,.header-middle #yarnball .yarnball .yarnlet a:visited {\r\n    color: #666;\r\n    display: inline-block;\r\n    font-size: 1em;\r\n    padding: 0px 15px 0px 20px;\r\n    margin-left: -15px;\r\n    position: relative;\r\n    text-decoration: none;\r\n    vertical-align: top;\r\n    line-height: 27px;\r\n}\r\n\r\n.header-middle #yarnball .yarnball .yarnlet.first a {\r\n    margin-left: 0px;\r\n    padding-left: 15px;\r\n}\r\n\r\n.header-middle #yarnball .yarnball .yarnlet a:hover {\r\n    background-position: 100% -48px;\r\n    color: #333;\r\n}\r\n\r\n.header-middle #yarnball .yarnball .yarnlet a:active,.header-middle #yarnball .yarnball .yarnlet a.curDropToPath {\r\n    background-position: 100% -96px;\r\n    color: #333;\r\n}\r\n\r\n.header-middle #yarnball .yarnball .yarnlet a.curDropToPath {\r\n    color: #fff;\r\n    background-position: 100% -144px;\r\n}\r\n\r\n.header-middle #yarnball .yarnball .yarnlet .left-yarn {\r\n    background: url(\"/img/common/ybutton.png\") no-repeat 0 -2px;\r\n    margin-left: -17px;\r\n    padding: 5px 6px 11px 4px;\r\n    z-index: 11;\r\n    padding-top: 5px \\9;\r\n}\r\n\r\n.header-middle #yarnball .yarnball .yarnlet a:hover .left-yarn {\r\n    background-position: 0 -50px;\r\n}\r\n\r\n.header-middle #yarnball .yarnball .yarnlet a:active .left-yarn {\r\n    background-position: 0 -98px;\r\n}\r\n\r\n\r\n.header-middle #yarnball-input input.path {\r\n    border: none;\r\n    height: 25px;\r\n    display: block;\r\n    width: 100%;\r\n    padding: 0;\r\n    padding-left: 10px;\r\n    padding-right: 10px;\r\n    background: #f8f8f8;\r\n    background: #f8f8f8 url(\"/img/common/bg.gif\") 0px -2px repeat-x;\r\n    background: none;\r\n    width: 94%;\r\n    font-size: 1em;\r\n    line-height: 25px;\r\n    color: #444;\r\n}\r\n\r\n.header-middle #yarnball-input input:focus {\r\n    outline: none;\r\n}\r\n#yarnball p{\r\n    display: inline-block;\r\n}\r\n.Ntext{\r\n    display: inline-block;\r\n    line-height: 32px;\r\n    cursor: default;\r\n}\r\n.icon-caret-right,.icon-caret-down{\r\n    padding: 0 5px;\r\n}","vmdprops":"\"\"","type":"ux","vmdinterface":"{\"components\":[{\"cid\":\"vmduxprops\",\"layoutConfig\":{},\"userConfig\":{}},{\"cid\":\"vmduxmethods\",\"id\":\"方法\",\"layoutConfig\":{},\"userConfig\":{},\"cn\":[{\"cid\":\"uxmethod\",\"id\":\"setPath\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"setPath\",\"zhname\":\"\",\"bindCmp\":\"\",\"bindValue\":\"\",\"isPublic\":\"on\",\"desc\":\"\",\"uxcid\":\"\",\"params\":\"address, path\",\"code\":\"//直接填写方法内容\\nyarnball_ct.setPath(address, path)\",\"returnType\":\"无\"}},{\"cid\":\"uxmethod\",\"id\":\"previousChange\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"previousChange\",\"zhname\":\"\",\"bindCmp\":\"\",\"bindValue\":\"\",\"isPublic\":\"on\",\"desc\":\"回退操作，回调函数返回会退后当前节点id\",\"uxcid\":\"\",\"params\":\"callback\",\"code\":\"//直接填写方法内容\\nprevious(callback)\",\"returnType\":\"\"}},{\"cid\":\"uxmethod\",\"id\":\"nextChange\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"nextChange\",\"zhname\":\"\",\"bindCmp\":\"\",\"bindValue\":\"\",\"isPublic\":\"on\",\"desc\":\"前进操作，回调函数返回前进后当前节点id\",\"uxcid\":\"\",\"params\":\"callback\",\"code\":\"//直接填写方法内容\\n next(callback)\",\"returnType\":\"\"}},{\"cid\":\"uxmethod\",\"id\":\"preIsEnabled\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"preIsEnabled\",\"zhname\":\"\",\"bindCmp\":\"\",\"bindValue\":\"\",\"isPublic\":\"on\",\"desc\":\"\",\"uxcid\":\"\",\"params\":\"\",\"code\":\"//直接填写方法内容\\nreturn preIsShow\",\"returnType\":\"\"}},{\"cid\":\"uxmethod\",\"id\":\"nexIsEnabled\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"nexIsEnabled\",\"zhname\":\"\",\"bindCmp\":\"\",\"bindValue\":\"\",\"isPublic\":\"on\",\"desc\":\"\",\"uxcid\":\"\",\"params\":\"\",\"code\":\"//直接填写方法内容\\nreturn nextIsShow\",\"returnType\":\"\"}}]},{\"cid\":\"vmduxevents\",\"id\":\"事件\",\"layoutConfig\":{},\"userConfig\":{},\"cn\":[{\"cid\":\"uxevent\",\"id\":\"homeClick\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"homeClick\",\"zhname\":\"\",\"bindCmp\":\"\",\"bindValue\":\"\",\"isPublic\":\"\",\"desc\":\"返回主页面\",\"uxcid\":\"\",\"params\":\"e\",\"code\":\"\"}},{\"cid\":\"uxevent\",\"id\":\"pathClick\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"pathClick\",\"zhname\":\"\",\"bindCmp\":\"\",\"bindValue\":\"\",\"isPublic\":\"\",\"desc\":\"\",\"uxcid\":\"\",\"params\":\"textpath,idpath\",\"code\":\"\"}},{\"cid\":\"uxevent\",\"id\":\"patnIcoClick\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"patnIcoClick\",\"zhname\":\"\",\"bindCmp\":\"\",\"bindValue\":\"\",\"isPublic\":\"\",\"desc\":\"\",\"uxcid\":\"\",\"params\":\"e,id\",\"code\":\"\"}}]}]}"}