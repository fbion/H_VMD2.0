{"vmdversion":"vmd2.0.5.191130","vmdlayout":"{\"components\":[{\"cid\":\"uxpanel\",\"id\":\"GridType_new\",\"layoutConfig\":{},\"userConfig\":{\"layout\":\"fit\",\"header\":false,\"width\":320,\"autoScroll\":false,\"autoHeight\":false,\"height\":700},\"cn\":[{\"cid\":\"panel\",\"id\":\"panel\",\"layoutConfig\":{},\"userConfig\":{\"title\":\"配置\",\"layout\":\"border\",\"autoScroll\":true,\"header\":false},\"cn\":[{\"cid\":\"panel\",\"id\":\"panel5\",\"layoutConfig\":{},\"userConfig\":{\"region\":\"center\",\"layout\":\"border\",\"header\":false,\"autoScroll\":false},\"cn\":[{\"cid\":\"container\",\"id\":\"div\",\"layoutConfig\":{},\"userConfig\":{\"width\":482,\"height\":40,\"layout\":\"border\",\"border\":false,\"region\":\"north\"},\"cn\":[{\"cid\":\"panel\",\"id\":\"panel4\",\"layoutConfig\":{\"align\":\"middle\",\"pack\":\"start\"},\"userConfig\":{\"region\":\"north\",\"height\":35,\"border\":false,\"header\":false,\"layout\":\"hbox\"},\"cn\":[{\"cid\":\"label\",\"id\":\"label\",\"layoutConfig\":{},\"userConfig\":{\"text\":\"锁定列数：\",\"margins\":\"0 0 0 5\"}},{\"cid\":\"numberfield\",\"id\":\"fixedCol\",\"layoutConfig\":{},\"userConfig\":{\"width\":178,\"id\":\"fixedCol\",\"allowDecimals\":false,\"allowNegative\":false,\"afterrender\":\"fixedCol_afterrender\"}}]}]},{\"cid\":\"panel\",\"id\":\"panel2\",\"layoutConfig\":{},\"userConfig\":{\"region\":\"center\",\"header\":false,\"layout\":\"border\",\"border\":false,\"autoScroll\":false,\"autoHeight\":false},\"cn\":[{\"cid\":\"grid\",\"id\":\"MyGrid\",\"layoutConfig\":{},\"userConfig\":{\"region\":\"center\",\"beforerender\":\"MyGrid_beforerender\",\"hideHeaders\":true,\"disableHeaderClick\":true,\"title\":\"字段配置\",\"afterrender\":\"MyGrid_afterrender\",\"celldblclick\":\"MyGrid_celldblclick\",\"header\":false},\"cn\":[{\"cid\":\"gridcolumn\",\"layoutConfig\":{},\"userConfig\":{\"header\":\"Column 1\",\"dataIndex\":\"mixName\",\"width\":300},\"name\":\"mixName\"}]},{\"cid\":\"container\",\"id\":\"hwDiv\",\"layoutConfig\":{},\"userConfig\":{\"region\":\"north\",\"height\":35,\"layout\":\"border\",\"style\":\"background-color: #f4f6fd\"},\"cn\":[{\"cid\":\"vmdButton\",\"id\":\"button\",\"layoutConfig\":{},\"userConfig\":{\"text\":\"字段配置\",\"margins\":\"5 5 0 5\",\"click\":\"button_click\",\"type\":\"text\",\"region\":\"west\",\"style\":\"font-weight: bold\"}},{\"cid\":\"container\",\"id\":\"hwDiv2\",\"layoutConfig\":{},\"userConfig\":{\"region\":\"center\",\"border\":false}},{\"cid\":\"container\",\"id\":\"hwDiv1\",\"layoutConfig\":{\"align\":\"middle\",\"pack\":\"start\"},\"userConfig\":{\"region\":\"east\",\"width\":200,\"border\":false,\"layout\":\"hbox\"},\"cn\":[{\"cid\":\"vmdButton\",\"id\":\"button6\",\"layoutConfig\":{},\"userConfig\":{\"iconcls\":\"\",\"type\":\"text\",\"text\":\"\",\"width\":30,\"icon\":\"\",\"cls\":\"icon-ficsel\",\"click\":\"button6_click\"}},{\"cid\":\"vmdButton\",\"id\":\"button5\",\"layoutConfig\":{},\"userConfig\":{\"iconcls\":\"\",\"type\":\"text\",\"text\":\"\",\"width\":30,\"icon\":\"icon-fic-add\",\"cls\":\"icon-ficadd\",\"click\":\"button5_click\"}},{\"cid\":\"vmdButton\",\"id\":\"button1\",\"layoutConfig\":{},\"userConfig\":{\"margins\":\"\",\"text\":\"\",\"width\":30,\"type\":\"text\",\"iconcls\":\"\",\"click\":\"button1_click\",\"cls\":\"icon-ficup\"}},{\"cid\":\"vmdButton\",\"id\":\"button2\",\"layoutConfig\":{},\"userConfig\":{\"margins\":\"\",\"text\":\"\",\"height\":\"\",\"width\":30,\"type\":\"text\",\"iconcls\":\"\",\"click\":\"button2_click\",\"cls\":\"icon-ficdown\"}},{\"cid\":\"vmdButton\",\"id\":\"button4\",\"layoutConfig\":{},\"userConfig\":{\"icon\":\"\",\"text\":\"\",\"type\":\"text\",\"margins\":\"\",\"click\":\"button4_click\",\"iconcls\":\"\",\"width\":30,\"cls\":\"icon-ficdel\"}},{\"cid\":\"vmdButton\",\"id\":\"button3\",\"layoutConfig\":{},\"userConfig\":{\"type\":\"text\",\"margins\":\"\",\"text\":\"\",\"click\":\"button3_click\",\"iconcls\":\"\",\"width\":30,\"cls\":\"icon-ficgtf\"}}]}]}]}]},{\"cid\":\"panel\",\"id\":\"panel6\",\"layoutConfig\":{\"align\":\"middle\",\"pack\":\"start\"},\"userConfig\":{\"region\":\"north\",\"header\":false,\"height\":35,\"layout\":\"hbox\",\"style\":\"padding-top: 5px\"},\"cn\":[{\"cid\":\"label\",\"id\":\"label3\",\"layoutConfig\":{},\"userConfig\":{\"margins\":\"0 0 0 5\",\"text\":\"展示方式：\"}},{\"cid\":\"radiogroup\",\"id\":\"grid_display\",\"layoutConfig\":{},\"userConfig\":{\"height\":30,\"margins\":\"0 0 0 5\",\"id\":\"grid_display\",\"change\":\"grid_display_change\"},\"cn\":[{\"cid\":\"radio\",\"id\":\"hwRadio\",\"layoutConfig\":{},\"userConfig\":{\"boxLabel\":\"实际宽度\",\"fieldLabel\":\"\",\"width\":81,\"checked\":true,\"inputValue\":\"0\"}},{\"cid\":\"radio\",\"id\":\"hwRadio1\",\"layoutConfig\":{},\"userConfig\":{\"fieldLabel\":\"\",\"boxLabel\":\"比例平铺\",\"inputValue\":\"1\"}}]}]}]}]}]}","vmdevents":"var page = this;\r\n\r\npage.controller = new vmd.ux.gridType.Controller(this)\r\n\r\nvar util = new ide.ext.DataInputUtils(page, 'grid')\r\n\r\npage.selectedField = new Ext.data.JsonStore({\r\n    proxy: new Ext.data.MemoryProxy(),\r\n    fields: ['mixName']\r\n});\r\n\r\nfunction MyGrid_beforerender(sender) {\r\n    this.ddGroup = 'griddd';\r\n    this.enableDragDrop = true;\r\n    sender.store = page.selectedField;\r\n\r\n    MyGrid.on('cellclick', function(sender, rowindex, cellindex) {\r\n        page.selNo = rowindex;\r\n        var gv = MyGrid.getView();\r\n        var row = gv.getRow(rowindex);\r\n        Ext.get(row).removeClass('x-grid3-row-selected')\r\n        currow = gv.getRow(rowindex);\r\n        Ext.get(currow).addClass('x-grid3-row-selected')\r\n    })\r\n}\r\n\r\nfunction grid_display_change(sender, checked) {\r\n    page.controller.settings.displayMode = checked.inputValue\r\n    page.fireEvent('settingChangeEvents')\r\n}\r\n\r\nfunction MyGrid_afterrender(sender) {\r\n    var store = this.store\r\n    var ddrow = new Ext.dd.DropTarget(MyGrid.container, {\r\n        ddGroup: 'griddd',\r\n        copy: false,\r\n        notifyEnter: function(ddSource, e, data) {},\r\n        notifyDrop: function(ddSource, e, data) {\r\n            \tvar list = page.controller.settings.fields;\r\n            // 选中了多少行\r\n            var rows = data.selections;\r\n            // 拖动到第几行\r\n            var index = ddSource.getDragData(e).rowIndex;\r\n            if (typeof(index) == \"undefined\") {\r\n                return;\r\n            }\r\n            // 修改store\r\n            for (i = 0; i < rows.length; i++) {\r\n                var rowData = rows[i];\r\n                 lindex=store.indexOf(rowData)\r\n                temp=list[lindex]\r\n                list.remove(list[lindex])\r\n                list.splice(index, 0, temp);\r\n                if (!this.copy) store.remove(rowData);\r\n                store.insert(index, rowData);\r\n            }\r\n            page.selected = Ext.pluck(store.data.items, 'json')\r\n            page.selectedField.loadData(page.selected)\r\n\t\tpage.fireEvent('settingChangeEvents')\r\n        }\r\n    });\r\n}\r\n\r\nfunction grid_rowChange_afterrender(sender) {\r\n    setEvent(sender, 'grid_rowChange', \"\")\r\n}\r\n\r\nfunction grid_rowSelected_afterrender(sender) {\r\n    setEvent(sender, 'grid_rowSelected', \"\")\r\n}\r\n\r\nfunction MyTabs_afterrender(sender) {\r\n    sender.header.setDisplayed(false)\r\n}\r\n\r\nfunction fixedCol_afterrender(sender) {\r\n    sender.el.on('change', function() {\r\n        var max = page.rootScope.controller.comp.grid.settings.fields.length;\r\n        if (max < fixedCol.getValue()) {\r\n            vmd.tip('锁定列数超过已选择字段数', 'error')\r\n            fixedCol.setValue(page.controller.settings.fc)\r\n            return;\r\n        }\r\n        page.controller.settings.fc = sender.getValue()\r\n        page.fireEvent('settingChangeEvents')\r\n    })\r\n}\r\n\r\nfunction button_click(sender, e) {\r\n}\r\n\r\nfunction button3_click(sender, e) {\r\n    util.copyToAnother()\r\n}\r\n\r\nfunction MyGrid_celldblclick(sender, rowIndex, columnIndex, e) {\r\n    util.celldbclick()\r\n}\r\n\r\nfunction button1_click(sender, e) {\r\n    util.moveUp()\r\n}\r\n\r\nfunction button2_click(sender, e) {\r\n    util.moveDown()\r\n}\r\n\r\nfunction button4_click(sender, e) {\r\n    util.delete()\r\n}\r\n\r\nfunction button6_click(sender,e){\r\n    util.clickFieldsSelect()\r\n}\r\n\r\nfunction button5_click(sender,e){alert('打开虚拟列') \r\n}","vmdcss":".icon-ficup {\n    background-image: url(/img/public/fic_add.png) !important;\n    background-repeat: no-repeat !important;\n    background-position: left center !important;\n}\n\n.icon-ficdown {\n    background-image: url(/img/public/fic_down.png) !important;\n    background-repeat: no-repeat !important;\n    background-position: left center !important;\n}\n.icon-ficup {\n    background-image: url(/img/public/fic_up.png) !important;\n    background-repeat: no-repeat !important;\n    background-position: left center !important;\n}\n.icon-ficadd {\n    background-image: url(/img/public/fic_add.png) !important;\n    background-repeat: no-repeat !important;\n    background-position: left center !important;\n}\n\n.icon-ficsel {\n    background-image: url(/img/public/fic_sel.png) !important;\n    background-repeat: no-repeat !important;\n    background-position: left center !important;\n}\n\n.icon-ficftg {\n    background-image: url(/img/public/fic_ftg.png) !important;\n    background-repeat: no-repeat !important;\n    background-position: left center !important;\n}\n\n.icon-ficgtf {\n    background-image: url(/img/public/fic_gtf.png) !important;\n    background-repeat: no-repeat !important;\n    background-position: left center !important;\n}\n\n.icon-ficdel {\n    background-image: url(/img/public/fic_del.png) !important;\n    background-repeat: no-repeat !important;\n    background-position: left center !important;\n}","vmdprops":"\"\"","type":"ux","vmdevents_controller":"//grid\nExt.define('vmd.ux.gridType.Controller', {\n    xtype: 'vmd.ux.gridType.Controller',\n    constructor: function(options) {\n        this.scope = options;\n        this.settings = new vmd.ux.gridType.settings(options);\n        // this.events = new vmd.ux.gridType.events(options);\n    },\n    setValue: function(jsonConfig) {\n        if (jsonConfig) {\n            //设置值和事件\n            this.settings.setValue(jsonConfig.settings);\n            // this.events.setValue(jsonConfig.events);\n            //取得的已选字段\n            var temp = [];\n            for (var i = 0; i < jsonConfig.settings.fields.length; i++) {\n                temp.push(jsonConfig.settings.fields[i].dictionary)\n            }\n            this.scope.selectedField.loadData(temp)\n            //grid层需要展示赋值的\n            // this.scope.grid_dataSet.setValue(this.settings.storeName);\n\n        }\n    },\n    serialize: function() {\n        var json = {\n            settings: this.settings.serialize()\n            // events: this.events.serialize()\n        }\n        return json;\n    }\n})\n\n//grid-settings\nExt.define('vmd.ux.gridType.settings', {\n    xtype: 'vmd.ux.gridType.settings',\n    constructor: function(options) {\n        this.displayMode = '0'\n        this.fc = '0'\n        this.fields = [];\n        this.scope = options;\n    },\n    setValue: function(jsonConfig) {\n        if (jsonConfig) {\n            this.displayMode = jsonConfig.displayMode;\n            this.fc = jsonConfig.fc;\n            this.fields = jsonConfig.fields;\n            this.scope.grid_display.setValue(this.displayMode)\n            this.scope.fixedCol.setValue(this.fc)\n        }\n    },\n    serialize: function() {\n        var temp = [];\n        for (var i = 0; i < this.fields.length; i++) {\n            var tmp\n            if (this.fields[i] && this.fields[i].fieldsConfig && this.fields[i].fieldsConfig.hasOwnProperty('scope')) {\n                tmp = {\n                    fieldsConfig: this.fields[i].fieldsConfig.serialize(),\n                    dictionary: this.fields[i].dictionary\n                }\n                if (this.fields[i] && this.fields[i].selected) tmp.selected = this.fields[i].selected\n            } else {\n                tmp = this.fields[i]\n            }\n            //删除数据字典中的role规则\n\n            if (tmp.dictionary) {\n                delete tmp.dictionary.rule;\n                delete tmp.dictionary.rules;\n                delete tmp.dictionary.xml;\n                delete tmp.dictionary.defaultValue;\n            }\n            temp.push(tmp)\n        }\n        var json = {\n            displayMode: this.displayMode,\n            fc: this.fc,\n            fields: temp,\n            issave: true\n        }\n        return json;\n    }\n})\n\n//grid-settings\nExt.define('vmd.ux.gridType.settings.fieldSettings', {\n    xtype: 'vmd.ux.gridType.settings.fieldSettings',\n    constructor: function(options) {\n        this.scope = options;\n        this.dictionary;\n        this.fieldsConfig;\n    },\n    setValue: function(jsonConfig) {\n        if (jsonConfig) {\n            this.dictionary = jsonConfig.dictionary;\n            this.fieldsConfig = jsonConfig.fieldsConfig.serialize();\n        }\n    },\n    serialize: function() {\n\n        var temp = {};\n        if (this.fieldsConfig) {\n            temp = this.fieldsConfig.serialize();\n        }\n        var json = {\n            dictionary: this.dictionary,\n            fieldsConfig: temp\n        }\n        return json;\n    }\n})","vmdinterface":"{\"components\":[{\"cid\":\"vmduxprops\",\"layoutConfig\":{},\"userConfig\":{}},{\"cid\":\"vmduxmethods\",\"id\":\"方法\",\"layoutConfig\":{},\"userConfig\":{},\"cn\":[{\"cid\":\"uxmethod\",\"id\":\"serialize\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"serialize\",\"zhname\":\"\",\"bindCmp\":\"\",\"bindValue\":\"\",\"isPublic\":\"on\",\"desc\":\"\",\"uxcid\":\"\",\"params\":\"info\",\"code\":\"page.controller.serialize();\",\"returnType\":\"\"}},{\"cid\":\"uxmethod\",\"id\":\"setInfo\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"setInfo\",\"zhname\":\"\",\"bindCmp\":\"\",\"bindValue\":\"\",\"isPublic\":\"on\",\"desc\":\"\",\"uxcid\":\"\",\"params\":\"info\",\"code\":\"page.controller.setValue(info)\",\"returnType\":\"\"}},{\"cid\":\"uxmethod\",\"id\":\"initDefault\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"initDefault\",\"zhname\":\"\",\"bindCmp\":\"\",\"bindValue\":\"\",\"isPublic\":\"on\",\"desc\":\"\",\"uxcid\":\"\",\"params\":\"\",\"code\":\"//直接填写方法内容\\ninit()\",\"returnType\":\"\"}}]},{\"cid\":\"vmduxevents\",\"id\":\"事件\",\"layoutConfig\":{},\"userConfig\":{},\"cn\":[{\"cid\":\"uxevent\",\"id\":\"copyGridToForm\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"copyGridToForm\",\"zhname\":\"\",\"bindCmp\":\"\",\"bindValue\":\"\",\"isPublic\":\"\",\"desc\":\"\",\"uxcid\":\"\",\"params\":\"\",\"code\":\"\"}},{\"cid\":\"uxevent\",\"id\":\"compareDataSet\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"compareDataSet\",\"zhname\":\"\",\"bindCmp\":\"\",\"bindValue\":\"\",\"isPublic\":\"\",\"desc\":\"\",\"uxcid\":\"\",\"params\":\"sender,value\",\"code\":\"\"}},{\"cid\":\"uxevent\",\"id\":\"settingChangeEvents\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"settingChangeEvents\",\"params\":\"\",\"desc\":\"\"}}]}]}","vmdresource":"{\"components\":[{\"cid\":\"vmdrescsss\",\"layoutConfig\":{},\"userConfig\":{},\"cn\":[{\"cid\":\"rescss\",\"id\":\"components/ux/gridtype/1.0/css/icons.css\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"components/ux/gridtype/1.0/css/icons.css\",\"path\":\"components/ux/gridtype/1.0/css/icons.css\",\"absolutePath\":\"{{vmduxpath}}/components/ux/gridtype/1.0/css/icons.css\",\"ext\":\"css\"}}]},{\"cid\":\"vmdresjss\",\"layoutConfig\":{},\"userConfig\":{},\"cn\":[{\"cid\":\"resjs\",\"id\":\"controller.js\",\"layoutConfig\":{},\"userConfig\":{}}]},{\"cid\":\"vmdresimgs\",\"layoutConfig\":{},\"userConfig\":{}}]}"}