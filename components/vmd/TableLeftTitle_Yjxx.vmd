{"vmdversion":"2.0.3.0920","vmdlayout":"{\"components\":[{\"cid\":\"uxpanel\",\"id\":\"TableLeftTitle_Yjxx\",\"layoutConfig\":{},\"userConfig\":{\"layout\":\"fit\",\"header\":false,\"width\":860,\"height\":\"\",\"autoHeight\":true},\"cn\":[{\"cid\":\"panel\",\"id\":\"panel\",\"layoutConfig\":{},\"userConfig\":{\"x\":\"\",\"y\":\"\",\"border\":true,\"header\":false,\"height\":300,\"width\":770,\"afterrender\":\"panel_afterrender\",\"padding\":\"\",\"title\":\"预警信息通用报表\",\"layout\":\"hbox\",\"autoHeight\":false},\"cn\":[{\"cid\":\"container\",\"id\":\"div_l\",\"layoutConfig\":{},\"userConfig\":{\"width\":80,\"id\":\"div_l\",\"html\":\"\",\"layout\":\"auto\",\"backgroundPosition\":\"center center\"}},{\"cid\":\"grid\",\"id\":\"MyGrid\",\"layoutConfig\":{},\"userConfig\":{\"hideHeaders\":false,\"header\":false,\"border\":true,\"height\":300,\"width\":762,\"beforerender\":\"MyGrid_beforerender\",\"cls\":\"vmd-grid\"},\"cn\":[{\"cid\":\"gridcolumn\",\"layoutConfig\":{},\"userConfig\":{\"header\":\"序号\",\"dataIndex\":\"xh\",\"align\":\"center\",\"resizable\":false,\"fixed\":true,\"menuDisabled\":false},\"name\":\"xh\"},{\"cid\":\"gridcolumn\",\"layoutConfig\":{},\"userConfig\":{\"align\":\"center\",\"dataIndex\":\"ygjxxid\",\"header\":\"预告警信息id\",\"hidden\":true,\"menuDisabled\":true},\"name\":\"ygjxxid\"},{\"cid\":\"gridcolumn\",\"layoutConfig\":{},\"userConfig\":{\"header\":\"预告警对象\",\"dataIndex\":\"ygjmc\",\"align\":\"center\",\"width\":200,\"menuDisabled\":true,\"css\":\"text-align: left !important;\",\"hidden\":false,\"resizable\":false},\"name\":\"ygjmc\"},{\"cid\":\"gridcolumn\",\"layoutConfig\":{},\"userConfig\":{\"header\":\"预告警时间\",\"dataIndex\":\"ygjsj\",\"align\":\"center\",\"menuDisabled\":true,\"css\":\"text-align: center !important;\",\"width\":150},\"name\":\"ygjsj\"},{\"cid\":\"gridcolumn\",\"layoutConfig\":{},\"userConfig\":{\"header\":\"参数名称\",\"dataIndex\":\"csmc\",\"align\":\"center\",\"menuDisabled\":true,\"css\":\"text-align: left !important;\"},\"name\":\"csmc\"},{\"cid\":\"gridcolumn\",\"layoutConfig\":{},\"userConfig\":{\"header\":\"预告警内容\",\"dataIndex\":\"ygjnr\",\"align\":\"center\",\"menuDisabled\":true,\"css\":\"text-align: left !important;\"},\"name\":\"ygjnr\"},{\"cid\":\"gridcolumn\",\"layoutConfig\":{},\"userConfig\":{\"header\":\"历史处置\",\"dataIndex\":\"op\",\"align\":\"center\",\"menuDisabled\":true,\"css\":\"text-align: center !important;\",\"resizable\":true},\"name\":\"op\"}]}]}]}]}","vmdevents":"var page = this;\nvar dbrwDateList = [];\nvar store3 = new Ext.data.JsonStore({\n    proxy: new Ext.data.MemoryProxy(),\n    fields: [\"xh\",\"ygjxxid\", \"ygjmc\", \"ygjsj\", \"csmc\", \"ygjnr\", \"op\"]\n});\nvar ptServer = {\n    ip: '192.168.1.180:6602',\n    callcode: 'snyjcz',\n    //userInfo: 'platform/v1/UserManage', //用户信息服务\n    dsurl: 'XXHTS/monitor/warninghandle/handle/warninginfo'\n};\n//var dwdm = '';\n\nfunction MyGrid_beforerender(sender) {\n    this.store = store3;\n}\n\n//获取用户信息\n// function loginInfo() {\n//     var hwDao = new HwDao(ptServer.ip, ptServer.callcode); //地址:端口和授权码(服务管理员分配)\n//     var url = ptServer.userInfo;\n//     hwDao.get(url, {}, {}, function(res) {\n//         if(res.data[0].size > 0) {\n//             dwdm = res.data[0].datas[0].dwdm;\n//             loadData(dwdm);\n//         } else {\n//             loadData(dwdm);\n//         }\n//     }, function() {}); /*成功回调函数*/\n// }\n\nfunction panel_afterrender(sender) {\n   // loginInfo();\n   loadData();\n}\n\n//加载用户数据\nfunction loadData(dwcode) {\n    var hwDao = new HwDao(ptServer.ip, ptServer.callcode); //地址:端口和授权码(服务管理员分配)\n    var url = ptServer.dsurl;\n    hwDao.get(url, {}, \"\", function(res) {\n        if(res.isSucceed) {\n            if(res.data && res.data[0].datas.length > 0) {\n                var data = res.data[0].datas;\n                for(var i = 0; i < data.length; i++) {\n                    var itemObj = {\n                        xh: i + 1,\n                        ygjxxid: i + 1,\n                       // dwdm: data[i].dwdm,\n                        ygjmc: data[i].warning_obj,\n                        ygjsj: data[i].warning_date,\n                        csmc: data[i].warning_event,\n                        ygjnr:data[i].warning_content,\n                        op: \"<a href='#' class='hand'>历史处置</a>\"\n                       \n                    }\n                    dbrwDateList.push(itemObj);\n                }\n            }\n            \n            store3.loadData(dbrwDateList);\n            gridSpan(MyGrid,\"row\",\"[title]\",'');\n           \n            \n        } else {\n            alert(res.errMsg);\n        }\n    }, function(res) {\n        alert(res);\n    });\n}\n\nfunction gridSpan(grid, rowOrCol, cols, sepCol){\n    var array1 = new Array();\n    var arraySep = new Array();\n    var count1 = 0;\n    var count2 = 0;\n    var index1 = 0;\n    var index2 = 0;\n    var aRow = undefined;\n    var preValue = undefined;\n    var firstSameCell = 0;\n    var allRecs = grid.getStore().getRange();\n    if(rowOrCol == \"row\"){\n        count1 = grid.getColumnModel().getColumnCount();\n        count2 = grid.getStore().getCount();\n        grid.height= count2*31+29;\n        var aa = panel.el.dom.childNodes[0].childNodes[0].childNodes[0].childNodes[0].id;\n        vmd(\"#\" + aa + \"\").append(\"<div style='font-size:14px;font-weight:bold;margin-top:50%;'><span>预警信息</span></div>\");\n        vmd(\"#\" + aa + \"\").css({\n        \"height\": (count2*31+29)+3,\n       // \"line-height\":(count2+1)*30+6,\n         \"background-color\": \"#f7f7f7\",\n         \"text-align\": \"center\",\n         \"margin-top\":\"1px\"\n        \n    });\n    } else {\n        count1 = grid.getStore().getCount();\n        count2 = grid.getColumnModel().getColumnCount();\n    }\n    \n    \n    \n    \n//     for(i = 0; i < count1; i++){\n//         if(rowOrCol == \"row\"){\n//             var curColName = grid.getColumnModel().getDataIndex(i);\n//             var curCol = \"[\" + curColName + \"]\";\n//             if(cols.indexOf(curCol) < 0)\n//             continue;\n//         }\n//         preValue = undefined;\n//         firstSameCell = 0;\n//         array1[i] = new Array();\n//         for(j = 0; j < count2; j++){\n//             if(rowOrCol == \"row\"){\n//                 index1 = j;\n//                 index2 = i;\n//             } else {\n//                 index1 = i;\n//                 index2 = j;\n//             }\n//             var colName = grid.getColumnModel().getDataIndex(index2);\n//             if(sepCol && colName == sepCol)\n//             arraySep[index1] = allRecs[index1].get(sepCol);\n//             var seqOldValue = seqCurValue = \"1\";\n//             if(sepCol && index1 > 0){\n//                 seqOldValue = arraySep[index1 - 1];\n//                 seqCurValue = arraySep[index1];\n//             }\n             \n//             if(allRecs[index1].get(colName) == preValue && (colName == sepCol || seqOldValue == seqCurValue)){\n// //                 alert(colName + \"======\" + seqOldValue + \"======\" + seqCurValue);\n//                  allRecs[index1].set(colName, \"\");\n//                  array1[i].push(j);\n//                  if(j == count2 - 1){\n//                      var index = firstSameCell + Math.round((j + 1 - firstSameCell) / 2 - 1);\n//                      if(rowOrCol == \"row\"){\n//                          allRecs[index].set(colName, preValue);\n//                       } else {\n//                           allRecs[index1].set(grid.getColumnModel().getColumnId(index), preValue);\n//                       }\n//                   }\n//               } else {\n//                   if(j != 0){\n//                       var index = firstSameCell + Math.round((j + 1 - firstSameCell) / 2 - 1);\n//                       if(rowOrCol == \"row\"){\n//                           allRecs[index].set(colName, preValue);\n//                       } else {\n//                           allRecs[index1].set(grid.getColumnModel().getColumnId(index), preValue);\n//                     }\n//                   }\n//               firstSameCell = j;\n//               preValue = allRecs[index1].get(colName);\n//               allRecs[index1].set(colName, \"\");\n//               if(j == count2 - 1){\n//                   allRecs[index1].set(colName, preValue);\n//               }\n//           }\n//         }\n        \n//     }\n  //  grid.getStore().commitChanges();\n    //添加所有分隔线\n    // var rCount = grid.getStore().getCount();\n    // for(i = 0; i < rCount; i ++){\n    //     for(j = 0; j < grid.getColumnModel().getColumnCount(); j ++){\n    //           aRow = grid.getView().getCell(i,j);\n    //          if(i == 0){\n    //              aRow.style.borderTop = \"none\";\n    //              aRow.style.borderLeft = \"1px solid #ccc\";\n    //          }else if(i == rCount - 1){\n    //              aRow.style.borderTop = \"1px solid #ccc\";\n    //              aRow.style.borderLeft = \"1px solid #ccc\";\n    //             aRow.style.borderBottom = \"1px solid #ccc\";\n    //          }else{\n    //              aRow.style.borderTop = \"1px solid #ccc\";\n    //              aRow.style.borderLeft = \"1px solid #ccc\";\n    //          }\n    //          if(j == grid.getColumnModel().getColumnCount()-1)\n    //              aRow.style.borderRight = \"1px solid #ccc\";\n    //         if(i == rCount-1)     \n    //          aRow.style.borderBottom = \"1px solid #ccc\";\n    //       }\n    //   }\n      //去除合并的单元格的分隔线\n     // debugger\n    //   for(i = 0; i < array1.length; i++){\n    //       if(!Ext.isEmpty(array1[i])){\n    //           for(j = 0; j < array1[i].length; j++){\n    //               if(rowOrCol == \"row\"){\n    //                   aRow = grid.getView().getCell(array1[i][j],i);\n    //                   aRow.style.borderBottom = \"none\";\n    //               } else {\n    //                   aRow = grid.getView().getCell(i, array1[i][j]);\n    //                   aRow.style.borderTop = \"none\";\n    //               }\n    //           }\n    //       }\n    //   }\n}\n\n\nfunction div_beforerender(sender){\n\n}","vmdcss":".hand a{\r\n   text-decoration:none; \r\n}\r\n.hand a:link {\r\n    color: blue; text-decoration:none;\r\n    \r\n}\r\n.hand a:active:{\r\n    color: red;\r\n    } \r\na:visited {\r\n    color:purple;text-decoration:none;\r\n    \r\n} \r\n.hand a:hover {\r\n    color: red; text-decoration:underline;\r\n    \r\n} \r\n.x-grid3-hd-row td {\r\n    line-height: 15px;\r\n    vertical-align: middle;\r\n    border-left: 0px solid;\r\n     border-right: 0px solid;\r\n     border: 1px solid #e4e4e4;\r\n}\r\n.x-grid3-scroller {\r\n    overflow-x: hidden;\r\n}\r\n/* =========================================== Grid Panel =========================================== */\r\n/* 表格左右间距 */\r\n.vmd-grid {\r\n    \r\n    padding-left: 0px;\r\n    padding-right: 0px;\r\n}\r\n\r\n/* 表格线样式兼容 */\r\n.vmd-grid table {\r\n    border-collapse: collapse;\r\n}\r\n\r\n/* 表头背景色 */\r\n.vmd-grid .x-grid3-header {\r\n    background-color: #f7f7f7;\r\n}\r\n\r\n/* 表头鼠标悬停背景色 */\r\n.vmd-grid .x-grid3-hd-over .x-grid3-hd-inner {\r\n    background-color: #f7f7f7;\r\n}\r\n\r\n/* 表头错位兼容 */\r\n.vmd-grid .x-grid3-header-offset {\r\n    padding: 0;\r\n}\r\n\r\n/* 表头单元格 */\r\n.vmd-grid .x-grid3-header td {\r\n    border: 1px solid #e3e2e8;\r\n    font-size: 14px;\r\n}\r\n\r\n/* 表体单元格 */\r\n.vmd-grid .x-grid3-body td {\r\n    border: 1px solid #e3e2e8;\r\n    border-top-width: 0;\r\n    padding: 0;\r\n    font-size: 14px;\r\n}\r\n\r\n/* 表体行 */\r\n.vmd-grid .x-grid3-row {\r\n    border: none;\r\n}\r\n\r\n/* 表体行鼠标悬停背景色 */\r\n.vmd-grid .x-grid3-row-over {\r\n    background-color: white;\r\n}\r\n\r\n/* 表体行选中背景色 */\r\n.vmd-grid .x-grid3-row-selected {\r\n    background-color: #F5F7FC !important;\r\n}\r\n\r\n/* =========================================== Grid Panel =========================================== */","vmdprops":"\"\"","type":"ux","vmdinterface":"{\"components\":[{\"cid\":\"vmduxprops\",\"layoutConfig\":{},\"userConfig\":{},\"cn\":[{\"cid\":\"uxprop\",\"id\":\"config\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"config\",\"zhname\":\"配置\",\"bindCmp\":\"panel\",\"bindValue\":\"input\",\"isPublic\":\"on\",\"desc\":\"配置\",\"uxcid\":\"panel\",\"group\":\"\",\"cmptype\":\"string\",\"cmpsettings\":\"{\\\"isMulti\\\":false,\\\"data\\\":\\\"\\\"}\",\"radio_GoML\":\"string\"}}]},{\"cid\":\"vmduxmethods\",\"id\":\"方法\",\"layoutConfig\":{},\"userConfig\":{}},{\"cid\":\"vmduxevents\",\"id\":\"事件\",\"layoutConfig\":{},\"userConfig\":{}}]}"}