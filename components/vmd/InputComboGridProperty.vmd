{"vmdversion":"vmd2.0.5.200306","vmdlayout":"{\"components\":[{\"cid\":\"uxpanel\",\"id\":\"InputComboGridProperty\",\"layoutConfig\":{},\"userConfig\":{\"layout\":\"fit\",\"header\":false,\"width\":500,\"height\":621,\"beforerender\":\"InputComboGridProperty_beforerender\"},\"cn\":[{\"cid\":\"tabpanel\",\"id\":\"MyTabs\",\"layoutConfig\":{},\"userConfig\":{\"activeTab\":2,\"tabchange\":\"MyTabs_tabchange\",\"activeItem\":\"panel\"},\"cn\":[{\"cid\":\"panel\",\"id\":\"panel\",\"layoutConfig\":{},\"userConfig\":{\"title\":\"属性\",\"layout\":\"anchor\",\"padding\":\"5\"},\"cn\":[{\"cid\":\"checkbox\",\"id\":\"allowEdit\",\"layoutConfig\":{},\"userConfig\":{\"boxLabel\":\"允许编辑\",\"margins\":\"5 0 0 5\",\"id\":\"allowEdit\",\"height\":30}},{\"cid\":\"checkbox\",\"id\":\"multi\",\"layoutConfig\":{},\"userConfig\":{\"boxLabel\":\"多选\",\"margins\":\"5 0 0 5\",\"id\":\"multi\",\"height\":30}},{\"cid\":\"container\",\"id\":\"div2\",\"layoutConfig\":{},\"userConfig\":{\"height\":30,\"anchor\":\"100%\",\"layout\":\"border\",\"border\":false},\"cn\":[{\"cid\":\"container\",\"id\":\"div18\",\"layoutConfig\":{},\"userConfig\":{\"region\":\"center\",\"width\":111,\"layout\":\"anchor\",\"border\":false},\"cn\":[{\"cid\":\"vmd.ux.ClickText\",\"id\":\"grid_width\",\"layoutConfig\":{},\"userConfig\":{\"width\":144,\"id\":\"grid_width\",\"anchor\":\"100%\",\"plus\":\"grid_width_plus\",\"minus\":\"grid_width_minus\"}}]},{\"cid\":\"container\",\"id\":\"div19\",\"layoutConfig\":{\"align\":\"center\",\"pack\":\"center\"},\"userConfig\":{\"region\":\"west\",\"width\":40,\"border\":false,\"layout\":\"vbox\"},\"cn\":[{\"cid\":\"label\",\"id\":\"label\",\"layoutConfig\":{},\"userConfig\":{\"text\":\"宽度：\"}}]},{\"cid\":\"container\",\"id\":\"div20\",\"layoutConfig\":{\"align\":\"center\",\"pack\":\"center\"},\"userConfig\":{\"region\":\"east\",\"width\":10,\"border\":false,\"layout\":\"vbox\"},\"cn\":[{\"cid\":\"label\",\"id\":\"label1\",\"layoutConfig\":{},\"userConfig\":{\"text\":\"%\",\"margins\":\"\"}}]}]},{\"cid\":\"container\",\"id\":\"div4\",\"layoutConfig\":{},\"userConfig\":{\"height\":30,\"layout\":\"border\",\"anchor\":\"100%\",\"border\":false},\"cn\":[{\"cid\":\"container\",\"id\":\"div16\",\"layoutConfig\":{},\"userConfig\":{\"region\":\"center\",\"layout\":\"anchor\",\"border\":false},\"cn\":[{\"cid\":\"textfield\",\"id\":\"gridHeight\",\"layoutConfig\":{},\"userConfig\":{\"margins\":\"5 0 0 5\",\"id\":\"gridHeight\",\"anchor\":\"-10\"}}]},{\"cid\":\"container\",\"id\":\"div17\",\"layoutConfig\":{\"align\":\"center\",\"pack\":\"center\"},\"userConfig\":{\"region\":\"west\",\"width\":39,\"layout\":\"vbox\",\"border\":false},\"cn\":[{\"cid\":\"label\",\"id\":\"label2\",\"layoutConfig\":{},\"userConfig\":{\"text\":\"高度：\"}}]}]},{\"cid\":\"container\",\"id\":\"div3\",\"layoutConfig\":{},\"userConfig\":{\"height\":23,\"border\":false,\"margins\":\"5 0 0 5\",\"layout\":\"hbox\"},\"cn\":[{\"cid\":\"label\",\"id\":\"label3\",\"layoutConfig\":{},\"userConfig\":{\"text\":\"校验\"}},{\"cid\":\"label\",\"id\":\"label4\",\"layoutConfig\":{},\"userConfig\":{\"text\":\"——————————\",\"style\":\"color: #ddd\",\"margins\":\"0 0 0 5\"}}]},{\"cid\":\"checkbox\",\"id\":\"allowEmpty\",\"layoutConfig\":{},\"userConfig\":{\"boxLabel\":\"允许为空\",\"margins\":\"5 0 0 5\",\"checked\":true,\"id\":\"allowEmpty\",\"check\":\"allowEmpty_check\"}},{\"cid\":\"container\",\"id\":\"emptyDiv\",\"layoutConfig\":{},\"userConfig\":{\"height\":30,\"anchor\":\"100%\",\"layout\":\"border\",\"border\":false,\"id\":\"emptyDiv\"},\"cn\":[{\"cid\":\"container\",\"id\":\"div1\",\"layoutConfig\":{},\"userConfig\":{\"region\":\"center\",\"layout\":\"anchor\",\"border\":false},\"cn\":[{\"cid\":\"textfield\",\"id\":\"emptyAlert\",\"layoutConfig\":{},\"userConfig\":{\"margins\":\"5 0 0 5\",\"id\":\"emptyAlert\",\"anchor\":\"-10\"}}]},{\"cid\":\"container\",\"id\":\"div21\",\"layoutConfig\":{\"align\":\"center\",\"pack\":\"center\"},\"userConfig\":{\"region\":\"west\",\"width\":64,\"layout\":\"vbox\",\"border\":false},\"cn\":[{\"cid\":\"label\",\"id\":\"label5\",\"layoutConfig\":{},\"userConfig\":{\"text\":\"空值提示：\"}}]}]}]},{\"cid\":\"panel\",\"id\":\"panel1\",\"layoutConfig\":{},\"userConfig\":{\"title\":\"数据\",\"layout\":\"anchor\",\"padding\":\"5\"},\"cn\":[{\"cid\":\"container\",\"id\":\"div5\",\"layoutConfig\":{},\"userConfig\":{\"height\":35,\"layout\":\"anchor\",\"border\":false,\"margins\":\"\",\"anchor\":\"100%\",\"cls\":\"flex\"},\"cn\":[{\"cid\":\"label\",\"id\":\"label6\",\"layoutConfig\":{},\"userConfig\":{\"text\":\"数据集：\",\"width\":55,\"cls\":\"line35\"}},{\"cid\":\"vmdComlist\",\"id\":\"dataSet\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"dataSet\",\"selectChanged\":\"dataSet_selectChanged\",\"anchor\":\"-55\"}}]},{\"cid\":\"container\",\"id\":\"div6\",\"layoutConfig\":{},\"userConfig\":{\"height\":35,\"layout\":\"anchor\",\"border\":false,\"margins\":\"5 0 0 5\",\"anchor\":\"100%\",\"cls\":\"flex\"},\"cn\":[{\"cid\":\"label\",\"id\":\"label7\",\"layoutConfig\":{},\"userConfig\":{\"text\":\"保存字段：\",\"cls\":\"line35\"}},{\"cid\":\"vmdComlist\",\"id\":\"saveField\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"saveField\",\"anchor\":\"-60\"}}]},{\"cid\":\"container\",\"id\":\"div7\",\"layoutConfig\":{},\"userConfig\":{\"height\":35,\"layout\":\"anchor\",\"border\":false,\"margins\":\"5 0 0 5\",\"anchor\":\"100%\",\"cls\":\"flex\"},\"cn\":[{\"cid\":\"label\",\"id\":\"label8\",\"layoutConfig\":{},\"userConfig\":{\"text\":\"显示字段：\",\"cls\":\"line35\"}},{\"cid\":\"vmdComlist\",\"id\":\"displayField\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"displayField\",\"anchor\":\"-60\"}}]},{\"cid\":\"container\",\"id\":\"div8\",\"layoutConfig\":{},\"userConfig\":{\"border\":false,\"margins\":\"5 0 0 5\",\"height\":55,\"layout\":\"anchor\",\"anchor\":\"100%\",\"hidden\":true},\"cn\":[{\"cid\":\"label\",\"id\":\"label9\",\"layoutConfig\":{},\"userConfig\":{\"text\":\"过滤条件：\"}},{\"cid\":\"container\",\"id\":\"div9\",\"layoutConfig\":{},\"userConfig\":{\"height\":32,\"margins\":\"5 0 0 5\",\"layout\":\"anchor\",\"border\":false,\"anchor\":\"100%\"},\"cn\":[{\"cid\":\"textfield\",\"id\":\"filter\",\"layoutConfig\":{},\"userConfig\":{\"width\":125,\"margins\":\"\",\"id\":\"filter\",\"anchor\":\"80%\"}},{\"cid\":\"vmdButton\",\"id\":\"filterDelete\",\"layoutConfig\":{},\"userConfig\":{\"text\":\"\",\"width\":30,\"icon\":\"delete\",\"margins\":\"0 0 0 5\",\"id\":\"filterDelete\"}}]}]},{\"cid\":\"container\",\"id\":\"div10\",\"layoutConfig\":{},\"userConfig\":{\"border\":false,\"margins\":\"5 0 0 5\",\"height\":35,\"layout\":\"anchor\",\"anchor\":\"100%\",\"cls\":\"flex\"},\"cn\":[{\"cid\":\"label\",\"id\":\"label10\",\"layoutConfig\":{},\"userConfig\":{\"text\":\"下拉网格：\",\"margins\":\"5 0 0 5\",\"cls\":\"line35\"}},{\"cid\":\"container\",\"id\":\"div11\",\"layoutConfig\":{},\"userConfig\":{\"border\":false,\"layout\":\"anchor\",\"margins\":\"5 0 0 5\",\"anchor\":\"-60\",\"height\":30},\"cn\":[{\"cid\":\"textfield\",\"id\":\"comlist\",\"layoutConfig\":{},\"userConfig\":{\"width\":125,\"id\":\"comlist\",\"anchor\":\"-30\",\"cls\":\"m-r5\"}},{\"cid\":\"vmdButton\",\"id\":\"selectField\",\"layoutConfig\":{},\"userConfig\":{\"text\":\"...\",\"width\":30,\"margins\":\"0 0 0 5\",\"id\":\"selectField\",\"click\":\"selectField_click\"}}]}]}]},{\"cid\":\"panel\",\"id\":\"panel2\",\"layoutConfig\":{},\"userConfig\":{\"title\":\"事件\",\"layout\":\"anchor\",\"padding\":\"5\"},\"cn\":[{\"cid\":\"container\",\"id\":\"hwDiv\",\"layoutConfig\":{},\"userConfig\":{\"height\":35,\"border\":false,\"layout\":\"anchor\",\"anchor\":\"100%\",\"cls\":\"flex\"},\"cn\":[{\"cid\":\"label\",\"id\":\"hwLabel\",\"layoutConfig\":{},\"userConfig\":{\"text\":\"beforeClick：\",\"width\":77,\"height\":\"\",\"cls\":\"line35\"}},{\"cid\":\"container\",\"id\":\"hwDiv1\",\"layoutConfig\":{},\"userConfig\":{\"anchor\":\"-77\",\"border\":false,\"layout\":\"anchor\",\"height\":40},\"cn\":[{\"cid\":\"textfield\",\"id\":\"beforeClick\",\"layoutConfig\":{},\"userConfig\":{\"anchor\":\"-30\",\"focusClass\":\"\",\"cls\":\"m-r5\",\"id\":\"beforeClick\",\"afterrender\":\"beforeClick_afterrender\"}},{\"cid\":\"vmdButton\",\"id\":\"beforeClickdelete\",\"layoutConfig\":{},\"userConfig\":{\"icon\":\"delete\",\"width\":30,\"text\":\"\",\"id\":\"beforeClickdelete\",\"click\":\"beforeClickdelete_click\"}}]}]},{\"cid\":\"container\",\"id\":\"div12\",\"layoutConfig\":{},\"userConfig\":{\"height\":35,\"layout\":\"anchor\",\"border\":false,\"anchor\":\"100%\",\"cls\":\"flex\"},\"cn\":[{\"cid\":\"label\",\"id\":\"label11\",\"layoutConfig\":{},\"userConfig\":{\"text\":\"click:\",\"margins\":\"5 0 0 5\",\"width\":50,\"cls\":\"line35\"}},{\"cid\":\"container\",\"id\":\"div13\",\"layoutConfig\":{},\"userConfig\":{\"height\":40,\"layout\":\"anchor\",\"margins\":\"5 0 0 5\",\"border\":false,\"anchor\":\"-50\"},\"cn\":[{\"cid\":\"textfield\",\"id\":\"click\",\"layoutConfig\":{},\"userConfig\":{\"width\":125,\"margins\":\"5 0 0 5\",\"id\":\"click\",\"anchor\":\"-30\",\"cls\":\"m-r5\",\"afterrender\":\"click_afterrender\"}},{\"cid\":\"vmdButton\",\"id\":\"clickDelete\",\"layoutConfig\":{},\"userConfig\":{\"text\":\"\",\"icon\":\"delete\",\"width\":30,\"margins\":\"5 0 0 5\",\"id\":\"clickDelete\",\"click\":\"clickDelete_click\"}}]}]},{\"cid\":\"container\",\"id\":\"div14\",\"layoutConfig\":{},\"userConfig\":{\"height\":35,\"layout\":\"anchor\",\"border\":false,\"anchor\":\"100%\",\"cls\":\"flex\"},\"cn\":[{\"cid\":\"label\",\"id\":\"label12\",\"layoutConfig\":{},\"userConfig\":{\"text\":\"change:\",\"margins\":\"5 0 0 5\",\"width\":50,\"cls\":\"line35\"}},{\"cid\":\"container\",\"id\":\"div15\",\"layoutConfig\":{},\"userConfig\":{\"height\":40,\"layout\":\"anchor\",\"margins\":\"5 0 0 5\",\"border\":false,\"anchor\":\"-50\"},\"cn\":[{\"cid\":\"textfield\",\"id\":\"change\",\"layoutConfig\":{},\"userConfig\":{\"width\":125,\"margins\":\"5 0 0 5\",\"id\":\"change\",\"anchor\":\"-30\",\"cls\":\"m-r5\",\"afterrender\":\"change_afterrender\"}},{\"cid\":\"vmdButton\",\"id\":\"changeDelete\",\"layoutConfig\":{},\"userConfig\":{\"text\":\"\",\"icon\":\"delete\",\"width\":30,\"margins\":\"5 0 0 5\",\"id\":\"changeDelete\",\"click\":\"changeDelete_click\"}}]}]}]}]}]}]}","vmdevents":"var page = this;\nvar store = new Ext.data.JsonStore({\n    proxy: new Ext.data.MemoryProxy(),\n    fields: ['name', 'value']\n});\nvar store1 = new Ext.data.JsonStore({\n    proxy: new Ext.data.MemoryProxy(),\n    fields: ['name', 'value']\n});\nvar store2 = new Ext.data.JsonStore({\n    proxy: new Ext.data.MemoryProxy(),\n    fields: ['name', 'value']\n});\n\nvar activePropPanel = parent.xds && parent.xds.active.component.propPanel;\n//获取数据集方法\nfunction getDatasets() {\n    return activePropPanel && activePropPanel.controller.getDatasets() || [];\n}\n\nfunction allowEmpty_check(sender, checked) {\n    checked ? emptyDiv.hide() : emptyDiv.show()\n    panel.doLayout()\n}\n\nfunction grid_width_plus(sender) {\n    if (grid_width.getValue() < 1)\n        grid_width.setValue(parseFloat(110))\n    else\n        grid_width.setValue(parseFloat(grid_width.getValue()) + 10)\n    page.fireEvent('updateValue', sender, 'grid_width', this.getValue())\n}\n\nfunction grid_width_minus(sender) {\n    if (grid_width.getValue() >= 1) {\n        grid_width.setValue(parseFloat(grid_width.getValue()) - 10)\n    }\n\n    if (grid_width.getValue() < 0) grid_width.setValue(0)\n    page.fireEvent('updateValue', sender, 'grid_width', this.getValue())\n}\n\nfunction InputComboGridProperty_beforerender(sender) {\n    //对数据集、保存字段、显示字段进行设置\n    dataSet.store = store;\n    dataSet.valueField = 'value'\n    dataSet.displayField = 'name'\n\n    saveField.store = store1;\n    saveField.valueField = 'value'\n    saveField.displayField = 'name'\n\n    displayField.store = store2;\n    displayField.valueField = 'value'\n    displayField.displayField = 'name'\n}\n\nfunction dataSet_selectChanged(sender, combo, record, index) {\n    sender.setValue(record.data.name)\n    var temp = [];\n    var dataSets = getDatasets();\n    for (var i = 0; i < dataSets.length; i++) {\n        if (dataSets[i].name == record.data.name) {\n            for (var n = 0; n < dataSets[i].fields.length; n++) {\n                temp.push({\n                    name: dataSets[i].fields[n],\n                    value: dataSets[i].fields[n],\n                    cname: dataSets[i].dictionary[n].cname\n                })\n            }\n        }\n    }\n    store2.loadData(temp)\n    store1.loadData(temp)\n    page.fields = temp;\n    saveField.setValue(\"\");\n    displayField.setValue(\"\");\n    page.fireEvent('data_dataSet_changed', dataSet.getValue())\n}\n\nfunction MyTabs_tabchange(sender, tab) {\n    var temp = [];\n    var nameSet = [];\n    var dataSets = getDatasets();\n    for (var i = 0; i < dataSets.length; i++) {\n        nameSet.push({\n            name: dataSets[i].name,\n            value: dataSets[i].name\n        })\n        if (dataSets[i].name == dataSet.getValue()) {\n            for (var n = 0; n < dataSets[i].fields.length; n++) {\n                temp.push({\n                    name: dataSets[i].fields[n],\n                    value: dataSets[i].fields[n],\n                    cname: dataSets[i].dicitonary && dataSets[i].dicitonary[n] ? dataSets[i].dicitonary[n].cname : \"\"\n                })\n            }\n        }\n    }\n    store.loadData(nameSet);\n    store2.loadData(temp)\n    store1.loadData(temp)\n    page.fields = temp;\n\n}\n\nfunction selectField_click(sender, e) {\n    var data = [];\n    var data1 = activePropPanel.controller.comp.grid.settings.fields[activePropPanel.controller.comp[activePropPanel.controller.operateType].activeNo].fieldsConfig.selected || [];\n    if (page.fields) {\n        for (var n = 0; n < page.fields.length; n++) {\n            var flag = true\n            for (var k = 0; k < data1.length; k++) {\n                if (page.fields[n].name == data1[k].name) {\n                    flag = false;\n                    break;\n                }\n            }\n            if (flag) {\n                data.push({\n                    name: page.fields[n].name,\n                    cname: page.fields[n].cname\n                })\n            }\n        }\n    }\n    if (data.length > 0 || data1.length > 0) {\n        activePropPanel.controller.openVisualSelector(data, data1, 'xlwg', comlist, activePropPanel.controller.comp.grid.settings.fields[activePropPanel.controller.comp[activePropPanel.controller.operateType].activeNo]);\n    } else {\n        vmd.tip('请先选择拥有字段的数据集', 'error')\n    }\n}\n\nfunction click_afterrender(sender) {\n    sender.el.on('dblclick', function() {\n        var publicmethod = activePropPanel.controller;\n        publicmethod.openCodeEditor(sender, 'cgrid_click', sender.getValue(), 'grid,cell,rId,cInd');\n    })\n}\n\nfunction change_afterrender(sender) {\n    sender.el.on('dblclick', function() {\n        var publicmethod = activePropPanel.controller;\n        publicmethod.openCodeEditor(sender, 'cgrid_change', sender.getValue(), 'grid,cell,rId,cInd,nValue,oValue');\n    })\n}\n\nfunction clickDelete_click(sender, e) {\n    click.setValue('');\n    click.fireEvent('change', click, '')\n}\n\nfunction changeDelete_click(sender, e) {\n    change.setValue('');\n    change.fireEvent('change', change, '')\n}\n\nwindow.setGridSettings = function(values) {\n    comlist.setValue(values);\n    comlist.fireEvent('change', comlist, values)\n\n}\n\nfunction beforeClick_afterrender(sender){\n sender.el.on('dblclick', function() {\n        var publicmethod = activePropPanel.controller;\n        publicmethod.openCodeEditor(sender, 'cgrid_beforeClick', sender.getValue(), 'grid,cell,rId,cInd,nValue,oValue');\n    })\n}\n\nfunction beforeClickdelete_click(sender,e){\n    beforeClick.setValue(values);\n    beforeClick.fireEvent('change', beforeClick, \"\")\n}","vmdcss":".flex{\n    display: flex\n}\n.m-r5{\n    margin-right: 5px\n}\n.line35{\n    line-height: 35px\n}","vmdprops":"\"\"","type":"ux","vmdevents_controller":"Ext.define('vmd.ux.inputComboGridProperty.Controller', {\n    xtype: 'vmd.ux.inputComboGridProperty.Controller',\n    constructor: function(options) {\n        this.type = 'comboGrid'\n        this.scope = options;\n        this.allowEdit = true\n        this.multi = false\n        this.grid_width = ''\n        this.gridHeight = ''\n        this.allowEmpty = true\n        this.emptyAlert = ''\n        this.dataSet = ''\n        this.saveField = ''\n        this.displayField = ''\n        this.filter = ''\n        this.comlist = ''\n        this.click = ''\n        this.change = ''\n        this.beforeClick = ''\n        this.colHide = false\n        this.colWidth = '100'\n        this.txtAlign=\"1\";\n        this.dicFirst=true;\n        this.selected = [];\n    },\n    setValue: function(info, flag) {\n        if (info) {\n            this.allowEdit = info.settings.allowEdit\n            this.multi = info.settings.multi\n            this.grid_width = info.settings.grid_width\n            this.gridHeight = info.settings.gridHeight\n            this.allowEmpty = info.settings.allowEmpty\n            this.emptyAlert = info.settings.emptyAlert\n\n            if (info.datas) {\n                this.dataSet = info.datas.dataSet\n                this.saveField = info.datas.saveField\n                this.displayField = info.datas.displayField\n                this.filter = info.datas.filter\n                this.comlist = info.datas.comlist\n            }\n\n            if (!flag) {\n                this.click = info.events.click\n                this.change = info.events.change\n                this.beforeClick = info.events.beforeClick\n            }\n            this.colHide = info.settings.colHide\n            this.colWidth = info.settings.colWidth\n            this.dicFirst = info.settings.dicFirst\n            this.txtAlign = info.settings.txtAlign\n\n            if (this.scope) {\n                this.scope.allowEdit.setValue(this.allowEdit)\n                this.scope.multi.setValue(this.multi)\n                this.scope.grid_width.setValue(this.grid_width)\n                this.scope.gridHeight.setValue(this.gridHeight)\n                this.scope.allowEmpty.setValue(this.allowEmpty)\n                this.scope.emptyAlert.setValue(this.emptyAlert)\n                if (info.datas) {\n                    this.dataSet = info.datas.dataSet ;\n                    this.saveField = info.datas.saveField ;\n                    this.displayField = info.datas.displayField;\n                    this.filter = info.datas.displayField ;\n                    this.comlist =  info.datas.comlist ;\n                } else if (info.settings.serialize) {\n                    this.dataSet =info.settings.serialize().datas.dataSet;\n                    this.saveField = info.settings.serialize().datas.saveField;\n                    this.displayField = info.settings.serialize().datas.saveField;\n                    this.filter = info.settings.serialize().datas.filter;\n                    this.comlist = info.settings.serialize().datas.comlist;\n                } else {\n                    this.dataSet =  info.settings.dataSet;\n                    this.saveField =  info.settings.saveField;\n                    this.displayField =  info.settings.saveField;\n                    this.filter = info.settings.filter;\n                    this.comlist =  info.settings.comlist;\n                }\n\n                this.scope.dataSet.setValue(this.dataSet)\n                this.scope.saveField.setValue(this.saveField)\n                this.scope.displayField.setValue(this.displayField)\n                this.scope.filter.setValue(this.filter)\n                this.scope.comlist.setValue(this.comlist)\n\n                if (!flag) {\n                    this.scope.click.setValue(this.click)\n                    this.scope.change.setValue(this.change)\n                    this.scope.beforeClick.setValue(this.beforeClick)\n                }\n            }\n            this.selected = info.selected;\n        }\n    },\n    serialize: function() {\n        var json = {\n            settings: {\n                allowEdit: this.allowEdit,\n                multi: this.multi,\n                grid_width: this.grid_width,\n                gridHeight: this.gridHeight,\n                allowEmpty: this.allowEmpty,\n                emptyAlert: this.emptyAlert,\n                colHide: this.colHide,\n                colWidth: this.colWidth,\n                dicFirst:this.dicFirst,\n                txtAlign:this.txtAlign\n            },\n            datas: {\n                dataSet: this.dataSet,\n                saveField: this.saveField,\n                displayField: this.displayField,\n                filter: this.filter,\n                comlist: this.comlist\n            },\n            events: {\n                click: this.click,\n                change: this.change,\n                beforeClick: this.beforeClick\n            },\n            selected: this.selected,\n            type: 'comboGrid'\n        }\n        return json;\n    }\n})\n\n\nfunction setEvent(sender, eventName, param) {\n    sender.el.on('dblclick', function() {\n        var editor = new vmd.comp.Ace({\n            id: \"ace_code\"\n        });\n        // init_def_platformControlData();\n        var aceWin = new vmd.window({\n            title: \"事件编辑\",\n            id: \"aceWin\",\n            url: vmd.virtualPath + vmd.vmdCodePath + \"?\" + Date.parse(new Date()),\n            offset: [100, 100],\n            modal: true,\n            maximizable: true,\n            maskStyle: 'opacity:0.7',\n            layout: 'border',\n            draggable: false,\n            listeners: {\n                move: function(me, x, y) {\n                    this.moveZone(me, x, y);\n                }\n            }\n        });\n        aceWin.closeFn = function() {\n            //修复ace tooltip还存在的问题\n            Ext.select('.Ace-Tern-tooltip').remove();\n            var val = aceWin.val;\n            if (aceWin.script == val) {\n                return;\n            }\n            Ext.Msg.confirm(\"提示\", \"脚本已改变是否保存?\", function(btn) {\n                if (btn == 'no') return;\n                var click_label = sender;\n                if (val.trim()) {\n                    xds.vmd.events = val;\n                    sender.setValue(eventName)\n                    // 返回给对象\n                } else {\n                    click_label = undefined;\n                    delete xds.vmd.events\n                }\n            })\n        }\n        //mafei 在ide-automachjs中\n        // init_def_platformControlData();\n        aceWin.on('close', aceWin.closeFn, this)\n        //当前拖拽组件\n        window.setTimeout(function() {\n            window.setTimeout(function() {\n                //代码编辑器初始化\n                if (typeof rowIndex == \"number\") {\n                    aceWin.aceline = rowIndex;\n                }\n            }, 150)\n            var code = parent.xds.vmd.events;\n            // var me = \n            var getdefaulteventname = function() {\n                if (param != '') {\n                    return \"function(sender\" + \"){\\n\" + \"\\n} \\n\";\n                } else {\n                    return \"function(sender,\" + param + \"){\\n\" + \"\\n} \\n\";\n                }\n            }\n            var m = getdefaulteventname(),\n                code = code ? code : \"\",\n                replaceStr = \"function {0}{1}\",\n                regex = new RegExp(\"function\\\\s+\" + eventName + \"\\\\s*?\\\\(\");\n            if (eventName && code.search(regex) == -1) {\n                var e = m.trim().replace(\"function\", \"\"),\n                    i = String.format(replaceStr, eventName, e);\n                code += (code ? \"\\n\\n\" : \"\") + i\n            }\n            aceWin.script = code;\n            aceWin.val = code;\n            aceWin.show();\n            //进度提示\n            var myMask = new Ext.LoadMask(aceWin.el, {\n                msg: \"数据加载中,请稍后...\",\n                msgCls: 'z-index:10000;'\n            });\n            myMask.show();\n            aceWin.loading = myMask;\n            //  aceWin.update(\"<iframe  id='iframe_page' src='\" + vmd.virtualPath + vmd.vmdCodePath + \"?\" + Date.parse(new Date()) + \"' width=600 height=900 frameborder=0  ></iframe>\")\n            var scriptArr = code.split(\"\\n\"),\n                rowIndex = null;\n            Ext.each(scriptArr,\n                function(o, p) {\n                    if (o.search(regex) != -1) {\n                        rowIndex = p + 2;\n                        return false\n                    }\n                });\n        }, 50)\n    })\n}","vmdinterface":"{\"components\":[{\"cid\":\"vmduxprops\",\"layoutConfig\":{},\"userConfig\":{}},{\"cid\":\"vmduxmethods\",\"id\":\"方法\",\"layoutConfig\":{},\"userConfig\":{},\"cn\":[{\"cid\":\"uxmethod\",\"id\":\"setInfo\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"setInfo\",\"params\":\"info\",\"desc\":\"\",\"isPublic\":\"on\",\"code\":\"setInfo(info)\",\"returnType\":\"\"}},{\"cid\":\"uxmethod\",\"id\":\"getInfo\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"getInfo\",\"params\":\"\",\"desc\":\"\",\"isPublic\":\"on\",\"code\":\"getInfo()\",\"returnType\":\"\"}}]},{\"cid\":\"vmduxevents\",\"id\":\"事件\",\"layoutConfig\":{},\"userConfig\":{}}]}","vmdresource":"{\"components\":[{\"cid\":\"vmdrescsss\",\"layoutConfig\":{},\"userConfig\":{}},{\"cid\":\"vmdresjss\",\"layoutConfig\":{},\"userConfig\":{},\"cn\":[{\"cid\":\"resjs\",\"id\":\"controller.js\",\"layoutConfig\":{},\"userConfig\":{}}]},{\"cid\":\"vmdresimgs\",\"layoutConfig\":{},\"userConfig\":{}}]}"}