{"vmdversion":"2.0.4.20190331","vmdlayout":"{\"components\":[{\"cid\":\"uxpanel\",\"id\":\"UploadType\",\"layoutConfig\":{},\"userConfig\":{\"layout\":\"absolute\",\"header\":false,\"width\":290,\"height\":621,\"beforerender\":\"UploadType_beforerender\"},\"cn\":[{\"cid\":\"label\",\"id\":\"label\",\"layoutConfig\":{},\"userConfig\":{\"x\":10,\"y\":16,\"text\":\"类型：\"}},{\"cid\":\"radiogroup\",\"id\":\"sczj_Type\",\"layoutConfig\":{},\"userConfig\":{\"x\":50,\"y\":10,\"width\":260,\"height\":30,\"id\":\"sczj_Type\",\"change\":\"sczj_Type_change\"},\"cn\":[{\"cid\":\"radio\",\"id\":\"hwRadio\",\"layoutConfig\":{},\"userConfig\":{\"boxLabel\":\"文档\",\"fieldLabel\":\"\",\"checked\":true,\"inputValue\":\"0\"}},{\"cid\":\"radio\",\"id\":\"hwRadio1\",\"layoutConfig\":{},\"userConfig\":{\"fieldLabel\":\"\",\"boxLabel\":\"图片\",\"inputValue\":\"1\"}},{\"cid\":\"radio\",\"id\":\"hwRadio2\",\"layoutConfig\":{},\"userConfig\":{\"fieldLabel\":\"\",\"boxLabel\":\"视频\",\"disabled\":true,\"inputValue\":\"2\"}},{\"cid\":\"radio\",\"id\":\"hwRadio3\",\"layoutConfig\":{},\"userConfig\":{\"fieldLabel\":\"\",\"boxLabel\":\"音频\",\"disabled\":true,\"inputValue\":\"3\"}}]},{\"cid\":\"container\",\"id\":\"div\",\"layoutConfig\":{},\"userConfig\":{\"x\":0,\"y\":40,\"width\":290,\"height\":580,\"border\":false,\"layout\":\"absolute\",\"id\":\"div\",\"hidden\":false},\"cn\":[{\"cid\":\"label\",\"id\":\"label1\",\"layoutConfig\":{},\"userConfig\":{\"x\":35,\"y\":15,\"text\":\"允许最多上传\"}},{\"cid\":\"numberfield\",\"id\":\"sczj_max\",\"layoutConfig\":{},\"userConfig\":{\"x\":120,\"y\":10,\"width\":120,\"style\":\"border: 1px solid #dddddd\",\"id\":\"sczj_max\",\"cls\":\"b\"}},{\"cid\":\"container\",\"id\":\"div1\",\"layoutConfig\":{},\"userConfig\":{\"x\":220,\"y\":10,\"width\":30,\"height\":15,\"border\":false,\"style\":\"cursor: pointer\",\"html\":\"<img src=\\\"/system/img/report/border/上.png\\\" />\",\"click\":\"div1_click\"}},{\"cid\":\"container\",\"id\":\"div2\",\"layoutConfig\":{},\"userConfig\":{\"x\":220,\"y\":20,\"width\":20,\"height\":15,\"border\":false,\"style\":\"cursor: pointer\",\"html\":\"<img src=\\\"/system/img/report/border/下.png\\\" />\",\"click\":\"div2_click\"}},{\"cid\":\"label\",\"id\":\"label2\",\"layoutConfig\":{},\"userConfig\":{\"x\":290,\"y\":15,\"text\":\"个\",\"width\":10}},{\"cid\":\"label\",\"id\":\"label3\",\"layoutConfig\":{},\"userConfig\":{\"x\":10,\"y\":50,\"text\":\"布局：\"}},{\"cid\":\"label\",\"id\":\"label4\",\"layoutConfig\":{},\"userConfig\":{\"x\":57,\"y\":50,\"text\":\"每页显示\"}},{\"cid\":\"label\",\"id\":\"label5\",\"layoutConfig\":{},\"userConfig\":{\"x\":57,\"y\":84,\"text\":\"每行显示\"}},{\"cid\":\"numberfield\",\"id\":\"sczj_everyPage\",\"layoutConfig\":{},\"userConfig\":{\"x\":120,\"y\":45,\"style\":\"border: 1px solid #dddddd\",\"width\":120,\"id\":\"sczj_everyPage\"}},{\"cid\":\"numberfield\",\"id\":\"sczj_everyRow\",\"layoutConfig\":{},\"userConfig\":{\"x\":120,\"y\":80,\"style\":\"border: 1px solid #dddddd\",\"width\":120,\"id\":\"sczj_everyRow\"}},{\"cid\":\"vmdButton\",\"id\":\"aaa\",\"layoutConfig\":{},\"userConfig\":{\"x\":250,\"y\":46,\"text\":\"...\",\"height\":24,\"width\":28,\"id\":\"aaa\"}},{\"cid\":\"vmdButton\",\"id\":\"bbb\",\"layoutConfig\":{},\"userConfig\":{\"x\":250,\"y\":80,\"text\":\"...\",\"height\":24,\"width\":28,\"id\":\"bbb\"}},{\"cid\":\"label\",\"id\":\"label6\",\"layoutConfig\":{},\"userConfig\":{\"x\":290,\"y\":50,\"text\":\"张\"}},{\"cid\":\"label\",\"id\":\"label7\",\"layoutConfig\":{},\"userConfig\":{\"x\":290,\"y\":84,\"text\":\"张\"}},{\"cid\":\"label\",\"id\":\"label8\",\"layoutConfig\":{},\"userConfig\":{\"x\":10,\"y\":118,\"text\":\"权限控制：\"}},{\"cid\":\"checkbox\",\"id\":\"sczj_add\",\"layoutConfig\":{},\"userConfig\":{\"x\":20,\"y\":146,\"boxLabel\":\"添加\",\"id\":\"sczj_add\",\"checked\":true}},{\"cid\":\"checkbox\",\"id\":\"sczj_delete\",\"layoutConfig\":{},\"userConfig\":{\"x\":20,\"y\":180,\"boxLabel\":\"删除\",\"id\":\"sczj_delete\",\"checked\":true}},{\"cid\":\"textfield\",\"id\":\"sczj_addText\",\"layoutConfig\":{},\"userConfig\":{\"x\":70,\"y\":146,\"style\":\"border: 1px solid #dddddd\",\"id\":\"sczj_addText\",\"width\":170}},{\"cid\":\"textfield\",\"id\":\"sczj_deleteText\",\"layoutConfig\":{},\"userConfig\":{\"x\":70,\"y\":180,\"style\":\"border: 1px solid #dddddd\",\"id\":\"sczj_deleteText\",\"width\":170,\"afterrender\":\"sczj_deleteText_afterrender\"}},{\"cid\":\"vmdButton\",\"id\":\"ccc\",\"layoutConfig\":{},\"userConfig\":{\"x\":250,\"y\":146,\"text\":\"...\",\"height\":24,\"width\":28,\"id\":\"ccc\",\"disabled\":true}},{\"cid\":\"vmdButton\",\"id\":\"ddd\",\"layoutConfig\":{},\"userConfig\":{\"x\":250,\"y\":180,\"text\":\"...\",\"height\":24,\"width\":28,\"id\":\"ddd\",\"disabled\":true}},{\"cid\":\"container\",\"id\":\"picDiv\",\"layoutConfig\":{},\"userConfig\":{\"x\":20,\"y\":240,\"width\":250,\"height\":280,\"layout\":\"absolute\",\"border\":false,\"id\":\"picDiv\",\"hidden\":true},\"cn\":[{\"cid\":\"label\",\"id\":\"label9\",\"layoutConfig\":{},\"userConfig\":{\"x\":10,\"y\":0,\"text\":\"展示效果：\"}},{\"cid\":\"radiogroup\",\"id\":\"sczj_display\",\"layoutConfig\":{},\"userConfig\":{\"x\":30,\"y\":20,\"width\":210,\"height\":250,\"id\":\"sczj_display\"},\"cn\":[{\"cid\":\"radio\",\"id\":\"hwRadio8\",\"layoutConfig\":{},\"userConfig\":{\"fieldLabel\":\"\",\"checked\":true,\"inputValue\":\"EqualScaling\",\"boxLabel\":\"等比例缩放\",\"width\":85}},{\"cid\":\"radio\",\"id\":\"hwRadio5\",\"layoutConfig\":{},\"userConfig\":{\"fieldLabel\":\"\",\"boxLabel\":\"拉伸\",\"inputValue\":\"Extend\",\"width\":52}},{\"cid\":\"radio\",\"id\":\"hwRadio6\",\"layoutConfig\":{},\"userConfig\":{\"fieldLabel\":\"\",\"inputValue\":\"Hextend\",\"boxLabel\":\"横向拉伸\",\"width\":85}},{\"cid\":\"radio\",\"id\":\"hwRadio7\",\"layoutConfig\":{},\"userConfig\":{\"fieldLabel\":\"\",\"boxLabel\":\"纵向拉伸\",\"inputValue\":\"Vextens\",\"width\":115}},{\"cid\":\"radio\",\"id\":\"hwRadio4\",\"layoutConfig\":{},\"userConfig\":{\"boxLabel\":\"图片实际大小\",\"fieldLabel\":\"\",\"checked\":false,\"inputValue\":\"ActualSize\",\"width\":104}}]}]},{\"cid\":\"checkbox\",\"id\":\"sczj_wdk\",\"layoutConfig\":{},\"userConfig\":{\"x\":20,\"y\":210,\"boxLabel\":\"上传文档库\",\"id\":\"sczj_wdk\",\"check\":\"sczj_wdk_check\"}}]}]}]}","vmdevents":"var page = this;\n\nfunction setInfo(info, cell) {\n    debugger\n    if (info) {\n        var hot = sheetHot;\n        var canWrite = false;\n        var cell = hot.dealInvert()[0];\n        var mArr = hot.getPlugin('MergeCells').mergedCellsCollection.mergedCells;\n        var sel = hot.dealInvert()[0];\n        var count = 0;\n        if (mArr.length > 0) {\n            for (var x = 0; x < mArr.length; x++) {\n                for (var i = sel.sr; i < sel.er + 1; i++) {\n                    for (var n = sel.sc; n < sel.ec + 1; n++) {\n                        if (mArr[x].row == i && mArr[x].col == n) {\n                            count++;\n                            if (count == 1) no = x;\n                        }\n                    }\n                }\n            }\n            if (count == 1) {\n                if (mArr[no].row + mArr[no].rowspan - 1 == sel.er && mArr[no].col + mArr[no].colspan - 1 == sel.ec) {\n                    canWrite = true;\n                }\n            }\n        }\n        if (canWrite || (cell.sr == cell.er && cell.sc == cell.ec)) {\n            info = sheetHot.getCellMeta(cell.sr, cell.sc).cellAttributeInfo.cell_UploadInfo;\n            sczj_Type.setValue(info.sczj_Type.value)\n            sczj_max.setValue(info.sczj_max.value)\n            sczj_everyPage.setValue(info.sczj_everyPage.value)\n            sczj_everyRow.setValue(info.sczj_everyRow.value)\n            sczj_add.setValue(info.sczj_add.checked)\n            sczj_delete.setValue(info.sczj_delete.checked)\n            sczj_addText.setValue(info.sczj_addText.value)\n            sczj_deleteText.setValue(info.sczj_deleteText.value)\n            sczj_display.setValue(info.sczj_display.value)\n            sczj_wdk.setValue(info.sczj_wdk.checked)\n        } else {\n            sczj_Type.setValue(info[0].sczj_Type.value)\n            sczj_max.setValue(info[0].sczj_max.value)\n            sczj_everyPage.setValue(info[0].sczj_everyPage.value)\n            sczj_everyRow.setValue(info[0].sczj_everyRow.value)\n            sczj_add.setValue(info[0].sczj_add.checked)\n            sczj_delete.setValue(info[0].sczj_delete.checked)\n            sczj_addText.setValue(info[0].sczj_addText.value)\n            sczj_deleteText.setValue(info[0].sczj_deleteText.value)\n            sczj_display.setValue(info[0].sczj_display.value)\n            sczj_wdk.setValue(info[0].sczj_wdk.checked)\n        }\n    }\n}\n\nfunction div1_click(sender, e) {\n    debugger\n    sczj_max.setValue(parseInt(sczj_max.getValue()) + 1)\n    page.fireEvent('uploadDecimalChanged', sczj_max, sczj_max.getValue())\n}\n\nfunction div2_click(sender, e) {\n    debugger\n    if (sczj_max.getValue() > 0) {\n        sczj_max.setValue(parseInt(sczj_max.getValue()) - 1)\n    } else {\n        sczj_max.setValue(0)\n    }\n    page.fireEvent('uploadDecimalChanged', sczj_max, sczj_max.getValue())\n}\n\nfunction sczj_Type_change(sender, checked) {\n    if (checked && checked.inputValue == '1') {\n        //  sczj_wdk.hide()\n        picDiv.show()\n    } else {\n        //  sczj_wdk.show()\n        picDiv.hide()\n    }\n}\n\nfunction sczj_deleteText_afterrender(sender) {}\n\nfunction UploadType_beforerender(sender) {}\n\nfunction sczj_wdk_check(sender, checked) {\n    // if (checked) {\n    //     var wdkHost = (vmd.projectInfo && vmd.projectInfo.docIp) || \"\";\n    //     if(wdkHost == \"\"){\n    //         vmd.tip('未正确配置文档中心，','error')\n    //     }\n    // }\n}","vmdcss":".b{\n    border: 1px solid #dddddd;\n    \n}","vmdprops":"\"\"","type":"ux","vmdevents_controller":"Ext.define('vmd.ux.uploadType.Controller', {\n    xtype: 'vmd.ux.uploadType.Controller',\n    constructor: function(options) {\n        \n    }\n})","vmdinterface":"{\"components\":[{\"cid\":\"vmduxprops\",\"layoutConfig\":{},\"userConfig\":{}},{\"cid\":\"vmduxmethods\",\"id\":\"方法\",\"layoutConfig\":{},\"userConfig\":{},\"cn\":[{\"cid\":\"uxmethod\",\"id\":\"setInfo\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"setInfo\",\"zhname\":\"\",\"bindCmp\":\"\",\"bindValue\":\"\",\"isPublic\":\"on\",\"desc\":\"\",\"uxcid\":\"\",\"params\":\"info,cell\",\"code\":\"setInfo(info,cell)\",\"returnType\":\"\"}},{\"cid\":\"uxmethod\",\"id\":\"getInfo\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"getInfo\",\"zhname\":\"\",\"bindCmp\":\"\",\"bindValue\":\"\",\"isPublic\":\"on\",\"desc\":\"\",\"uxcid\":\"\",\"params\":\"att\",\"code\":\"var temp;\\r\\nif(att == \\\"sczj_document_max\\\") {\\r\\n    temp = sczj_document_max.getValue()\\r\\n} else if(att == \\\"sczj_document_everyPage\\\") {\\r\\n    temp = sczj_document_everyPage.getValue()\\r\\n} else if(att == \\\"sczj_document_everyRow\\\") {\\r\\n    temp = sczj_document_everyRow.getValue()\\r\\n} else if(att == \\\"sczj_document_add\\\") {\\r\\n    temp = sczj_document_add.getValue()\\r\\n} else if(att == \\\"sczj_document_delete\\\") {\\r\\n    temp = sczj_document_delete.getValue()\\r\\n} else if(att == \\\"sczj_document_addText\\\") {\\r\\n    temp = sczj_document_addText.getValue()\\r\\n} else if(att == \\\"sczj_document_deleteText\\\") {\\r\\n    temp = sczj_document_deleteText.getValue()\\r\\n} else if(att == \\\"sczj_pic_max\\\") {\\r\\n    temp = sczj_pic_max.getValue()\\r\\n} else if(att == \\\"sczj_pic_everyRow\\\") {\\r\\n    temp = sczj_pic_everyRow.getValue()\\r\\n} else if(att == \\\"sczj_pic_everyPage\\\") {\\r\\n    temp = sczj_pic_everyPage.getValue()\\r\\n} else if(att == \\\"sczj_pic_add\\\") {\\r\\n    temp = sczj_pic_add.getValue()\\r\\n} else if(att == \\\"sczj_pic_delete\\\") {\\r\\n    temp = sczj_pic_delete.getValue()\\r\\n} else if(att == \\\"sczj_pic_addText\\\") {\\r\\n    temp = sczj_pic_addText.getValue()\\r\\n} else if(att == \\\"sczj_pic_deleteText\\\") {\\r\\n    temp = sczj_pic_deleteText.getValue()\\r\\n} else if(att == \\\"sczj_pic_display\\\") {\\r\\n    temp = sczj_pic_display.getValue()\\r\\n}\\r\\nreturn temp\",\"returnType\":\"\"}}]},{\"cid\":\"vmduxevents\",\"id\":\"事件\",\"layoutConfig\":{},\"userConfig\":{},\"cn\":[{\"cid\":\"uxevent\",\"id\":\"uploadDecimalChanged\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"uploadDecimalChanged\",\"params\":\"value,describe\",\"desc\":\"\"}}]}]}","vmdresource":"{\"components\":[{\"cid\":\"vmdrescsss\",\"layoutConfig\":{},\"userConfig\":{}},{\"cid\":\"vmdresjss\",\"layoutConfig\":{},\"userConfig\":{},\"cn\":[{\"cid\":\"resjs\",\"id\":\"controller.js\",\"layoutConfig\":{},\"userConfig\":{}}]},{\"cid\":\"vmdresimgs\",\"layoutConfig\":{},\"userConfig\":{}}]}"}