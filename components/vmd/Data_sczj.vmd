{"vmdversion":"2.0.4.20190402","vmdlayout":"{\"components\":[{\"cid\":\"uxpanel\",\"id\":\"Data_sczj\",\"layoutConfig\":{},\"userConfig\":{\"layout\":\"absolute\",\"header\":false,\"width\":320,\"height\":621,\"afterrender\":\"Data_sczj_afterrender\"},\"cn\":[{\"cid\":\"label\",\"id\":\"label\",\"layoutConfig\":{},\"userConfig\":{\"x\":10,\"y\":15,\"text\":\"数据集：\"}},{\"cid\":\"label\",\"id\":\"label1\",\"layoutConfig\":{},\"userConfig\":{\"x\":20,\"y\":50,\"text\":\"路径：\"}},{\"cid\":\"label\",\"id\":\"label2\",\"layoutConfig\":{},\"userConfig\":{\"x\":20,\"y\":85,\"text\":\"名称：\"}},{\"cid\":\"label\",\"id\":\"label3\",\"layoutConfig\":{},\"userConfig\":{\"x\":20,\"y\":120,\"text\":\"大小：\"}},{\"cid\":\"label\",\"id\":\"label4\",\"layoutConfig\":{},\"userConfig\":{\"x\":20,\"y\":155,\"text\":\"类型：\"}},{\"cid\":\"label\",\"id\":\"label5\",\"layoutConfig\":{},\"userConfig\":{\"x\":6,\"y\":190,\"text\":\"文档ID：\"}},{\"cid\":\"vmdComlist\",\"id\":\"sczj_dataSet\",\"layoutConfig\":{},\"userConfig\":{\"x\":60,\"y\":10,\"width\":220,\"id\":\"sczj_dataSet\",\"style\":\"border: 1px solid #dddddd\",\"afterrender\":\"sczj_dataSet_afterrender\",\"beforerender\":\"sczj_dataSet_beforerender\",\"selectChanged\":\"sczj_dataSet_selectChanged\"}},{\"cid\":\"vmdComlist\",\"id\":\"sczj_dataPath\",\"layoutConfig\":{},\"userConfig\":{\"x\":60,\"y\":45,\"width\":220,\"id\":\"sczj_dataPath\",\"style\":\"border: 1px solid #dddddd\",\"beforerender\":\"sczj_dataPath_beforerender\",\"selectChanged\":\"sczj_dataPath_selectChanged\"}},{\"cid\":\"vmdComlist\",\"id\":\"sczj_dataName\",\"layoutConfig\":{},\"userConfig\":{\"x\":60,\"y\":80,\"width\":220,\"id\":\"sczj_dataName\",\"style\":\"border: 1px solid #dddddd\",\"beforerender\":\"sczj_dataName_beforerender\",\"selectChanged\":\"sczj_dataName_selectChanged\"}},{\"cid\":\"vmdComlist\",\"id\":\"sczj_dataSize\",\"layoutConfig\":{},\"userConfig\":{\"x\":60,\"y\":115,\"width\":220,\"id\":\"sczj_dataSize\",\"style\":\"border: 1px solid #dddddd\",\"beforerender\":\"sczj_dataSize_beforerender\",\"selectChanged\":\"sczj_dataSize_selectChanged\"}},{\"cid\":\"vmdComlist\",\"id\":\"sczj_dataType\",\"layoutConfig\":{},\"userConfig\":{\"x\":60,\"y\":150,\"width\":220,\"id\":\"sczj_dataType\",\"style\":\"border: 1px solid #dddddd\",\"beforerender\":\"sczj_dataType_beforerender\",\"selectChanged\":\"sczj_dataType_selectChanged\"}},{\"cid\":\"vmdComlist\",\"id\":\"sczj_dataId\",\"layoutConfig\":{},\"userConfig\":{\"x\":60,\"y\":185,\"width\":220,\"id\":\"sczj_dataId\",\"style\":\"border: 1px solid #dddddd\",\"beforerender\":\"sczj_dataId_beforerender\",\"selectChanged\":\"sczj_dataId_selectChanged\"}}]}]}","vmdevents":"var store = new Ext.data.JsonStore({\n    proxy: new Ext.data.MemoryProxy(),\n    fields: ['name', 'value']\n});\n/////////////////////////////////////////////////////\nvar store1 = new Ext.data.JsonStore({\n    proxy: new Ext.data.MemoryProxy(),\n    fields: ['name', 'value']\n});\n/////////////////////////////////////////////////////\nvar store2 = new Ext.data.JsonStore({\n    proxy: new Ext.data.MemoryProxy(),\n    fields: ['name', 'value']\n});\n/////////////////////////////////////////////////////\nvar store3 = new Ext.data.JsonStore({\n    proxy: new Ext.data.MemoryProxy(),\n    fields: ['name', 'value']\n});\n/////////////////////////////////////////////////////\nvar store4 = new Ext.data.JsonStore({\n    proxy: new Ext.data.MemoryProxy(),\n    fields: ['name', 'value']\n});\n/////////////////////////////////////////////////////\nvar store5 = new Ext.data.JsonStore({\n    proxy: new Ext.data.MemoryProxy(),\n    fields: ['name', 'value']\n});\n/////////////////////////////////////////////////////\nfunction sczj_dataSet_beforerender(sender) {\n    sczj_dataSet.store = store;\n    sczj_dataSet.displayField = \"name\"\n    sczj_dataSet.valueField = \"id\"\n}\n\nfunction sczj_dataPath_beforerender(sender) {\n    sczj_dataPath.store = store1;\n    sczj_dataPath.displayField = \"name\"\n    sczj_dataPath.valueField = \"id\"\n}\n\nfunction sczj_dataName_beforerender(sender) {\n    sczj_dataName.store = store2;\n    sczj_dataName.displayField = \"name\"\n    sczj_dataName.valueField = \"id\"\n}\n\nfunction sczj_dataSize_beforerender(sender) {\n    sczj_dataSize.store = store3;\n    sczj_dataSize.displayField = \"name\"\n    sczj_dataSize.valueField = \"id\"\n}\n\nfunction sczj_dataType_beforerender(sender) {\n    sczj_dataId.store = store4;\n    sczj_dataId.displayField = \"name\"\n    sczj_dataId.valueField = \"id\"\n}\n\nfunction sczj_dataId_beforerender(sender) {\n    sczj_dataType.store = store5;\n    sczj_dataType.displayField = \"name\"\n    sczj_dataType.valueField = \"id\"\n}\n\nfunction sczj_dataSet_afterrender(sender) {\n    var el = sender.el.dom.parentElement.parentElement.childNodes[6];\n    el.onclick = function() {\n        var names = parent.sheetHot.getDatasets();\n        if (names && names.length > 0) {\n            var nameSet = [];\n            for (var i = 0; i < names.length; i++) {\n                nameSet.push({\n                    name: names[i].name,\n                    value: names[i].name\n                })\n            }\n        }\n        if (nameSet) {\n            store.loadData(nameSet);\n        }\n    }\n}\n\nfunction sczj_dataSet_selectChanged(sender, combo, record, index) {\n    sender.setValue(record.data.name)\n    temp = [];\n    var dataSets = parent.sheetHot.getDatasets();\n    for (var i = 0; i < dataSets.length; i++) {\n        if (dataSets[i].name == record.data.name) {\n            for (var n = 0; n < dataSets[i].fields.length; n++) {\n                temp.push({\n                    name: dataSets[i].fields[n],\n                    value: dataSets[i].fields[n]\n                })\n            }\n        }\n    }\n    store1.loadData(temp)\n    store2.loadData(temp)\n    store3.loadData(temp)\n    store4.loadData(temp)\n    store5.loadData(temp)\n    sczj_dataPath.setValue(\"\");\n    sczj_dataName.setValue(\"\");\n    sczj_dataSize.setValue(\"\");\n    sczj_dataType.setValue(\"\");\n    sczj_dataId.setValue(\"\")\n}\n\nfunction sczj_dataPath_selectChanged(sender, combo, record, index) {\n    sender.setValue(record.data.name)\n}\n\nfunction sczj_dataName_selectChanged(sender, combo, record, index) {\n    sender.setValue(record.data.name)\n}\n\nfunction sczj_dataSize_selectChanged(sender, combo, record, index) {\n    sender.setValue(record.data.name)\n}\n\nfunction sczj_dataType_selectChanged(sender, combo, record, index) {\n    sender.setValue(record.data.name)\n}\n\nfunction sczj_dataId_selectChanged(sender, combo, record, index) {\n    sender.setValue(record.data.name)\n}\n\nfunction setInfo(info) {\n    if (info) {\n       var hot =sheetHot;\n    var canWrite = false;\n    var cell = hot.dealInvert()[0];\n    var mArr = hot.getPlugin('MergeCells').mergedCellsCollection.mergedCells;\n    var sel = hot.dealInvert()[0];\n    var count = 0;\n    if (mArr.length > 0) {\n        for (var x = 0; x < mArr.length; x++) {\n            for (var i = sel.sr; i < sel.er + 1; i++) {\n                for (var n = sel.sc; n < sel.ec + 1; n++) {\n                    if (mArr[x].row == i && mArr[x].col == n) {\n                        count++;\n                        if (count == 1) no = x;\n                    }\n                }\n            }\n        }\n        if (count == 1) {\n            if (mArr[no].row + mArr[no].rowspan - 1 == sel.er && mArr[no].col + mArr[no].colspan - 1 == sel.ec) {\n                canWrite = true;\n            }\n        }\n    }\n    if (canWrite || (cell.sr == cell.er && cell.sc == cell.ec)) {\n            info = parent.sheetHot.getCellMeta(cell.sr, cell.sc).cellAttributeInfo.cell_UploadInfo;\n            sczj_dataId.setValue(info.sczj_dataId.value);\n            sczj_dataName.setValue(info.sczj_dataName.value);\n            sczj_dataPath.setValue(info.sczj_dataPath.value);\n            sczj_dataSet.setValue(info.sczj_dataSet.value);\n            sczj_dataSize.setValue(info.sczj_dataSize.value);\n            sczj_dataType.setValue(info.sczj_dataType.value)\n        } else {\n            sczj_dataId.setValue(info[0].sczj_dataId.value);\n            sczj_dataName.setValue(info[0].sczj_dataName.value);\n            sczj_dataPath.setValue(info[0].sczj_dataPath.value);\n            sczj_dataSet.setValue(info[0].sczj_dataSet.value);\n            sczj_dataSize.setValue(info[0].sczj_dataSize.value);\n            sczj_dataType.setValue(info[0].sczj_dataType.value)\n        }\n    }\n}\n\nfunction Data_sczj_afterrender(sender) {}","vmdcss":"","vmdprops":"\"\"","type":"ux","vmdevents_controller":"Ext.define('vmd.ux.data_sczj.Controller', {\n    xtype: 'vmd.ux.data_sczj.Controller',\n    constructor: function(options) {\n        \n    }\n})","vmdinterface":"{\"components\":[{\"cid\":\"vmduxprops\",\"layoutConfig\":{},\"userConfig\":{}},{\"cid\":\"vmduxmethods\",\"id\":\"方法\",\"layoutConfig\":{},\"userConfig\":{},\"cn\":[{\"cid\":\"uxmethod\",\"id\":\"getInfo\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"getInfo\",\"zhname\":\"\",\"bindCmp\":\"\",\"bindValue\":\"\",\"isPublic\":\"on\",\"desc\":\"\",\"uxcid\":\"\",\"params\":\"att\",\"code\":\"var temp;\\nif(att == \\\"sczj_dataId\\\") {\\n    temp = sczj_dataId.getValue()\\n} else if(att == \\\"sczj_dataName\\\") {\\n    temp = sczj_dataName.getValue()\\n} else if(att == \\\"sczj_dataPath\\\") {\\n    temp = sczj_dataPath.getValue()\\n} else if(att == \\\"sczj_dataSet\\\") {\\n    temp = sczj_dataSet.getValue()\\n} else if(att == \\\"sczj_dataSize\\\") {\\n    temp = sczj_dataSize.getValue()\\n} else if(att == \\\"sczj_dataType\\\") {\\n    temp = sczj_dataType.getValue()\\n}\\nreturn temp;\",\"returnType\":\"\"}},{\"cid\":\"uxmethod\",\"id\":\"setInfo\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"setInfo\",\"zhname\":\"\",\"bindCmp\":\"\",\"bindValue\":\"\",\"isPublic\":\"on\",\"desc\":\"\",\"uxcid\":\"\",\"params\":\"info\",\"code\":\"setInfo(info)\",\"returnType\":\"\"}}]},{\"cid\":\"vmduxevents\",\"id\":\"事件\",\"layoutConfig\":{},\"userConfig\":{}}]}","vmdresource":"{\"components\":[{\"cid\":\"vmdrescsss\",\"layoutConfig\":{},\"userConfig\":{}},{\"cid\":\"vmdresjss\",\"layoutConfig\":{},\"userConfig\":{},\"cn\":[{\"cid\":\"resjs\",\"id\":\"controller.js\",\"layoutConfig\":{},\"userConfig\":{}}]},{\"cid\":\"vmdresimgs\",\"layoutConfig\":{},\"userConfig\":{}}]}"}