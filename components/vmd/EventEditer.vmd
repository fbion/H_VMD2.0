{"vmdversion":"2.0.3.201900303","vmdlayout":"{\"components\":[{\"cid\":\"uxpanel\",\"id\":\"EventEditer\",\"layoutConfig\":{},\"userConfig\":{\"layout\":\"border\",\"header\":false,\"width\":1400,\"height\":700,\"afterrender\":\"EventEditer_afterrender\"},\"cn\":[{\"cid\":\"container\",\"id\":\"div\",\"layoutConfig\":{},\"userConfig\":{\"x\":0,\"y\":0,\"height\":700,\"width\":320,\"layout\":\"fit\",\"region\":\"west\",\"split\":true,\"collapseMode\":\"mini\",\"xtype\":\"panel\"},\"cn\":[{\"cid\":\"vmdTreeEx\",\"id\":\"tree\",\"layoutConfig\":{},\"userConfig\":{\"width\":208,\"beforerender\":\"tree_beforerender\",\"rootValue\":\"0\",\"rootText\":\"内核功能\",\"loadType\":\"全部加载\",\"nodeDblClick\":\"tree_nodeDblClick\",\"leafImg\":\"/img/public/圆点.png\"}}]},{\"cid\":\"container\",\"id\":\"div1\",\"layoutConfig\":{},\"userConfig\":{\"x\":1100,\"y\":0,\"width\":496,\"height\":700,\"region\":\"center\",\"border\":false,\"split\":true,\"collapseMode\":\"mini\",\"layout\":\"anchor\",\"xtype\":\"panel\"},\"cn\":[{\"cid\":\"vmdAceEditor\",\"id\":\"MyAce\",\"layoutConfig\":{},\"userConfig\":{\"anchor\":\"100% 100%\"}}]},{\"cid\":\"container\",\"id\":\"div2\",\"layoutConfig\":{},\"userConfig\":{\"region\":\"east\",\"width\":350,\"split\":true,\"collapseMode\":\"mini\",\"xtype\":\"panel\"}}]}]}","vmdevents":"var store = new Ext.data.JsonStore({\r\n    proxy: new Ext.data.MemoryProxy(),\r\n    fields: ['name', 'id', 'pID']\r\n});\r\nvar data = [{\r\n    name: '内核功能',\r\n    id: '0',\r\n    pID: ''\r\n}, {\r\n    name: '报表操作',\r\n    id: 'F1',\r\n    pID: '0'\r\n}, {\r\n    name: '脚本',\r\n    id: 'F2',\r\n    pID: '0'\r\n}, {\r\n    name: 'CellEditRefresh(刷新控制单元格是否可以编辑)',\r\n    id: 'func1',\r\n    pID: 'F1'\r\n}, {\r\n    name: 'CellsValueRefresh(刷新单元格值)',\r\n    id: 'func2',\r\n    pID: 'F1'\r\n}, {\r\n    name: 'CellVisibleRefresh(刷新控制单元格是否可见)',\r\n    id: 'func3',\r\n    pID: 'F1'\r\n}, {\r\n    name: 'ColsRefresh(刷新列)',\r\n    id: 'func4',\r\n    pID: 'F1'\r\n}, {\r\n    name: 'DataSetSRefresh(刷新数据集)',\r\n    id: 'func5',\r\n    pID: 'F1'\r\n}, {\r\n    name: 'MakeSql(设置sql语句)',\r\n    id: 'func6',\r\n    pID: 'F1'\r\n}, {\r\n    name: 'ReadExcelFile(导入excel)',\r\n    id: 'func7',\r\n    pID: 'F1'\r\n}, {\r\n    name: 'ReportRefresh(刷新报表)',\r\n    id: 'func8',\r\n    pID: 'F1'\r\n}, {\r\n    name: 'RowsRefresh(刷新行)',\r\n    id: 'func9',\r\n    pID: 'F1'\r\n}, {\r\n    name: 'SaveTableEvent(保存表)',\r\n    id: 'func10',\r\n    pID: 'F1'\r\n}, {\r\n    name: 'SetParams(参数配置)',\r\n    id: 'func11',\r\n    pID: 'F1'\r\n}, {\r\n    name: 'SubReportEvent(打开模块)',\r\n    id: 'func12',\r\n    pID: 'F1'\r\n}, {\r\n    name: 'WindowClose(关闭窗体)',\r\n    id: 'func13',\r\n    pID: 'F1'\r\n}, {\r\n    name: 'JavaScript(JavaScript)',\r\n    id: 'func14',\r\n    pID: 'F2'\r\n}];\r\nstore.loadData(data);\r\n////////////////////////////////////////////////////////////////////////////////\r\n\r\nfunction tree_beforerender(sender) {\r\n    // \r\n    tree.store = store;\r\n    tree.valueField = \"id\"\r\n    tree.textField = \"name\"\r\n    tree.parentField = \"pID\"\r\n    tree.rootValue = \"0\"\r\n}\r\n\r\n//<trigger triggerFunc=\"edit\" Cells=\"B1,C1,D1\" IsEditable=\"1\" />\r\nvar ff1 = \"//edit(cells,flag)\\n//cells:单元格id (B2,C3);\\n//flag:是否可编辑（1：可编辑；0：不可编辑)\\nedit()\"\r\n//<trigger triggerFunc=\"fillcells\" Cells=\"C2,E2,D4\" />\r\nvar ff2 = \"//fillcells(Cells)\\n//Celss:单元格id（B2,C1);\\nfillcells()\"\r\n//<trigger triggerFunc=\"visible\" Cells=\"C2,D2\" IsVisible=\"1\" />\r\nvar ff3 = \"//visible(Cells,IsVisible)\\n//Cells:单元格id （C1,D1);\\n//IsVisible:是否可见(1:可见；2:不可见)\\nvisible()\"\r\n/*<trigger triggerFunc=\"makesql\" sql=\"select a from b where a&gt;1\">\r\n                <paramlist>\r\n                  <param name=\"a\" type=\"Byte\" value=\"0\" />\r\n                </paramlist>\r\n              </trigger>*/\r\nvar ff6 = \"//makesql(sql,param)\\n//sql:SQL语句 \\\"select a from b where a& gt; 1\\\"\\n //param:属性 包含name变量名，type类型，value值\\n//类型包括 Binary、Byte、Boolean、Currency、Int32、Int64、Single、Double、VarNumeric、String、Date、DateTime、DateTime2、DateTimeOffset\\nmakesql()\";\r\n// <trigger triggerFunc=\"freshrows\" Rows=\"6,11,9,7,5,2,1\" rowHeight=\"666\" />\r\nvar ff9 = \"//freshrows(Rows,Height)\\n//Rows:行id (1,3,4);\\n//Height:行高\\nfreshrows()\"\r\n// <trigger triggerFunc=\"submitdb\" />\r\nvar ff10 = \"//submitdb()\\nsubmitdb()\"\r\n// <trigger triggerFunc=\"setparams\">\r\n//     <params>\r\n//       <var id=\"0\" name=\"aaaaaaaaa\" value=\"bbbbbbbbbb\" description=\"\" type=\"report\" />\r\n//       <var id=\"0\" name=\"cccccccccc\" value=\"dddddddddd\" description=\"\" type=\"report\" />\r\n//     </params>\r\n// </trigger>\r\nvar ff11 = \"//setparams(params)\\n//params包含 id、name、value、description、type\\nsetparams()\"\r\n//<trigger triggerFunc=\"windowclose\" />\r\nvar ff13 = \"//windowclose()\\nwindowclose()\"\r\n//<trigger triggerFunc=\"javascript\" javascript=\"ZnVuY3Rpb24oKXsNCgkvL215IGphdmFzY3JpcHQgaW5mbw0KfQ==\" linkarea=\"A1:K6\" />\r\nvar ff14 = \"//javascript(javascript,linkarea)\\n//javascript JS脚本 linkarea：关联区域 示例\\\"A1:K6\\\"\\njavascript()\"\r\n\r\n\r\nfunction tree_nodeDblClick(sender, node, e) {\r\n    if(MyAce.getValue() == \"\") {\r\n        switch (node.attributes.id) {\r\n            case \"func1\":\r\n                MyAce.setValue(ff1);\r\n                break;\r\n            case \"func2\":\r\n                MyAce.setValue(ff2);\r\n                break;\r\n            case \"func3\":\r\n                MyAce.setValue(ff3);\r\n                break;\r\n            case \"func4\":\r\n                MyAce.setValue(ff4);\r\n                break;\r\n            case \"func5\":\r\n                MyAce.setValue(ff5);\r\n                break;\r\n            case \"func6\":\r\n                MyAce.setValue(ff6);\r\n                break;\r\n            case \"func7\":\r\n                MyAce.setValue(ff7);\r\n                break;\r\n            case \"func8\":\r\n                MyAce.setValue(ff8);\r\n                break;\r\n            case \"func9\":\r\n                MyAce.setValue(ff9);\r\n                break;\r\n            case \"func10\":\r\n                MyAce.setValue(ff10);\r\n                break;\r\n            case \"func11\":\r\n                MyAce.setValue(ff11);\r\n                break;\r\n            case \"func12\":\r\n                MyAce.setValue(ff12);\r\n                break;\r\n            case \"func13\":\r\n                MyAce.setValue(ff13);\r\n                break;\r\n            case \"func14\":\r\n                MyAce.setValue(ff14);\r\n                break;\r\n\r\n        }\r\n    } else {\r\n        switch (node.attributes.id) {\r\n            case \"func1\":\r\n                MyAce.setValue(MyAce.getValue() + '\\n\\n' + ff1);\r\n                break;\r\n            case \"func2\":\r\n                MyAce.setValue(MyAce.getValue() + '\\n\\n' + ff2);\r\n                break;\r\n            case \"func3\":\r\n                MyAce.setValue(MyAce.getValue() + '\\n\\n' + ff3);\r\n                break;\r\n            case \"func4\":\r\n                MyAce.setValue(MyAce.getValue() + '\\n\\n' + ff4);\r\n                break;\r\n            case \"func5\":\r\n                MyAce.setValue(MyAce.getValue() + '\\n\\n' + ff5);\r\n                break;\r\n            case \"func6\":\r\n                MyAce.setValue(MyAce.getValue() + '\\n\\n' + ff6);\r\n                break;\r\n            case \"func7\":\r\n                MyAce.setValue(MyAce.getValue() + '\\n\\n' + ff7);\r\n                break;\r\n            case \"func8\":\r\n                MyAce.setValue(MyAce.getValue() + '\\n\\n' + ff8);\r\n                break;\r\n            case \"func9\":\r\n                MyAce.setValue(MyAce.getValue() + '\\n\\n' + ff9);\r\n                break;\r\n            case \"func10\":\r\n                MyAce.setValue(MyAce.getValue() + '\\n\\n' + ff10);\r\n                break;\r\n            case \"func11\":\r\n                MyAce.setValue(MyAce.getValue() + '\\n\\n' + ff11);\r\n                break;\r\n            case \"func12\":\r\n                MyAce.setValue(MyAce.getValue() + '\\n\\n' + ff12);\r\n                break;\r\n            case \"func13\":\r\n                MyAce.setValue(MyAce.getValue() + '\\n\\n' + ff13);\r\n                break;\r\n            case \"func14\":\r\n                MyAce.setValue(MyAce.getValue() + '\\n\\n' + ff14);\r\n                break;\r\n        }\r\n    }\r\n}\r\n\r\n\r\n\r\nfunction EventEditer_afterrender(sender) {\r\n\r\n}","vmdcss":"","vmdprops":"\"\"","type":"ux","vmdinterface":"{\"components\":[{\"cid\":\"vmduxprops\",\"layoutConfig\":{},\"userConfig\":{}},{\"cid\":\"vmduxmethods\",\"id\":\"方法\",\"layoutConfig\":{},\"userConfig\":{},\"cn\":[{\"cid\":\"uxmethod\",\"id\":\"getCode\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"getCode\",\"zhname\":\"\",\"bindCmp\":\"\",\"bindValue\":\"\",\"isPublic\":\"on\",\"desc\":\"\",\"uxcid\":\"\",\"params\":\"\",\"code\":\"return MyAce.getValue()\",\"returnType\":\"\"}},{\"cid\":\"uxmethod\",\"id\":\"setCode\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"setCode\",\"params\":\"code\",\"desc\":\"\",\"isPublic\":\"on\",\"code\":\"MyAce.setValue(MyAce.getValue() + code)\",\"returnType\":\"\"}}]},{\"cid\":\"vmduxevents\",\"id\":\"事件\",\"layoutConfig\":{},\"userConfig\":{}}]}","vmdresource":"{\"components\":[{\"cid\":\"vmdrescsss\",\"layoutConfig\":{},\"userConfig\":{}},{\"cid\":\"vmdresjss\",\"layoutConfig\":{},\"userConfig\":{}},{\"cid\":\"vmdresimgs\",\"layoutConfig\":{},\"userConfig\":{}}]}"}