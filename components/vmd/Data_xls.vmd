{"vmdversion":"2.0.4.20190402","vmdlayout":"{\"components\":[{\"cid\":\"uxpanel\",\"id\":\"Data_xls\",\"layoutConfig\":{},\"userConfig\":{\"layout\":\"absolute\",\"header\":false,\"width\":320,\"height\":621,\"afterrender\":\"Data_xls_afterrender\"},\"cn\":[{\"cid\":\"label\",\"id\":\"label\",\"layoutConfig\":{},\"userConfig\":{\"x\":30,\"y\":15,\"text\":\"数据集：\"}},{\"cid\":\"vmdComlist\",\"id\":\"xls_dataSet\",\"layoutConfig\":{},\"userConfig\":{\"x\":80,\"y\":10,\"width\":180,\"style\":\"border: 1px solid #dddddd\",\"id\":\"xls_dataSet\",\"beforerender\":\"xls_dataSet_beforerender\",\"selectChanged\":\"xls_dataSet_selectChanged\"}},{\"cid\":\"vmdComlist\",\"id\":\"xls_myDisplayFiled\",\"layoutConfig\":{},\"userConfig\":{\"x\":80,\"y\":45,\"width\":180,\"style\":\"border: 1px solid #dddddd\",\"id\":\"xls_myDisplayFiled\",\"beforerender\":\"xls_myDisplayFiled_beforerender\"}},{\"cid\":\"vmdComlist\",\"id\":\"xls_myFatherFiled\",\"layoutConfig\":{},\"userConfig\":{\"x\":80,\"y\":220,\"width\":180,\"style\":\"border: 1px solid #dddddd\",\"id\":\"xls_myFatherFiled\",\"beforerender\":\"xls_myFatherFiled_beforerender\"}},{\"cid\":\"vmdComlist\",\"id\":\"xls_myNodeFiled\",\"layoutConfig\":{},\"userConfig\":{\"x\":80,\"y\":115,\"width\":180,\"style\":\"border: 1px solid #dddddd\",\"id\":\"xls_myNodeFiled\",\"beforerender\":\"xls_myNodeFiled_beforerender\"}},{\"cid\":\"vmdComlist\",\"id\":\"xls_rootValue\",\"layoutConfig\":{},\"userConfig\":{\"x\":80,\"y\":150,\"width\":180,\"style\":\"border: 1px solid #dddddd\",\"id\":\"xls_rootValue\",\"beforerender\":\"xls_rootValue_beforerender\"}},{\"cid\":\"vmdComlist\",\"id\":\"xls_rootNodeText\",\"layoutConfig\":{},\"userConfig\":{\"x\":80,\"y\":185,\"width\":180,\"style\":\"border: 1px solid #dddddd\",\"id\":\"xls_rootNodeText\",\"beforerender\":\"xls_rootNodeText_beforerender\"}},{\"cid\":\"vmdComlist\",\"id\":\"xls_myValueFiled\",\"layoutConfig\":{},\"userConfig\":{\"x\":80,\"y\":80,\"width\":180,\"style\":\"border: 1px solid #dddddd\",\"id\":\"xls_myValueFiled\",\"beforerender\":\"xls_myValueFiled_beforerender\"}},{\"cid\":\"label\",\"id\":\"label1\",\"layoutConfig\":{},\"userConfig\":{\"x\":20,\"y\":50,\"text\":\"显示字段：\"}},{\"cid\":\"label\",\"id\":\"label2\",\"layoutConfig\":{},\"userConfig\":{\"x\":20,\"y\":225,\"text\":\"父列字段：\"}},{\"cid\":\"label\",\"id\":\"label3\",\"layoutConfig\":{},\"userConfig\":{\"x\":20,\"y\":120,\"text\":\"节点字段：\"}},{\"cid\":\"label\",\"id\":\"label4\",\"layoutConfig\":{},\"userConfig\":{\"x\":40,\"y\":155,\"text\":\"根值：\"}},{\"cid\":\"label\",\"id\":\"label5\",\"layoutConfig\":{},\"userConfig\":{\"x\":10,\"y\":190,\"text\":\"根节点文本：\"}},{\"cid\":\"label\",\"id\":\"label6\",\"layoutConfig\":{},\"userConfig\":{\"x\":30,\"y\":85,\"text\":\"值字段：\",\"height\":20}},{\"cid\":\"textfield\",\"id\":\"filter_xls\",\"layoutConfig\":{},\"userConfig\":{\"x\":80,\"y\":255,\"cls\":\"b\",\"width\":160,\"id\":\"filter_xls\"}},{\"cid\":\"label\",\"id\":\"label7\",\"layoutConfig\":{},\"userConfig\":{\"x\":20,\"y\":260,\"text\":\"过滤条件：\"}},{\"cid\":\"vmdButton\",\"id\":\"button\",\"layoutConfig\":{},\"userConfig\":{\"x\":250,\"y\":255,\"width\":30,\"text\":\"...\",\"click\":\"button_click\"}}]}]}","vmdevents":"var hot = parent.sheetHot;\nvar page = this\nvar store1 = new Ext.data.JsonStore({\n    proxy: new Ext.data.MemoryProxy(),\n    fields: ['name', 'value']\n});\nvar store2 = new Ext.data.JsonStore({\n    proxy: new Ext.data.MemoryProxy(),\n    fields: ['name', 'value']\n});\nvar store3 = new Ext.data.JsonStore({\n    proxy: new Ext.data.MemoryProxy(),\n    fields: ['name', 'value']\n});\nvar store4 = new Ext.data.JsonStore({\n    proxy: new Ext.data.MemoryProxy(),\n    fields: ['name', 'value']\n});\nvar store5 = new Ext.data.JsonStore({\n    proxy: new Ext.data.MemoryProxy(),\n    fields: ['name', 'value']\n});\nvar store6 = new Ext.data.JsonStore({\n    proxy: new Ext.data.MemoryProxy(),\n    fields: ['name', 'value']\n});\nvar store7 = new Ext.data.JsonStore({\n    proxy: new Ext.data.MemoryProxy(),\n    fields: ['name', 'value']\n});\n\nfunction xls_dataSet_beforerender(sender) {\n    xls_dataSet.store = store1;\n    xls_dataSet.displayField = 'name';\n    xls_dataSet.valueField = 'value'\n}\n\nfunction Data_xls_afterrender(sender) {\n    sender.items.items[1].el.dom.parentElement.onclick = function() {\n        var names = parent.sheetHot.getDatasets();\n        if (names && names.length > 0) {\n            var nameSet = [];\n            for (var i = 0; i < names.length; i++) {\n                nameSet.push({\n                    name: names[i].name,\n                    value: names[i].name\n                })\n            }\n        }\n        if (nameSet) {\n            store1.loadData(nameSet);\n        }\n    }\n}\n\nfunction xls_dataSet_selectChanged(sender, combo, record, index) {\n    temp = [];\n    var dataSets = parent.sheetHot.getDatasets();\n    for (var i = 0; i < dataSets.length; i++) {\n        if (dataSets[i].name == record.data.name) {\n            for (var n = 0; n < dataSets[i].fields.length; n++) {\n                temp.push({\n                    name: dataSets[i].fields[n],\n                    value: dataSets[i].fields[n]\n                })\n            }\n        }\n    }\n    store2.loadData(temp)\n    store3.loadData(temp)\n    store4.loadData(temp)\n    store5.loadData(temp)\n    store6.loadData(temp)\n    store7.loadData(temp)\n    xls_myDisplayFiled.setValue(\"\");\n    xls_myNodeFiled.setValue(\"\");\n    xls_myFatherFiled.setValue(\"\");\n    xls_rootValue.setValue(\"\");\n    xls_rootNodeText.setValue(\"\");\n    xls_myValueFiled.setValue(\"\");\n}\n\nfunction xls_myDisplayFiled_beforerender(sender) {\n    xls_myDisplayFiled.store = store2;\n    xls_myDisplayFiled.displayField = 'name';\n    xls_myDisplayFiled.valueField = 'value'\n}\n\nfunction xls_myValueFiled_beforerender(sender) {\n    xls_myValueFiled.store = store3;\n    xls_myValueFiled.displayField = 'name';\n    xls_myValueFiled.valueField = 'value'\n}\n\nfunction xls_myNodeFiled_beforerender(sender) {\n    xls_myNodeFiled.store = store4;\n    xls_myNodeFiled.displayField = 'name';\n    xls_myNodeFiled.valueField = 'value'\n}\n\nfunction xls_rootValue_beforerender(sender) {\n    xls_rootValue.store = store5;\n    xls_rootValue.displayField = 'name';\n    xls_rootValue.valueField = 'value'\n}\n\nfunction xls_rootNodeText_beforerender(sender) {\n    xls_rootNodeText.store = store6;\n    xls_rootNodeText.displayField = 'name';\n    xls_rootNodeText.valueField = 'value'\n}\n\nfunction xls_myFatherFiled_beforerender(sender) {\n    xls_myFatherFiled.store = store7;\n    xls_myFatherFiled.displayField = 'name';\n    xls_myFatherFiled.valueField = 'value'\n}\n\nfunction setInfo(info) {\n    debugger\n    if (info) {\n        xls_dataSet.setValue(info.xls_dataSet.value);\n        xls_myDisplayFiled.setValue(info.xls_myDisplayFiled.value);\n        xls_myNodeFiled.setValue(info.xls_myNodeFiled.value);\n        xls_myFatherFiled.setValue(info.xls_myFatherFiled.value);\n        xls_rootValue.setValue(info.xls_rootValue.value);\n        xls_rootNodeText.setValue(info.xls_rootNodeText.value);\n        xls_myValueFiled.setValue(info.xls_myValueFiled.value);\n        filter_xls.setValue(info.filter_xls.value)\n        temp = [];\n        var dataSets = parent.sheetHot.getDatasets();\n        for (var i = 0; i < dataSets.length; i++) {\n            if (dataSets[i].name == xls_dataSet.getValue()) {\n                for (var n = 0; n < dataSets[i].fields.length; n++) {\n                    temp.push({\n                        name: dataSets[i].fields[n],\n                        value: dataSets[i].fields[n]\n                    })\n                }\n            }\n        }\n        store2.loadData(temp)\n        store3.loadData(temp)\n        store4.loadData(temp)\n        store5.loadData(temp)\n        store6.loadData(temp)\n        store7.loadData(temp)\n    }\n}\n\nfunction button_click(sender, e) {\n    var data = [];\n    var data1 = [];\n    var cell = sheetHot.dealInvert()[0]\n    var meta = sheetHot.getCellMeta(cell.sr, cell.sc);\n    if (meta && meta.filterInfo_xls) {\n        for (var i = 0; i < meta.filterInfo_xls.length; i++) {\n            data1.push({\n                name: meta.filterInfo_xls[i].name,\n                cnname: meta.filterInfo_xls[i].cnname,\n                width: meta.filterInfo_xls[i].width,\n                search: meta.filterInfo_xls[i].search\n            })\n        }\n    }\n    var index = 0;\n    if (page.fields) {\n        for (var n = 0; n < page.fields.length; n++) {\n            var flag = true\n            for (var k = 0; k < data1.length; k++) {\n                if (page.fields[n].name == data1[k].name) {\n                    flag = false;\n                    break;\n                }\n            }\n            if (flag) {\n                data.push({\n                    name: page.fields[n].name\n                })\n            }\n        }\n    }\n    if (data.length > 0 || data1.length > 0) {\n        parent.openVisualSelector(data, data1, 'xls', true);\n    } else {\n        vmd.tip('请先选择拥有字段的数据集', 'error')\n    }\n}","vmdcss":".b{\n    border:1px solid #ccc\n}","vmdprops":"\"\"","type":"ux","vmdevents_controller":"Ext.define('vmd.ux.data_xls.Controller', {\n    xtype: 'vmd.ux.data_xls.Controller',\n    constructor: function(options) {\n        \n    }\n})","vmdinterface":"{\"components\":[{\"cid\":\"vmduxprops\",\"layoutConfig\":{},\"userConfig\":{}},{\"cid\":\"vmduxmethods\",\"id\":\"方法\",\"layoutConfig\":{},\"userConfig\":{},\"cn\":[{\"cid\":\"uxmethod\",\"id\":\"getInfo\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"getInfo\",\"zhname\":\"\",\"bindCmp\":\"\",\"bindValue\":\"\",\"isPublic\":\"on\",\"desc\":\"\",\"uxcid\":\"\",\"params\":\"att\",\"code\":\"var temp;\\nif(att==\\\"xls_dataSet\\\"){\\n    temp = xls_dataSet.getValue()\\n}else if(att==\\\"xls_myDisplayFiled\\\"){\\n    temp = xls_myDisplayFiled.getValue()\\n}else if (att==\\\"xls_myFatherFiled\\\"){\\n    temp = xls_myFatherFiled.getValue()\\n}else if(att==\\\"xls_myNodeFiled\\\"){\\n    temp =xls_myNodeFiled.getValue()\\n}else if(att==\\\"xls_rootNodeText\\\"){\\n    temp = xls_rootNodeText.getValue()\\n}else if(att==\\\"xls_rootValue\\\"){\\n    temp = xls_rootValue.getValue()\\n}else if(att==\\\"xls_myValueFiled\\\"){\\n    temp = xls_myValueFiled.getValue()\\n}\\nreturn temp;\",\"returnType\":\"\"}},{\"cid\":\"uxmethod\",\"id\":\"setInfo\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"setInfo\",\"zhname\":\"\",\"bindCmp\":\"\",\"bindValue\":\"\",\"isPublic\":\"on\",\"desc\":\"\",\"uxcid\":\"\",\"params\":\"info\",\"code\":\"setInfo(info);\",\"returnType\":\"\"}}]},{\"cid\":\"vmduxevents\",\"id\":\"事件\",\"layoutConfig\":{},\"userConfig\":{}}]}","vmdresource":"{\"components\":[{\"cid\":\"vmdrescsss\",\"layoutConfig\":{},\"userConfig\":{}},{\"cid\":\"vmdresjss\",\"layoutConfig\":{},\"userConfig\":{},\"cn\":[{\"cid\":\"resjs\",\"id\":\"controller.js\",\"layoutConfig\":{},\"userConfig\":{}}]},{\"cid\":\"vmdresimgs\",\"layoutConfig\":{},\"userConfig\":{}}]}"}