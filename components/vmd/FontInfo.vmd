{"vmdversion":"2.0.3.1108","vmdlayout":"{\"components\":[{\"cid\":\"uxpanel\",\"id\":\"FontInfo\",\"layoutConfig\":{},\"userConfig\":{\"layout\":\"absolute\",\"header\":false,\"width\":320,\"height\":621,\"afterrender\":\"FontInfo_afterrender\"},\"cn\":[{\"cid\":\"vmdComlist\",\"id\":\"fontFamily\",\"layoutConfig\":{},\"userConfig\":{\"x\":50,\"y\":10,\"width\":220,\"id\":\"fontFamily\",\"afterrender\":\"fontFamily_afterrender\",\"query\":false}},{\"cid\":\"vmdComlist\",\"id\":\"fontShape\",\"layoutConfig\":{},\"userConfig\":{\"x\":50,\"y\":50,\"width\":220,\"id\":\"fontShape\",\"afterrender\":\"fontShape_afterrender\"}},{\"cid\":\"vmdComlist\",\"id\":\"fontSize\",\"layoutConfig\":{},\"userConfig\":{\"x\":50,\"y\":90,\"width\":220,\"id\":\"fontSize\",\"afterrender\":\"fontSize_afterrender\"}},{\"cid\":\"radiogroup\",\"id\":\"underline\",\"layoutConfig\":{},\"userConfig\":{\"x\":60,\"y\":140,\"store\":\"\",\"id\":\"underline\",\"width\":190,\"height\":30,\"change\":\"underline_change\"},\"cn\":[{\"cid\":\"radio\",\"id\":\"hwRadio\",\"layoutConfig\":{},\"userConfig\":{\"boxLabel\":\"有下划线\",\"fieldLabel\":\"\",\"inputValue\":\"Y\"}},{\"cid\":\"radio\",\"id\":\"hwRadio1\",\"layoutConfig\":{},\"userConfig\":{\"fieldLabel\":\"\",\"boxLabel\":\"无下划线\",\"checked\":true,\"inputValue\":\"N\"}}]},{\"cid\":\"label\",\"id\":\"label\",\"layoutConfig\":{},\"userConfig\":{\"x\":10,\"y\":10,\"text\":\"字体：\"}},{\"cid\":\"label\",\"id\":\"label1\",\"layoutConfig\":{},\"userConfig\":{\"x\":10,\"y\":50,\"text\":\"字形：\"}},{\"cid\":\"label\",\"id\":\"label2\",\"layoutConfig\":{},\"userConfig\":{\"x\":10,\"y\":90,\"text\":\"字号：\"}},{\"cid\":\"label\",\"id\":\"label3\",\"layoutConfig\":{},\"userConfig\":{\"x\":0,\"y\":140,\"text\":\" 下划线：\",\"width\":60,\"height\":20}},{\"cid\":\"label\",\"id\":\"label4\",\"layoutConfig\":{},\"userConfig\":{\"x\":10,\"y\":182,\"text\":\"颜色：\",\"height\":20}},{\"cid\":\"container\",\"id\":\"fontColorSelect\",\"layoutConfig\":{},\"userConfig\":{\"x\":60,\"y\":180,\"width\":150,\"height\":30,\"id\":\"fontColorSelect\",\"click\":\"fontColorSelect_click\"}},{\"cid\":\"vmdButton\",\"id\":\"button\",\"layoutConfig\":{},\"userConfig\":{\"x\":210,\"y\":180,\"icon\":\"icon-caret-down\",\"text\":\"\",\"style\":\"border-radius: 0;    background-size: 120%;    background-position: right;    border: 0;    float: right\",\"width\":22,\"height\":25,\"click\":\"button_click\"}},{\"cid\":\"container\",\"id\":\"myColor\",\"layoutConfig\":{},\"userConfig\":{\"x\":60,\"y\":210,\"width\":150,\"height\":160,\"layout\":\"absolute\",\"id\":\"myColor\",\"hidden\":true},\"cn\":[{\"cid\":\"vmdButton\",\"id\":\"button1\",\"layoutConfig\":{},\"userConfig\":{\"x\":1.5,\"y\":130,\"width\":145,\"text\":\"其他颜色\",\"click\":\"button1_click\",\"style\":\"border:none;\"}}]},{\"cid\":\"container\",\"id\":\"myAnchor\",\"layoutConfig\":{},\"userConfig\":{\"x\":40,\"y\":210,\"width\":20,\"border\":false,\"id\":\"myAnchor\"}}]}]}","vmdevents":"var isCp = false,\n    isCpPick = false; // 颜色面板是否已存在\nvar value = '',\n    selectColor = '';\nvar colorShow, myColorPicker;\nvar page = this\n//font family 字体\nvar store = new Ext.data.JsonStore({\n    proxy: new Ext.data.MemoryProxy(),\n    fields: ['EnName', 'name']\n});\nvar data = [{\n    EnName: 'SimSun',\n    name: '宋体'\n}, {\n    EnName: 'SimHei',\n    name: '黑体'\n}, {\n    EnName: 'Microsoft YaHei',\n    name: '微软雅黑'\n}, {\n    EnName: 'Microsoft JhengHei',\n    name: '微软正黑体'\n}, {\n    EnName: 'NSimSun',\n    name: '新宋体'\n}, {\n    EnName: 'PMingLiU',\n    name: '新细明体'\n}, {\n    EnName: 'FangSong',\n    name: '仿宋'\n}, {\n    EnName: 'KaiTi',\n    name: '楷体'\n}, {\n    EnName: 'FangSong_GB2312',\n    name: '仿宋_GB2312'\n}, {\n    EnName: 'KaiTi_GB2312',\n    name: '楷体_GB2312'\n}, {\n    EnName: 'STHeiti Light',\n    name: '华文细黑'\n}];\nstore.loadData(data);\n///////////////////////////////////////\n//shape 字形\nvar store1 = new Ext.data.JsonStore({\n    proxy: new Ext.data.MemoryProxy(),\n    fields: ['id', 'shapeType']\n});\nvar data1 = [{\n    id: 'normal',\n    shapeType: '常规'\n}, {\n    id: 'italic',\n    shapeType: '倾斜'\n}, {\n    id: 'bold',\n    shapeType: '加粗'\n}, {\n    id: 'double',\n    shapeType: '加粗倾斜'\n}]\nstore1.loadData(data1);\n///////////////////////////////////////\n//font size 字号\nvar store2 = new Ext.data.JsonStore({\n    proxy: new Ext.data.MemoryProxy(),\n    fields: ['size', 'px']\n});\nvar data2 = [{\n        size: '6',\n        px: '6'\n    }, {\n        size: '8',\n        px: '8'\n    }, {\n        size: '9',\n        px: '9'\n    },\n    {\n        size: '10',\n        px: '10'\n    }, {\n        size: '10.5',\n        px: '10.5'\n    }, {\n        size: '11',\n        px: '11'\n    }, {\n        size: '12',\n        px: '12'\n    },\n    {\n        size: '14',\n        px: '14'\n    }, {\n        size: '15',\n        px: '15'\n    }, {\n        size: '16',\n        px: '16'\n    }, {\n        size: '18',\n        px: '18'\n    },\n    {\n        size: '20',\n        px: '20'\n    }, {\n        size: '22',\n        px: '22'\n    }, {\n        size: '24',\n        px: '24'\n    }, {\n        size: '26',\n        px: '26'\n    }, {\n        size: '28',\n        px: '28'\n    }, {\n        size: '36',\n        px: '36'\n    }, {\n        size: '48',\n        px: '48'\n    }, {\n        size: '54',\n        px: '54'\n    }, {\n        size: '72',\n        px: '72'\n    }\n];\nstore2.loadData(data2);\n////////////////////////////////////////\n\nfunction fontFamily_afterrender(sender) {\n    fontFamily.store = store;\n    fontFamily.displayField = 'name';\n    fontFamily.valueField = 'EnName'\n}\n\n\nfunction fontShape_afterrender(sender) {\n    fontShape.store = store1;\n    fontShape.displayField = 'shapeType';\n    fontShape.valueField = 'id';\n}\n\nfunction fontSize_afterrender(sender) {\n    fontSize.store = store2;\n    fontSize.displayField = 'size';\n    fontSize.valueField = 'px';\n}\n\nfunction FontInfo_afterrender(sender) {\n    fontFamily_afterrender();\n    fontShape_afterrender();\n    fontSize_afterrender();\n}\n\nfunction setInfo(info, cell) {\n    // debugger\n    page.selectCells = cell;\n    if(info) {\n        fontFamily.setValue(info.fontFamily.value);\n        fontShape.setValue(info.fontShape.value);\n        fontSize.setValue(info.fontSize.value);\n        // debugger\n        if(info.underline.value && info.underline.value.inputValue) {\n            underline.setValue(info.underline.value.inputValue);\n        } else {\n            underline.setValue(info.underline.value);\n        }\n        setColorValue(info.ColorSelect.value)\n        setBackColor(info.ColorSelect.value)\n        // ColorSelect.setOriColor(\"#5e5e5e\")\n    }\n}\n\nfunction underline_change(sender, checked) {\n    page.fireEvent('underlineChecked', underline, checked)\n}\n\nfunction fontColorSelect_colorchange(sender, selColor) {\n\n}\n\nfunction showColor(value) {\n    if(isCp) {\n        return\n    }\n    var cValue = value;\n    var colors = ['000000', '993300', '333300', '003300', '003366', '000080', '333399', '333333', '800000', 'FF6600', '808000', '008000', '008080', '0000FF', '666699', '808080', 'FF0000', 'FF9900', '99CC00', '339966', '33CCCC', '3366FF', '800080', '969696', 'FF00FF', 'FFCC00', 'FFFF00', '00FF00', '00FFFF', '00CCFF', '993366', 'C0C0C0', 'FF99CC', 'FFCC99', 'FFFF99', 'CCFFCC', 'CCFFFF', '99CCFF', 'CC99FF', 'FFFFFF', 'DDDDDD', 'EEEEEE'];\n    if(value.indexOf(\"#\") != -1) {\n        cValue = value.slice(1);\n    }\n    if(!isInArray(colors, cValue)) {\n        cValue = '';\n    }\n    var cp = new Ext.ColorPalette({\n        value: cValue,\n    });\n    cp.colors = colors;\n    cp.render(myColor.id);\n    cp.on('select', function(palette, color) {\n        selectColor = \"#\" + color;\n        setBackColor(color);\n        page.fireEvent('colorChanged', fontColorSelect, \"#\" + color);\n        // page.fireEvent('colorChanged', fontColorSelect, selColor)\n        myColor.hide();\n        if(isCpPick) {\n            myColorPicker.unload();\n            myColorPicker = null;\n            isCpPick = false;\n        }\n    });\n    isCp = true;\n}\n\nfunction isInArray(arr, value) {\n    for(var i = 0; i < arr.length; i++) {\n        if(value === arr[i]) {\n            return true;\n        }\n    }\n    return false;\n}\n\nfunction button_click(sender, e) {\n    if(myColor.hidden) {\n        myColor.show();\n        showColor(value);\n    } else {\n        myColor.hide();\n        if(isCpPick) {\n            myColorPicker.unload();\n            myColorPicker = null;\n            isCpPick = false;\n        }\n    }\n}\n// 设置图框背景颜色\nfunction setBackColor(selColor) {\n    if(selColor) {\n        colorShow = vmd.getElement(fontColorSelect.id);\n        if(selColor.indexOf('#') == -1) {\n            colorShow.applyStyles('backgroundColor:#' + selColor);\n        } else {\n            colorShow.applyStyles('backgroundColor:' + selColor);\n        }\n    }\n}\n\nfunction button1_click(sender, e) {\n    debugger\n    // if(isCpPick) {\n    //     return;\n    // }\n    myColor.hide()\n    isCpPick = true;\n    // 语言设置\n    dhtmlXColorPicker.prototype.i18n.zn = {\n        labelHue: \"H\",\n        labelSat: \"S\",\n        labelLum: \"L\",\n        labelRed: \"R\",\n        labelGreen: \"g\",\n        labelBlue: \"B\",\n        btnSelect: \"选择\",\n        btnCancel: \"取消\"\n    }\n    myColorPicker = new dhtmlXColorPicker({\n        // parent: document.body,\n        input: myAnchor.id,\n        color: value,\n        closeable: false\n    });\n    myColorPicker.loadUserLanguage('zn');\n    myColorPicker.show();\n    myColorPicker.setPosition(100, 100)\n    var myEvent = myColorPicker.attachEvent(\"onSelect\", function(color, node) {\n        debugger\n        selectColor = color;\n        page.fireEvent('colorChanged', fontColorSelect, color);\n        temp = vmd.getElement(myAnchor.id);\n        temp.applyStyles('backgroundColor:#fff');\n        setBackColor(color)\n        myColor.hide();\n        myColorPicker.unload();\n        myColorPicker = null;\n        isCpPick = false\n    });\n    var myEvent = myColorPicker.attachEvent(\"onCancel\", function(color, node) {\n        myColorPicker.unload();\n        myColorPicker = null;\n        isCpPick = false\n    });\n}\n\nfunction ColorSelect_afterrender(sender) {\n    colorShow = vmd.getElement(fontColorSelect.id);\n    colorShow.applyStyles('backgroundColor:#' + value);\n}\n\nfunction setColorValue(color) {\n    value = color\n    selectColor = color;\n}\n\nfunction fontColorSelect_beforerender(sender){\n\n}\n\nfunction fontColorSelect_click(sender,e){\n\n}","vmdcss":"","vmdprops":"\"\"","type":"ux","vmdinterface":"{\"components\":[{\"cid\":\"vmduxprops\",\"layoutConfig\":{},\"userConfig\":{}},{\"cid\":\"vmduxmethods\",\"id\":\"方法\",\"layoutConfig\":{},\"userConfig\":{},\"cn\":[{\"cid\":\"uxmethod\",\"id\":\"fontSetInfo\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"fontSetInfo\",\"zhname\":\"\",\"bindCmp\":\"\",\"bindValue\":\"\",\"isPublic\":\"on\",\"desc\":\"\",\"uxcid\":\"\",\"params\":\"info,cell\",\"code\":\"//直接填写方法内容\\nsetInfo(info,cell);\",\"returnType\":\"对象\"}}]},{\"cid\":\"vmduxevents\",\"id\":\"事件\",\"layoutConfig\":{},\"userConfig\":{},\"cn\":[{\"cid\":\"uxevent\",\"id\":\"colorChanged\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"colorChanged\",\"zhname\":\"\",\"bindCmp\":\"\",\"bindValue\":\"\",\"isPublic\":\"\",\"desc\":\"\",\"uxcid\":\"\",\"params\":\"color\",\"code\":\"\"}},{\"cid\":\"uxevent\",\"id\":\"underlineChecked\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"underlineChecked\",\"params\":\"check\",\"desc\":\"\"}}]}]}"}