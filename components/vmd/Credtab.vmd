{"vmdversion":"2.0.3.0920","vmdlayout":"{\"components\":[{\"cid\":\"uxpanel\",\"id\":\"Credtab\",\"layoutConfig\":{},\"userConfig\":{\"layout\":\"fit\",\"header\":false,\"width\":580,\"height\":200},\"cn\":[{\"cid\":\"tabpanel\",\"id\":\"MyTabs\",\"layoutConfig\":{},\"userConfig\":{\"height\":320,\"width\":580,\"afterrender\":\"MyTabs_afterrender\",\"activeTab\":0,\"x\":0,\"y\":10,\"tabchange\":\"MyTabs_tabchange\"},\"cn\":[{\"cid\":\"panel\",\"id\":\"panel\",\"layoutConfig\":{},\"userConfig\":{\"title\":\"待办信息\",\"html\":\"\",\"width\":580,\"autoScroll\":false,\"height\":320,\"autoHeight\":false,\"layout\":\"fit\"},\"cn\":[{\"cid\":\"grid\",\"id\":\"MyGrid1\",\"layoutConfig\":{},\"userConfig\":{\"height\":320,\"border\":false,\"header\":false,\"beforerender\":\"MyGrid1_beforerender\",\"x\":\"\",\"enableHdMenu\":true,\"disableHeaderClick\":true,\"disabled\":false,\"hideHeaders\":true,\"hidden\":false,\"style\":\"overflow-x: hidden;\",\"width\":580,\"ctCls\":\"\",\"cls\":\"\"},\"cn\":[{\"cid\":\"gridcolumn\",\"layoutConfig\":{},\"userConfig\":{\"header\":\"名称\",\"dataIndex\":\"name\",\"align\":\"left\",\"width\":418,\"css\":\"padding-left: 10px;\"},\"name\":\"name\"},{\"cid\":\"gridcolumn\",\"layoutConfig\":{},\"userConfig\":{\"header\":\"createddate\",\"dataIndex\":\"createddate\",\"align\":\"left\",\"width\":200},\"name\":\"createddate\"},{\"cid\":\"gridcolumn\",\"layoutConfig\":{},\"userConfig\":{\"header\":\"id\",\"dataIndex\":\"id\",\"align\":\"left\",\"width\":\"\",\"hidden\":true,\"resizable\":false},\"name\":\"id\"},{\"cid\":\"gridcolumn\",\"layoutConfig\":{},\"userConfig\":{\"header\":\"url\",\"dataIndex\":\"url\",\"align\":\"left\",\"width\":\"\",\"hidden\":true,\"resizable\":false},\"name\":\"url\"}]}]},{\"cid\":\"panel\",\"id\":\"panel1\",\"layoutConfig\":{},\"userConfig\":{\"title\":\"已办信息\",\"html\":\"\",\"border\":false,\"header\":true},\"cn\":[{\"cid\":\"grid\",\"id\":\"MyGrid\",\"layoutConfig\":{},\"userConfig\":{\"height\":288,\"enableHdMenu\":true,\"disableHeaderClick\":true,\"hideHeaders\":true,\"header\":false,\"border\":false,\"beforerender\":\"MyGrid_beforerender\"},\"cn\":[{\"cid\":\"gridcolumn\",\"layoutConfig\":{},\"userConfig\":{\"header\":\"名称\",\"dataIndex\":\"name\",\"align\":\"left\",\"width\":418,\"css\":\"padding-left: 10px;\"},\"name\":\"name\"},{\"cid\":\"gridcolumn\",\"layoutConfig\":{},\"userConfig\":{\"header\":\"时间\",\"dataIndex\":\"createddate\",\"align\":\"left\",\"width\":200,\"resizable\":false},\"name\":\"createddate\"},{\"cid\":\"gridcolumn\",\"layoutConfig\":{},\"userConfig\":{\"header\":\"id\",\"dataIndex\":\"id\",\"align\":\"center\",\"width\":500,\"resizable\":false,\"hidden\":true},\"name\":\"id\"},{\"cid\":\"gridcolumn\",\"layoutConfig\":{},\"userConfig\":{\"header\":\"url\",\"dataIndex\":\"url\",\"align\":\"center\",\"width\":500,\"resizable\":false,\"hidden\":true},\"name\":\"url\"}]}]}]}]}]}","vmdevents":"var page = this;\nvar ptServer = {\n    ip: '192.168.1.180:6602',\n    callcode: 'snqtscdd',\n    functionPower: '/platform/v1/userFunction', //功能点权限\n    notification: '/XXHTS/schedule/taskmanager/flowandapprove/notification', //待办已办\n    useRole: '/platform/v1/roleUser', //用户角色服务\n};\n\nvar ipServer = {\n    tz: 'http://192.168.1.180:8001'\n}\n\n//工作流模板节点\nvar objNode = {\n    workFlowNodeCode_workTemp: [\"gdmblcjd2\", \"gdmblcjd3\", \"gdmblcjd4\", \"gdmblcjd5\"], //工单模板\n    workFlowNodeCode_taskTemp: [\"rwmblcjd2\", \"rwmblcjd3\", \"rwmblcjd4\", \"rwmblcjd5\"], //任务模板\n    workFlowNodeCode_task: [\"rwlcjd2\", \"rwlcjd3\", \"rwlcjd4\", \"rwlcjd5\", \"rwlcjd6\"] //任务\n}\nvar now = new Date;\nvar dataList = [];\nvar dataListYb = [];\nvar todoData = [];\nvar todoDataYb = [];\nvar year = now.getFullYear();\nvar month = (now.getMonth() + 1).toString();\nvar day = (now.getDate()).toString();\nif(month.length == 1) {\n    month = \"0\" + month;\n}\nif(day.length == 1) {\n    day = \"0\" + day;\n}\nvar dateTime = year + \"-\" + month + \"-\" + day;\nvar params = {\n    ntfcttype: \"TODO\",\n    exdate: dateTime + ' 23:59:59',\n    efdate: dateTime + ' 00:00:00'\n};\nvar paramsyb = {\n    ntfcttype: \"DONE\",\n    exdate: dateTime + ' 23:59:59',\n    efdate: dateTime + ' 00:00:00'\n};\n// 创建数据集。\nvar store = new Ext.data.JsonStore({\n    proxy: new Ext.data.MemoryProxy(),\n    fields: [\"id\", \"xh\", \"name\", \"createddate\", \"dwmc\", \"url\"]\n})\n// 创建数据集。\nvar store2 = new Ext.data.JsonStore({\n    proxy: new Ext.data.MemoryProxy(),\n    fields: [\"id\", \"xh\", \"name\", \"createddate\", \"dwmc\", \"url\"]\n})\n\nfunction MyTabs_afterrender(sender) {\n    var org = getQueryString(\"gztlx\");\n    var el = MyTabs.el.dom.childNodes[0].childNodes[0].childNodes[0].childNodes[1].id;\n    if(org == 'bzz') {\n        vmd(\"#\" + el + \"\").after(\"<li class='x-tab-edge' style='width:400px;' id='eweu'><a class='x-tab-right' href='#'><span class='x-tab-strip-inner' style='margin:7px 0 0 0;'><span class='x-tab-strip-text' style='color:blue;float:right;' onclick='more();'>+更多</span></span></a></li>\");\n    } else {\n        vmd(\"#\" + el + \"\").after(\"<li class='x-tab-edge' style='width:80px;' id='eweu'><a class='x-tab-right' href='#'><span class='x-tab-strip-inner' style='margin:7px 0 0 0;'><span class='x-tab-strip-text' style='color:blue;' onclick='more();'>+更多</span></span></a></li>\");\n        vmd(\"#\" + el + \"\").after(\"<li class='x-tab-edge' style='width:170px;text-align: left;' id='ewew'><a  href='#'><span class='x-tab-strip-inner'  style='margin:7px 0 0 0;'><span class='x-tab-strip-text' style='color:blue;' onclick='week();'>本周</span></span></a></li>\");\n        vmd(\"#\" + el + \"\").after(\"<li class='x-tab-edge' style='width:20px;text-align: center;' id='ewee'><span class='x-tab-strip-inner'  style='margin:7px 0 0 0;'><span class='x-tab-strip-text' style='color:blue;'>/</span></span></li>\");\n        vmd(\"#\" + el + \"\").after(\"<li class='x-tab-edge' style='width:140px;text-align: right;' id='eweq'><a href='#'><span class='x-tab-strip-inner'  style='margin:7px 5px 0 0;'><span class='x-tab-strip-text' style='color:blue;' onclick='yue();'>本月</span></span></a></li>\");\n    }\n\n\n}\n//本月\nwindow.yue = function() {\n    var url = '/sngzt/release/12efebd0-5bd2-4d64-8582-fe88888e55ac/hwDoGEhIQq/hw658aa84d.html'\n    var newWindow; //定义一个窗口，有利于窗口间的通讯\n    if(!newWindow || newWindow.closed) {\n        var width = 900;\n        var height = 600;\n        var left = parseInt((screen.availWidth / 2) - (width / 2)); //屏幕居中\n        var top = parseInt((screen.availHeight / 2) - (height / 2));\n        var windowFeatures = \"width=\" + width + \",height=\" + height + \",status,resizable,left=\" + left + \",top=\" + top + \"screenX=\" + left + \",screenY=\" + top;\n        newWindow = window.open(url, \"subWind\", windowFeatures);\n    } else {\n        // window is already open, so bring it to the front\n        newWindow.focus();\n    }\n}\n//本周\nwindow.week = function() {\n    var url = '/sngzt/release/12efebd0-5bd2-4d64-8582-fe88888e55ac/hwDoGEhIQq/hwe0dc77fa.html'\n    var newWindow; //定义一个窗口，有利于窗口间的通讯\n    if(!newWindow || newWindow.closed) {\n        var width = 900;\n        var height = 600;\n        var left = parseInt((screen.availWidth / 2) - (width / 2)); //屏幕居中\n        var top = parseInt((screen.availHeight / 2) - (height / 2));\n        var windowFeatures = \"width=\" + width + \",height=\" + height + \",status,resizable,left=\" + left + \",top=\" + top + \"screenX=\" + left + \",screenY=\" + top;\n        newWindow = window.open(url, \"subWind\", windowFeatures);\n    } else {\n        // window is already open, so bring it to the front\n        newWindow.focus();\n    }\n}\n//更多\nwindow.more = function() {\n    todoData = [];\n    todoDataYb = [];\n    var params = {\n        ntfcttype: \"TODO\",\n        exdate: '',\n        efdate: ''\n    };\n    var paramsyb = {\n        ntfcttype: \"DONE\",\n        exdate: '',\n        efdate: ''\n    };\n    loadStoreYb(paramsyb);\n    loadStoreDb(params);\n}\n//加载已办数据\nwindow.loadStoreYb = function(paramsyb) {\n    dataListYb = [];\n    var hwDao = new HwDao(ptServer.ip, ptServer.callcode); //地址:端口和授权码(服务管理员分配)\n    var url = ptServer.notification;\n    hwDao.get(url, {}, paramsyb, function(res) {\n        if(res.isSucceed) {\n            if(res.data && res.data[0].datas.length > 0) {\n                var data = res.data[0].datas;\n                dataListYb = data;\n                setTabItemYb(); //加载已办数据\n            }\n        } else {\n            alert(res.errMsg);\n        }\n    }, function(res) {\n        alert(res);\n    });\n}\n\nfunction MyGrid1_beforerender(sender) {\n    this.store = store;\n    loadStoreDb(params);\n}\n//加载待办数据\nwindow.loadStoreDb = function(params) {\n    dataList = [];\n    var hwDao = new HwDao(ptServer.ip, ptServer.callcode); //地址:端口和授权码(服务管理员分配)\n    var url = ptServer.notification;\n    hwDao.get(url, {}, params, function(res) {\n        if(res.isSucceed) {\n            if(res.data && res.data[0].datas.length > 0) {\n                var data = res.data[0].datas;\n                dataList = data;\n            }\n            setTabItem(); //加载数据\n        } else {\n            alert(res.errMsg);\n        }\n    }, function(res) {\n        alert(res);\n    });\n}\n//数据组装\nwindow.setTabItem = function() {\n    var i = 0;\n    getRoleInfo('gzttodo', function(res) {\n        if(res == true) {\n            var tabs = [\"任务待派发\", \"任务待审核\", \"异常工作\"];\n            for(i = 0; i < 3; i++) {\n                var tdname = \"<span class=tabName>\" + tabs[i] + \"</span>\";\n                switch (i) {\n                    case 0:\n                        setDataCount(tdname, objNode.workFlowNodeCode_task[0], '');\n                        break;\n                    case 1:\n                        setDataCount(tdname, objNode.workFlowNodeCode_task[2], '');\n                        break;\n                    case 2:\n                        setDataCount(tdname, objNode.workFlowNodeCode_task[4], '');\n                        break;\n                    default:\n                        break;\n                }\n            }\n            store.loadData(todoData);\n        }\n    })\n    getRoleInfo('rwdcl', function(res) {\n        if(res == true) {\n            var tdname = \"<span class=tabName>任务待处理</span>\";\n            setDataCount(tdname, objNode.workFlowNodeCode_task[3], '');\n            store.loadData(todoData);\n        }\n    })\n    getRoleInfo('mbsp', function(res) {\n        if(res == true) {\n            var tabs = [\"工单模板待审批\", \"任务模板待审批\"];\n            for(i = 0; i < 2; i++) {\n                var tdname = \"<span class=tabName>\" + tabs[i] + \"</span>\";\n                switch (i) {\n                    case 0:\n                        setDataCount(tdname, objNode.workFlowNodeCode_workTemp[0], objNode.workFlowNodeCode_workTemp[1]);\n                        break;\n                    case 1:\n                        setDataCount(tdname, objNode.workFlowNodeCode_taskTemp[0], objNode.workFlowNodeCode_taskTemp[1]);\n                        break;\n                    default:\n                        break;\n                }\n            }\n            store.loadData(todoData);\n        }\n    })\n    getRoleInfo('mbgl', function(res) {\n        if(res == true) {\n            var tabs = [\"模板待确认\", \"重新调整\"];\n            for(i = 0; i < 2; i++) {\n                var tdname = \"<span class=tabName>\" + tabs[i] + \"</span>\";\n                switch (i) {\n                    case 0:\n                        setDataCount(tdname, objNode.workFlowNodeCode_workTemp[2], objNode.workFlowNodeCode_taskTemp[2]);\n                        break;\n                    case 1:\n                        setDataCount(tdname, objNode.workFlowNodeCode_workTemp[3], objNode.workFlowNodeCode_taskTemp[3]);\n                        break;\n                    default:\n                        break;\n                }\n            }\n            store.loadData(todoData);\n        }\n    })\n}\n//获取权限信息\nfunction getRoleInfo(type, callback) {\n    var flag = false;\n    var moduleId = \"\"; //模块id\n    var moduleUrl = \"\"; //模块url\n\n\n    //参数顺序  1、moduleId  2、moduleUrl 3、g_moduleGuid  4、相对路径\n    if(moduleId.trim().length == 0) {\n        if(moduleUrl.length == 0) {\n            moduleId = getQueryString(\"g_moduleGuid\") || \"\";\n            if(moduleId.trim().length == 0) {\n                moduleUrl = '';//window.location.pathname;\n            }\n        }\n    }\n    var hwDao = new HwDao(ptServer.ip, ptServer.callcode); //地址:端口和授权码(服务管理员分配)\n    var paras = {\n        moduleid: moduleId,\n        moduleurl: decodeURI(moduleUrl),\n        functionname: type\n    };\n    var url = ptServer.functionPower;\n    hwDao.get(url, {}, paras, function(res) {\n        if(res.isSucceed) {\n            if(res.data && res.data[0].datas.length > 0) {\n                flag = true;\n\n            }\n        } else {\n            alert(res.errMsg);\n        }\n        if(typeof(callback) == 'function') {\n            callback(flag);\n        }\n    }, function(res) {\n        alert(res);\n        if(typeof(callback) == 'function') {\n            callback(false);\n        }\n    });\n}\n// 获取各类数据记录数\nfunction setDataCount(name, node1, node2) {\n    var data = dataList;\n    var dataCount = 0;\n    var date = '';\n    for(var i = 0; i < data.length; i++) {\n        if(data[i].flownode == node1 || data[i].flownode == node2) {\n            dataCount++;\n            date = data[i].createddate\n        }\n    }\n    if(dataCount != 0) {\n        var ob = {\n            name: \"<a class='info' href='#' onclick='ymtz(this);'>\" + name + \"(<span style='color:red;'>\" + dataCount + \"</span></a>)\",\n            createddate: date\n        }\n        todoData.push(ob);\n    }\n}\n//页面跳转\nwindow.ymtz = function(id) {\n    var data = dataList;\n    var dataModel = [];\n    var urlModel=[];\n    var tr = $(id).closest('tr'),\n        id = tr.find('td')[0].innerText;\n    var url='';\n    for(var i = 0; i < data.length; i++) {\n        switch (id.split(\"(\")[0]) {\n            case \"任务待派发\": //任务派发\n                if(data[i].flownode == objNode.workFlowNodeCode_task[0]) {\n                    urlModel.push({\n                        name: \"<a href='#' onclick='rowLink(this);'>\" + data[i].notfctct + \"</a>\",\n                        createddate: data[i].serveddate,\n                        url: ipServer.tz + \"/pages/task/taskDispatch/taskDispatch.html?r=\" + Math.random()\n                    });\n                }\n                break;\n            case \"任务待审核\": //任务审核\n                if(data[i].flownode == objNode.workFlowNodeCode_task[2]) {\n                    urlModel.push({\n                        name: \"<a href='#' onclick='rowLink(this);'>\" + data[i].notfctct + \"</a>\",\n                        createddate: data[i].serveddate,\n                        url: ipServer.tz + \"/pages/task/compTaskApprove.html?r=\" + Math.random()\n                    });\n                }\n                break;\n            case \"异常工作\": //异常任务\n                if(data[i].flownode == objNode.workFlowNodeCode_task[4]) {\n                    urlModel.push({\n                        name: \"<a href='#' onclick='rowLink(this);'>\" + data[i].notfctct + \"</a>\",\n                        createddate: data[i].serveddate,\n                        url: ipServer.tz + \"/pages/task/exceptiontaskchange/exceptiontaskchange.html?r=\" + Math.random()\n                    });\n                }\n                break;\n            case \"任务待处理\": //任务处理\n                if(data[i].flownode == objNode.workFlowNodeCode_task[3]) {\n                    urlModel.push({\n                        name: data[i].notfctct,\n                        createddate: data[i].serveddate,\n                        url: ipServer.tz + \"/pages/task/taskOpMonitoring/taskOpMonitoring.html?r=\" + Math.random()\n                    });\n                }\n                break;\n            case \"工单模板待审批\": //工单模板审批\n                if(data[i].flownode == objNode.workFlowNodeCode_workTemp[0]) { //业务部门领导审批\n                    var jumpUrl = ipServer.tz + \"/pages/workListTemp/workOrderApplyApproveBizDepartment.html\";\n\n                    /*if(data[i].appltype == objNode.busApplyTypeArr[1]) { //0:工单模板创建   1:工单模板变更 2:任务模板创建  3:任务模板变更  4:任务\n                        jumpUrl = ipServer.tz + \"/pages/workListTemp/workOrderApplyChangeApproveBizDepartment.html\";\n                    }*/\n                    dataModel = addTodoInfo(dataModel, data[i], jumpUrl);\n                } else if(data[i].flownode == objNode.workFlowNodeCode_workTemp[1]) { //生产指挥中心领导审批\n                    var jumpUrl = ipServer.tz + \"/pages/workListTemp/workOrderApplyApproveControlCenter.html\";\n\n                    /*if(data[i].appltype == objNode.busApplyTypeArr[1]) { //0:工单模板创建   1:工单模板变更 2:任务模板创建  3:任务模板变更  4:任务\n                        jumpUrl = ipServer.tz + \"/pages/workListTemp/workOrderApplyChangeApproveControlCenter.html\";\n                    }*/\n                    dataModel = addTodoInfo(dataModel, data[i], jumpUrl);\n                }\n                break;\n            case \"任务模板待审批\": //任务模板审批\n                if(data[i].flownode == objNode.workFlowNodeCode_taskTemp[0]) { //业务部门审批\n                    var jumpUrl = ipServer.tz + \"/pages/taskTemp/taskTemplateApp/busDeparApproval.html\";\n\n                    /*if(data[i].appltype == objNode.busApplyTypeArr[3]) { //0:工单模板创建   1:工单模板变更 2:任务模板创建  3:任务模板变更  4:任务\n                        jumpUrl = ipServer.tz + \"/pages/taskTemp/taskTempModify/taskTempModifyYwbmSp.html\";\n                    }*/\n                    dataModel = addTodoInfo(dataModel, data[i], jumpUrl);\n                }\n                if(data[i].flownode == objNode.workFlowNodeCode_taskTemp[1]) { //生产指挥中心领导审批\n                    var jumpUrl = ipServer.tz + \"/pages/taskTemp/taskTemplateApp/approvalOfcenter.html\";\n\n                    /*if(data[i].appltype == objNode.busApplyTypeArr[3]) { //0:工单模板创建   1:工单模板变更 2:任务模板创建  3:任务模板变更  4:任务\n                        jumpUrl = ipServer.tz + \"/pages/taskTemp/taskTempModify/taskTempModifySczhSp.html\";\n                    }*/\n                    dataModel = addTodoInfo(dataModel, data[i], jumpUrl);\n                }\n                break;\n            case \"模板待确认\": //模板确认\n                if(data[i].flownode == objNode.workFlowNodeCode_workTemp[2]) { //工单模板确认\n                    dataModel.push({\n                        name: data[i].notfctct,\n                        createddate: data[i].serveddate,\n                        url: ipServer.tz + \"tempConfirm.html?flag=gdmb&applyid=\" + data[i].applid + \"&taskid=\" + data[i].flowtaskid + \"&r=\" + Math.random()\n                    });\n                }\n                if(data[i].flownode == objNode.workFlowNodeCode_taskTemp[2]) { //任务模板确认\n                    var jumpUrl = ipServer.tz + \"/pages/taskTemp/preview.html\";\n\n                    dataModel = addTodoInfo(dataModel, data[i], jumpUrl);\n                }\n                break;\n            case \"重新调整\": //重新提交\n                if(data[i].flownode == objNode.workFlowNodeCode_workTemp[3]) { //工单模板重新提交\n                    var jumpUrl = ipServer.tz + \"/pages/workListTemp/workOrderApply.html\";\n\n                    /* if(data[i].appltype == objNode.busApplyTypeArr[1]) { //0:工单模板创建   1:工单模板变更 2:任务模板创建  3:任务模板变更  4:任务\n                         jumpUrl = ipServer.tz + \"/pages/workListTemp/workOrderApplyChange.html\";\n                     }*/\n                    dataModel = addTodoInfo(dataModel, data[i], jumpUrl);\n                }\n                if(data[i].flownode == objNode.workFlowNodeCode_taskTemp[3]) { //任务模板重新提交\n                    var jumpUrl = ipServer.tz + \"/pages/taskTemp/taskTemplateApp/taskTemplateApp.html\";\n\n                    /*if(data[i].appltype == objNode.busApplyTypeArr[3]) { //0:工单模板创建   1:工单模板变更 2:任务模板创建  3:任务模板变更  4:任务\n                        jumpUrl = ipServer.tz + \"/pages/taskTemp/taskTempModify/taskTempModifyApp.html\";\n                    }*/\n                    dataModel = addTodoInfo(dataModel, data[i], jumpUrl);\n                }\n                break;\n            default:\n                break;\n        }\n    }\n    store.loadData(dataModel);\n}\n\nwindow.rowLink = function(id) {\n    var tr = $(id).closest('tr'),\n        url = tr.find('td')[3].innerText;\n    window.open(url, '_blank', '')\n}\n\nfunction MyGrid_beforerender(sender) {\n    this.store = store2;\n    loadStoreYb(paramsyb);\n}\n\n//页面参数获取方法\nfunction getQueryString(name) {\n    var reg = new RegExp(\"(^|&)\" + name + \"=([^&]*)(&|$)\", \"i\");\n    var r = window.location.search.substr(1).match(reg); //获取url中\"?\"符后的字符串并正则匹配\n    var context = \"\";\n    if(r != null)\n        context = r[2];\n    reg = null;\n    r = null;\n    return context == null || context == \"\" || context == \"undefined\" ? \"\" : context;\n}\n\nfunction addTodoInfo(todoDataModel, todoInfo, jumpUrl) {\n    todoDataModel.push({\n        name: \"<a href='#' onclick='rowLink(this);'>\" + todoInfo.notfctct + \"</a>\",\n        createddate: todoInfo.serveddate,\n        url: jumpUrl + \"?applyid=\" + todoInfo.applid + \"&taskid=\" + todoInfo.flowtaskid +\n            \"&nodeid=\" + todoInfo.flownode + \"&lcslh=\" + todoInfo.flowinstanceid + \"&r=\" + Math.random()\n    });\n    return todoDataModel;\n}\n\nfunction setTabItemYb() {\n    getRoleInfo('ybrw', function(res) {\n        if(res == true) {\n            var tdname = \"<span class=tabName>任务</span>\";\n            setDataCountYb(tdname, objNode.workFlowNodeCode_task[0], objNode.workFlowNodeCode_task[2], objNode.workFlowNodeCode_task[3], objNode.workFlowNodeCode_task[4]);\n            store2.loadData(todoDataYb);\n        }\n    });\n    getRoleInfo('mbysh', function(res) {\n        if(res == true) {\n            var tabs = [\"工单模板\", \"任务模板\"];\n            for(var i = 0; i < 2; i++) {\n                var tdname = \"<span class=tabName>\" + tabs[i] + \"</span>\";\n                switch (i) {\n                    case 0:\n                        setDataCountYb(tdname, objNode.workFlowNodeCode_workTemp[0], objNode.workFlowNodeCode_workTemp[1], objNode.workFlowNodeCode_workTemp[2], objNode.workFlowNodeCode_workTemp[3]);\n                        break;\n                    case 1:\n                        setDataCountYb(tdname, objNode.workFlowNodeCode_taskTemp[0], objNode.workFlowNodeCode_taskTemp[1], objNode.workFlowNodeCode_taskTemp[2], objNode.workFlowNodeCode_taskTemp[3]);\n                        break;\n                    default:\n                        break;\n                }\n            }\n            store2.loadData(todoDataYb);\n        }\n    })\n}\n\n// 获取各类数据记录数\nfunction setDataCountYb(name, node1, node2, node3, node4) {\n    var data = dataListYb;\n    debugger\n    var dataCount = 0;\n    for(var i = 0; i < data.length; i++) {\n        if(data[i].flownode == node1 || data[i].flownode == node2 || data[i].flownode == node3 || data[i].flownode == node4) {\n            dataCount++;\n            date = data[i].createddate\n        }\n    }\n    if(dataCount != 0) {\n        var ob = {\n            name: \"<a class='info' href='#' onclick='ymtzYb(this);'>\" + name + \"(<span style='color:red;'>\" + dataCount + \"</span></a>)\",\n            createddate: date\n        }\n        todoDataYb.push(ob);\n    }\n}\n\nwindow.ymtzYb = function(objYb) {\n    var data = dataListYb;\n    var dataModel = [];\n    var tr = $(objYb).closest('tr'),\n        td = tr.find('td')[0].innerText;\n    for(var i = 0; i < data.length; i++) {\n        switch (td.split(\"(\")[0]) {\n            case \"任务\":\n                if(data[i].flownode == objNode.workFlowNodeCode_task[0] ||\n                    data[i].flownode == objNode.workFlowNodeCode_task[2] ||\n                    data[i].flownode == objNode.workFlowNodeCode_task[3] ||\n                    data[i].flownode == objNode.workFlowNodeCode_task[4]) {\n                    dataModel.push({\n                        name: \"<a href='#' onclick='rowLink(this);'>\" + data[i].notfctct + \"</a>\",\n                        createddate: data[i].serveddate,\n                        url: ipServer.tz + \"/pages/task/orderView.html?flag=view&applyid=\" + data[i].applid + \"&r=\" + Math.random()\n                    });\n                }\n                break;\n            case \"工单模板\":\n                if(data[i].flownode == objNode.workFlowNodeCode_workTemp[0] ||\n                    data[i].flownode == objNode.workFlowNodeCode_workTemp[1] ||\n                    data[i].flownode == objNode.workFlowNodeCode_workTemp[2] ||\n                    data[i].flownode == objNode.workFlowNodeCode_workTemp[3]) {\n                    dataModel.push({\n                        name: \"<a href='#' onclick='rowLink(this);'>\" + data[i].notfctct + \"</a>\",\n                        createddate: data[i].serveddate,\n                        url: ipServer.tz + \"/pages/workListTemp/workOrderView.html?applyid=\" + data[i].applid +\n                            \"&lcslh=\" + data[i].flowinstanceid + \"&r=\" + Math.random()\n                    });\n                }\n                break;\n            case \"任务模板\":\n                if(data[i].flownode == objNode.workFlowNodeCode_taskTemp[0] ||\n                    data[i].flownode == objNode.workFlowNodeCode_taskTemp[1] ||\n                    data[i].flownode == objNode.workFlowNodeCode_taskTemp[2] ||\n                    data[i].flownode == objNode.workFlowNodeCode_taskTemp[3]) {\n                    dataModel.push({\n                        name: \"<a href='#' onclick='rowLink(this);'>\" + data[i].notfctct + \"</a>\",\n                        time: data[i].serveddate,\n                        url: ipServer.tz + \"/pages/taskTemp/taskTemplateAuditView.html?applyid=\" + data[i].applid +\n                            \"&lcslh=\" + data[i].flowinstanceid + \"&r=\" + Math.random()\n                    });\n                }\n                break;\n            default:\n                break;\n        }\n    }\n    store2.loadData(dataModel);\n}\nfunction MyTabs_tabchange(sender, tab) {\n   /* loadStoreYb(paramsyb);\n    loadStoreDb(params);*/\n}","vmdcss":".info a {\r\n   text-decoration:none; \r\n}\r\n.info a:link {\r\n    color: blue; text-decoration:none;\r\n    \r\n}\r\n.info a:active:{\r\n    color: red;\r\n    } \r\n.info a:visited {\r\n    color:purple;text-decoration:none;\r\n    \r\n} \r\n.info a:hover {\r\n    color: red; text-decoration:underline;\r\n    \r\n} \r\n.x-grid3-scroller {\r\noverflow-x: hidden\r\n}","vmdprops":"\"\"","type":"ux","vmdinterface":"{\"components\":[{\"cid\":\"vmduxprops\",\"layoutConfig\":{},\"userConfig\":{},\"cn\":[{\"cid\":\"uxprop\",\"id\":\"ip\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"ip\",\"desc\":\"数据服务\",\"zhname\":\"数据服务\",\"isPublic\":\"on\",\"radio_y2ZN\":\"string\",\"bindCmp\":\"MyTabs\",\"bindValue\":\"ip\",\"uxcid\":\"tabpanel\",\"cmptype\":\"string\",\"cmpsettings\":\"{\\\"isMulti\\\":false,\\\"data\\\":\\\"\\\"}\"}},{\"cid\":\"uxprop\",\"id\":\"callCode\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"callCode\",\"desc\":\"授权码\",\"zhname\":\"授权码\",\"isPublic\":\"on\",\"radio_y2ZN\":\"string\",\"bindCmp\":\"MyTabs\",\"bindValue\":\"callCode\",\"uxcid\":\"tabpanel\",\"cmptype\":\"string\",\"cmpsettings\":\"{\\\"isMulti\\\":false,\\\"data\\\":\\\"\\\"}\"}},{\"cid\":\"uxprop\",\"id\":\"url\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"url\",\"desc\":\"数据服务地址\",\"zhname\":\"数据服务地址\",\"isPublic\":\"on\",\"radio_y2ZN\":\"string\",\"bindCmp\":\"MyTabs\",\"bindValue\":\"url\",\"uxcid\":\"tabpanel\",\"cmptype\":\"string\",\"cmpsettings\":\"{\\\"isMulti\\\":false,\\\"data\\\":\\\"\\\"}\"}}]},{\"cid\":\"vmduxmethods\",\"id\":\"方法\",\"layoutConfig\":{},\"userConfig\":{}},{\"cid\":\"vmduxevents\",\"id\":\"事件\",\"layoutConfig\":{},\"userConfig\":{}}]}"}