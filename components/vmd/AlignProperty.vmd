{"vmdversion":"2.0.3.1108","vmdlayout":"{\"components\":[{\"cid\":\"uxpanel\",\"id\":\"AlignProperty\",\"layoutConfig\":{},\"userConfig\":{\"layout\":\"absolute\",\"header\":false,\"width\":290,\"height\":621,\"afterrender\":\"AlignProperty_afterrender\"},\"cn\":[{\"cid\":\"label\",\"id\":\"label3\",\"layoutConfig\":{},\"userConfig\":{\"x\":10,\"y\":10,\"text\":\"文本控制\"}},{\"cid\":\"vmd.ux.ButtonGroup\",\"id\":\"textControl\",\"layoutConfig\":{},\"userConfig\":{\"x\":5,\"y\":30,\"count\":\"3\",\"text\":\"自动换行,宽度自适应,缩小字体填充\",\"width\":280,\"height\":30,\"selectIndex\":\"0\",\"id\":\"textControl\",\"click\":\"textControl_click\"}},{\"cid\":\"vmd.ux.ButtonGroup\",\"id\":\"escapeLabel\",\"layoutConfig\":{},\"userConfig\":{\"x\":5,\"y\":65,\"count\":\"1\",\"text\":\"转义标签\",\"selectIndex\":\"0\",\"height\":30,\"id\":\"escapeLabel\",\"click\":\"escapeLabel_click\"}},{\"cid\":\"label\",\"id\":\"label4\",\"layoutConfig\":{},\"userConfig\":{\"x\":10,\"y\":105,\"text\":\"文本方向\"}},{\"cid\":\"label\",\"id\":\"label5\",\"layoutConfig\":{},\"userConfig\":{\"x\":20,\"y\":130,\"text\":\"方向：\",\"height\":20}},{\"cid\":\"vmd.ux.ButtonGroup\",\"id\":\"textDirection\",\"layoutConfig\":{},\"userConfig\":{\"x\":60,\"y\":125,\"width\":170,\"count\":\"2\",\"text\":\"水平,垂直\",\"height\":30,\"id\":\"textDirection\",\"click\":\"textDirection_click\"}},{\"cid\":\"label\",\"id\":\"label1\",\"layoutConfig\":{},\"userConfig\":{\"x\":10,\"y\":165,\"text\":\"旋转（度）：\"}},{\"cid\":\"numberfield\",\"id\":\"rotation\",\"layoutConfig\":{},\"userConfig\":{\"x\":85,\"y\":160,\"grow\":false,\"msgTarget\":\"qtip\",\"readOnly\":false,\"allowDecimals\":true,\"blankText\":\"\",\"emptyText\":\"0\",\"width\":100,\"id\":\"rotation\"}},{\"cid\":\"checkbox\",\"id\":\"singleRotation\",\"layoutConfig\":{},\"userConfig\":{\"x\":195,\"y\":160,\"boxLabel\":\"单字旋转\",\"id\":\"singleRotation\"}},{\"cid\":\"label\",\"id\":\"label6\",\"layoutConfig\":{},\"userConfig\":{\"x\":10,\"y\":190,\"text\":\"内部边距\"}},{\"cid\":\"label\",\"id\":\"label7\",\"layoutConfig\":{},\"userConfig\":{\"x\":35,\"y\":220,\"text\":\"上：\"}},{\"cid\":\"numberfield\",\"id\":\"topPadding\",\"layoutConfig\":{},\"userConfig\":{\"x\":60,\"y\":220,\"width\":60,\"id\":\"topPadding\",\"emptyText\":\"2\"}},{\"cid\":\"label\",\"id\":\"label8\",\"layoutConfig\":{},\"userConfig\":{\"x\":145,\"y\":220,\"text\":\"下：\"}},{\"cid\":\"numberfield\",\"id\":\"bottomPadding\",\"layoutConfig\":{},\"userConfig\":{\"x\":170,\"y\":220,\"width\":60,\"id\":\"bottomPadding\",\"emptyText\":\"2\"}},{\"cid\":\"label\",\"id\":\"label9\",\"layoutConfig\":{},\"userConfig\":{\"x\":35,\"y\":250,\"text\":\"左：\"}},{\"cid\":\"numberfield\",\"id\":\"leftPadding\",\"layoutConfig\":{},\"userConfig\":{\"x\":60,\"y\":250,\"width\":60,\"id\":\"leftPadding\",\"emptyText\":\"2\"}},{\"cid\":\"label\",\"id\":\"label10\",\"layoutConfig\":{},\"userConfig\":{\"x\":145,\"y\":250,\"text\":\"右：\"}},{\"cid\":\"numberfield\",\"id\":\"rightPadding\",\"layoutConfig\":{},\"userConfig\":{\"x\":170,\"y\":250,\"width\":60,\"id\":\"rightPadding\",\"emptyText\":\"2\"}},{\"cid\":\"label\",\"id\":\"label11\",\"layoutConfig\":{},\"userConfig\":{\"x\":10,\"y\":280,\"text\":\"行间距\"}},{\"cid\":\"label\",\"id\":\"label12\",\"layoutConfig\":{},\"userConfig\":{\"x\":35,\"y\":310,\"text\":\"行间距：\"}},{\"cid\":\"numberfield\",\"id\":\"verticalSpace\",\"layoutConfig\":{},\"userConfig\":{\"x\":85,\"y\":305,\"id\":\"verticalSpace\",\"emptyText\":\"1\",\"width\":100}}]}]}","vmdevents":"var page = this;\n\nfunction AlignGroup_click(sender, selectIndex) {\n    //alert(selectIndex.VAlign.value+\";\"+selectIndex.HAlign.value)\n    // \n    setCellInfo(AlignGroup, selectIndex);\n    // var cell = page.CellInfo && page.CellInfo.grid.editor;\n    // var cell = page.CellInfo;\n    // if(cell) {\n    //     if(cell.cell) {\n    //         cell.cell.style.textAlign = selectIndex.HAlign.value;\n    //         cell.cell.style.verticalAlign = selectIndex.VAlign.value;\n    //     }\n    // }\n    if(page.CellInfo && page.CellInfo.type == \"TD\") {\n        var cell = page.CellInfo.cells;\n        if(cell) {\n            if(cell.cell) {\n                cell.cell.style.textAlign = selectIndex.HAlign.value;\n                cell.cell.style.verticalAlign = selectIndex.VAlign.value;\n            }\n        }\n    } else if(page.CellInfo && page.CellInfo.type == \"DIV\") {\n        var cells = page.CellInfo.cells;\n        if(cells && cells.length > 0) {\n            for(var i = 0; i < cells.length; i++) {\n                var cell = cells[i];\n                if(cell) {\n                    if(cell.cell) {\n                        cell.cell.style.textAlign = selectIndex.HAlign.value;\n                        cell.cell.style.verticalAlign = selectIndex.VAlign.value;\n                    }\n                }\n            }\n        }\n    } else {\n        if(page.CellInfo && page.CellInfo.cell) {\n            page.CellInfo.cell.style.textAlign = selectIndex.HAlign.value;\n            page.CellInfo.cell.style.verticalAlign = selectIndex.VAlign.value;\n        }\n    }\n}\n\nfunction button_click(sender, e) {\n    var obj = {\n        VAlign: {\n            value: \"bottom\"\n        },\n        HAlign: {\n            value: \"center\"\n        }\n    }\n\n\n    AlignGroup.setValue(obj);\n\n    var o = AlignGroup.getValue();\n    alert(o.VAlign.value + \";\" + o.HAlign.value)\n}\n\n\nfunction setCellInfo(sender, value) {\n    // var cell = page.CellInfo && page.CellInfo.grid.editor;\n    // var cell = page.CellInfo\n    // if(cell) {\n    //     if(cell.cell && cell.cell.cellAttributeInfo) {\n    //         cell.cell.cellAttributeInfo.setCellInfos(sender.initialConfig.id, value);\n    //     }\n    // }\n    if(page.CellInfo && page.CellInfo.type == \"TD\") {\n        var cell = page.CellInfo.cells;\n        if(cell) {\n            if(cell.cell && cell.cell.cellAttributeInfo) {\n                cell.cell.cellAttributeInfo.setCellInfos(sender.initialConfig.id, value);\n            }\n        }\n    } else if(page.CellInfo && page.CellInfo.type == \"DIV\") {\n        var cells = page.CellInfo.cells;\n        if(cells && cells.length > 0) {\n            for(var i = 0; i < cells.length; i++) {\n                var cell = cells[i];\n                if(cell) {\n                    if(cell.cell && cell.cell.cellAttributeInfo) {\n                        cell.cell.cellAttributeInfo.setCellInfos(sender.initialConfig.id, value);\n                    }\n                }\n            }\n        }\n    } else {\n        if(page.CellInfo && page.CellInfo.cell) {\n            if(page.CellInfo.cell.cellAttributeInfo) {\n                page.CellInfo.cell.cellAttributeInfo.setCellInfos(sender.initialConfig.id, value);\n            }\n        }\n    }\n}\n\nfunction setInfo(info, selectCell) {\n    //\n    page.CellInfo = selectCell;\n    if(info) {\n        //  \n        AlignGroup.setValue(info.align.value);\n        textControl.setSelectIndex(info.textControl.value);\n        escapeLabel.setSelectIndex(info.escapeLabel.value);\n        textDirection.setSelectIndex(info.textDirection.value);\n        rotation.setValue(info.rotation.value);\n        singleRotation.setValue(info.singleRotation.value);\n        cellMerge.setSelectIndex(info.cellMerge.value);\n        topPadding.setValue(info.topPadding.value);\n        bottomPadding.setValue(info.bottomPadding.value);\n        leftPadding.setValue(info.leftPadding.value);\n        rightPadding.setValue(info.rightPadding.value);\n        verticalSpace.setValue(info.verticalSpace.value);\n    }\n}\n\n\n\nfunction AlignProperty_afterrender(sender) {\n\n}\n\nfunction textControl_click(sender, selectedIndex) {\n    // \n    setCellInfo(textControl, selectedIndex);\n}\n\nfunction escapeLabel_click(sender, selectedIndex) {\n    setCellInfo(escapeLabel, selectedIndex);\n}\n\nfunction textDirection_click(sender, selectedIndex) {\n    setCellInfo(textDirection, selectedIndex);\n}\n\nfunction cellMerge_click(sender, selectedIndex) {\n    // setCellInfo(cellMerge, selectedIndex);\n    var grid = page.CellInfo.grid;\n    if(page.CellInfo && page.CellInfo.type == \"DIV\") {\n        var cells = page.CellInfo.cells;\n        cells = [];\n        var selblock = grid.getSelectedBlock();\n        //grid.setRowspan(grid.getRowId(selblock.LeftTopRow), selblock.LeftTopCol, 1)\n        for(var r = selblock.LeftTopRow; r <= selblock.RightBottomRow; r++) {\n            for(var rr = selblock.LeftTopCol; rr <= selblock.RightBottomCol; rr++) {\n                var cl = grid.cells2(r, rr);\n                cells.push(cl);\n            }\n        }\n\n\n        var rowspan = page.CellInfo.rowspan || 1;\n        var colspan = page.CellInfo.colspan || 1;\n        var index = 1;\n        \n        if(cells && cells.length > 0) {\n            //先将单元格拆分\n\n            for(var i = 0; i < cells.length; i++) {\n                var cell = cells[i];\n                if(cell.cell.parentNode && cell.cell.parentNode.idd) {\n                    if(cell.cell.rowSpan > 1 && cell.cell.colSpan > 1) {\n                        grid.setColRowspan(cell.cell.parentNode.idd, cell.cell._cellIndex, 1, cell.cell.rowSpan)\n                    } else if(cell.cell.rowSpan > 1) {\n                        grid.setRowspan(cell.cell.parentNode.idd, cell.cell._cellIndex, 1)\n\n                    } else if(cell.cell.colSpan > 1) {\n                        grid.setColspan(cell.cell.parentNode.idd, cell.cell._cellIndex, 1)\n                    }\n                }\n            }\n            if(selectedIndex == 4) {\n                // allrowfirstcells = [];\n                // for(var r = selblock.LeftTopRow; r <= selblock.RightBottomRow; r++) {\n                //     for(var rr = selblock.LeftTopCol; rr <= selblock.RightBottomCol; rr++) {\n                //         var cl = grid.cells2(r, rr);\n                //         allrowfirstcells.push(cl);\n                //     }\n                //     \n                // }\n                // for(var jj = 0; jj < allrowfirstcells.length; jj++) {\n                //     grid.setColspan(allrowfirstcells[jj].cell.parentNode.idd, allrowfirstcells[jj].cell._cellIndex, 1)\n                //     grid.setRowspan(allrowfirstcells[jj].cell.parentNode.idd, allrowfirstcells[jj].cell._cellIndex, 1)\n                // }\n                return;\n            }\n            var rowfirstcells = [];\n            if(rowspan > 1 && colspan > 1) {\n                var selblock = grid.getSelectedBlock();\n                for(var r = selblock.LeftTopRow; r <= selblock.RightBottomRow; r++) {\n                    var cl = grid.cells2(r, selblock.LeftTopCol);\n                    rowfirstcells.push(cl);\n                    \n                }\n            } else\n                rowfirstcells.push(cells[0])\n\n            for(var jj = 0; jj < rowfirstcells.length; jj++)\n                grid.setColspan(rowfirstcells[jj].cell.parentNode.idd, rowfirstcells[jj].cell._cellIndex, colspan)\n\n            if(selectedIndex != 2)\n                grid.setRowspan(rowfirstcells[0].cell.parentNode.idd, rowfirstcells[0].cell._cellIndex, rowspan)\n        }\n\n        // for(var i = 0; i < cells.length; i++) {\n        //     var cell = cells[i];\n        //     if(i == 0) {\n        //         index = cell.cell.cellIndex;\n        //     }\n        //     //colspan+= cell.cell.colSpan;\n        //     if(selectedIndex == 2) {\n        //         if(cell.cell.cellIndex == index) {\n        //             setMergeInfo(i, rowspan, colspan, grid, cell, selectedIndex, sender);\n        //             //index = cell.cell.cellIndex + colspan;\n        //         }\n        //     } else {\n        //         setMergeInfo(i, rowspan, colspan, grid, cell, selectedIndex, sender);\n        //     }\n        // }\n\n    } else {\n        if(page.CellInfo && page.CellInfo.cell) {\n            setMergeInfo(0, page.CellInfo.cell.rowSpan, page.CellInfo.cell.colSpan, grid, page.CellInfo, selectedIndex, sender);\n        }\n    }\n}\n\n\n\n\n// 设置合并单元格信息\nfunction setMergeInfo(i, rowspan, colspan, grid, cell, selectedIndex, sender) {\n    if(i == 0) {\n        if(cell.cell) {\n            if(selectedIndex == 1 || selectedIndex == 3) {\n                if(colspan > 1) {\n                    // if(grid) {\n                    //cell.cell.colSpan = colspan;\n                    grid.setColspan(cell.cell.parentNode.idd, cell.cell._cellIndex, colspan)\n                    // }\n                }\n                if(rowspan > 1) {\n                    // if(grid) {\n                    //cell.cell.rowSpan = rowspan;\n                    grid.setRowspan(cell.cell.parentNode.idd, cell.cell._cellIndex, rowspan)\n                    //  }\n                }\n            } else if(selectedIndex == 2) {\n                if(colspan > 1) {\n                    // if(grid) {\n                    //cell.cell.colSpan = colspan;\n                    grid.setColspan(cell.cell.parentNode.idd, cell.cell._cellIndex, colspan)\n                    // }\n                }\n            } else if(selectedIndex == 4) {\n                if(colspan > 1 && rowspan > 1) {\n                    grid.setColRowspan(cell.cell.parentNode.idd, cell.cell._cellIndex, 1, rowspan);\n                    grid.setRowspan(cell.cell.parentNode.idd, cell.cell._cellIndex, 1);\n                } else if(colspan > 1) {\n                    //  if(grid) {\n                    //cell.cell.colSpan = 1;\n                    grid.setColspan(cell.cell.parentNode.idd, cell.cell._cellIndex, 1)\n                    // }\n                } else if(rowspan > 1) {\n                    // if(grid) {\n                    //cell.cell.rowSpan = 1;\n                    grid.setRowspan(cell.cell.parentNode.idd, cell.cell._cellIndex, 1)\n                    // }\n                }\n            }\n            if(cell.cell && cell.cell.cellAttributeInfo) {\n                cell.cell.cellAttributeInfo.setCellInfos(sender.initialConfig.id, selectedIndex);\n                cell.cell.cellAttributeInfo.colspan = colspan;\n                cell.cell.cellAttributeInfo.rowspan = rowspan;\n            }\n        }\n    } else {\n        if(selectedIndex == 2) {\n            if(colspan > 1) {\n                // if(grid) {\n                //cell.cell.colSpan = colspan;\n                grid.setColspan(cell.cell.parentNode.idd, cell.cell._cellIndex, colspan)\n                // }\n            }\n        } else if(selectedIndex == 4) {\n            if(colspan > 1 && rowspan > 1) {\n                grid.setColRowspan(cell.cell.parentNode.idd, cell.cell._cellIndex, 1, rowspan);\n                grid.setRowspan(cell.cell.parentNode.idd, cell.cell._cellIndex, 1);\n            } else if(colspan > 1) {\n                // if(grid) {\n                //cell.cell.colSpan = 1;\n                grid.setColspan(cell.cell.parentNode.idd, cell.cell._cellIndex, 1)\n                //  }\n            } else if(rowspan > 1) {\n                // if(grid) {\n                //cell.cell.rowSpan = 1;\n                grid.setRowspan(cell.cell.parentNode.idd, cell.cell._cellIndex, 1)\n                // }\n            }\n        }\n    }\n}","vmdcss":"","vmdprops":"\"\"","type":"ux","vmdinterface":"{\"components\":[{\"cid\":\"vmduxprops\",\"layoutConfig\":{},\"userConfig\":{}},{\"cid\":\"vmduxmethods\",\"id\":\"方法\",\"layoutConfig\":{},\"userConfig\":{},\"cn\":[{\"cid\":\"uxmethod\",\"id\":\"setAlignInfo\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"setAlignInfo\",\"zhname\":\"\",\"bindCmp\":\"\",\"bindValue\":\"\",\"isPublic\":\"on\",\"desc\":\"设置对齐信息\",\"uxcid\":\"\",\"params\":\"info,cell\",\"code\":\"//直接填写方法内容\\nsetInfo(info,cell);\",\"returnType\":\"\"}}]},{\"cid\":\"vmduxevents\",\"id\":\"事件\",\"layoutConfig\":{},\"userConfig\":{}}]}"}