{"vmdversion":"vmd2.0.5.191031","vmdlayout":"{\"components\":[{\"cid\":\"uxpanel\",\"id\":\"ApprovlProperty\",\"layoutConfig\":{},\"userConfig\":{\"layout\":\"fit\",\"header\":false,\"width\":343,\"height\":672,\"afterrender\":\"ApprovlProperty_afterrender\"},\"cn\":[{\"cid\":\"tabpanel\",\"id\":\"MyTabs\",\"layoutConfig\":{},\"userConfig\":{\"activeTab\":0,\"tabchange\":\"MyTabs_tabchange\"},\"cn\":[{\"cid\":\"panel\",\"id\":\"panel\",\"layoutConfig\":{},\"userConfig\":{\"title\":\"属性\",\"layout\":\"fit\"},\"cn\":[{\"cid\":\"vmd.ux.ApprovlType\",\"id\":\"ApprovlType\",\"layoutConfig\":{},\"userConfig\":{\"spzj_decimalChanged\":\"ApprovlType_spzj_decimalChanged\"}}]},{\"cid\":\"panel\",\"id\":\"panel1\",\"layoutConfig\":{},\"userConfig\":{\"title\":\"事件\",\"layout\":\"fit\"},\"cn\":[{\"cid\":\"vmd.ux.Approval_Event\",\"id\":\"Approval_Event\",\"layoutConfig\":{},\"userConfig\":{}}]}]}]}]}","vmdevents":"var page = this;\n\nfunction MyTabs_tabchange(sender, tab) {\n     var t = sheetHot.dealInvert()[0]\n    var info = sheetHot.getCellMeta(t.sr, t.sc).cellAttributeInfo;\n    var cell = page.cell;\n    var curTab = tab;\n    if(info) {\n        switch (curTab.title) {\n            case \"属性\":\n                ApprovlType.setInfo(info.cell_ApprovlInfo, cell)\n                break;\n            case \"事件\":\n                Approval_Event.setInfo(info.cell_ApprovlInfo)\n                break;\n        }\n    }\n\n}\n\nfunction setInfo(info, cell) {\n    page.cell = cell;\n    page.info = info;\n    var curTab = MyTabs.activeTab;\n    switch (curTab.title) {\n        case \"属性\":\n            ApprovlType.setInfo(page.info.cell_ApprovlInfo[0], page.cell)\n            break;\n        case \"事件\":\n            Approval_Event.setInfo(info.cell_ApprovlInfo[0])\n            break;\n    }\n}\n\nfunction setCellStyle(value, type, sender) {\n    if(page.cell && page.cell.type == \"TD\") {\n        var cell = page.cell.cells;\n        if(cell) {\n            if(cell.cell && cell.cell.cellAttributeInfo) {\n                if(type == \"underline\" && value) {\n                    cell.cell.cellAttributeInfo.setCellInfos(sender.initialConfig.id, value.inputValue);\n                } else {\n                    cell.cell.cellAttributeInfo.setCellInfos(sender.initialConfig.id, value);\n                }\n            }\n            \n        }\n    } else if(page.cell && page.cell.type == \"DIV\") {\n        var cells = page.cell.cells;\n        if(cells && cells.length > 0) {\n            for(var i = 0; i < cells.length; i++) {\n                var cell = cells[i];\n                if(cell) {\n                    if(cell.cell && cell.cell.cellAttributeInfo) {\n                        if(type == \"underline\" && value) {\n                            cell.cell.cellAttributeInfo.setCellInfos(sender.initialConfig.id, value.inputValue);\n                        } else {\n                            cell.cell.cellAttributeInfo.setCellInfos(sender.initialConfig.id, value);\n                        }\n                    }\n                    \n                }\n            }\n        }\n    } else {\n        if(page.cell && page.cell.cell) {\n            if(page.cell.cell.cellAttributeInfo) {\n                if(type == \"underline\" && value) {\n                    page.cell.cell.cellAttributeInfo.setCellInfos(sender.initialConfig.id, value.inputValue);\n                } else {\n                    page.cell.cell.cellAttributeInfo.setCellInfos(sender.initialConfig.id, value);\n                }\n            }\n           \n        }\n    }\n}\n\nfunction ApprovlType_spzj_decimalChanged(sender, value, describe) {\n    page.fireEvent(\"APchange\",sender,value)\n}\n\nfunction ApprovlProperty_afterrender(sender){\n\n}","vmdcss":"","vmdprops":"\"\"","type":"ux","vmdevents_controller":"Ext.define('vmd.ux.approvlProperty.Controller', {\n    xtype: 'vmd.ux.approvlProperty.Controller',\n    constructor: function(options) {\n        \n    }\n})","vmdinterface":"{\"components\":[{\"cid\":\"vmduxprops\",\"layoutConfig\":{},\"userConfig\":{}},{\"cid\":\"vmduxmethods\",\"id\":\"方法\",\"layoutConfig\":{},\"userConfig\":{},\"cn\":[{\"cid\":\"uxmethod\",\"id\":\"setInfo\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"setInfo\",\"zhname\":\"\",\"bindCmp\":\"\",\"bindValue\":\"\",\"isPublic\":\"on\",\"desc\":\"\",\"uxcid\":\"\",\"params\":\"info,cell\",\"code\":\"setInfo(info,cell);\",\"returnType\":\"\"}}]},{\"cid\":\"vmduxevents\",\"id\":\"事件\",\"layoutConfig\":{},\"userConfig\":{},\"cn\":[{\"cid\":\"uxevent\",\"id\":\"APchange\",\"layoutConfig\":{},\"userConfig\":{\"id\":\"APchange\",\"params\":\"value\",\"desc\":\"\"}}]}]}","vmdresource":"{\"components\":[{\"cid\":\"vmdrescsss\",\"layoutConfig\":{},\"userConfig\":{}},{\"cid\":\"vmdresjss\",\"layoutConfig\":{},\"userConfig\":{},\"cn\":[{\"cid\":\"resjs\",\"id\":\"controller.js\",\"layoutConfig\":{},\"userConfig\":{}}]},{\"cid\":\"vmdresimgs\",\"layoutConfig\":{},\"userConfig\":{}}]}"}