<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

    <title>自定义工作台</title>
	<!--基本样式-->
    <link href="/css/common.css?ver=2.0.3.0920" rel="stylesheet" />
    <!--加载dhx组件-->
    <link href="/lib/ext-3.4/resources/css/ext-all.css?ver=2.0.3.0920" rel="stylesheet" />
   
    <link href="/design/css/icons.css?ver=2.0.3.0920" rel="stylesheet" />

	<link href="/lib/dhtmlx/dhtmlx.css?ver=2.0.3.0920" rel="stylesheet" />
	  <!--样式快捷索引表-->
    <link href="/css/shortcut.css?ver=2.0.3.0920" rel="stylesheet" />
    
    <script src="/lib/labjs/LAB.min.js?ver=2.0.3.0920"></script>
    <script src="/config.js?ver=2.0.3.0920"></script>
    <script src="/lib/ext-3.4/adapter/ext/ext-base-debug.js?ver=2.0.3.0920"></script>
    <script src="/lib/ext-3.4/adapter/ext/ext-base-lang.js?ver=2.0.3.0920"></script>
    <script src="/lib/ext-3.4/adapter/ext/ext-base-class.js?ver=2.0.3.0920"></script>
    <script src="/lib/ext-3.4/ext-all-debug.js?ver=2.0.3.0920"></script>
    <script src="/lib/ext-3.4/src/locale/ext-lang-zh_CN.js?ver=2.0.3.0920"></script>
    <script src="/js/util.js?ver=2.0.3.0920"></script>
    <script src="/lib/dhtmlx/dhtmlx.js?ver=2.0.3.0920"></script>
	<script src="/report/dhtmlx/dhtmlxCommon/codebase/dhtmlxcommon.js?ver=2.0.3.0920"></script>
	<script src="/report/dhtmlx/dhtmlxCommon/codebase/dhtmlxcore.js?ver=2.0.3.0920"></script>
    <script src="/report/dhtmlx/dhtmlxCommon/codebase/dhtmlxcontainer.js?ver=2.0.3.0920"></script>
	<script src="/report/FillReport2.0/js/dhtmlx/dhtmlXFileUploader.js?ver=2.0.3.0920"></script>
    <script src="/js/hwdas.js?ver=2.0.3.0920"></script>
	<script src="/js/hwMSC.js?ver=2.0.3.0920"></script>
    <script src="/js/vmdcore.js?ver=2.0.3.0920"></script>
    <script src="/js/vmdcomps.js?ver=2.0.3.0920"></script>
    <script src="/js/publicMethods.js?ver=2.0.3.0920"></script>
    <script src="/js/vmdreport.js?ver=2.0.3.0920"></script>
    <script src="/release/12efebd0-5bd2-4d64-8582-fe88888e55ac/config.js"></script>

    <script src="/lib/ace/ace.js"></script>
    <script src="/lib/ace/mode-base.js" type="text/javascript"></script>
    <script src="/lib/ace/theme-xcode.js" type="text/javascript" ></script>
    <script src="/lib/ace/ext-language_tools.js"></script>
    

    <style>

    </style>
    <style type="text/css" id="vmdcss">
        /* =========================================== MainViewport =========================================== */
/* 总体字体样式 */
.vmd-global {
    font-size: 14px;
    color: #2e2e2e;
}

/* 重写下拉框选中样式 */
.vmd-global div.dhxcombo_material.dhxcombo_actv {
    padding-bottom: 1px;
    border-bottom: 1px solid #3c8fff;
}

/* 重写日期选择框选中样式 */
.vmd-global .x-form-text.x-form-focus {
    padding-bottom: 1px;
    border-bottom: 1px solid #3c8fff;
}

/* 重写下拉框边框样式 */
.vmd-global .dhxcombo_material {
    border-radius: 4px;
    border: 1px solid #e4e4e4;
}

/* 鼠标悬停 */
.vmd-global .dhxcombo_material:hover {
    border: 1px solid #3c8fff;
}

/* 重写下拉框箭头样式 */
.vmd-global .dhxcombo_material .dhxcombo_select_button {
    height: 25px;
    background: none;
    padding-right: 6px;
    filter: none;
}

/* 箭头图片替换 */
.vmd-global .dhxcombo_material .dhxcombo_select_img {
    background-image: url("http://www.hanweikeji.com:6606/resource/图片/dhxcombo_arrow_down.gif") !important;
}

/* 重写下拉框输入框样式 */
.vmd-global .dhxcombo_material .dhxcombo_input {
    height: 30px;
    line-height: 30px;
    margin-left: 7px;
    font-size: 14px;
    color: #2E2E2E;
}

/* 重写下拉框内容样式 */
.vmd-global .dhxcombolist_material {
    border-color: #e4e7ed;
    border-radius: 4px;
    margin-top: 2px;
}

/* 重写下拉框内容项样式 */
.vmd-global .dhxcombolist_material .dhxcombo_option {
    height: 30px;
    line-height: 30px;
    font-size: 14px;
    color: #2E2E2E;
    border-width: 0;
}

/* 重写下拉框内容项鼠标悬停样式 */
.vmd-global .dhxcombolist_material .dhxcombo_option :hover {
    background-color: #daecfd;
}

/* 重写下拉框内容项文本样式 */
.vmd-global .dhxcombolist_material .dhxcombo_option .dhxcombo_option_text {
    padding-left: 8px;
}

/* 重写下拉框内容项选中样式 */
.vmd-global .dhxcombolist_material .dhxcombo_option_selected.dhxcombo_option {
    border-width: 0 !important;
    background-color: #fdebda !important;
}

/* =========================================== MainViewport =========================================== */
/* =========================================== Date Field =========================================== */
/* 日期选择框样式 */
.vmd-date {
    border-radius: 4px;
    border: 1px solid #e4e4e4;
    width: 120px !important;
    height: 30px !important;
    background-image: url("../图片/calendar.png");
    background-repeat: no-repeat;
    background-position: 100px;
    font-size: 14px;
}

/* =========================================== Date Field =========================================== */
/* =========================================== Button =========================================== */
/* 一般按钮样式 */
.vmd-btn {
    padding: 0;
    text-align: center;
    height: 30px;
    line-height: 27px;
    color: #fff;
    border: 1px solid #4a67d2;
    background-color: #4a67d2;
    border-radius: 4px;
    width: 80px;
}

/* 鼠标悬停 */
.vmd-btn:hover {
    border: 1px solid #6e88e5;
    background-color: #6e88e5;
    color: white;
    cursor: pointer;
}

/* 鼠标点击 */
.vmd-btn:active {
    border: 1px solid #3652bb;
    background-color: #3652bb;
    color: white;
    cursor: pointer;
}

/* 屏蔽按钮选中样式 */
.vmd-btn.vmd-button-selected {
    color: white !important;
}

/* 取消按钮样式 */
.vmd-btn-cancel {
    padding: 0;
    text-align: center;
    height: 30px;
    line-height: 27px;
    color: #353535;
    border: 1px solid #e3e2e8;
    background-color: #fff;
    border-radius: 4px;
    width: 80px;
}

/* 鼠标悬停 */
.vmd-btn-cancel:hover {
    color: #353535;
    cursor: pointer;
    border: 1px solid #e3e2e8;
}

/* 鼠标点击 */
.vmd-btn-cancel:active {
    border: 1px solid #e2e2e2;
    background-color: #e2e2e2;
    color: black;
    cursor: pointer;
}

/* 屏蔽按钮选中样式 */
.vmd-btn-cancel.vmd-button-selected {
    color: #353535 !important;
    border: 1px solid #e3e2e8;
}

/* =========================================== Button =========================================== */
/* =========================================== Grid Panel =========================================== */
/* 表格左右间距 */
.vmd-grid {
    padding-left: 2%;
    padding-right: 2%;
}

/* 表格线样式兼容 */
.vmd-grid table {
    border-collapse: collapse;
}

/* 表头背景色 */
.vmd-grid .x-grid3-header {
    background-color: #f7f7f7;
}

/* 表头鼠标悬停背景色 */
.vmd-grid .x-grid3-hd-over .x-grid3-hd-inner {
    background-color: #f7f7f7;
}

/* 表头错位兼容 */
.vmd-grid .x-grid3-header-offset {
    padding: 0;
}

/* 表头单元格 */
.vmd-grid .x-grid3-header td {
    border: 1px solid #e3e2e8;
    font-size: 14px;
}

/* 表体单元格 */
.vmd-grid .x-grid3-body td {
    border: 1px solid #e3e2e8;
    border-top-width: 0;
    padding: 0;
    font-size: 14px;
}

/* 表体行 */
.vmd-grid .x-grid3-row {
    border: none;
}

/* 表体行鼠标悬停背景色 */
.vmd-grid .x-grid3-row-over {
    background-color: white;
}

/* 表体行选中背景色 */
.vmd-grid .x-grid3-row-selected {
    background-color: #F5F7FC !important;
}

/* =========================================== Grid Panel =========================================== */
/* =========================================== Text Field =========================================== */
/* 带边框的输入框 */
.vmd-text {
    height: 30px !important;
    line-height: 30px;
    padding-left: 8px;
    border: 1px solid #e4e4e4;
    border-radius: 4px;
    font-size: 14px;
}

/* 获得焦点 */
.vmd-text:focus {
    border: 1px solid #3c8fff;
}

/* 不带边框的输入框 */
.vmd-text-border-none {
    height: 30px !important;
    line-height: 30px;
    padding-left: 8px;
    border: none;
    font-size: 14px;
}

/* 获得焦点 */
.vmd-text-border-none:focus {
    border: none !important;
}

/* 带底部边框的输入框 */
.vmd-text-border-bottom {
    height: 30px;
    line-height: 30px;
    padding-left: 8px;
    border-width: 0;
    border-bottom: 1px solid #e4e4e4;
    font-size: 14px;
}

/* =========================================== Text Field =========================================== */
/* =========================================== Text Area =========================================== */
/* 文本域样式 */
.vmd-textarea {
    line-height: 30px;
    padding-left: 8px;
    border: 1px solid #e4e4e4;
    border-radius: 4px;
    font-size: 14px;
}

/* 获得焦点 */
.vmd-textarea:focus {
    border: 1px solid #3c8fff !important;
}

/* =========================================== Text Area =========================================== */
.overf-top {
    margin-top: 10px !important;
}

.x-panel-header {
    font-size: 14px;
    height: 20px;
    text-align: center;
}

.x-tree-node-el {
    line-height: 30px;
    cursor: pointer;
}
.flott{
    float: left;
}

    </style>
    <script>
	    
        vmd.virtualPath = '';
        
        Ext.define("vmd.module.MainViewport" ,{
	extend:"vmd.comp.viewport",
	requires:vmd.getCmpDeps([]),
	xtype:"vmd.module.MainViewport",
	layoutConfig:{
		align:"top",
		pack:"center",
		padding:"",
		scrollOffset:10
	},
	layout:"hbox",
	cls:"vmd-global",
	autoScroll:false,
	afterrender:"MainViewport_afterrender",
	listeners:{
		vmdafterrender:function(){
	this.MainViewport_afterrender(this)
}
	},
	initComponent: function(){
		 var paghe = this;
 var mytree = null;
 var picForm = null;
 var pidForm = null;
 var formWindow = null;
 var loadWindow = null;
 var jsonData = {
     id: "root",
     text: "根节点", //节点名称
     expanded: true, //展开
     leaf: false, //是否为叶子节点
     children: [{
             text: '办公类',
             leaf: false,
             expanded: true, //展开,
             draggable: false,
             children: [{
                 text: "待办已办",
                 id: 'dbyb',
                 leaf: true,
                 draggable: true
             }]
         },
         {
             text: '曲线类',
             leaf: false,
             expanded: true, //展开,
             draggable: false,
             children: [{
                 text: "本班任务统计",
                 id: 'bbrwtj',
                 leaf: true,
                 draggable: true
             }]
         }, {
             text: '表格类',
             leaf: false,
             expanded: true, //展开,
             draggable: false,
             children: [{
                 text: "任务运行监控",
                 id: 'rwyxjk',
                 leaf: true,
                 draggable: true
             }]
         }
     ]
 }

 function newPictureWin() {
     var row = '';
     var cell = '';
     var windows = new Ext.Window({
         title: '提示框',
         width: 260,
         height: 180,
         resizable: false,
         plain: false,
         frame: true,
         border: false,
         modal: true,
         constrainHeader: true,
         autoScroll: true,
         formPanel: picForm,
         form: picForm.form,
         closeAction: 'hide',
         items: [picForm],
         listeners: {
             beforeHide: function() {
                 formWindow.show();
             }
         },
         buttons: [{
             text: '确定',
             handler: function() {
                 row = vmd('#row').val();
                 cell = vmd('#cell').val();
                 addPanel(row, cell);
                 vmd('#row').val('');
                 vmd('#cell').val('');
                 windows.hide();
             }
         }, {
             text: '关闭',
             handler: function() {
                 windows.hide();
             }
         }]
     });
     return windows;
 }

 function button1_click(sender, e) {
     formWindow = newPictureWin();
     formWindow.show();
 }

 function addPanel(row, cell) {
     /*var row = 1;
     var cell = 4;*/
     var panels = 'panels' + Math.random();
     panels = new Ext.Panel({
         margins: '10 0 0 0',
         header: false,
         width: 1000,
         autoScroll: true,
         style: 'border: 0px solid #e4e4e4;margin:0 0 0 0;',
         region: 'center',
         layout: {
             type: 'table',
             align: 'center'
         },
     });
     panels.layout.columns = cell;
     var style = 'border: 1px solid #e4e4e4;margin:0 5px 10px 5px;';
     for(var i = 0; i < row; i++) {
         for(var j = 0; j < cell; j++) {
             var pan = 'pan' + Math.random();
             var width = (1000 - cell * 10 - 10) / cell;
             var height = (1000 - cell * 10 - 10) / cell;
             setDx(pan, width, height, style, panels);
         }
     }
     panel3.add(panels);
     panel3.doLayout();
 }



 //动态创建对象
 function setDx(pans, width, height, style, panels) {
     var pans = new Ext.Panel({
         margins: '0 0 0 0',
         style: style,
         height: height,
         width: width,
         region: 'center',
         layout: {
             type: 'fit',
             align: 'stretch'
         },
         draggable: {
             insertProxy: false, //设置不需要虚边框
             //拖动事件
             onDrag: function(e) {
                 //获得移动之后的对象，代理对象
                 var pel = this.proxy.getEl();
                 this.x = pel.getLeft(true); //设置坐标
                 this.y = pel.getTop(true);
                 //获得阴影对象
                 var s = this.panel.getEl().shadow;
                 //设置阴影与拖动同步
                 if(s) {
                     s.realign(this.x, this.y, pel.getWidth(), pel.getHeight())
                 }
             },
             //松开鼠标是触发
             endDrag: function(e) {
                 //设置panel到拖动之后的位置
                 this.panel.setPosition(this.x, this.y);
             }
         }
     });
     pans.add({
         flex: 1,
         layout: {
             type: 'fit',
             align: 'center'
         },
         defaults: {
             ddGroup: 'mygroup',
             listeners: {
                 render: renderHander
             },
             frame: true
         },
         items: [{
             title: '组件编辑区',
             flex: 1,
             margins: '0 0 0 0',
         }]
     });
     panels.add(pans)
     panels.doLayout();
 }

 function panel_afterrender(sender) {
     var panerl_renderTo = panel.el.dom.childNodes[1].childNodes[0].id;
     
     mytree = new Ext.tree.TreePanel({
         header: false,
         animate: true, //以动画形式伸展,收缩子节点
         /*title:"Extjs静态树",*/
         onlyLeafCheckable: false,
         enableDD: true,
         enableDrag: false, //树的节点可以拖动Drag(效果上是),注意不是Draggable
         enableDrop: false, //仅仅drop
         ddGroup: 'mygroup',
         renderTo: panerl_renderTo,
         collapsible: true,
         rootVisible: false, //是否显示根节点
         autoScroll: true,
         autoHeight: true,
         /* width:150,
          height : 300,*/
         lines: false, //节点之间连接的横竖线
         loader: new Ext.tree.TreeLoader(), //
         root: new Ext.tree.AsyncTreeNode(jsonData),
     });

     mytree.render();

     mytree.on("nodedragover", function(e) {
         var node = e.target;
         if(node.leaf || !node.leaf) {
             node.leaf = false;
         }
         return true;
     });

 }


 var renderHander = function(cmp) {
     new Ext.dd.DropTarget(cmp.body.dom, {
         ddGroup: 'mygroup',
         notifyDrop: function(ddSource, e, data) {
             if(!data.node.hasChildNodes()) {
                 cmp.setTitle(data.node.attributes.text);
                 $LAB.script(vmd.virtualPath + '/components/ux/componentstab/1.0/ComponentsTab.js').wait(function(e) { // 等待所有script加载完再执行这个代码块					cmp.add(e);
                     allcmploaded = true;
                     panels.add("vmd.ux.ComponentsTab");
                     //加载模块树
                     /*xds.toolbox.loadUserTypes2();
                     me.initModule()*/
                 });
                 

             }
             return true;
         }
     });
 };

 function mygroup_afterrender(sender) {
     mygroup.add({
         flex: 1,
         layout: {
             type: 'fit',
             align: 'center'
         },
         defaults: {
             ddGroup: 'mygroup',
             listeners: {
                 render: renderHander
             },
             frame: true
         },
         items: [{
             /*id: pans,*/
             title: '组件编辑区',
             flex: 1,
             margins: '0 0 0 10',
             html: "<div id='div3'></div>"
         }]
     });
 }

 function MainViewport_afterrender(sender) {
     picForm = new Ext.form.FormPanel({
         labelAlign: 'center',
         fileUpload: false,
         border: false,
         frame: false,
         autoScroll: true,
         layout: 'fit',
         items: [{
             border: true,
             autoScroll: true,
             html: "<div style='margin:10px;' id='alertDiv'><table style='margin:10px;'>" +
                 "<tr><td><span>行：</span></td><td><input type='text' class='vmd-text'  id='row' autocomplete='off'/>" +
                 "</td></tr><tr><td><span>列：</span></td><td><input type='text' class='vmd-text'  id='cell' autocomplete='off'/></td></tr>" +
                 "</table></div>"
         }]
     });
     pidForm = new Ext.form.FormPanel({
         labelAlign: 'center',
         fileUpload: false,
         border: false,
         frame: false,
         autoScroll: true,
         layout: 'fit',
         items: [{
             border: true,
             autoScroll: true,
             html: "<div style='margin:10px;' id='alertDiv'><table style='margin:10px;'>dfsdfds</div>"
         }]
     });
 }

 function button6_click(sender, e) {
     loadWindow = loadWin();
     loadWindow.show();
 }

 function loadWin() {
     var windows = new Ext.Window({
         title: '模板列表',
         width: 800,
         height: 500,
         resizable: false,
         plain: false,
         frame: true,
         border: false,
         modal: true,
         constrainHeader: true,
         autoScroll: true,
         formPanel: pidForm,
         form: pidForm.form,
         closeAction: 'hide',
         items: [pidForm],
         listeners: {
             beforeHide: function() {
                 loadWindow.show();
             }
         },
         buttons: [{
             text: '确定',
             handler: function() {
                 row = vmd('#row').val();
                 cell = vmd('#cell').val();
                 addPanel(row, cell);
                 vmd('#row').val('');
                 vmd('#cell').val('');
                 windows.hide();
             }
         }, {
             text: '关闭',
             handler: function() {
                 windows.hide();
             }
         }]
     });
     return windows;
 }
			this.MainViewport_afterrender=MainViewport_afterrender;



		this.items=[
			{
				xtype:"panel",
				id:"panel",
				title:"桌面组件",
				header:true,
				border:true,
				height:690,
				x:10,
				y:10,
				layout:"hbox",
				width:266,
				margins:"10px 10px  10px 0",
				cls:"header",
				afterrender:"panel_afterrender",
				listeners:{
					vmdafterrender:panel_afterrender
				}
			},
			{
				xtype:"panel",
				id:"panel1",
				title:"Panel",
				header:false,
				border:true,
				height:690,
				x:240,
				y:10,
				layout:"auto",
				margins:"10px 0 10px 0",
				autoScroll:false,
				items:[
					{
						xtype:"panel",
						id:"panel2",
						layoutConfig:{
							align:"middle",
							pack:"end"
						},
						title:"Panel",
						header:false,
						border:true,
						height:40,
						layout:"hbox",
						bodyStyle:"border: 1px solid  #ddd;    background-color: #f5f5f5;",
						padding:"0 10px 0 0",
						items:[
							{
								xtype:"vmd.button",
								id:"button6",
								text:"模板选择",
								type:"primary",
								size:"small",
								region:"east",
								margins:"0 10px 0 0",
								width:80,
								height:30,
								click:"button6_click",
								listeners:{
									click:button6_click
								}
							},
							{
								xtype:"vmd.button",
								id:"button",
								text:"保存为模板",
								type:"primary",
								size:"small",
								region:"east",
								margins:"0 10px 0 0",
								width:80,
								height:30
							},
							{
								xtype:"vmd.button",
								id:"button1",
								text:"新增",
								type:"primary",
								size:"small",
								region:"north",
								margins:"0 10px 0 0",
								click:"button1_click",
								width:80,
								height:30,
								listeners:{
									click:button1_click
								}
							},
							{
								xtype:"vmd.button",
								id:"button2",
								text:"重置",
								type:"primary",
								size:"small",
								region:"south",
								margins:"0 10px 0 0",
								width:80,
								height:30
							},
							{
								xtype:"vmd.button",
								id:"button4",
								text:"保存",
								type:"primary",
								size:"small",
								margins:"0 10px 0 0 ",
								width:80,
								height:30
							},
							{
								xtype:"vmd.button",
								id:"button5",
								text:"取消",
								type:"primary",
								size:"small",
								margins:"0 0 0 0",
								width:80,
								height:30
							}
						]
					},
					{
						xtype:"panel",
						id:"panel3",
						title:"Panel",
						header:false,
						border:true,
						height:690,
						layout:"auto",
						autoHeight:false,
						width:1000,
						autoScroll:true,
						cls:"overf-top",
						style:"overflow: auto !important;"
					}
				]
			}
		]
		this.callParent();
		var me = this;vmd.core.moduleInit(this.items, this);
	}
})
        Ext.onReady(function () {
            Ext.create('vmd.module.MainViewport', {
                renderTo: document.body
            })


        })

      </script>
</head>
<body>
</body>
</html>
